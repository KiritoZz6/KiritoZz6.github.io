<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>LeetCodeå‘¨èµ›266åœº</title>
      <link href="LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B266%E5%9C%BA/"/>
      <url>LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B266%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCodeå‘¨èµ›266åœº"><a href="#LeetCodeå‘¨èµ›266åœº" class="headerlink" title="LeetCodeå‘¨èµ›266åœº"></a>LeetCodeå‘¨èµ›266åœº</h1><p>æœ¬å‘¨çš„å‘¨èµ›é¢˜ç›®çœ‹ä¸Šå»æŒºéš¾çš„ï¼Œä½†èµ›åçœ‹äº†ä¸€ä¸‹åˆ«äººçš„è§£ç­”å‘ç°å…¶å®ä¹Ÿå¹¶ä¸å¤æ‚ï¼Œç»ˆç©¶è¿˜æ˜¯å¾—å¤šåšé¢˜å¤šæ€è€ƒğŸ’¦</p><h2 id="2062-ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³å­å­—ç¬¦ä¸²"><a href="#2062-ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³å­å­—ç¬¦ä¸²" class="headerlink" title="2062. ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³å­å­—ç¬¦ä¸²"></a><a href="https://leetcode-cn.com/problems/count-vowel-substrings-of-a-string/">2062. ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³å­å­—ç¬¦ä¸²</a></h2><img src="https://i.loli.net/2021/11/09/ng5oS9MrtU3XKDJ.png" style="zoom:80%;" /><img src="https://i.loli.net/2021/11/09/QAnk9YMCWuNGDc3.png" style="zoom:80%;" /><p>ç¬¬ä¸€é¢˜ç»å…¸å¯ä»¥æš´åŠ›è§£æ³•ï¼Œä½†éœ€è¦æ³¨æ„çœ‹æ¸…é¢˜ç›®ï¼Œæˆ‘åœ¨åšçš„æ—¶å€™ç¬¬ä¸€æ¬¡çœ‹é¢˜è·³ç€çœ‹å¯¼è‡´çœ‹é”™äº†é¢˜æ„ï¼Œæ‰€ä»¥ç®€å•é¢˜æ›´åº”è¯¥å°å¿ƒï¼Œä¸èƒ½å¤ªç€æ€¥</p><p>ä¸‹é¢æ˜¯æˆ‘çš„æš´åŠ›è§£æ³•</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">countVowelSubstrings</span><span class="token punctuation">(</span>string word<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> wlen<span class="token operator">=</span>word<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>wlen<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">char</span> w<span class="token operator">=</span>word<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">==</span><span class="token string">'a'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'e'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'i'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'o'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'u'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> temp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">bool</span> sig<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>i<span class="token punctuation">;</span>j<span class="token operator">&lt;</span>wlen<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    w<span class="token operator">=</span>word<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">==</span><span class="token string">'a'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'e'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'i'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'o'</span><span class="token operator">||</span>w<span class="token operator">==</span><span class="token string">'u'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token operator">++</span>temp<span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">==</span><span class="token string">'a'</span><span class="token punctuation">)</span>                            sig<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">==</span><span class="token string">'e'</span><span class="token punctuation">)</span>                            sig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">==</span><span class="token string">'i'</span><span class="token punctuation">)</span>                            sig<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">==</span><span class="token string">'o'</span><span class="token punctuation">)</span>                            sig<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>w<span class="token operator">==</span><span class="token string">'u'</span><span class="token punctuation">)</span>                            sig<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                        temp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                        <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>temp<span class="token operator">>=</span><span class="token number">5</span><span class="token punctuation">)</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>sig<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>sig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>sig<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>sig<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>sig<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                            <span class="token operator">++</span>res<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="2063-æ‰€æœ‰å­å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³"><a href="#2063-æ‰€æœ‰å­å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³" class="headerlink" title="2063. æ‰€æœ‰å­å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³"></a><a href="https://leetcode-cn.com/problems/vowels-of-all-substrings/">2063. æ‰€æœ‰å­å­—ç¬¦ä¸²ä¸­çš„å…ƒéŸ³</a></h2><img src="https://i.loli.net/2021/11/09/ojNTOd4J9l2VuFz.png" style="zoom:80%;" /><img src="https://i.loli.net/2021/11/09/GbS93UM7IRAd4Kt.png" style="zoom:80%;" /><p>è¿™é“é¢˜åœ¨ç«èµ›åšçš„æ—¶å€™è§‰å¾—æŒºå¤æ‚æŒºéš¾çš„ï¼Œä½†çœ‹äº†é¢˜è§£ä¹‹åå…¶å®å¹¶ä¸éš¾ï¼Œåªæ˜¯ä¸€é“dpé—®é¢˜ï¼Œåªå¯æƒœå½“æ—¶åšçš„æ—¶å€™æ²¡æœ‰æƒ³åˆ°</p><p>è¿™é‡Œçš„dpè½¬ç§»æ¡ä»¶å¯ä»¥ç›´æ¥å½“æˆè¿”å›æ¡ä»¶ï¼Œå³<code>res</code>ï¼Œä½†æ˜¯è¦æ³¨æ„å®ƒæ˜¯ä¸€ä¸ª<code>long long</code>ç±»å‹çš„</p><p>éšåæ˜¯çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œæˆ‘ä»¬åœ¨éå†å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè®¾å½“å‰éå†åˆ°çš„å­—ç¬¦ä¸º<code>cur</code>ï¼Œå¦‚æœ<code>cur</code>æ˜¯å…ƒéŸ³å­—ç¬¦ï¼Œåˆ™åˆ°æ­¤å­—ç¬¦ä¸ºæ­¢çš„<code>res</code>çŠ¶æ€æ˜¯ç”±å‰ä¸€ä¸ªå­—ç¬¦çš„<code>res</code>çŠ¶æ€å†åŠ ä¸Šå½“å‰åŒ…å«<code>cur</code>çš„å­å­—ç¬¦ä¸²ä¸ªæ•°ï¼Œå³<code>if(cur==å…ƒéŸ³) -&gt; res=res+åŒ…å«curå­ä¸²ä¸ªæ•°</code></p><p>é‚£ä¹ˆç°åœ¨é—®é¢˜æ¥åˆ°äº†æ€ä¹ˆæ±‚åŒ…å«<code>cur</code>å­ä¸²ä¸ªæ•°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†<code>cur</code>åœ¨å­—ç¬¦ä¸²ä¸­ä½ç½®è§†ä¸ºä¸­ç‚¹ï¼Œä¾‹å¦‚å®ƒçš„ä½ç½®ä¸º<code>i</code></p><p>åˆ™åœ¨å®ƒå·¦è¾¹å¯ä»¥é€‰æ‹©ç¬¬<em>0,1,2,3â€¦i-1,i</em>ä¸ªå­—ç¬¦ä¸<code>cur</code>æ„æˆä¸€ä¸ªå­ä¸²ï¼Œè¿™é‡Œä¸€å…±æœ‰<code>i+1</code>ç§æƒ…å†µ</p><p>åœ¨å®ƒå³è¾¹å¯ä»¥é€‰æ‹©<em>i,i+1,i+2â€¦.n-2,n-1</em>ï¼Œä¸€å…±<code>n-i</code>ç§æƒ…å†µ</p><p>æ€»å…±åŠ èµ·æ¥çš„å­å­—ç¬¦ä¸²ä¸ªæ•°å°±æ˜¯<code>(i+1)(n-i)</code>ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ä¹˜æ³•å‘¢ï¼Œæ˜¯å› ä¸ºå­—ç¬¦<code>cur</code>ä¸¤è¾¹å¯ä»¥äº’ç›¸è¿æ¥ï¼Œä¾‹å¦‚åœ¨<em>a b c d e</em>å­—ç¬¦ä¸²ä¸­ï¼Œä»¥<em>b</em>ä¸ºä¸­å¿ƒï¼Œå¯ä»¥æ„æˆä»¥ä¸‹å­ä¸² <em>a b c</em> æˆ–  <em>b c d</em> ç­‰ï¼Œä¸¤è¾¹é€‰æ‹©ä¸€äº›å­—ç¬¦ç„¶åæ„æˆå…¶ä¸­ä¸€ä¸ªå­ä¸²ï¼Œæ‰€ä»¥è¿™æ˜¯æ•°å­¦ä¸­æ’åˆ—ç»„åˆçš„ <strong>ç»„åˆé—®é¢˜</strong></p><p>äº†è§£äº†è¿™äº›å°±å¯ä»¥å¾ˆè½»æ˜“å†™å‡ºä»£ç æ¥äº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">countVowels</span><span class="token punctuation">(</span>string word<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> wlen<span class="token operator">=</span>word<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> <span class="token keyword">long</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> <span class="token keyword">char</span> vowels<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'e'</span><span class="token punctuation">,</span><span class="token string">'i'</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">,</span><span class="token string">'u'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>wlen<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">char</span> cur<span class="token operator">=</span>word<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>vowels<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>cur<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//éå†åˆ°çš„å­—æ¯æ˜¯å…ƒéŸ³å­—æ¯</span>                    res<span class="token operator">+=</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>wlen<span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="2064-åˆ†é…ç»™å•†åº—çš„æœ€å¤šå•†å“çš„æœ€å°å€¼"><a href="#2064-åˆ†é…ç»™å•†åº—çš„æœ€å¤šå•†å“çš„æœ€å°å€¼" class="headerlink" title="2064. åˆ†é…ç»™å•†åº—çš„æœ€å¤šå•†å“çš„æœ€å°å€¼"></a><a href="https://leetcode-cn.com/problems/minimized-maximum-of-products-distributed-to-any-store/">2064. åˆ†é…ç»™å•†åº—çš„æœ€å¤šå•†å“çš„æœ€å°å€¼</a></h2><img src="https://i.loli.net/2021/11/09/L8MljnYs4i1cRdp.png" style="zoom:80%;" /><img src="https://i.loli.net/2021/11/09/k3mcabiyPAlSfzv.png" style="zoom:80%;" /><p>è¿™é“é¢˜ä¹Ÿæ˜¯å½“æ—¶åšä¸å‡ºæ¥çš„ï¼Œè§‰å¾—é¢˜ç›®ä¼¼æ‡‚éæ‡‚çš„æ ·å­ï¼Œå¯¼è‡´ä¹Ÿæ²¡æœ‰æ€è·¯</p><p>å…¶å®è¿™é“é¢˜æœ¬è´¨æ˜¯ä¸€ä¸ªäºŒåˆ†é¢˜ï¼Œè¦æ‰¾å‡ºå¯ä»¥æ»¡è¶³åˆ†é…åº—é“ºæƒ…å†µä¸‹ï¼Œæ¯å®¶åº—æœ€å¤§å¯ä»¥åˆ†é…çš„å•†å“æ•°</p><p>æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¾ªç¯ä¸æ–­å¯»æ‰¾è¿™ä¸ªå€¼ï¼Œè¿™é‡Œè®¾æ¯ä¸€å›åˆåˆ†é…<code>mid</code>ä¸ªå•†å“æ—¶ï¼Œæœ€åéœ€è¦çš„åº—é“ºæ•°ä¸º<code>cnt</code>ï¼Œåœ¨ä¸€è½®åˆ†é…ç»“æŸåï¼Œåˆ¤æ–­<code>cnt</code>ä¸é¢˜ç›®æ‰€ç»™çš„<code>n</code>çš„å…³ç³»</p><p>å¦‚æœï¼š</p><ul><li><code>cnt</code>&gt;<code>n</code>ï¼Œåˆ™ä¸€å®šä¸åˆæ³•ï¼Œå› ä¸ºåº—é“ºæ•°é‡è¿‡å¤šè¯æ˜å•†å“åˆ†é…å¤ªå°‘äº†ï¼Œå¯ä»¥å†è¿›ä¸€æ­¥å‹ç¼©åº—é“ºæ•°</li><li><code>cnt</code>=<code>n</code>ï¼Œåˆšå¥½æ»¡è¶³åˆ†é…åº—é“ºæ•°è¦æ±‚ï¼Œä½†æ˜¯è¦æ³¨æ„å•†å“æ•°ä¸èƒ½æœ‰å‰©ä½™ï¼Œå³<code>mod=0</code></li><li><code>cnt</code>&lt;<code>n</code>ï¼Œè¯´æ˜ä¸èƒ½å¯¹æ¯ä¸ªå•†åº—éƒ½åˆ†é… mid å•†å“ï¼Œä½†å‰©ä½™çš„å•†å“ç§ç±»å¿…é¡»æ»¡è¶³æœªèƒ½åˆ†é…çš„å•†åº— å³ mod &lt;= n - cntã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰å‰©ä¸‹çš„å•†å“åˆ†é…åˆ°å‰©ä½™çš„å•†åº—ä¸­ï¼Œè‹¥ä»æœ‰å•†åº—å‰©ä½™å°±ä¸åˆ†é…å•†å“ï¼Œåˆ™æ¯ç§å‰©ä½™çš„å•†å“æ•°é‡ä¸€å®šå°äºmid</li></ul><p>ä¸‹é¢æ˜¯æˆ‘åæ¥è‡ªå·±å†™çš„ä»£ç ï¼Œè¦æ³¨æ„çš„æ˜¯äºŒåˆ†çš„ç•Œé™ï¼Œå¦‚æ¯æ¬¡æ›´æ–°æ—¶çš„æ“ä½œç­‰ï¼Œè¿˜æœ‰å°±æ˜¯æœ€åè¿”å›çš„æ˜¯<code>l</code>ï¼Œæˆ‘ä¹Ÿè¯•è¿‡äº†è‹¥ç›´æ¥è¿”å›<code>mid</code>æ˜¯ä¸è¡Œçš„ï¼ˆâ—è¿™é‡Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">minimizedMaximum</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> quantities<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> l<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//æ³¨æ„åˆå§‹å€¼æ¡ä»¶</span>        <span class="token keyword">int</span> r<span class="token operator">=</span><span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>quantities<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>quantities<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> mid<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>l<span class="token operator">&lt;</span>r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            mid<span class="token operator">=</span><span class="token punctuation">(</span>l<span class="token operator">+</span>r<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> cnt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mid<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                l<span class="token operator">=</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>                        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> i<span class="token operator">:</span>quantities<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> cur<span class="token operator">=</span>i<span class="token operator">/</span>mid<span class="token punctuation">;</span><span class="token comment">//æ±‚å‡ºå½“å‰å•†å“æŒ‰midä»¶ä¸€å®¶åº—å¯ä»¥åˆ†å¤šå°‘åº—</span>                cnt<span class="token operator">+=</span>cur<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">%</span>mid<span class="token punctuation">)</span><span class="token comment">//å¦‚æœè¿˜æœ‰å‰©ä½™å•†å“æ²¡æœ‰ç»™åˆ†é…ï¼Œåˆ™åˆ†é…çš„åº—é“ºé‡è¦åŠ ä¸€</span>                    <span class="token operator">++</span>cnt<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>cnt<span class="token operator">></span>n<span class="token punctuation">)</span>                l<span class="token operator">=</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                r<span class="token operator">=</span>mid<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> l<span class="token punctuation">;</span><span class="token comment">//è¿”å›æ¡ä»¶è¦æ³¨æ„</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜æœ‰ä¸€ä¸ªç®€ç•¥ä¸€ç‚¹çš„ä»£ç ï¼Œåˆ«äººå†™çš„</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">minimizedMaximum</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> quantities<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>quantities<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> quantities<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> r<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> q <span class="token operator">:</span> quantities<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                cnt <span class="token operator">+=</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> mid<span class="token punctuation">;</span><span class="token comment">//è¿™é‡Œæ˜¯å‘ä¸Šå–æ•´æ“ä½œï¼Œå³åˆ†é…å‰©ä½™çš„å•†å“å†åŠ ä¸€ä¸ªå•†åº—æ¥æ”¾å®ƒ</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>cnt <span class="token operator">></span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                r <span class="token operator">=</span> mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> l<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> LeetCodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebServeré¡¹ç›®ä»£ç </title>
      <link href="WebServer/WebServer%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81/"/>
      <url>WebServer/WebServer%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="WebServeré¡¹ç›®ä»£ç "><a href="#WebServeré¡¹ç›®ä»£ç " class="headerlink" title="WebServeré¡¹ç›®ä»£ç "></a>WebServeré¡¹ç›®ä»£ç </h1><p>è¿™é‡Œä¸“é—¨æ¥å­˜æ”¾ä¸€ä¸‹æˆ‘æ­£åœ¨åšçš„IOå¤šè·¯å¤ç”¨é«˜å¹¶å‘æœåŠ¡å™¨<code>WebServer</code>çš„ä»£ç ï¼Œæ–¹ä¾¿åœ¨å¹³æ¿ä¸Šçœ‹</p><h1 id="HTTPæ¨¡å—"><a href="#HTTPæ¨¡å—" class="headerlink" title="HTTPæ¨¡å—"></a>HTTPæ¨¡å—</h1><h2 id="http-conn-hğŸ‘‡"><a href="#http-conn-hğŸ‘‡" class="headerlink" title="http_conn.hğŸ‘‡"></a>http_conn.hğŸ‘‡</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">HTTPCONNECTION_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">HTTPCONNECTION_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/epoll.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;assert.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;pthread.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/mman.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdarg.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;errno.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/wait.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/uio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;map></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../lock/locker.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../CGImysql/sql_connection_pool.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../timer/lst_timer.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"../log/log.h"</span></span><span class="token keyword">class</span> <span class="token class-name">http_conn</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> FILENAME_LEN <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> READ_BUFFER_SIZE <span class="token operator">=</span> <span class="token number">2048</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> WRITE_BUFFER_SIZE <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>    <span class="token keyword">enum</span> <span class="token class-name">METHOD</span>    <span class="token punctuation">&#123;</span>        GET <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>        POST<span class="token punctuation">,</span>        HEAD<span class="token punctuation">,</span>        PUT<span class="token punctuation">,</span>        DELETE<span class="token punctuation">,</span>        TRACE<span class="token punctuation">,</span>        OPTIONS<span class="token punctuation">,</span>        CONNECT<span class="token punctuation">,</span>        PATH    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">enum</span> <span class="token class-name">CHECK_STATE</span>    <span class="token punctuation">&#123;</span>        CHECK_STATE_REQUESTLINE <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>        CHECK_STATE_HEADER<span class="token punctuation">,</span>        CHECK_STATE_CONTENT    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">enum</span> <span class="token class-name">HTTP_CODE</span>    <span class="token punctuation">&#123;</span>        NO_REQUEST<span class="token punctuation">,</span>        GET_REQUEST<span class="token punctuation">,</span>        BAD_REQUEST<span class="token punctuation">,</span>        NO_RESOURCE<span class="token punctuation">,</span>        FORBIDDEN_REQUEST<span class="token punctuation">,</span>        FILE_REQUEST<span class="token punctuation">,</span>        INTERNAL_ERROR<span class="token punctuation">,</span>        CLOSED_CONNECTION    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">enum</span> <span class="token class-name">LINE_STATUS</span>    <span class="token punctuation">&#123;</span>        LINE_OK <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>        LINE_BAD<span class="token punctuation">,</span>        LINE_OPEN    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">http_conn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token operator">~</span><span class="token function">http_conn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">const</span> sockaddr_in <span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">,</span> string user<span class="token punctuation">,</span> string passwd<span class="token punctuation">,</span> string sqlname<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">close_conn</span><span class="token punctuation">(</span><span class="token keyword">bool</span> real_close <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">read_once</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    sockaddr_in <span class="token operator">*</span><span class="token function">get_address</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token operator">&amp;</span>m_address<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">initmysql_result</span><span class="token punctuation">(</span>connection_pool <span class="token operator">*</span>connPool<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> timer_flag<span class="token punctuation">;</span>    <span class="token keyword">int</span> improv<span class="token punctuation">;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    HTTP_CODE <span class="token function">process_read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">process_write</span><span class="token punctuation">(</span>HTTP_CODE ret<span class="token punctuation">)</span><span class="token punctuation">;</span>    HTTP_CODE <span class="token function">parse_request_line</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>    HTTP_CODE <span class="token function">parse_headers</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>    HTTP_CODE <span class="token function">parse_content</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>    HTTP_CODE <span class="token function">do_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">get_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> m_read_buf <span class="token operator">+</span> m_start_line<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    LINE_STATUS <span class="token function">parse_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">unmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_response</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_content</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_status_line</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_headers</span><span class="token punctuation">(</span><span class="token keyword">int</span> content_length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_content_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_content_length</span><span class="token punctuation">(</span><span class="token keyword">int</span> content_length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_linger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">add_blank_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">static</span> <span class="token keyword">int</span> m_epollfd<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token keyword">int</span> m_user_count<span class="token punctuation">;</span>    MYSQL <span class="token operator">*</span>mysql<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_state<span class="token punctuation">;</span>  <span class="token comment">//è¯»ä¸º0, å†™ä¸º1</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">int</span> m_sockfd<span class="token punctuation">;</span>    sockaddr_in m_address<span class="token punctuation">;</span>    <span class="token keyword">char</span> m_read_buf<span class="token punctuation">[</span>READ_BUFFER_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> m_read_idx<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_checked_idx<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_start_line<span class="token punctuation">;</span>    <span class="token keyword">char</span> m_write_buf<span class="token punctuation">[</span>WRITE_BUFFER_SIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> m_write_idx<span class="token punctuation">;</span>    CHECK_STATE m_check_state<span class="token punctuation">;</span>    METHOD m_method<span class="token punctuation">;</span>    <span class="token keyword">char</span> m_real_file<span class="token punctuation">[</span>FILENAME_LEN<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>m_url<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>m_version<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>m_host<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_content_length<span class="token punctuation">;</span>    <span class="token keyword">bool</span> m_linger<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>m_file_address<span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">stat</span> m_file_stat<span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">iovec</span> m_iv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> m_iv_count<span class="token punctuation">;</span>    <span class="token keyword">int</span> cgi<span class="token punctuation">;</span>        <span class="token comment">//æ˜¯å¦å¯ç”¨çš„POST</span>    <span class="token keyword">char</span> <span class="token operator">*</span>m_string<span class="token punctuation">;</span> <span class="token comment">//å­˜å‚¨è¯·æ±‚å¤´æ•°æ®</span>    <span class="token keyword">int</span> bytes_to_send<span class="token punctuation">;</span>    <span class="token keyword">int</span> bytes_have_send<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>doc_root<span class="token punctuation">;</span>    map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> m_users<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_TRIGMode<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_close_log<span class="token punctuation">;</span>    <span class="token keyword">char</span> sql_user<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> sql_passwd<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> sql_name<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="http-conn-cppğŸ‘‡"><a href="#http-conn-cppğŸ‘‡" class="headerlink" title="http_conn.cppğŸ‘‡"></a>http_conn.cppğŸ‘‡</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"http_conn.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;mysql/mysql.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fstream></span></span><span class="token comment">//å®šä¹‰httpå“åº”çš„ä¸€äº›çŠ¶æ€ä¿¡æ¯</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>ok_200_title <span class="token operator">=</span> <span class="token string">"OK"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_400_title <span class="token operator">=</span> <span class="token string">"Bad Request"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_400_form <span class="token operator">=</span> <span class="token string">"Your request has bad syntax or is inherently impossible to staisfy.\n"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_403_title <span class="token operator">=</span> <span class="token string">"Forbidden"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_403_form <span class="token operator">=</span> <span class="token string">"You do not have permission to get file form this server.\n"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_404_title <span class="token operator">=</span> <span class="token string">"Not Found"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_404_form <span class="token operator">=</span> <span class="token string">"The requested file was not found on this server.\n"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_500_title <span class="token operator">=</span> <span class="token string">"Internal Error"</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>error_500_form <span class="token operator">=</span> <span class="token string">"There was an unusual problem serving the request file.\n"</span><span class="token punctuation">;</span>locker m_lock<span class="token punctuation">;</span>map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> users<span class="token punctuation">;</span><span class="token keyword">void</span> http_conn<span class="token operator">::</span><span class="token function">initmysql_result</span><span class="token punctuation">(</span>connection_pool <span class="token operator">*</span>connPool<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å…ˆä»è¿æ¥æ± ä¸­å–ä¸€ä¸ªè¿æ¥</span>    MYSQL <span class="token operator">*</span>mysql <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    connectionRAII <span class="token function">mysqlcon</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>mysql<span class="token punctuation">,</span> connPool<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åœ¨userè¡¨ä¸­æ£€ç´¢usernameï¼Œpasswdæ•°æ®ï¼Œæµè§ˆå™¨ç«¯è¾“å…¥</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span>mysql<span class="token punctuation">,</span> <span class="token string">"SELECT username,passwd FROM user"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"SELECT error:%s\n"</span><span class="token punctuation">,</span> <span class="token function">mysql_error</span><span class="token punctuation">(</span>mysql<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//ä»è¡¨ä¸­æ£€ç´¢å®Œæ•´çš„ç»“æœé›†</span>    MYSQL_RES <span class="token operator">*</span>result <span class="token operator">=</span> <span class="token function">mysql_store_result</span><span class="token punctuation">(</span>mysql<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¿”å›ç»“æœé›†ä¸­çš„åˆ—æ•°</span>    <span class="token keyword">int</span> num_fields <span class="token operator">=</span> <span class="token function">mysql_num_fields</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¿”å›æ‰€æœ‰å­—æ®µç»“æ„çš„æ•°ç»„</span>    MYSQL_FIELD <span class="token operator">*</span>fields <span class="token operator">=</span> <span class="token function">mysql_fetch_fields</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ä»ç»“æœé›†ä¸­è·å–ä¸‹ä¸€è¡Œï¼Œå°†å¯¹åº”çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå­˜å…¥mapä¸­</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>MYSQL_ROW row <span class="token operator">=</span> <span class="token function">mysql_fetch_row</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        string <span class="token function">temp1</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        string <span class="token function">temp2</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        users<span class="token punctuation">[</span>temp1<span class="token punctuation">]</span> <span class="token operator">=</span> temp2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¯¹æ–‡ä»¶æè¿°ç¬¦è®¾ç½®éé˜»å¡</span><span class="token keyword">int</span> <span class="token function">setnonblocking</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> old_option <span class="token operator">=</span> <span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> F_GETFL<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> new_option <span class="token operator">=</span> old_option <span class="token operator">|</span> O_NONBLOCK<span class="token punctuation">;</span>    <span class="token function">fcntl</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> F_SETFL<span class="token punctuation">,</span> new_option<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> old_option<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å°†å†…æ ¸äº‹ä»¶è¡¨æ³¨å†Œè¯»äº‹ä»¶ï¼ŒETæ¨¡å¼ï¼Œé€‰æ‹©å¼€å¯EPOLLONESHOT</span><span class="token keyword">void</span> <span class="token function">addfd</span><span class="token punctuation">(</span><span class="token keyword">int</span> epollfd<span class="token punctuation">,</span> <span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">bool</span> one_shot<span class="token punctuation">,</span> <span class="token keyword">int</span> TRIGMode<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    epoll_event event<span class="token punctuation">;</span>    event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> TRIGMode<span class="token punctuation">)</span>        event<span class="token punctuation">.</span>events <span class="token operator">=</span> EPOLLIN <span class="token operator">|</span> EPOLLET <span class="token operator">|</span> EPOLLRDHUP<span class="token punctuation">;</span>    <span class="token keyword">else</span>        event<span class="token punctuation">.</span>events <span class="token operator">=</span> EPOLLIN <span class="token operator">|</span> EPOLLRDHUP<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>one_shot<span class="token punctuation">)</span>        event<span class="token punctuation">.</span>events <span class="token operator">|=</span> EPOLLONESHOT<span class="token punctuation">;</span>    <span class="token function">epoll_ctl</span><span class="token punctuation">(</span>epollfd<span class="token punctuation">,</span> EPOLL_CTL_ADD<span class="token punctuation">,</span> fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setnonblocking</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//ä»å†…æ ¸æ—¶é—´è¡¨åˆ é™¤æè¿°ç¬¦</span><span class="token keyword">void</span> <span class="token function">removefd</span><span class="token punctuation">(</span><span class="token keyword">int</span> epollfd<span class="token punctuation">,</span> <span class="token keyword">int</span> fd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">epoll_ctl</span><span class="token punctuation">(</span>epollfd<span class="token punctuation">,</span> EPOLL_CTL_DEL<span class="token punctuation">,</span> fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å°†äº‹ä»¶é‡ç½®ä¸ºEPOLLONESHOT</span><span class="token keyword">void</span> <span class="token function">modfd</span><span class="token punctuation">(</span><span class="token keyword">int</span> epollfd<span class="token punctuation">,</span> <span class="token keyword">int</span> fd<span class="token punctuation">,</span> <span class="token keyword">int</span> ev<span class="token punctuation">,</span> <span class="token keyword">int</span> TRIGMode<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    epoll_event event<span class="token punctuation">;</span>    event<span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd <span class="token operator">=</span> fd<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> TRIGMode<span class="token punctuation">)</span>        event<span class="token punctuation">.</span>events <span class="token operator">=</span> ev <span class="token operator">|</span> EPOLLET <span class="token operator">|</span> EPOLLONESHOT <span class="token operator">|</span> EPOLLRDHUP<span class="token punctuation">;</span>    <span class="token keyword">else</span>        event<span class="token punctuation">.</span>events <span class="token operator">=</span> ev <span class="token operator">|</span> EPOLLONESHOT <span class="token operator">|</span> EPOLLRDHUP<span class="token punctuation">;</span>    <span class="token function">epoll_ctl</span><span class="token punctuation">(</span>epollfd<span class="token punctuation">,</span> EPOLL_CTL_MOD<span class="token punctuation">,</span> fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> http_conn<span class="token operator">::</span>m_user_count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> http_conn<span class="token operator">::</span>m_epollfd <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//å…³é—­è¿æ¥ï¼Œå…³é—­ä¸€ä¸ªè¿æ¥ï¼Œå®¢æˆ·æ€»é‡å‡ä¸€</span><span class="token keyword">void</span> http_conn<span class="token operator">::</span><span class="token function">close_conn</span><span class="token punctuation">(</span><span class="token keyword">bool</span> real_close<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>real_close <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>m_sockfd <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"close %d\n"</span><span class="token punctuation">,</span> m_sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">removefd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>        m_sockfd <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        m_user_count<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//åˆå§‹åŒ–è¿æ¥,å¤–éƒ¨è°ƒç”¨åˆå§‹åŒ–å¥—æ¥å­—åœ°å€</span><span class="token keyword">void</span> http_conn<span class="token operator">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">,</span> <span class="token keyword">const</span> sockaddr_in <span class="token operator">&amp;</span>addr<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>root<span class="token punctuation">,</span> <span class="token keyword">int</span> TRIGMode<span class="token punctuation">,</span>                     <span class="token keyword">int</span> close_log<span class="token punctuation">,</span> string user<span class="token punctuation">,</span> string passwd<span class="token punctuation">,</span> string sqlname<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    m_sockfd <span class="token operator">=</span> sockfd<span class="token punctuation">;</span>    m_address <span class="token operator">=</span> addr<span class="token punctuation">;</span>    <span class="token function">addfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> sockfd<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> m_TRIGMode<span class="token punctuation">)</span><span class="token punctuation">;</span>    m_user_count<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token comment">//å½“æµè§ˆå™¨å‡ºç°è¿æ¥é‡ç½®æ—¶ï¼Œå¯èƒ½æ˜¯ç½‘ç«™æ ¹ç›®å½•å‡ºé”™æˆ–httpå“åº”æ ¼å¼å‡ºé”™æˆ–è€…è®¿é—®çš„æ–‡ä»¶ä¸­å†…å®¹å®Œå…¨ä¸ºç©º</span>    doc_root <span class="token operator">=</span> root<span class="token punctuation">;</span>    m_TRIGMode <span class="token operator">=</span> TRIGMode<span class="token punctuation">;</span>    m_close_log <span class="token operator">=</span> close_log<span class="token punctuation">;</span>    <span class="token function">strcpy</span><span class="token punctuation">(</span>sql_user<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">strcpy</span><span class="token punctuation">(</span>sql_passwd<span class="token punctuation">,</span> passwd<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">strcpy</span><span class="token punctuation">(</span>sql_name<span class="token punctuation">,</span> sqlname<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//åˆå§‹åŒ–æ–°æ¥å—çš„è¿æ¥</span><span class="token comment">//check_stateé»˜è®¤ä¸ºåˆ†æè¯·æ±‚è¡ŒçŠ¶æ€</span><span class="token keyword">void</span> http_conn<span class="token operator">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    mysql <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    bytes_to_send <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    bytes_have_send <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_check_state <span class="token operator">=</span> CHECK_STATE_REQUESTLINE<span class="token punctuation">;</span>    m_linger <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    m_method <span class="token operator">=</span> GET<span class="token punctuation">;</span>    m_url <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_version <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_content_length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_host <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_start_line <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_checked_idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_read_idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_write_idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    cgi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    m_state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    timer_flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    improv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>m_read_buf<span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">,</span> READ_BUFFER_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>m_write_buf<span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">,</span> WRITE_BUFFER_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>m_real_file<span class="token punctuation">,</span> <span class="token string">'\0'</span><span class="token punctuation">,</span> FILENAME_LEN<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//ä»çŠ¶æ€æœºï¼Œç”¨äºåˆ†æå‡ºä¸€è¡Œå†…å®¹</span><span class="token comment">//è¿”å›å€¼ä¸ºè¡Œçš„è¯»å–çŠ¶æ€ï¼Œæœ‰LINE_OK,LINE_BAD,LINE_OPEN</span>http_conn<span class="token operator">::</span>LINE_STATUS http_conn<span class="token operator">::</span><span class="token function">parse_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">char</span> temp<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> m_checked_idx <span class="token operator">&lt;</span> m_read_idx<span class="token punctuation">;</span> <span class="token operator">++</span>m_checked_idx<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        temp <span class="token operator">=</span> m_read_buf<span class="token punctuation">[</span>m_checked_idx<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">==</span> <span class="token string">'\r'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m_checked_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> m_read_idx<span class="token punctuation">)</span>                <span class="token keyword">return</span> LINE_OPEN<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m_read_buf<span class="token punctuation">[</span>m_checked_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                m_read_buf<span class="token punctuation">[</span>m_checked_idx<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>                m_read_buf<span class="token punctuation">[</span>m_checked_idx<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> LINE_OK<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> LINE_BAD<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">==</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>m_checked_idx <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> m_read_buf<span class="token punctuation">[</span>m_checked_idx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\r'</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                m_read_buf<span class="token punctuation">[</span>m_checked_idx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>                m_read_buf<span class="token punctuation">[</span>m_checked_idx<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> LINE_OK<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> LINE_BAD<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> LINE_OPEN<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¾ªç¯è¯»å–å®¢æˆ·æ•°æ®ï¼Œç›´åˆ°æ— æ•°æ®å¯è¯»æˆ–å¯¹æ–¹å…³é—­è¿æ¥</span><span class="token comment">//éé˜»å¡ETå·¥ä½œæ¨¡å¼ä¸‹ï¼Œéœ€è¦ä¸€æ¬¡æ€§å°†æ•°æ®è¯»å®Œ</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">read_once</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_read_idx <span class="token operator">>=</span> READ_BUFFER_SIZE<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> bytes_read <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//LTè¯»å–æ•°æ®</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> m_TRIGMode<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        bytes_read <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span>m_sockfd<span class="token punctuation">,</span> m_read_buf <span class="token operator">+</span> m_read_idx<span class="token punctuation">,</span> READ_BUFFER_SIZE <span class="token operator">-</span> m_read_idx<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        m_read_idx <span class="token operator">+=</span> bytes_read<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>bytes_read <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//ETè¯»æ•°æ®</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            bytes_read <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span>m_sockfd<span class="token punctuation">,</span> m_read_buf <span class="token operator">+</span> m_read_idx<span class="token punctuation">,</span> READ_BUFFER_SIZE <span class="token operator">-</span> m_read_idx<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>bytes_read <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>errno <span class="token operator">==</span> EAGAIN <span class="token operator">||</span> errno <span class="token operator">==</span> EWOULDBLOCK<span class="token punctuation">)</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bytes_read <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            m_read_idx <span class="token operator">+=</span> bytes_read<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//è§£æhttpè¯·æ±‚è¡Œï¼Œè·å¾—è¯·æ±‚æ–¹æ³•ï¼Œç›®æ ‡urlåŠhttpç‰ˆæœ¬å·</span>http_conn<span class="token operator">::</span>HTTP_CODE http_conn<span class="token operator">::</span><span class="token function">parse_request_line</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>text<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    m_url <span class="token operator">=</span> <span class="token function">strpbrk</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">" \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>m_url<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token operator">*</span>m_url<span class="token operator">++</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>method <span class="token operator">=</span> text<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> <span class="token string">"GET"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        m_method <span class="token operator">=</span> GET<span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> <span class="token string">"POST"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        m_method <span class="token operator">=</span> POST<span class="token punctuation">;</span>        cgi <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>        <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>    m_url <span class="token operator">+=</span> <span class="token function">strspn</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">" \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    m_version <span class="token operator">=</span> <span class="token function">strpbrk</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">" \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>m_version<span class="token punctuation">)</span>        <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>    <span class="token operator">*</span>m_version<span class="token operator">++</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>    m_version <span class="token operator">+=</span> <span class="token function">strspn</span><span class="token punctuation">(</span>m_version<span class="token punctuation">,</span> <span class="token string">" \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span>m_version<span class="token punctuation">,</span> <span class="token string">"HTTP/1.1"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strncasecmp</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"http://"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        m_url <span class="token operator">+=</span> <span class="token number">7</span><span class="token punctuation">;</span>        m_url <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strncasecmp</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"https://"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        m_url <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">;</span>        m_url <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>m_url <span class="token operator">||</span> m_url<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>    <span class="token comment">//å½“urlä¸º/æ—¶ï¼Œæ˜¾ç¤ºåˆ¤æ–­ç•Œé¢</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>m_url<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token function">strcat</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"judge.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    m_check_state <span class="token operator">=</span> CHECK_STATE_HEADER<span class="token punctuation">;</span>    <span class="token keyword">return</span> NO_REQUEST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//è§£æhttpè¯·æ±‚çš„ä¸€ä¸ªå¤´éƒ¨ä¿¡æ¯</span>http_conn<span class="token operator">::</span>HTTP_CODE http_conn<span class="token operator">::</span><span class="token function">parse_headers</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>text<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>text<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\0'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_content_length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            m_check_state <span class="token operator">=</span> CHECK_STATE_CONTENT<span class="token punctuation">;</span>            <span class="token keyword">return</span> NO_REQUEST<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> GET_REQUEST<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strncasecmp</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"Connection:"</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        text <span class="token operator">+=</span> <span class="token number">11</span><span class="token punctuation">;</span>        text <span class="token operator">+=</span> <span class="token function">strspn</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">" \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"keep-alive"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            m_linger <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strncasecmp</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"Content-length:"</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        text <span class="token operator">+=</span> <span class="token number">15</span><span class="token punctuation">;</span>        text <span class="token operator">+=</span> <span class="token function">strspn</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">" \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        m_content_length <span class="token operator">=</span> <span class="token function">atol</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strncasecmp</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">"Host:"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        text <span class="token operator">+=</span> <span class="token number">5</span><span class="token punctuation">;</span>        text <span class="token operator">+=</span> <span class="token function">strspn</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">" \t"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        m_host <span class="token operator">=</span> text<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"oop!unknow header: %s"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> NO_REQUEST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//åˆ¤æ–­httpè¯·æ±‚æ˜¯å¦è¢«å®Œæ•´è¯»å…¥</span>http_conn<span class="token operator">::</span>HTTP_CODE http_conn<span class="token operator">::</span><span class="token function">parse_content</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>text<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_read_idx <span class="token operator">>=</span> <span class="token punctuation">(</span>m_content_length <span class="token operator">+</span> m_checked_idx<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        text<span class="token punctuation">[</span>m_content_length<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>        <span class="token comment">//POSTè¯·æ±‚ä¸­æœ€åä¸ºè¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç </span>        m_string <span class="token operator">=</span> text<span class="token punctuation">;</span>        <span class="token keyword">return</span> GET_REQUEST<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> NO_REQUEST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>http_conn<span class="token operator">::</span>HTTP_CODE http_conn<span class="token operator">::</span><span class="token function">process_read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    LINE_STATUS line_status <span class="token operator">=</span> LINE_OK<span class="token punctuation">;</span>    HTTP_CODE ret <span class="token operator">=</span> NO_REQUEST<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>text <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m_check_state <span class="token operator">==</span> CHECK_STATE_CONTENT <span class="token operator">&amp;&amp;</span> line_status <span class="token operator">==</span> LINE_OK<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>line_status <span class="token operator">=</span> <span class="token function">parse_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> LINE_OK<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        text <span class="token operator">=</span> <span class="token function">get_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        m_start_line <span class="token operator">=</span> m_checked_idx<span class="token punctuation">;</span>        <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>m_check_state<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> CHECK_STATE_REQUESTLINE<span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            ret <span class="token operator">=</span> <span class="token function">parse_request_line</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> BAD_REQUEST<span class="token punctuation">)</span>                <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> CHECK_STATE_HEADER<span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            ret <span class="token operator">=</span> <span class="token function">parse_headers</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> BAD_REQUEST<span class="token punctuation">)</span>                <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> GET_REQUEST<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token function">do_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> CHECK_STATE_CONTENT<span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            ret <span class="token operator">=</span> <span class="token function">parse_content</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> GET_REQUEST<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token function">do_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            line_status <span class="token operator">=</span> LINE_OPEN<span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">default</span><span class="token operator">:</span>            <span class="token keyword">return</span> INTERNAL_ERROR<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> NO_REQUEST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>http_conn<span class="token operator">::</span>HTTP_CODE http_conn<span class="token operator">::</span><span class="token function">do_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_real_file<span class="token punctuation">,</span> doc_root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>doc_root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//printf("m_url:%s\n", m_url);</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å¤„ç†cgi</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cgi <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'2'</span> <span class="token operator">||</span> <span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">//æ ¹æ®æ ‡å¿—åˆ¤æ–­æ˜¯ç™»å½•æ£€æµ‹è¿˜æ˜¯æ³¨å†Œæ£€æµ‹</span>        <span class="token keyword">char</span> flag <span class="token operator">=</span> m_url<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> <span class="token operator">*</span>m_url_real <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcat</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">,</span> m_url <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strncpy</span><span class="token punctuation">(</span>m_real_file <span class="token operator">+</span> len<span class="token punctuation">,</span> m_url_real<span class="token punctuation">,</span> FILENAME_LEN <span class="token operator">-</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†ç”¨æˆ·åå’Œå¯†ç æå–å‡ºæ¥</span>        <span class="token comment">//user=123&amp;passwd=123</span>        <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> password<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> m_string<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'&amp;'</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            name<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> m_string<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        name<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span> m_string<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">,</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>            password<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> m_string<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        password<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'3'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token comment">//å¦‚æœæ˜¯æ³¨å†Œï¼Œå…ˆæ£€æµ‹æ•°æ®åº“ä¸­æ˜¯å¦æœ‰é‡åçš„</span>            <span class="token comment">//æ²¡æœ‰é‡åçš„ï¼Œè¿›è¡Œå¢åŠ æ•°æ®</span>            <span class="token keyword">char</span> <span class="token operator">*</span>sql_insert <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">strcpy</span><span class="token punctuation">(</span>sql_insert<span class="token punctuation">,</span> <span class="token string">"INSERT INTO user(username, passwd) VALUES("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">strcat</span><span class="token punctuation">(</span>sql_insert<span class="token punctuation">,</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">strcat</span><span class="token punctuation">(</span>sql_insert<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">strcat</span><span class="token punctuation">(</span>sql_insert<span class="token punctuation">,</span> <span class="token string">"', '"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">strcat</span><span class="token punctuation">(</span>sql_insert<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">strcat</span><span class="token punctuation">(</span>sql_insert<span class="token punctuation">,</span> <span class="token string">"')"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">==</span> users<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                m_lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span>mysql<span class="token punctuation">,</span> sql_insert<span class="token punctuation">)</span><span class="token punctuation">;</span>                users<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>pair<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                m_lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">)</span>                    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"/log.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"/registerError.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span>                <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"/registerError.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//å¦‚æœæ˜¯ç™»å½•ï¼Œç›´æ¥åˆ¤æ–­</span>        <span class="token comment">//è‹¥æµè§ˆå™¨ç«¯è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç åœ¨è¡¨ä¸­å¯ä»¥æŸ¥æ‰¾åˆ°ï¼Œè¿”å›1ï¼Œå¦åˆ™è¿”å›0</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">!=</span> users<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> users<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">==</span> password<span class="token punctuation">)</span>                <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"/welcome.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url<span class="token punctuation">,</span> <span class="token string">"/logError.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> <span class="token operator">*</span>m_url_real <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">,</span> <span class="token string">"/register.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strncpy</span><span class="token punctuation">(</span>m_real_file <span class="token operator">+</span> len<span class="token punctuation">,</span> m_url_real<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> <span class="token operator">*</span>m_url_real <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">,</span> <span class="token string">"/log.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strncpy</span><span class="token punctuation">(</span>m_real_file <span class="token operator">+</span> len<span class="token punctuation">,</span> m_url_real<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'5'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> <span class="token operator">*</span>m_url_real <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">,</span> <span class="token string">"/picture.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strncpy</span><span class="token punctuation">(</span>m_real_file <span class="token operator">+</span> len<span class="token punctuation">,</span> m_url_real<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'6'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> <span class="token operator">*</span>m_url_real <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">,</span> <span class="token string">"/video.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strncpy</span><span class="token punctuation">(</span>m_real_file <span class="token operator">+</span> len<span class="token punctuation">,</span> m_url_real<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'7'</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> <span class="token operator">*</span>m_url_real <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strcpy</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">,</span> <span class="token string">"/fans.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">strncpy</span><span class="token punctuation">(</span>m_real_file <span class="token operator">+</span> len<span class="token punctuation">,</span> m_url_real<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">free</span><span class="token punctuation">(</span>m_url_real<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>        <span class="token function">strncpy</span><span class="token punctuation">(</span>m_real_file <span class="token operator">+</span> len<span class="token punctuation">,</span> m_url<span class="token punctuation">,</span> FILENAME_LEN <span class="token operator">-</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stat</span><span class="token punctuation">(</span>m_real_file<span class="token punctuation">,</span> <span class="token operator">&amp;</span>m_file_stat<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> NO_RESOURCE<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>m_file_stat<span class="token punctuation">.</span>st_mode <span class="token operator">&amp;</span> S_IROTH<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> FORBIDDEN_REQUEST<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">S_ISDIR</span><span class="token punctuation">(</span>m_file_stat<span class="token punctuation">.</span>st_mode<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> BAD_REQUEST<span class="token punctuation">;</span>    <span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>m_real_file<span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>    m_file_address <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">mmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> m_file_stat<span class="token punctuation">.</span>st_size<span class="token punctuation">,</span> PROT_READ<span class="token punctuation">,</span> MAP_PRIVATE<span class="token punctuation">,</span> fd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> FILE_REQUEST<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> http_conn<span class="token operator">::</span><span class="token function">unmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_file_address<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">munmap</span><span class="token punctuation">(</span>m_file_address<span class="token punctuation">,</span> m_file_stat<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span class="token punctuation">;</span>        m_file_address <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>bytes_to_send <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">modfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_sockfd<span class="token punctuation">,</span> EPOLLIN<span class="token punctuation">,</span> m_TRIGMode<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        temp <span class="token operator">=</span> <span class="token function">writev</span><span class="token punctuation">(</span>m_sockfd<span class="token punctuation">,</span> m_iv<span class="token punctuation">,</span> m_iv_count<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>errno <span class="token operator">==</span> EAGAIN<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token function">modfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_sockfd<span class="token punctuation">,</span> EPOLLOUT<span class="token punctuation">,</span> m_TRIGMode<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token function">unmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        bytes_have_send <span class="token operator">+=</span> temp<span class="token punctuation">;</span>        bytes_to_send <span class="token operator">-=</span> temp<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>bytes_have_send <span class="token operator">>=</span> m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            m_iv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> m_file_address <span class="token operator">+</span> <span class="token punctuation">(</span>bytes_have_send <span class="token operator">-</span> m_write_idx<span class="token punctuation">)</span><span class="token punctuation">;</span>            m_iv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> bytes_to_send<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> m_write_buf <span class="token operator">+</span> bytes_have_send<span class="token punctuation">;</span>            m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">-</span> bytes_have_send<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>bytes_to_send <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">unmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">modfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_sockfd<span class="token punctuation">,</span> EPOLLIN<span class="token punctuation">,</span> m_TRIGMode<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>m_linger<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_response</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m_write_idx <span class="token operator">>=</span> WRITE_BUFFER_SIZE<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    va_list arg_list<span class="token punctuation">;</span>    <span class="token function">va_start</span><span class="token punctuation">(</span>arg_list<span class="token punctuation">,</span> format<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">vsnprintf</span><span class="token punctuation">(</span>m_write_buf <span class="token operator">+</span> m_write_idx<span class="token punctuation">,</span> WRITE_BUFFER_SIZE <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> m_write_idx<span class="token punctuation">,</span> format<span class="token punctuation">,</span> arg_list<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">>=</span> <span class="token punctuation">(</span>WRITE_BUFFER_SIZE <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> m_write_idx<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">va_end</span><span class="token punctuation">(</span>arg_list<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    m_write_idx <span class="token operator">+=</span> len<span class="token punctuation">;</span>    <span class="token function">va_end</span><span class="token punctuation">(</span>arg_list<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"request:%s"</span><span class="token punctuation">,</span> m_write_buf<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_status_line</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>title<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">add_response</span><span class="token punctuation">(</span><span class="token string">"%s %d %s\r\n"</span><span class="token punctuation">,</span> <span class="token string">"HTTP/1.1"</span><span class="token punctuation">,</span> status<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_headers</span><span class="token punctuation">(</span><span class="token keyword">int</span> content_len<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">add_content_length</span><span class="token punctuation">(</span>content_len<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">add_linger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>           <span class="token function">add_blank_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_content_length</span><span class="token punctuation">(</span><span class="token keyword">int</span> content_len<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">add_response</span><span class="token punctuation">(</span><span class="token string">"Content-Length:%d\r\n"</span><span class="token punctuation">,</span> content_len<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_content_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">add_response</span><span class="token punctuation">(</span><span class="token string">"Content-Type:%s\r\n"</span><span class="token punctuation">,</span> <span class="token string">"text/html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_linger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">add_response</span><span class="token punctuation">(</span><span class="token string">"Connection:%s\r\n"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>m_linger <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"keep-alive"</span> <span class="token operator">:</span> <span class="token string">"close"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_blank_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">add_response</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">add_content</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>content<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">add_response</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> http_conn<span class="token operator">::</span><span class="token function">process_write</span><span class="token punctuation">(</span>HTTP_CODE ret<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>ret<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> INTERNAL_ERROR<span class="token operator">:</span>    <span class="token punctuation">&#123;</span>        <span class="token function">add_status_line</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> error_500_title<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">add_headers</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>error_500_form<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">add_content</span><span class="token punctuation">(</span>error_500_form<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">case</span> BAD_REQUEST<span class="token operator">:</span>    <span class="token punctuation">&#123;</span>        <span class="token function">add_status_line</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> error_404_title<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">add_headers</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>error_404_form<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">add_content</span><span class="token punctuation">(</span>error_404_form<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">case</span> FORBIDDEN_REQUEST<span class="token operator">:</span>    <span class="token punctuation">&#123;</span>        <span class="token function">add_status_line</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">,</span> error_403_title<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">add_headers</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>error_403_form<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">add_content</span><span class="token punctuation">(</span>error_403_form<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">case</span> FILE_REQUEST<span class="token operator">:</span>    <span class="token punctuation">&#123;</span>        <span class="token function">add_status_line</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> ok_200_title<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_file_stat<span class="token punctuation">.</span>st_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">add_headers</span><span class="token punctuation">(</span>m_file_stat<span class="token punctuation">.</span>st_size<span class="token punctuation">)</span><span class="token punctuation">;</span>            m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> m_write_buf<span class="token punctuation">;</span>            m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> m_write_idx<span class="token punctuation">;</span>            m_iv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> m_file_address<span class="token punctuation">;</span>            m_iv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> m_file_stat<span class="token punctuation">.</span>st_size<span class="token punctuation">;</span>            m_iv_count <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>            bytes_to_send <span class="token operator">=</span> m_write_idx <span class="token operator">+</span> m_file_stat<span class="token punctuation">.</span>st_size<span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>ok_string <span class="token operator">=</span> <span class="token string">"&lt;html>&lt;body>&lt;/body>&lt;/html>"</span><span class="token punctuation">;</span>            <span class="token function">add_headers</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>ok_string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">add_content</span><span class="token punctuation">(</span>ok_string<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">default</span><span class="token operator">:</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_base <span class="token operator">=</span> m_write_buf<span class="token punctuation">;</span>    m_iv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iov_len <span class="token operator">=</span> m_write_idx<span class="token punctuation">;</span>    m_iv_count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    bytes_to_send <span class="token operator">=</span> m_write_idx<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> http_conn<span class="token operator">::</span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    HTTP_CODE read_ret <span class="token operator">=</span> <span class="token function">process_read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>read_ret <span class="token operator">==</span> NO_REQUEST<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">modfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_sockfd<span class="token punctuation">,</span> EPOLLIN<span class="token punctuation">,</span> m_TRIGMode<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">bool</span> write_ret <span class="token operator">=</span> <span class="token function">process_write</span><span class="token punctuation">(</span>read_ret<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>write_ret<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">close_conn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">modfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_sockfd<span class="token punctuation">,</span> EPOLLOUT<span class="token punctuation">,</span> m_TRIGMode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="WebServer-hå’ŒWebServer-cppğŸ‘‡"><a href="#WebServer-hå’ŒWebServer-cppğŸ‘‡" class="headerlink" title="WebServer.hå’ŒWebServer.cppğŸ‘‡"></a>WebServer.hå’ŒWebServer.cppğŸ‘‡</h1><h2 id="WebServer-h"><a href="#WebServer-h" class="headerlink" title="WebServer.h"></a>WebServer.h</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">WEBSERVER_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">WEBSERVER_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;netinet/in.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;errno.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cassert></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/epoll.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./threadpool/threadpool.h"</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"./http/http_conn.h"</span></span><span class="token keyword">const</span> <span class="token keyword">int</span> MAX_FD <span class="token operator">=</span> <span class="token number">65536</span><span class="token punctuation">;</span>           <span class="token comment">//æœ€å¤§æ–‡ä»¶æè¿°ç¬¦</span><span class="token keyword">const</span> <span class="token keyword">int</span> MAX_EVENT_NUMBER <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span> <span class="token comment">//æœ€å¤§äº‹ä»¶æ•°</span><span class="token keyword">const</span> <span class="token keyword">int</span> TIMESLOT <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>             <span class="token comment">//æœ€å°è¶…æ—¶å•ä½</span><span class="token keyword">class</span> <span class="token class-name">WebServer</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">WebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">WebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> port <span class="token punctuation">,</span> string user<span class="token punctuation">,</span> string passWord<span class="token punctuation">,</span> string databaseName<span class="token punctuation">,</span>              <span class="token keyword">int</span> log_write <span class="token punctuation">,</span> <span class="token keyword">int</span> opt_linger<span class="token punctuation">,</span> <span class="token keyword">int</span> trigmode<span class="token punctuation">,</span> <span class="token keyword">int</span> sql_num<span class="token punctuation">,</span>              <span class="token keyword">int</span> thread_num<span class="token punctuation">,</span> <span class="token keyword">int</span> close_log<span class="token punctuation">,</span> <span class="token keyword">int</span> actor_model<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">thread_pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">sql_pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">log_write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">trig_mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">eventListen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">eventLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token keyword">int</span> connfd<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">sockaddr_in</span> client_address<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">adjust_timer</span><span class="token punctuation">(</span>util_timer <span class="token operator">*</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">deal_timer</span><span class="token punctuation">(</span>util_timer <span class="token operator">*</span>timer<span class="token punctuation">,</span> <span class="token keyword">int</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">dealclinetdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> <span class="token function">dealwithsignal</span><span class="token punctuation">(</span><span class="token keyword">bool</span><span class="token operator">&amp;</span> timeout<span class="token punctuation">,</span> <span class="token keyword">bool</span><span class="token operator">&amp;</span> stop_server<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">dealwithread</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">dealwithwrite</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token comment">//åŸºç¡€</span>    <span class="token keyword">int</span> m_port<span class="token punctuation">;</span>    <span class="token keyword">char</span> <span class="token operator">*</span>m_root<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_log_write<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_close_log<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_actormodel<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_pipefd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> m_epollfd<span class="token punctuation">;</span>    http_conn <span class="token operator">*</span>users<span class="token punctuation">;</span>    <span class="token comment">//æ•°æ®åº“ç›¸å…³</span>    connection_pool <span class="token operator">*</span>m_connPool<span class="token punctuation">;</span>    string m_user<span class="token punctuation">;</span>         <span class="token comment">//ç™»é™†æ•°æ®åº“ç”¨æˆ·å</span>    string m_passWord<span class="token punctuation">;</span>     <span class="token comment">//ç™»é™†æ•°æ®åº“å¯†ç </span>    string m_databaseName<span class="token punctuation">;</span> <span class="token comment">//ä½¿ç”¨æ•°æ®åº“å</span>    <span class="token keyword">int</span> m_sql_num<span class="token punctuation">;</span>    <span class="token comment">//çº¿ç¨‹æ± ç›¸å…³</span>    threadpool<span class="token operator">&lt;</span>http_conn<span class="token operator">></span> <span class="token operator">*</span>m_pool<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_thread_num<span class="token punctuation">;</span>    <span class="token comment">//epoll_eventç›¸å…³</span>    epoll_event events<span class="token punctuation">[</span>MAX_EVENT_NUMBER<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> m_listenfd<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_OPT_LINGER<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_TRIGMode<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_LISTENTrigmode<span class="token punctuation">;</span>    <span class="token keyword">int</span> m_CONNTrigmode<span class="token punctuation">;</span>    <span class="token comment">//å®šæ—¶å™¨ç›¸å…³</span>    client_data <span class="token operator">*</span>users_timer<span class="token punctuation">;</span>    Utils utils<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WebServer-cpp"><a href="#WebServer-cpp" class="headerlink" title="WebServer.cpp"></a>WebServer.cpp</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"webserver.h"</span></span><span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">WebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//http_connç±»å¯¹è±¡</span>    users <span class="token operator">=</span> <span class="token keyword">new</span> http_conn<span class="token punctuation">[</span>MAX_FD<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment">//rootæ–‡ä»¶å¤¹è·¯å¾„</span>    <span class="token keyword">char</span> server_path<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">getcwd</span><span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> root<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/root"</span><span class="token punctuation">;</span>    m_root <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>server_path<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">strcpy</span><span class="token punctuation">(</span>m_root<span class="token punctuation">,</span> server_path<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">strcat</span><span class="token punctuation">(</span>m_root<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å®šæ—¶å™¨</span>    users_timer <span class="token operator">=</span> <span class="token keyword">new</span> client_data<span class="token punctuation">[</span>MAX_FD<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token operator">~</span><span class="token function">WebServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">close</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>m_pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">close</span><span class="token punctuation">(</span>m_pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> users<span class="token punctuation">;</span>    <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> users_timer<span class="token punctuation">;</span>    <span class="token keyword">delete</span> m_pool<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">,</span> string user<span class="token punctuation">,</span> string passWord<span class="token punctuation">,</span> string databaseName<span class="token punctuation">,</span> <span class="token keyword">int</span> log_write<span class="token punctuation">,</span>                      <span class="token keyword">int</span> opt_linger<span class="token punctuation">,</span> <span class="token keyword">int</span> trigmode<span class="token punctuation">,</span> <span class="token keyword">int</span> sql_num<span class="token punctuation">,</span> <span class="token keyword">int</span> thread_num<span class="token punctuation">,</span> <span class="token keyword">int</span> close_log<span class="token punctuation">,</span> <span class="token keyword">int</span> actor_model<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    m_port <span class="token operator">=</span> port<span class="token punctuation">;</span>    m_user <span class="token operator">=</span> user<span class="token punctuation">;</span>    m_passWord <span class="token operator">=</span> passWord<span class="token punctuation">;</span>    m_databaseName <span class="token operator">=</span> databaseName<span class="token punctuation">;</span>    m_sql_num <span class="token operator">=</span> sql_num<span class="token punctuation">;</span>    m_thread_num <span class="token operator">=</span> thread_num<span class="token punctuation">;</span>    m_log_write <span class="token operator">=</span> log_write<span class="token punctuation">;</span>    m_OPT_LINGER <span class="token operator">=</span> opt_linger<span class="token punctuation">;</span>    m_TRIGMode <span class="token operator">=</span> trigmode<span class="token punctuation">;</span>    m_close_log <span class="token operator">=</span> close_log<span class="token punctuation">;</span>    m_actormodel <span class="token operator">=</span> actor_model<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">trig_mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//LT + LT</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> m_TRIGMode<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        m_LISTENTrigmode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        m_CONNTrigmode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//LT + ET</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> m_TRIGMode<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        m_LISTENTrigmode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        m_CONNTrigmode <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//ET + LT</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">==</span> m_TRIGMode<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        m_LISTENTrigmode <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        m_CONNTrigmode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//ET + ET</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">==</span> m_TRIGMode<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        m_LISTENTrigmode <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        m_CONNTrigmode <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">log_write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> m_close_log<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">//åˆå§‹åŒ–æ—¥å¿—</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> m_log_write<span class="token punctuation">)</span>            <span class="token class-name">Log</span><span class="token operator">::</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"./ServerLog"</span><span class="token punctuation">,</span> m_close_log<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">800000</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token class-name">Log</span><span class="token operator">::</span><span class="token function">get_instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"./ServerLog"</span><span class="token punctuation">,</span> m_close_log<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">800000</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">sql_pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//åˆå§‹åŒ–æ•°æ®åº“è¿æ¥æ± </span>    m_connPool <span class="token operator">=</span> connection_pool<span class="token operator">::</span><span class="token function">GetInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    m_connPool<span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> m_user<span class="token punctuation">,</span> m_passWord<span class="token punctuation">,</span> m_databaseName<span class="token punctuation">,</span> <span class="token number">3306</span><span class="token punctuation">,</span> m_sql_num<span class="token punctuation">,</span> m_close_log<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆå§‹åŒ–æ•°æ®åº“è¯»å–è¡¨</span>    users<span class="token operator">-></span><span class="token function">initmysql_result</span><span class="token punctuation">(</span>m_connPool<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">thread_pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//çº¿ç¨‹æ± </span>    m_pool <span class="token operator">=</span> <span class="token keyword">new</span> threadpool<span class="token operator">&lt;</span>http_conn<span class="token operator">></span><span class="token punctuation">(</span>m_actormodel<span class="token punctuation">,</span> m_connPool<span class="token punctuation">,</span> m_thread_num<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">eventListen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç½‘ç»œç¼–ç¨‹åŸºç¡€æ­¥éª¤</span>    m_listenfd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>PF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">assert</span><span class="token punctuation">(</span>m_listenfd <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ä¼˜é›…å…³é—­è¿æ¥</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> m_OPT_LINGER<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">struct</span> <span class="token class-name">linger</span> tmp <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token function">setsockopt</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">,</span> SOL_SOCKET<span class="token punctuation">,</span> SO_LINGER<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tmp<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> m_OPT_LINGER<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">struct</span> <span class="token class-name">linger</span> tmp <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token function">setsockopt</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">,</span> SOL_SOCKET<span class="token punctuation">,</span> SO_LINGER<span class="token punctuation">,</span> <span class="token operator">&amp;</span>tmp<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">struct</span> <span class="token class-name">sockaddr_in</span> address<span class="token punctuation">;</span>    <span class="token function">bzero</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>address<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    address<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>    address<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> <span class="token function">htonl</span><span class="token punctuation">(</span>INADDR_ANY<span class="token punctuation">)</span><span class="token punctuation">;</span>    address<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span>m_port<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token function">setsockopt</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">,</span> SOL_SOCKET<span class="token punctuation">,</span> SO_REUSEADDR<span class="token punctuation">,</span> <span class="token operator">&amp;</span>flag<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ret <span class="token operator">=</span> <span class="token function">bind</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sockaddr</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>address<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">assert</span><span class="token punctuation">(</span>ret <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ret <span class="token operator">=</span> <span class="token function">listen</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">assert</span><span class="token punctuation">(</span>ret <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    utils<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>TIMESLOT<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//epollåˆ›å»ºå†…æ ¸äº‹ä»¶è¡¨</span>    epoll_event events<span class="token punctuation">[</span>MAX_EVENT_NUMBER<span class="token punctuation">]</span><span class="token punctuation">;</span>    m_epollfd <span class="token operator">=</span> <span class="token function">epoll_create</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">assert</span><span class="token punctuation">(</span>m_epollfd <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    utils<span class="token punctuation">.</span><span class="token function">addfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_listenfd<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> m_LISTENTrigmode<span class="token punctuation">)</span><span class="token punctuation">;</span>    http_conn<span class="token operator">::</span>m_epollfd <span class="token operator">=</span> m_epollfd<span class="token punctuation">;</span>    ret <span class="token operator">=</span> <span class="token function">socketpair</span><span class="token punctuation">(</span>PF_UNIX<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> m_pipefd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">assert</span><span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    utils<span class="token punctuation">.</span><span class="token function">setnonblocking</span><span class="token punctuation">(</span>m_pipefd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    utils<span class="token punctuation">.</span><span class="token function">addfd</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> m_pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    utils<span class="token punctuation">.</span><span class="token function">addsig</span><span class="token punctuation">(</span>SIGPIPE<span class="token punctuation">,</span> SIG_IGN<span class="token punctuation">)</span><span class="token punctuation">;</span>    utils<span class="token punctuation">.</span><span class="token function">addsig</span><span class="token punctuation">(</span>SIGALRM<span class="token punctuation">,</span> utils<span class="token punctuation">.</span>sig_handler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    utils<span class="token punctuation">.</span><span class="token function">addsig</span><span class="token punctuation">(</span>SIGTERM<span class="token punctuation">,</span> utils<span class="token punctuation">.</span>sig_handler<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">alarm</span><span class="token punctuation">(</span>TIMESLOT<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å·¥å…·ç±»,ä¿¡å·å’Œæè¿°ç¬¦åŸºç¡€æ“ä½œ</span>    Utils<span class="token operator">::</span>u_pipefd <span class="token operator">=</span> m_pipefd<span class="token punctuation">;</span>    Utils<span class="token operator">::</span>u_epollfd <span class="token operator">=</span> m_epollfd<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token keyword">int</span> connfd<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">sockaddr_in</span> client_address<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    users<span class="token punctuation">[</span>connfd<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>connfd<span class="token punctuation">,</span> client_address<span class="token punctuation">,</span> m_root<span class="token punctuation">,</span> m_CONNTrigmode<span class="token punctuation">,</span> m_close_log<span class="token punctuation">,</span> m_user<span class="token punctuation">,</span> m_passWord<span class="token punctuation">,</span> m_databaseName<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åˆå§‹åŒ–client_dataæ•°æ®</span>    <span class="token comment">//åˆ›å»ºå®šæ—¶å™¨ï¼Œè®¾ç½®å›è°ƒå‡½æ•°å’Œè¶…æ—¶æ—¶é—´ï¼Œç»‘å®šç”¨æˆ·æ•°æ®ï¼Œå°†å®šæ—¶å™¨æ·»åŠ åˆ°é“¾è¡¨ä¸­</span>    users_timer<span class="token punctuation">[</span>connfd<span class="token punctuation">]</span><span class="token punctuation">.</span>address <span class="token operator">=</span> client_address<span class="token punctuation">;</span>    users_timer<span class="token punctuation">[</span>connfd<span class="token punctuation">]</span><span class="token punctuation">.</span>sockfd <span class="token operator">=</span> connfd<span class="token punctuation">;</span>    util_timer <span class="token operator">*</span>timer <span class="token operator">=</span> <span class="token keyword">new</span> util_timer<span class="token punctuation">;</span>    timer<span class="token operator">-></span>user_data <span class="token operator">=</span> <span class="token operator">&amp;</span>users_timer<span class="token punctuation">[</span>connfd<span class="token punctuation">]</span><span class="token punctuation">;</span>    timer<span class="token operator">-></span>cb_func <span class="token operator">=</span> cb_func<span class="token punctuation">;</span>    time_t cur <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    timer<span class="token operator">-></span>expire <span class="token operator">=</span> cur <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> TIMESLOT<span class="token punctuation">;</span>    users_timer<span class="token punctuation">[</span>connfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> timer<span class="token punctuation">;</span>    utils<span class="token punctuation">.</span>m_timer_lst<span class="token punctuation">.</span><span class="token function">add_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//è‹¥æœ‰æ•°æ®ä¼ è¾“ï¼Œåˆ™å°†å®šæ—¶å™¨å¾€åå»¶è¿Ÿ3ä¸ªå•ä½</span><span class="token comment">//å¹¶å¯¹æ–°çš„å®šæ—¶å™¨åœ¨é“¾è¡¨ä¸Šçš„ä½ç½®è¿›è¡Œè°ƒæ•´</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">adjust_timer</span><span class="token punctuation">(</span>util_timer <span class="token operator">*</span>timer<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    time_t cur <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    timer<span class="token operator">-></span>expire <span class="token operator">=</span> cur <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> TIMESLOT<span class="token punctuation">;</span>    utils<span class="token punctuation">.</span>m_timer_lst<span class="token punctuation">.</span><span class="token function">adjust_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"adjust timer once"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">deal_timer</span><span class="token punctuation">(</span>util_timer <span class="token operator">*</span>timer<span class="token punctuation">,</span> <span class="token keyword">int</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    timer<span class="token operator">-></span><span class="token function">cb_func</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users_timer<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        utils<span class="token punctuation">.</span>m_timer_lst<span class="token punctuation">.</span><span class="token function">del_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"close fd %d"</span><span class="token punctuation">,</span> users_timer<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">dealclinetdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">struct</span> <span class="token class-name">sockaddr_in</span> client_address<span class="token punctuation">;</span>    socklen_t client_addrlength <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>client_address<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> m_LISTENTrigmode<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> connfd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sockaddr</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>client_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>client_addrlength<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>connfd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"%s:errno is:%d"</span><span class="token punctuation">,</span> <span class="token string">"accept error"</span><span class="token punctuation">,</span> errno<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>http_conn<span class="token operator">::</span>m_user_count <span class="token operator">>=</span> MAX_FD<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            utils<span class="token punctuation">.</span><span class="token function">show_error</span><span class="token punctuation">(</span>connfd<span class="token punctuation">,</span> <span class="token string">"Internal server busy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"Internal server busy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">timer</span><span class="token punctuation">(</span>connfd<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> connfd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>m_listenfd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sockaddr</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>client_address<span class="token punctuation">,</span> <span class="token operator">&amp;</span>client_addrlength<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>connfd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token function">LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"%s:errno is:%d"</span><span class="token punctuation">,</span> <span class="token string">"accept error"</span><span class="token punctuation">,</span> errno<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>http_conn<span class="token operator">::</span>m_user_count <span class="token operator">>=</span> MAX_FD<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                utils<span class="token punctuation">.</span><span class="token function">show_error</span><span class="token punctuation">(</span>connfd<span class="token punctuation">,</span> <span class="token string">"Internal server busy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"Internal server busy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token function">timer</span><span class="token punctuation">(</span>connfd<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">bool</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">dealwithsignal</span><span class="token punctuation">(</span><span class="token keyword">bool</span> <span class="token operator">&amp;</span>timeout<span class="token punctuation">,</span> <span class="token keyword">bool</span> <span class="token operator">&amp;</span>stop_server<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> sig<span class="token punctuation">;</span>    <span class="token keyword">char</span> signals<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    ret <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span>m_pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> signals<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>signals<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ret<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">switch</span> <span class="token punctuation">(</span>signals<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> SIGALRM<span class="token operator">:</span>            <span class="token punctuation">&#123;</span>                timeout <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">case</span> SIGTERM<span class="token operator">:</span>            <span class="token punctuation">&#123;</span>                stop_server <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">dealwithread</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    util_timer <span class="token operator">*</span>timer <span class="token operator">=</span> users_timer<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer<span class="token punctuation">;</span>    <span class="token comment">//reactor</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> m_actormodel<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">adjust_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//è‹¥ç›‘æµ‹åˆ°è¯»äº‹ä»¶ï¼Œå°†è¯¥äº‹ä»¶æ”¾å…¥è¯·æ±‚é˜Ÿåˆ—</span>        m_pool<span class="token operator">-></span><span class="token function">append</span><span class="token punctuation">(</span>users <span class="token operator">+</span> sockfd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>improv<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer_flag<span class="token punctuation">)</span>                <span class="token punctuation">&#123;</span>                    <span class="token function">deal_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">,</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>                    users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer_flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>improv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">//proactor</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">read_once</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"deal with the client(%s)"</span><span class="token punctuation">,</span> <span class="token function">inet_ntoa</span><span class="token punctuation">(</span>users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get_address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span>sin_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//è‹¥ç›‘æµ‹åˆ°è¯»äº‹ä»¶ï¼Œå°†è¯¥äº‹ä»¶æ”¾å…¥è¯·æ±‚é˜Ÿåˆ—</span>            m_pool<span class="token operator">-></span><span class="token function">append_p</span><span class="token punctuation">(</span>users <span class="token operator">+</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token function">adjust_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            <span class="token function">deal_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">,</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">dealwithwrite</span><span class="token punctuation">(</span><span class="token keyword">int</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    util_timer <span class="token operator">*</span>timer <span class="token operator">=</span> users_timer<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer<span class="token punctuation">;</span>    <span class="token comment">//reactor</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> m_actormodel<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">adjust_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        m_pool<span class="token operator">-></span><span class="token function">append</span><span class="token punctuation">(</span>users <span class="token operator">+</span> sockfd<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>improv<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer_flag<span class="token punctuation">)</span>                <span class="token punctuation">&#123;</span>                    <span class="token function">deal_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">,</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>                    users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer_flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>improv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span>        <span class="token comment">//proactor</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"send data to the client(%s)"</span><span class="token punctuation">,</span> <span class="token function">inet_ntoa</span><span class="token punctuation">(</span>users<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get_address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span>sin_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token function">adjust_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            <span class="token function">deal_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">,</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">WebServer</span><span class="token operator">::</span><span class="token function">eventLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">bool</span> timeout <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">bool</span> stop_server <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>stop_server<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token function">epoll_wait</span><span class="token punctuation">(</span>m_epollfd<span class="token punctuation">,</span> events<span class="token punctuation">,</span> MAX_EVENT_NUMBER<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>number <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> errno <span class="token operator">!=</span> EINTR<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token function">LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"epoll failure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> number<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> sockfd <span class="token operator">=</span> events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>fd<span class="token punctuation">;</span>            <span class="token comment">//å¤„ç†æ–°åˆ°çš„å®¢æˆ·è¿æ¥</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>sockfd <span class="token operator">==</span> m_listenfd<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">bool</span> flag <span class="token operator">=</span> <span class="token function">dealclinetdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">==</span> flag<span class="token punctuation">)</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> <span class="token punctuation">(</span>EPOLLRDHUP <span class="token operator">|</span> EPOLLHUP <span class="token operator">|</span> EPOLLERR<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token comment">//æœåŠ¡å™¨ç«¯å…³é—­è¿æ¥ï¼Œç§»é™¤å¯¹åº”çš„å®šæ—¶å™¨</span>                util_timer <span class="token operator">*</span>timer <span class="token operator">=</span> users_timer<span class="token punctuation">[</span>sockfd<span class="token punctuation">]</span><span class="token punctuation">.</span>timer<span class="token punctuation">;</span>                <span class="token function">deal_timer</span><span class="token punctuation">(</span>timer<span class="token punctuation">,</span> sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">//å¤„ç†ä¿¡å·</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sockfd <span class="token operator">==</span> m_pipefd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> EPOLLIN<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">bool</span> flag <span class="token operator">=</span> <span class="token function">dealwithsignal</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> stop_server<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">==</span> flag<span class="token punctuation">)</span>                    <span class="token function">LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"dealclientdata failure"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">//å¤„ç†å®¢æˆ·è¿æ¥ä¸Šæ¥æ”¶åˆ°çš„æ•°æ®</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> EPOLLIN<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token function">dealwithread</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>events<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>events <span class="token operator">&amp;</span> EPOLLOUT<span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token function">dealwithwrite</span><span class="token punctuation">(</span>sockfd<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            utils<span class="token punctuation">.</span><span class="token function">timer_handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> <span class="token string">"timer tick"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            timeout <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="Config-hå’ŒConfig-cppğŸ‘‡"><a href="#Config-hå’ŒConfig-cppğŸ‘‡" class="headerlink" title="Config.hå’ŒConfig.cppğŸ‘‡"></a>Config.hå’ŒConfig.cppğŸ‘‡</h1><h2 id="Config-h"><a href="#Config-h" class="headerlink" title="Config.h"></a>Config.h</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">CONFIG_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CONFIG_H</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"webserver.h"</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Config</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">void</span> <span class="token function">parse_arg</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ç«¯å£å·</span>    <span class="token keyword">int</span> PORT<span class="token punctuation">;</span>    <span class="token comment">//æ—¥å¿—å†™å…¥æ–¹å¼</span>    <span class="token keyword">int</span> LOGWrite<span class="token punctuation">;</span>    <span class="token comment">//è§¦å‘ç»„åˆæ¨¡å¼</span>    <span class="token keyword">int</span> TRIGMode<span class="token punctuation">;</span>    <span class="token comment">//listenfdè§¦å‘æ¨¡å¼</span>    <span class="token keyword">int</span> LISTENTrigmode<span class="token punctuation">;</span>    <span class="token comment">//connfdè§¦å‘æ¨¡å¼</span>    <span class="token keyword">int</span> CONNTrigmode<span class="token punctuation">;</span>    <span class="token comment">//ä¼˜é›…å…³é—­é“¾æ¥</span>    <span class="token keyword">int</span> OPT_LINGER<span class="token punctuation">;</span>    <span class="token comment">//æ•°æ®åº“è¿æ¥æ± æ•°é‡</span>    <span class="token keyword">int</span> sql_num<span class="token punctuation">;</span>    <span class="token comment">//çº¿ç¨‹æ± å†…çš„çº¿ç¨‹æ•°é‡</span>    <span class="token keyword">int</span> thread_num<span class="token punctuation">;</span>    <span class="token comment">//æ˜¯å¦å…³é—­æ—¥å¿—</span>    <span class="token keyword">int</span> close_log<span class="token punctuation">;</span>    <span class="token comment">//å¹¶å‘æ¨¡å‹é€‰æ‹©</span>    <span class="token keyword">int</span> actor_model<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Config-cpp"><a href="#Config-cpp" class="headerlink" title="Config.cpp"></a>Config.cpp</h2><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"config.h"</span></span><span class="token class-name">Config</span><span class="token operator">::</span><span class="token function">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç«¯å£å·,é»˜è®¤9006</span>    PORT <span class="token operator">=</span> <span class="token number">9006</span><span class="token punctuation">;</span>    <span class="token comment">//æ—¥å¿—å†™å…¥æ–¹å¼ï¼Œé»˜è®¤åŒæ­¥</span>    LOGWrite <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//è§¦å‘ç»„åˆæ¨¡å¼,é»˜è®¤listenfd LT + connfd LT</span>    TRIGMode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//listenfdè§¦å‘æ¨¡å¼ï¼Œé»˜è®¤LT</span>    LISTENTrigmode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//connfdè§¦å‘æ¨¡å¼ï¼Œé»˜è®¤LT</span>    CONNTrigmode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//ä¼˜é›…å…³é—­é“¾æ¥ï¼Œé»˜è®¤ä¸ä½¿ç”¨</span>    OPT_LINGER <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//æ•°æ®åº“è¿æ¥æ± æ•°é‡,é»˜è®¤8</span>    sql_num <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token comment">//çº¿ç¨‹æ± å†…çš„çº¿ç¨‹æ•°é‡,é»˜è®¤8</span>    thread_num <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token comment">//å…³é—­æ—¥å¿—,é»˜è®¤ä¸å…³é—­</span>    close_log <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//å¹¶å‘æ¨¡å‹,é»˜è®¤æ˜¯proactor</span>    actor_model <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token class-name">Config</span><span class="token operator">::</span><span class="token function">parse_arg</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> opt<span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str <span class="token operator">=</span> <span class="token string">"p:l:m:o:s:t:c:a:"</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>opt <span class="token operator">=</span> <span class="token function">getopt</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>opt<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token string">'p'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            PORT <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> <span class="token string">'l'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            LOGWrite <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> <span class="token string">'m'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            TRIGMode <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> <span class="token string">'o'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            OPT_LINGER <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> <span class="token string">'s'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            sql_num <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> <span class="token string">'t'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            thread_num <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> <span class="token string">'c'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            close_log <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">case</span> <span class="token string">'a'</span><span class="token operator">:</span>        <span class="token punctuation">&#123;</span>            actor_model <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>optarg<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">default</span><span class="token operator">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebServer </tag>
            
            <tag> é¡¹ç›® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeå‘¨èµ›265åœº</title>
      <link href="LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B265%E5%9C%BA/"/>
      <url>LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B265%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCodeå‘¨èµ›ç¬¬265åœº"><a href="#LeetCodeå‘¨èµ›ç¬¬265åœº" class="headerlink" title="LeetCodeå‘¨èµ›ç¬¬265åœº"></a>LeetCodeå‘¨èµ›ç¬¬265åœº</h1><p>ç»ˆäºæœ‰æ—¶é—´æ¥è®¤è®¤çœŸçœŸå‚åŠ ä¸€æ¬¡å‘¨èµ›äº†ï¼Œå‰å‡ å‘¨éƒ½æ˜¯æ–­æ–­ç»­ç»­åœ°å‚åŠ ï¼Œå¥½å‡ æ¬¡éƒ½æ˜¯æœ‰ä¼šè¦å¼€ç»™å†²çªäº†</p><p>æœ¬å‘¨å‘¨èµ›æ¯”è¾ƒç®€å•ï¼Œç¬¬ä¸€ã€äºŒé¢˜éƒ½æ˜¯é€åˆ†é¢˜ï¼Œåªæ˜¯ç¬¬äºŒé¢˜ç¨å¾®éº»çƒ¦ä¸€äº›ï¼Œç„¶åç¬¬ä¸‰é¢˜éœ€è¦æ€è€ƒä¸€ä¸‹ï¼Œä½†æˆ‘åšçš„æ—¶å€™å¹¶æ²¡æœ‰æ€è·¯ï¼Œæ‰€ä»¥è¿™æ¬¡é‡ç‚¹æ¥çœ‹ç¬¬ä¸‰é¢˜</p><h2 id="2057-å€¼ç›¸ç­‰çš„æœ€å°ç´¢å¼•"><a href="#2057-å€¼ç›¸ç­‰çš„æœ€å°ç´¢å¼•" class="headerlink" title="2057. å€¼ç›¸ç­‰çš„æœ€å°ç´¢å¼•"></a><a href="https://leetcode-cn.com/problems/smallest-index-with-equal-value/">2057. å€¼ç›¸ç­‰çš„æœ€å°ç´¢å¼•</a></h2><p>é¦–å…ˆæ˜¯ç®€å•é¢˜ï¼Œç…§æ ·ä¹Ÿæ˜¯ä¸€é“é€åˆ†é¢˜ï¼Œè€Œä¸”è¿™é“é¢˜ä¸€åˆ†é’Ÿä¹‹å†…å°±å¯ä»¥å†™å®Œï¼Œæ„Ÿè§‰ä¸è¦å¤ªçˆ½</p><img src="https://i.loli.net/2021/11/01/2a7lsy64WCNFXhT.png" style="zoom:80%;" /><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">smallestEqual</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">%</span><span class="token number">10</span><span class="token operator">==</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="2058-æ‰¾å‡ºä¸´ç•Œç‚¹ä¹‹é—´çš„æœ€å°å’Œæœ€å¤§è·ç¦»"><a href="#2058-æ‰¾å‡ºä¸´ç•Œç‚¹ä¹‹é—´çš„æœ€å°å’Œæœ€å¤§è·ç¦»" class="headerlink" title="2058. æ‰¾å‡ºä¸´ç•Œç‚¹ä¹‹é—´çš„æœ€å°å’Œæœ€å¤§è·ç¦»"></a><a href="https://leetcode-cn.com/problems/find-the-minimum-and-maximum-number-of-nodes-between-critical-points/">2058. æ‰¾å‡ºä¸´ç•Œç‚¹ä¹‹é—´çš„æœ€å°å’Œæœ€å¤§è·ç¦»</a></h2><p>è¿™é“é¢˜æˆ‘åœ¨åšçš„æ—¶å€™ä¹Ÿåšå‡ºæ¥äº†ï¼Œæ€è·¯æ¯”è¾ƒå¥½æƒ³ï¼Œå°±æ˜¯ä»£ç æœ‰ç‚¹å¤šï¼Œæ¯”è¾ƒéº»çƒ¦</p><p>åŒæ—¶åœ¨ä¸€å¼€å§‹çœ‹é¢˜ç›®æ˜¯å¿«é€Ÿçœ‹çš„ï¼Œçœ‹é”™äº†è¿”å›æ¡ä»¶ï¼Œå¥½é™©æ˜¯åœ¨æµ‹è¯•ç”¨ä¾‹æ—¶å‘ç°äº†ï¼Œæ‰€ä»¥é¢˜ç›®é•¿çš„æ—¶å€™æ›´åº”è¯¥æ…¢æ…¢çœ‹é¢˜ç›®ï¼Œä¸è¦ç€æ€¥</p><img src="https://i.loli.net/2021/11/01/zK8uh7MiqBbFsYx.png" style="zoom:80%;" /><img src="https://i.loli.net/2021/11/01/ismdITA5bCnE8w9.png" style="zoom:80%;" /><img src="https://i.loli.net/2021/11/01/CEGDgenFLxi8NqM.png" style="zoom:80%;" /><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/** * Definition for singly-linked list. * struct ListNode &#123; *     int val; *     ListNode *next; *     ListNode() : val(0), next(nullptr) &#123;&#125; *     ListNode(int x) : val(x), next(nullptr) &#123;&#125; *     ListNode(int x, ListNode *next) : val(x), next(next) &#123;&#125; * &#125;; */</span><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">nodesBetweenCriticalPoints</span><span class="token punctuation">(</span>ListNode<span class="token operator">*</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>head<span class="token operator">||</span><span class="token operator">!</span>head<span class="token operator">-></span>next<span class="token operator">||</span><span class="token operator">!</span>head<span class="token operator">-></span>next<span class="token operator">-></span>next<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        ListNode<span class="token operator">*</span> lst<span class="token operator">=</span>head<span class="token punctuation">;</span>        ListNode<span class="token operator">*</span> cur<span class="token operator">=</span>head<span class="token operator">-></span>next<span class="token punctuation">;</span>        <span class="token keyword">int</span> index<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> minIndex<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>cur<span class="token operator">-></span>next<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token operator">-></span>val<span class="token operator">&lt;</span>lst<span class="token operator">-></span>val<span class="token operator">&amp;&amp;</span>cur<span class="token operator">-></span>val<span class="token operator">&lt;</span>cur<span class="token operator">-></span>next<span class="token operator">-></span>val<span class="token punctuation">)</span>                minIndex<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token operator">-></span>val<span class="token operator">></span>lst<span class="token operator">-></span>val<span class="token operator">&amp;&amp;</span>cur<span class="token operator">-></span>val<span class="token operator">></span>cur<span class="token operator">-></span>next<span class="token operator">-></span>val<span class="token punctuation">)</span>                minIndex<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>                        lst<span class="token operator">=</span>lst<span class="token operator">-></span>next<span class="token punctuation">;</span>            cur<span class="token operator">=</span>cur<span class="token operator">-></span>next<span class="token punctuation">;</span>            <span class="token operator">++</span>index<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">res</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> alen<span class="token operator">=</span>minIndex<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>alen<span class="token operator">>=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">sort</span><span class="token punctuation">(</span>minIndex<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>minIndex<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>minIndex<span class="token punctuation">[</span>alen<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">-</span>minIndex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                        <span class="token keyword">int</span> m<span class="token operator">=</span>INT_MAX<span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>alen<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">int</span> temp<span class="token operator">=</span>minIndex<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>minIndex<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                m<span class="token operator">=</span>temp<span class="token operator">&lt;</span>m<span class="token operator">?</span>temp<span class="token operator">:</span>m<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>m<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="2059-è½¬åŒ–æ•°å­—çš„æœ€å°è¿ç®—æ•°"><a href="#2059-è½¬åŒ–æ•°å­—çš„æœ€å°è¿ç®—æ•°" class="headerlink" title="2059. è½¬åŒ–æ•°å­—çš„æœ€å°è¿ç®—æ•°"></a><a href="https://leetcode-cn.com/problems/minimum-operations-to-convert-number/">2059. è½¬åŒ–æ•°å­—çš„æœ€å°è¿ç®—æ•°</a></h2><p>è¿™é“é¢˜åœ¨ç«èµ›æ—¶çœ‹æ‡‚äº†é¢˜ç›®ï¼ˆç»ˆäºçœ‹æ‡‚ç¬¬ä¸‰é¢˜äº†ï¼Œæ³ªç›®ğŸ˜­ï¼‰ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰æ€è·¯ï¼Œæ‰€ä»¥æ‰“ç®—ç«èµ›æ—¶é—´è¿‡åæ¥å¤ä¹ </p><p>èµ›åæˆ‘çœ‹äº†<a href="https://leetcode-cn.com/problems/minimum-operations-to-convert-number/solution/zhuan-hua-shu-zi-de-zui-xiao-yun-suan-sh-kju7/">å®˜æ–¹é¢˜è§£</a>ï¼Œæ€è·¯å…¶å®è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œåˆ©ç”¨äº†é˜Ÿåˆ—æ¥å®ç°<strong>å¹¿åº¦ä¼˜å…ˆéå†</strong>ï¼Œé˜Ÿåˆ—ä¸­æ¯ä¸ªå…ƒç´ çš„ç±»å‹æ˜¯ä¸€ä¸ª<code>pair&lt;int,int&gt;</code>ï¼Œè®°å½•çš„åˆ†åˆ«æ˜¯<code>[è®¡ç®—ç»“æœï¼Œå¾—å‡ºè¯¥ç»“æœæ‰€ç”¨çš„æ­¥æ•°]</code></p><p>æ¯ä¸€æ¬¡éå†ä»é˜Ÿåˆ—ä¸­å–å‡ºç¬¬ä¸€ä¸ªå€¼<code>x</code>ï¼Œå¹¶å°†å…¶è¿›è¡Œ<code>+</code>ã€<code>-</code>ã€<code>^</code>ä¸‰ç§è®¡ç®—ï¼Œå¾—å‡ºç»“æœ<code>nx</code>ï¼Œç„¶ååˆ†ä¸ºå››ç§æƒ…å†µï¼š</p><ul><li>å¦‚æœ<code>nx</code>åˆšå¥½ä¸ºæˆ‘ä»¬è¦æ±‚çš„ç›®æ ‡<code>goal</code>ï¼Œç›´æ¥è¿”å›æ­¥æ•°step+1</li><li><code>nx</code>ä¸åœ¨é¢˜ç›®æ‰€ç»™å®šçš„[1,1000]èŒƒå›´å†…ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸è¿›è¡Œæ“ä½œ</li><li><code>nx</code>åœ¨èŒƒå›´å†…ï¼Œä½†æ˜¯å‰é¢è®¡ç®—çš„æ•°ä¸­å·²ç»å‡ºç°è¿‡è¿™ä¸ªç»“æœäº†ï¼Œä¹Ÿæ˜¯ç›´æ¥è·³è¿‡ï¼Œä¸è¿›è¡Œæ“ä½œï¼ˆâ— è¿™é‡Œå°±è¦æ±‚æˆ‘ä»¬é¢å¤–è®°å½•ä¸€ä¸‹ä¹‹å‰å‡ºç°çš„ç»“æœï¼Œæˆ‘ç”¨çš„æ˜¯<code>vector&lt;bool&gt;</code>æ•°ç»„ï¼‰</li><li><code>nx</code>åœ¨èŒƒå›´å†…ï¼Œå‰é¢ä¹Ÿæ²¡æœ‰å‡ºç°è¿‡è¿™ä¸ªæ•°ï¼Œåˆ™å°†å¾—å‡ºçš„<code>nx</code>ä»¥<code>pair</code>çš„æ–¹å¼åŠ åˆ°é˜Ÿåˆ—ä¸­</li></ul><p>â— å¦å¤–ä¸€ä¸ªè¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºé¢˜ç›®è¿˜è¦æ±‚è®¡ç®—çš„æ•°è¦åˆ©ç”¨ç»™å®šæ•°ç»„<code>nums</code>ä¸­çš„æ•°ï¼Œæ‰€ä»¥è¿™é‡Œè¦ä¸¤å±‚éå†ï¼Œä¸€å±‚æ˜¯ä¸‰ä¸ªæ“ä½œç¬¦ï¼Œå¦ä¸€å±‚æ˜¯å’Œ<code>nums</code>ä¸­çš„å„ä¸ªæ•°è®¡ç®—</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">minimumOperations</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> goal<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">auto</span> op1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">int</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">auto</span> op2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">int</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">auto</span> op3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">int</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> x <span class="token operator">^</span> y<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span>function<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">>></span> ops <span class="token operator">=</span> <span class="token punctuation">&#123;</span>op1<span class="token punctuation">,</span> op2<span class="token punctuation">,</span> op3<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>   <span class="token comment">// è¿ç®—ç¬¦åˆ—è¡¨</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">vis</span><span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// å¯æ“ä½œèŒƒå›´å†…æ•´æ•°çš„è®¿é—®æƒ…å†µ</span>        queue<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">>></span> q<span class="token punctuation">;</span>        q<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        vis<span class="token punctuation">[</span>start<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">auto</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> step<span class="token punctuation">]</span> <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// æšä¸¾æ•°ç»„ä¸­çš„å…ƒç´ å’Œæ“ä½œç¬¦å¹¶è®¡ç®—æ–°ç”Ÿæˆçš„æ•°å€¼</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> op<span class="token operator">:</span> ops<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">int</span> nx <span class="token operator">=</span> <span class="token function">op</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// å¦‚æœæ–°ç”Ÿæˆçš„æ•°å€¼ç­‰äºç›®æ ‡å€¼ï¼Œåˆ™è¿”å›å¯¹åº”æ“ä½œæ•°</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>nx <span class="token operator">==</span> goal<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token keyword">return</span> step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token comment">// å¦‚æœæ–°ç”Ÿæˆçš„æ•°å€¼ä½äºå¯æ“ä½œèŒƒå›´å†…ä¸”æœªè¢«åŠ å…¥é˜Ÿåˆ—ï¼Œåˆ™æ›´æ”¹è®¿é—®æƒ…å†µå¹¶åŠ å…¥é˜Ÿåˆ—</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>nx <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nx <span class="token operator">&lt;=</span> <span class="token number">1000</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>vis<span class="token punctuation">[</span>nx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        vis<span class="token punctuation">[</span>nx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>                        q<span class="token punctuation">.</span><span class="token function">emplace</span><span class="token punctuation">(</span>nx<span class="token punctuation">,</span> step <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// ä¸å­˜åœ¨ä»åˆå§‹å€¼åˆ°ç›®æ ‡å€¼çš„è½¬åŒ–æ–¹æ¡ˆ</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> LeetCodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeå‘¨èµ›258åœº</title>
      <link href="LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B258%E5%9C%BA/"/>
      <url>LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B258%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCodeå‘¨èµ›257åœº"><a href="#LeetCodeå‘¨èµ›257åœº" class="headerlink" title="LeetCodeå‘¨èµ›257åœº"></a>LeetCodeå‘¨èµ›257åœº</h1><p>è¿™å‘¨çš„å‘¨èµ›ç¬¬äºŒé¢˜å¡äº†æŒºä¹…çš„ï¼Œç‰¹åˆ«æ˜¯æœ€åé¢å‡ ä¸ªç”¨ä¾‹</p><p>ç„¶åæ˜¯ç¬¬ä¸‰é¢˜ï¼Œè™½ç„¶æ²¡æœ‰åšä½†æ˜¯çœ‹äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰ä¹ŸæŒºæœ‰è¶£çš„:ice_cream:</p><h2 id="5867-åè½¬å•è¯å‰ç¼€-â€”ï¼ˆç®€å•ï¼‰"><a href="#5867-åè½¬å•è¯å‰ç¼€-â€”ï¼ˆç®€å•ï¼‰" class="headerlink" title="5867. åè½¬å•è¯å‰ç¼€    â€”ï¼ˆç®€å•ï¼‰"></a><a href="https://leetcode-cn.com/problems/reverse-prefix-of-word/">5867. åè½¬å•è¯å‰ç¼€</a>    â€”ï¼ˆç®€å•ï¼‰</h2><img src="https://i.loli.net/2021/09/12/AXe5iKohCBj9Uw1.png" style="zoom:80%;" /><p>ç¬¬ä¸€é¢˜é€åˆ†é¢˜ï¼Œæ€ä¹ˆèˆ’æœæ€ä¹ˆæ¥</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    string <span class="token function">reversePrefix</span><span class="token punctuation">(</span>string word<span class="token punctuation">,</span> <span class="token keyword">char</span> ch<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> wlen<span class="token operator">=</span>word<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>wlen<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>word<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>ch<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                index<span class="token operator">=</span>i<span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>index<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token function">reverse</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>word<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> word<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="5868-å¯äº’æ¢çŸ©å½¢çš„ç»„æ•°-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#5868-å¯äº’æ¢çŸ©å½¢çš„ç»„æ•°-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="5868. å¯äº’æ¢çŸ©å½¢çš„ç»„æ•°    â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/number-of-pairs-of-interchangeable-rectangles/">5868. å¯äº’æ¢çŸ©å½¢çš„ç»„æ•°</a>    â€”ï¼ˆä¸­ç­‰ï¼‰</h2><img src="https://i.loli.net/2021/09/12/LQGpVs37gmyHbO4.png" style="zoom:80%;" /><p>æç¤ºï¼š</p><ul><li>n == rectangles.length</li><li>1 &lt;= n &lt;= 105</li><li>rectangles[i].length == 2</li><li>1 &lt;= widthi, heighti &lt;= 105</li></ul><p>è¿™é“é¢˜å‡ºé”™å¥½å¤šæ¬¡ï¼Œå…¨éƒ½æ˜¯ç»†èŠ‚é—®é¢˜ï¼Œåˆšå¼€å§‹æƒ³ç€æš´åŠ›è§£æ³•å’Œè®°å¿†è¡¨è§£æ³•ï¼Œä½†æ˜¯éƒ½è¶…æ—¶äº†:point_down:</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//ï¼ï¼ï¼ä¸‹é¢ä»£ç æ˜¯è¶…æ—¶çš„è§£æ³•ï¼ï¼ï¼</span><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">interchangeableRectangles</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> rectangles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> rlen<span class="token operator">=</span>rectangles<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//çŸ©é˜µä¸ªæ•°</span>        vector<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">></span> <span class="token function">map</span><span class="token punctuation">(</span>rlen<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rlen<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>            map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>rectangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>rectangles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        std<span class="token operator">::</span><span class="token function">sort</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>map<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>rlen<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>rlen<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>map<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                    <span class="token operator">++</span>res<span class="token punctuation">;</span>                <span class="token keyword">else</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åé¢˜ç›®æ€»å…±æœ‰46ä¸ªç”¨ä¾‹ï¼Œåé¢ä¸€ç›´å¡åœ¨åé¢å‡ ä¸ªï¼Œç›´æ¥ç—›è‹¦é¢å…·:sweat:</p><p>èµ›åçœ‹äº†ä¸€ä¸‹åˆ«äººçš„è§£æ³•ï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œéƒ½æ˜¯è¿ç”¨äº†å“ˆå¸Œè¡¨æ¥å®ç°</p><p>æœ‰å‡ ä¸ªæ³¨æ„äº‹é¡¹ï¼š</p><ol><li>ç²¾åº¦é—®é¢˜ï¼Œx/yæŒ‰doubleæ±‚çš„è¯åº”è¯¥ä¸ä¼šæœ‰é—®é¢˜ï¼Œæœ€å¥½çš„æ–¹æ³•åº”è¯¥æ˜¯å…ˆæ±‚æœ€å¤§å…¬çº¦æ•°ï¼Œç„¶ååŒ–ç®€ï¼›</li><li>ä¿å­˜ç»“æœçš„è¯ï¼Œæ³¨æ„keyä¸º<strong>pairæ—¶é»˜è®¤ä¸æ”¯æŒunordered_map</strong>;ï¼ˆ:warning:è¿™ä¸ªè¦æ³¨æ„ï¼‰</li><li>æ³¨æ„æ•°æ®èŒƒå›´ï¼Œè¯¥ç”¨long longçš„åœ°æ–¹ä¸èƒ½çŠ¹è±«ã€‚</li></ol><p>å…¶ä¸­ä¸€ç§æ™®é€šçš„è§£æ³•å¯èƒ½ä¼šæœ‰ç»™å¡ç²¾åº¦çš„é£é™©ï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªç²¾åº¦å·®ä¸å¤šçš„æ•°è€Œå¯¼è‡´<code>res</code>æ”¹å˜ï¼Œä½†æœ¬é¢˜ç›®å¹¶æ²¡æœ‰å¡ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥äº†è§£ä¸€ä¸‹è¯¥è§£æ³•</p><p>ç®€å•æ¥è¯´å°±æ˜¯éå†ä¸€éçŸ©å½¢ï¼Œæ±‚å‡ºå„ä¸ªçŸ©é˜µçš„å®½é«˜æ¯”å¹¶æ‰“å…¥å“ˆå¸Œè¡¨ä¸­ï¼Œå“ˆå¸Œè¡¨è®°å½•çš„æ˜¯æ¯ä¸€ç§å®½é«˜æ¯”çš„æ€»æ•°</p><p>æœ€åå†è¿ç”¨é«˜ä¸­çŸ¥è¯†æ’åˆ—ç»„åˆçš„<code>ç»„åˆå…¬å¼</code>æ¥æ±‚ï¼Œï¼ˆåœ¨ä¸€å †ç›¸åŒçš„å®½é«˜æ¯”ä¸­é€‰å‡ºä¸¤ä¸ªæ¥é…å¯¹ï¼‰</p><img src="https://i.loli.net/2021/09/12/HBOSmRXbVlp2AWe.png" style="zoom:80%;" /><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">interchangeableRectangles</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> rectangles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    unordered_map<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token operator">></span>map<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> arr<span class="token operator">:</span>rectangles<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">double</span> cur<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token operator">++</span>map<span class="token punctuation">[</span>cur<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span>second<span class="token punctuation">]</span><span class="token operator">:</span>map<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        res<span class="token operator">+=</span><span class="token punctuation">(</span>second<span class="token operator">*</span><span class="token punctuation">(</span>second<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬äºŒç§è§£æ³•åˆšå¼€å§‹æˆ‘æ˜¯ä¸å¤ªæ‡‚çš„ï¼Œå®ƒæ˜¯ç”¨äº†<code>gcd()</code>æ¥æ±‚å®½å’Œé«˜ä¹‹é—´<code>æœ€å¤§å…¬å› æ•°</code>ï¼Œå†åˆ©ç”¨å®ƒæ¥åŒ–ç®€å®½é«˜æ¯”ï¼šå°†(åˆ†å­*BASE+åˆ†æ¯)ä½œä¸ºä¸€ä¸ªkeyå­˜å…¥å“ˆå¸Œè¡¨</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">private</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> a<span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token keyword">return</span> <span class="token function">gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>a<span class="token operator">%</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">interchangeableRectangles</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> rectangles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        unordered_map<span class="token operator">&lt;</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">,</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token operator">></span>map<span class="token punctuation">;</span>        <span class="token keyword">constexpr</span> <span class="token keyword">long</span> <span class="token keyword">long</span> BASE<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token punctuation">)</span><span class="token number">1e8</span><span class="token punctuation">;</span><span class="token comment">//åŸºæ•°ï¼Œå¤§ä¸€ç‚¹çš„æ•°éƒ½å¯ä»¥</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> arr<span class="token operator">:</span>rectangles<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> c<span class="token operator">=</span><span class="token function">gcd</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">long</span> <span class="token keyword">long</span> frac<span class="token operator">=</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">/</span>c<span class="token punctuation">)</span><span class="token operator">*</span>BASE<span class="token operator">+</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŒ–ç®€ï¼Œä¹˜ä¸ŠåŸºæ•°ä»¥ä¾¿åœ¨å“ˆå¸Œè¡¨å†…åŒºåˆ†</span>            <span class="token operator">++</span>map<span class="token punctuation">[</span>frac<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span> <span class="token keyword">long</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span>second<span class="token punctuation">]</span><span class="token operator">:</span>map<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            res<span class="token operator">+=</span><span class="token punctuation">(</span>second<span class="token operator">*</span><span class="token punctuation">(</span>second<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="5869-ä¸¤ä¸ªå›æ–‡å­åºåˆ—é•¿åº¦çš„æœ€å¤§ä¹˜ç§¯-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#5869-ä¸¤ä¸ªå›æ–‡å­åºåˆ—é•¿åº¦çš„æœ€å¤§ä¹˜ç§¯-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="5869. ä¸¤ä¸ªå›æ–‡å­åºåˆ—é•¿åº¦çš„æœ€å¤§ä¹˜ç§¯    â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/maximum-product-of-the-length-of-two-palindromic-subsequences/">5869. ä¸¤ä¸ªå›æ–‡å­åºåˆ—é•¿åº¦çš„æœ€å¤§ä¹˜ç§¯</a>    â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾åˆ° s ä¸­ä¸¤ä¸ª ä¸ç›¸äº¤å›æ–‡å­åºåˆ— ï¼Œä½¿å¾—å®ƒä»¬é•¿åº¦çš„ ä¹˜ç§¯æœ€å¤§ ã€‚ä¸¤ä¸ªå­åºåˆ—åœ¨åŸå­—ç¬¦ä¸²ä¸­å¦‚æœæ²¡æœ‰ä»»ä½•ç›¸åŒä¸‹æ ‡çš„å­—ç¬¦ï¼Œåˆ™å®ƒä»¬æ˜¯ ä¸ç›¸äº¤ çš„ã€‚</p><p>è¯·ä½ è¿”å›ä¸¤ä¸ªå›æ–‡å­åºåˆ—é•¿åº¦å¯ä»¥è¾¾åˆ°çš„ æœ€å¤§ä¹˜ç§¯ ã€‚</p><p>å­åºåˆ— æŒ‡çš„æ˜¯ä»åŸå­—ç¬¦ä¸²ä¸­åˆ é™¤è‹¥å¹²ä¸ªå­—ç¬¦ï¼ˆå¯ä»¥ä¸€ä¸ªä¹Ÿä¸åˆ é™¤ï¼‰åï¼Œå‰©ä½™å­—ç¬¦ä¸æ”¹å˜é¡ºåºè€Œå¾—åˆ°çš„ç»“æœã€‚å¦‚æœä¸€ä¸ªå­—ç¬¦ä¸²ä»å‰å¾€åè¯»å’Œä»åå¾€å‰è¯»ä¸€æ¨¡ä¸€æ ·ï¼Œé‚£ä¹ˆè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ª å›æ–‡å­—ç¬¦ä¸² ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><img src="https://i.loli.net/2021/09/12/lZzOQqu7myNiCaG.png" style="zoom:80%;" /><blockquote><p>è¾“å…¥ï¼šs = â€œleetcodecomâ€<br>è¾“å‡ºï¼š9<br>è§£é‡Šï¼šæœ€ä¼˜æ–¹æ¡ˆæ˜¯é€‰æ‹© â€œeteâ€ ä½œä¸ºç¬¬ä¸€ä¸ªå­åºåˆ—ï¼Œâ€cdcâ€ ä½œä¸ºç¬¬äºŒä¸ªå­åºåˆ—ã€‚<br>å®ƒä»¬çš„ä¹˜ç§¯ä¸º 3 * 3 = 9 ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œbbâ€<br>è¾“å‡ºï¼š1<br>è§£é‡Šï¼šæœ€ä¼˜æ–¹æ¡ˆä¸ºé€‰æ‹© â€œbâ€ ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦ï¼‰ä½œä¸ºç¬¬ä¸€ä¸ªå­åºåˆ—ï¼Œâ€bâ€ ï¼ˆç¬¬äºŒä¸ªå­—ç¬¦ï¼‰ä½œä¸ºç¬¬äºŒä¸ªå­åºåˆ—ã€‚<br>å®ƒä»¬çš„ä¹˜ç§¯ä¸º 1 * 1 = 1 ã€‚</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œaccbcaxxcxxâ€<br>è¾“å‡ºï¼š25<br>è§£é‡Šï¼šæœ€ä¼˜æ–¹æ¡ˆä¸ºé€‰æ‹© â€œacccaâ€ ä½œä¸ºç¬¬ä¸€ä¸ªå­åºåˆ—ï¼Œâ€xxcxxâ€ ä½œä¸ºç¬¬äºŒä¸ªå­åºåˆ—ã€‚<br>å®ƒä»¬çš„ä¹˜ç§¯ä¸º 5 * 5 = 25 ã€‚</p></blockquote><p>æç¤ºï¼š</p><ul><li>2 &lt;= s.length &lt;= 12</li><li>s åªå«æœ‰å°å†™è‹±æ–‡å­—æ¯</li></ul>]]></content>
      
      
      <categories>
          
          <category> LeetCodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeå‘¨èµ›257åœº</title>
      <link href="LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B257%E5%9C%BA/"/>
      <url>LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B257%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCodeå‘¨èµ›ç¬¬257åœº"><a href="#LeetCodeå‘¨èµ›ç¬¬257åœº" class="headerlink" title="LeetCodeå‘¨èµ›ç¬¬257åœº"></a><a href="https://leetcode-cn.com/contest/weekly-contest-257/">LeetCodeå‘¨èµ›ç¬¬257åœº</a></h1><p>ç”±äºä¸Šä¸€æ¬¡å‘¨èµ›çš„æ—¶å€™LeetCodeæœåŠ¡å™¨å‡ºäº†é—®é¢˜ï¼Œæ‰€ä»¥ä¸Šæ¬¡çš„å‘¨èµ›æ²¡æœ‰å‚åŠ åˆ°</p><p>è€Œæœ¬å‘¨çš„å‘¨èµ›å¼€å§‹å‰æœåŠ¡å™¨ä¹Ÿå‡ºäº†ä¸€äº›é—®é¢˜ï¼Œå¥½åœ¨ä¿®å¤åœ°å¿«è¿›å»äº†</p><img src="C:\Users\ZhaoYJ\AppData\Roaming\Typora\typora-user-images\image-20210905142220496.png" alt="image-20210905142220496" style="zoom:80%;" /><p>è¿™å‘¨çš„å‘¨èµ›åˆè®©æˆ‘ä»ä¸¤é“é€‰æ‰‹é€€åŒ–æˆäº†ä¸€é“é€‰æ‰‹ï¼ˆå‰ä¸¤é“ç›´æ¥å¯„ï¼‰</p><p>å‰ä¸¤é¢˜éƒ½æ˜¯æ•°ç»„é¢˜ï¼Œåé¢ä¸¤é¢˜å°±æ²¡æ€ä¹ˆçœ‹äº†ï¼Œè¿™é‡Œå°±å…ˆè®°å½•å‰ä¸¤é“é¢˜ç›®</p><h2 id="5863-ç»Ÿè®¡ç‰¹æ®Šå››å…ƒç»„"><a href="#5863-ç»Ÿè®¡ç‰¹æ®Šå››å…ƒç»„" class="headerlink" title="5863. ç»Ÿè®¡ç‰¹æ®Šå››å…ƒç»„"></a><a href="https://leetcode-cn.com/problems/count-special-quadruplets/">5863. ç»Ÿè®¡ç‰¹æ®Šå››å…ƒç»„</a></h2><p>ç»™ä½ ä¸€ä¸ª ä¸‹æ ‡ä» 0 å¼€å§‹ çš„æ•´æ•°æ•°ç»„ nums ï¼Œè¿”å›æ»¡è¶³ä¸‹è¿°æ¡ä»¶çš„ ä¸åŒ å››å…ƒç»„ (a, b, c, d) çš„ æ•°ç›® ï¼š</p><ul><li>nums[a] + nums[b] + nums[c] == nums[d] ï¼Œä¸”</li><li>a &lt; b &lt; c &lt; d</li></ul><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [1,2,3,6]<br>è¾“å‡ºï¼š1<br>è§£é‡Šï¼šæ»¡è¶³è¦æ±‚çš„å”¯ä¸€ä¸€ä¸ªå››å…ƒç»„æ˜¯ (0, 1, 2, 3) å› ä¸º 1 + 2 + 3 == 6 ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [3,3,6,4,5]<br>è¾“å‡ºï¼š0<br>è§£é‡Šï¼š[3,3,6,4,5] ä¸­ä¸å­˜åœ¨æ»¡è¶³è¦æ±‚çš„å››å…ƒç»„ã€‚</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [1,1,1,3,5]<br>è¾“å‡ºï¼š4<br>è§£é‡Šï¼šæ»¡è¶³è¦æ±‚çš„ 4 ä¸ªå››å…ƒç»„å¦‚ä¸‹ï¼š</p></blockquote><ul><li>(0, 1, 2, 3): 1 + 1 + 1 == 3</li><li>(0, 1, 3, 4): 1 + 1 + 3 == 5</li><li>(0, 2, 3, 4): 1 + 1 + 3 == 5</li><li>(1, 2, 3, 4): 1 + 1 + 3 == 5</li></ul><p>ç¬¬ä¸€é“é¢˜å› ä¸ºæ•°ç»„é•¿åº¦æœ€å¤§åˆ°50ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å››é‡å¾ªç¯æš´åŠ›è§£æ³•</p><p>ä½†æ˜¯è¦æ³¨æ„æ˜¯ä¸èƒ½sortï¼Œå› ä¸ºé¢˜ç›®ç»™å®šäº†æ¡ä»¶ï¼Œåˆå§‹ä¸‹æ ‡ä¸­<code>a&lt;b&lt;c&lt;d</code>ï¼Œå¦‚æœæ’åºçš„è¯å°±ä¼šæ‰“ä¹±ä¸‹æ ‡é¡ºåºäº†ï¼Œæˆ‘åœ¨åšé¢˜ä¸­å‡ºé”™äº†ä¸€æ¬¡ä¹Ÿæ˜¯è¿™ä¸ªåŸå› </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">countQuadruplets</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//ä¸èƒ½sort</span>        <span class="token keyword">int</span> nlen<span class="token operator">=</span>nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>a<span class="token operator">&lt;</span>nlen<span class="token punctuation">;</span><span class="token operator">++</span>a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token operator">=</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>b<span class="token operator">&lt;</span>nlen<span class="token punctuation">;</span><span class="token operator">++</span>b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token operator">=</span>b<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>c<span class="token operator">&lt;</span>nlen<span class="token punctuation">;</span><span class="token operator">++</span>c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> d<span class="token operator">=</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>d<span class="token operator">&lt;</span>nlen<span class="token punctuation">;</span><span class="token operator">++</span>d<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token operator">+</span>nums<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token operator">+</span>nums<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token operator">==</span>nums<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span>                            <span class="token operator">++</span>res<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N^4)</p><hr><h2 id="5864-æ¸¸æˆä¸­å¼±è§’è‰²çš„æ•°é‡"><a href="#5864-æ¸¸æˆä¸­å¼±è§’è‰²çš„æ•°é‡" class="headerlink" title="5864. æ¸¸æˆä¸­å¼±è§’è‰²çš„æ•°é‡"></a><a href="https://leetcode-cn.com/problems/the-number-of-weak-characters-in-the-game/">5864. æ¸¸æˆä¸­å¼±è§’è‰²çš„æ•°é‡</a></h2><p>ä½ æ­£åœ¨å‚åŠ ä¸€ä¸ªå¤šè§’è‰²æ¸¸æˆï¼Œæ¯ä¸ªè§’è‰²éƒ½æœ‰ä¸¤ä¸ªä¸»è¦å±æ€§ï¼šæ”»å‡» å’Œ é˜²å¾¡ ã€‚ç»™ä½ ä¸€ä¸ªäºŒç»´æ•´æ•°æ•°ç»„ properties ï¼Œå…¶ä¸­ properties[i] = [attacki, defensei] è¡¨ç¤ºæ¸¸æˆä¸­ç¬¬ i ä¸ªè§’è‰²çš„å±æ€§ã€‚</p><p>å¦‚æœå­˜åœ¨ä¸€ä¸ªå…¶ä»–è§’è‰²çš„æ”»å‡»å’Œé˜²å¾¡ç­‰çº§ éƒ½ä¸¥æ ¼é«˜äº è¯¥è§’è‰²çš„æ”»å‡»å’Œé˜²å¾¡ç­‰çº§ï¼Œåˆ™è®¤ä¸ºè¯¥è§’è‰²ä¸º å¼±è§’è‰² ã€‚æ›´æ­£å¼åœ°ï¼Œå¦‚æœè®¤ä¸ºè§’è‰² i å¼±äº å­˜åœ¨çš„å¦ä¸€ä¸ªè§’è‰² j ï¼Œé‚£ä¹ˆ attackj &gt; attacki ä¸” defensej &gt; defensei ã€‚</p><p>è¿”å› <strong>å¼±è§’è‰²</strong> çš„æ•°é‡ã€‚</p><p>è¿™é“é¢˜å½“åˆåšçš„æ—¶å€™æƒ³åˆ°äº†ä¸€ä¸ªæ€è·¯ä½†æ˜¯æ²¡æœ‰å»å®ç°ï¼Œè§‰å¾—ä¼šè¶…æ—¶ï¼Œåé¢ç»“æŸæ¯”èµ›åå»è¯•äº†ä¸€ä¸‹è¿˜çœŸå¯ä»¥è¿‡ï¼Œä¸‹é¢å°±æ¥è®°å½•ä¸€ä¸‹</p><h3 id="æˆ‘çš„è§£æ³•"><a href="#æˆ‘çš„è§£æ³•" class="headerlink" title="æˆ‘çš„è§£æ³•"></a>æˆ‘çš„è§£æ³•</h3><p>ç®€å•ç‚¹å°±æ˜¯åœ¨äºŒç»´æ•°ç»„ä¸­å…ˆæŒ‰æ”»å‡»åŠ›<strong>ä»å¤§åˆ°å°</strong>æ’å¥½ï¼Œå¦‚æœä¸¤ä¸ªè§’è‰²çš„æ”»å‡»åŠ›ç›¸åŒçš„è¯å°±æŒ‰é˜²å¾¡åŠ›<strong>ä»å°åˆ°å¤§</strong>æ’åºï¼Œä¾‹å¦‚ä¸‹é¢çš„æ’åºç»“æœ</p><pre class="line-numbers language-none"><code class="language-none">6 36 45 25 53 6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬å†éå†ä¸€éï¼ŒåŒæ—¶è®°å½•é˜²å¾¡åŠ›çš„æœ€å¤§å€¼<code>dmax</code>ï¼Œå¦‚æœå½“å‰éå†åˆ°çš„è§’è‰²é˜²å¾¡åŠ›å°äº<code>dmax</code>åˆ™æ‰¾åˆ°äº†ä¸€ä¸ªå¼±è§’è‰²</p><p>æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒç›¸åŒæ”»å‡»åŠ›çš„æƒ…å†µï¼Œå› ä¸ºç›¸åŒæ”»å‡»åŠ›æ—¶é˜²å¾¡åŠ›æ˜¯å°çš„åœ¨å‰é¢çš„</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">numberOfWeakCharacters</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> properties<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">sort</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>properties<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> a<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">?</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">:</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">></span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> plen<span class="token operator">=</span>properties<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> dmax<span class="token operator">=</span>INT_MIN<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> p<span class="token operator">:</span>properties<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//cout&lt;&lt;p[0]&lt;&lt;" "&lt;&lt;p[1]&lt;&lt;"\n";</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>dmax<span class="token punctuation">)</span>                <span class="token operator">++</span>res<span class="token punctuation">;</span>            dmax<span class="token operator">=</span><span class="token function">max</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dmax<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ï¼šO(NlogN)</p><h3 id="å…¶å®ƒè§£æ³•"><a href="#å…¶å®ƒè§£æ³•" class="headerlink" title="å…¶å®ƒè§£æ³•"></a>å…¶å®ƒè§£æ³•</h3><p>è¿™é‡Œæœ‰ä¸ªå¤§ä½¬ <a href="https://leetcode-cn.com/u/lucifer1004/">å´è‡ªå</a> çš„<a href="https://cp-wiki.vercel.app/tutorial/leetcode/WC257/#problem-b-%E6%B8%B8%E6%88%8F%E4%B8%AD%E5%BC%B1%E8%A7%92%E8%89%B2%E7%9A%84%E6%95%B0%E9%87%8F">è§£æ³•</a></p><img src="https://i.loli.net/2021/09/05/AEUhl721HGLRXeo.png" style="zoom:80%;" /><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">numberOfWeakCharacters</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> properties<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sort</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> properties<span class="token punctuation">.</span><span class="token function">rend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> bhi <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> last <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> a <span class="token operator">=</span> properties<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b <span class="token operator">=</span> properties<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">&lt;</span> properties<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                bhi <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>bhi<span class="token punctuation">,</span> properties<span class="token punctuation">[</span>last<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                last <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>b <span class="token operator">&lt;</span> bhi<span class="token punctuation">)</span>                ans<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ans<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> LeetCodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeå‘¨èµ›254åœº</title>
      <link href="LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B254%E5%9C%BA/"/>
      <url>LeetCode/%E5%91%A8%E8%B5%9B%E7%AC%94%E8%AE%B0/LeetCode%E5%91%A8%E8%B5%9B254%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCodeå‘¨èµ›ç¬¬254åœº"><a href="#LeetCodeå‘¨èµ›ç¬¬254åœº" class="headerlink" title="LeetCodeå‘¨èµ›ç¬¬254åœº"></a>LeetCodeå‘¨èµ›ç¬¬254åœº</h1><p>è¿™åœºå‘¨èµ›å†æ¬¡ç»™è™æƒ¨äº†ï¼Œåšåˆ°ç¬¬äºŒé¢˜å°±å¡ä½äº†æ²¡æœ‰æ€è·¯ï¼Œäº‰å–ä¸‹æ¬¡å‘¨èµ›å¯ä»¥åšåˆ°ç¬¬ä¸‰é¢˜<img src="https://i.loli.net/2021/09/05/85EFy4tfaplSvIi.png"></p><h2 id="5843-ä½œä¸ºå­å­—ç¬¦ä¸²å‡ºç°åœ¨å•è¯ä¸­çš„å­—ç¬¦ä¸²æ•°ç›®-â€”ï¼ˆç®€å•ï¼‰"><a href="#5843-ä½œä¸ºå­å­—ç¬¦ä¸²å‡ºç°åœ¨å•è¯ä¸­çš„å­—ç¬¦ä¸²æ•°ç›®-â€”ï¼ˆç®€å•ï¼‰" class="headerlink" title="5843. ä½œä¸ºå­å­—ç¬¦ä¸²å‡ºç°åœ¨å•è¯ä¸­çš„å­—ç¬¦ä¸²æ•°ç›®  â€”ï¼ˆç®€å•ï¼‰"></a><a href="https://leetcode-cn.com/problems/number-of-strings-that-appear-as-substrings-in-word/">5843. ä½œä¸ºå­å­—ç¬¦ä¸²å‡ºç°åœ¨å•è¯ä¸­çš„å­—ç¬¦ä¸²æ•°ç›®</a>  â€”ï¼ˆç®€å•ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ patterns å’Œä¸€ä¸ªå­—ç¬¦ä¸² word ï¼Œç»Ÿè®¡ patterns ä¸­æœ‰å¤šå°‘ä¸ªå­—ç¬¦ä¸²æ˜¯ word çš„å­å­—ç¬¦ä¸²ã€‚è¿”å›å­—ç¬¦ä¸²æ•°ç›®ã€‚</p><p><strong>å­å­—ç¬¦ä¸²</strong> æ˜¯å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªè¿ç»­å­—ç¬¦åºåˆ—ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼špatterns = [â€œaâ€,â€abcâ€,â€bcâ€,â€dâ€], word = â€œabcâ€<br>è¾“å‡ºï¼š3<br>è§£é‡Šï¼š</p><ul><li>â€œaâ€ æ˜¯ â€œabcâ€ çš„å­å­—ç¬¦ä¸²ã€‚</li><li>â€œabcâ€ æ˜¯ â€œabcâ€ çš„å­å­—ç¬¦ä¸²ã€‚</li><li>â€œbcâ€ æ˜¯ â€œabcâ€ çš„å­å­—ç¬¦ä¸²ã€‚</li><li>â€œdâ€ ä¸æ˜¯ â€œabcâ€ çš„å­å­—ç¬¦ä¸²ã€‚</li></ul><p>patterns ä¸­æœ‰ 3 ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå­å­—ç¬¦ä¸²å‡ºç°åœ¨ word ä¸­ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼špatterns = [â€œaâ€,â€bâ€,â€câ€], word = â€œaaaaabbbbbâ€<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼š</p><ul><li>â€œaâ€ æ˜¯ â€œaaaaabbbbbâ€ çš„å­å­—ç¬¦ä¸²ã€‚</li><li>â€œbâ€ æ˜¯ â€œaaaaabbbbbâ€ çš„å­å­—ç¬¦ä¸²ã€‚</li><li>â€œcâ€ ä¸æ˜¯ â€œaaaaabbbbbâ€ çš„å­—ç¬¦ä¸²ã€‚</li></ul><p>patterns ä¸­æœ‰ 2 ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå­å­—ç¬¦ä¸²å‡ºç°åœ¨ word ä¸­ã€‚</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼špatterns = [â€œaâ€,â€aâ€,â€aâ€], word = â€œabâ€<br>è¾“å‡ºï¼š3<br>è§£é‡Šï¼špatterns ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²éƒ½ä½œä¸ºå­å­—ç¬¦ä¸²å‡ºç°åœ¨ word â€œabâ€ ä¸­ã€‚</p></blockquote><p>æç¤ºï¼š</p><ul><li>1 &lt;= patterns.length &lt;= 100</li><li>1 &lt;= patterns[i].length &lt;= 100</li><li>1 &lt;= word.length &lt;= 100</li><li>patterns[i] å’Œ word ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ</li></ul><p>é¢˜ç›®åˆšå¼€å§‹åšçš„æ—¶å€™è„‘å­æ²¡è½¬è¿‡æ¥ï¼Œå¤©çœŸåœ°æƒ³è‡ªå·±å®ç°å¦‚ä½•æŸ¥æ‰¾å­å­—ç¬¦ä¸²ï¼Œåˆ°åé¢é†’æ‚Ÿæ‰æƒ³èµ·å¯ä»¥ç”¨åº“å‡½æ•°ï¼Œç›´æ¥æäº¤ä¸‹ä¸€é¢˜ï¼ˆæäº¤æ—¶è¿˜é”™äº†ä¸€æ¬¡ï¼Œå“­ï¼‰</p><p>æ³¨æ„è¿™é‡Œ<code>string::find()</code>å¯ä»¥ç”¨æ¥æŸ¥æ‰¾å­å­—ç¬¦ä¸²ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ™ä¼šè¿”å›å­ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä¸‹æ ‡åºå·ï¼Œæ‰¾ä¸åˆ°åˆ™ä¼šè¿”å›<code>string::npos</code>è¯¥å®šå€¼ä¸º<code>string::size_type</code>ç±»å‹ï¼Œå³<code>size_t==usigned int</code></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">numOfStrings</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> patterns<span class="token punctuation">,</span> string word<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> str<span class="token operator">:</span>patterns<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            string<span class="token operator">::</span>size_type pos<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pos<span class="token operator">=</span>word<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>pos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span>string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token operator">++</span>res<span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="5832-æ„é€ å…ƒç´ ä¸ç­‰äºä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼çš„æ•°ç»„-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#5832-æ„é€ å…ƒç´ ä¸ç­‰äºä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼çš„æ•°ç»„-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="5832. æ„é€ å…ƒç´ ä¸ç­‰äºä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼çš„æ•°ç»„  â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/array-with-elements-not-equal-to-average-of-neighbors/">5832. æ„é€ å…ƒç´ ä¸ç­‰äºä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼çš„æ•°ç»„</a>  â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ª ä¸‹æ ‡ä» 0 å¼€å§‹ çš„æ•°ç»„ nums ï¼Œæ•°ç»„ç”±è‹¥å¹² äº’ä¸ç›¸åŒçš„ æ•´æ•°ç»„æˆã€‚ä½ æ‰“ç®—é‡æ–°æ’åˆ—æ•°ç»„ä¸­çš„å…ƒç´ ä»¥æ»¡è¶³ï¼šé‡æ’åï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ ä¸ç­‰äº å…¶ä¸¤ä¾§ç›¸é‚»å…ƒç´ çš„ å¹³å‡å€¼ ã€‚</p><p>æ›´å…¬å¼åŒ–çš„è¯´æ³•æ˜¯ï¼Œé‡æ–°æ’åˆ—çš„æ•°ç»„åº”å½“æ»¡è¶³è¿™ä¸€å±æ€§ï¼šå¯¹äºèŒƒå›´ 1 &lt;= i &lt; nums.length - 1 ä¸­çš„æ¯ä¸ª i ï¼Œ(nums[i-1] + nums[i+1]) / 2 ä¸ç­‰äº nums[i] å‡æˆç«‹ ã€‚</p><p>è¿”å›æ»¡è¶³é¢˜æ„çš„ä»»ä¸€é‡æ’ç»“æœã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [1,2,3,4,5]<br>è¾“å‡ºï¼š[1,2,4,5,3]<br>è§£é‡Šï¼š<br>i=1, nums[i] = 2, ä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼ä¸º (1+4) / 2 = 2.5<br>i=2, nums[i] = 4, ä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼ä¸º (2+5) / 2 = 3.5<br>i=3, nums[i] = 5, ä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼ä¸º (4+3) / 2 = 3.5</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums = [6,2,0,9,7]<br>è¾“å‡ºï¼š[9,7,6,2,0]<br>è§£é‡Šï¼š<br>i=1, nums[i] = 7, ä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼ä¸º (9+6) / 2 = 7.5<br>i=2, nums[i] = 6, ä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼ä¸º (7+2) / 2 = 4.5<br>i=3, nums[i] = 2, ä¸¤ç›¸é‚»å…ƒç´ å¹³å‡å€¼ä¸º (6+0) / 2 = 3</p></blockquote><p>æç¤ºï¼š</p><ul><li>3 &lt;= nums.length &lt;= 105</li><li>0 &lt;= nums[i] &lt;= 105</li></ul><p>è¿™ä¸€é“é¢˜åˆšæ‹¿åˆ°å°±å†™ä¸å‡ºæ¥äº†ï¼Œå®Œå…¨æ²¡æœ‰æ€è·¯ï¼Œæ„Ÿè§‰å’Œå¹³æ—¶åšçš„é¢˜å‹ä¸ä¸€æ ·</p><p>åæ¥çœ‹äº†åˆ«äººçš„ä½œç­”ä¹‹åæ‰å‘ç°æ˜¯æŒºç®€å•çš„ä¸€é“é¢˜ï¼Œä¸»è¦è„‘ç­‹è½¬ä¸è¿‡æ¥</p><p>è¿™é‡Œæ‹¿æ•°ç»„<code>nums=[6,2,0,9,7]</code>æ¥ä¸¾ä¾‹ï¼Œç®€å•çš„æ€è·¯å°±æ˜¯ï¼š</p><ol><li>å…ˆæŠŠæ•°ç»„æ’åºï¼Œä»å°åˆ°å¤§æ’å¥½ï¼Œegï¼š<code>nums=[0,2,6,7,9]</code></li><li>æ–°å»ºä¸€ä¸ªç”¨æ¥è¿”å›çš„ç©ºæ•°ç»„<code>res</code>ï¼Œå¹¶æŒ‰é¡ºåºå°†<code>nums</code>æ•°ç»„çš„æ•°å¡«å……å®Œ<code>res</code>æ•°ç»„çš„å¥‡æ•°ä¸‹æ ‡ä½ï¼ˆè¿™é‡Œå¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆ<code>ans=0</code>æŒ‡å‘numsè¡¨ç¤ºå¡«å……åˆ°å“ªä¸ªæ•°å­—ï¼‰ï¼Œegï¼š<code>res=[0,-1,2,-1,6]</code>å…¶ä¸­<code>-1</code>è¡¨ç¤ºè¿˜æ²¡å¡«å……çš„ä½</li><li>æœ€åå†æŠŠå¶æ•°ä½ä¹Ÿå¡«å……å®Œï¼Œ<code>res=[0,7,2,9,6]</code></li><li>æ­¤æ—¶åœ¨<code>res</code>æ•°ç»„ä¸­ä»»æ„ä¸€ä½æ•°è¦ä¹ˆæ˜¯éƒ½å¤§äºä¸¤è¾¹çš„æ•°ï¼Œè¦ä¹ˆæ˜¯éƒ½å°äºä¸¤è¾¹çš„æ•°ï¼Œå³æ»¡è¶³é¢˜ç›®çš„è¦æ±‚ï¼Œè¯¥æ•°è‚¯å®šä¸ä¼šç­‰äºä¸¤è¾¹æ•°ä¹‹å’Œçš„å¹³å‡æ•°</li></ol><p>çŸ¥é“è¿™ä¸ªæ–¹æ³•ä¹‹åè¿˜æ˜¯è§‰å¾—æŒºç®€å•çš„ï¼Œä¸»è¦å°±æ˜¯æƒ³ä¸åˆ°è¿™ä¸ªæ–¹æ³•</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">rearrangeArray</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> nLen <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> ans <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">res</span><span class="token punctuation">(</span>nLen<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nLen<span class="token punctuation">;</span>i<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">)</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>nums<span class="token punctuation">[</span>ans<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>nLen<span class="token punctuation">;</span>i<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">)</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>nums<span class="token punctuation">[</span>ans<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> LeetCodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°29-åˆ¶ä½œä¸»èœå•ç•Œé¢</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B029-%E5%88%B6%E4%BD%9C%E4%B8%BB%E8%8F%9C%E5%8D%95%E7%95%8C%E9%9D%A2/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B029-%E5%88%B6%E4%BD%9C%E4%B8%BB%E8%8F%9C%E5%8D%95%E7%95%8C%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« æˆ‘ä»¬æ¥ä¸ºæ¸¸æˆåˆ¶ä½œä¸€ä¸ªä¸»èœå•ç•Œé¢</p><h1 id="åœ¨æ–°åœºæ™¯ä¸­ç»˜åˆ¶ç”»å¸ƒ"><a href="#åœ¨æ–°åœºæ™¯ä¸­ç»˜åˆ¶ç”»å¸ƒ" class="headerlink" title="åœ¨æ–°åœºæ™¯ä¸­ç»˜åˆ¶ç”»å¸ƒ"></a>åœ¨æ–°åœºæ™¯ä¸­ç»˜åˆ¶ç”»å¸ƒ</h1><p>æˆ‘ä»¬è¦ä¸“é—¨ä¸ºæˆ‘ä»¬çš„èœå•æ–°å»ºä¸€ä¸ªåœºæ™¯ï¼Œè€Œèœå•åˆ™æ˜¯åœ¨è¿™ä¸ªæ–°åœºæ™¯ä¸­ç»˜åˆ¶çš„</p><p>æˆ‘è¿™é‡Œå…ˆæŠŠåœºæ™¯æ­å»ºå¥½äº†ï¼Œæ³¨æ„æˆ‘ä»¬åœ¨æ‘†æ”¾äººç‰©çš„æ—¶å€™å¯ä»¥ç‚¹å‡»å³é”®èœå•è¿›è¡Œ<code>è„±åŒ…</code>å¤„ç†ï¼Œè¿™æ ·æˆ‘ä»¬ç§»é™¤ç»„ä»¶æ—¶å°±ä¸ä¼šå½±å“åˆ°ç´ æé‡Œé¢çš„æ¨¡æ¿äº†</p><img src="https://i.loli.net/2021/08/05/29wfpAg8ZEyLdDG.png" style="zoom:80%;" /><p>ç„¶åæˆ‘ä»¬ä¹ŸæŠŠUIæ‘†æ”¾å¥½</p><img src="https://i.loli.net/2021/08/05/sHZyaWhDmL6qEvK.png" style="zoom:80%;" /><p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™UIæ·»åŠ ä¸€äº›è§†è§‰æ•ˆæœçš„å¤„ç†</p><h2 id="å°†UIæ·»åŠ ç«‹ä½“æ•ˆæœ"><a href="#å°†UIæ·»åŠ ç«‹ä½“æ•ˆæœ" class="headerlink" title="å°†UIæ·»åŠ ç«‹ä½“æ•ˆæœ"></a>å°†UIæ·»åŠ ç«‹ä½“æ•ˆæœ</h2><p>è¿™é‡Œå¯ä»¥æ·»åŠ ä¸€ç§æ•ˆæœï¼Œæˆ‘æƒ³ç‚¹å‡»new game æ—¶å€™ç›¸æœºä¼šç©¿è¿‡æ ‡é¢˜UIç„¶åé è¿‘ä¼ é€é—¨çš„æ ·å¼ï¼Œä¸‹é¢å°±æ¥å®ç°ä¸€ä¸‹</p><p>æˆ‘ä»¬é€‰ä¸­ç”»å¸ƒï¼Œç„¶åå¦‚ä¸‹å›¾è®¾ç½®ï¼Œå°†<code>Render Mode</code>é€‰æ‹©ä¸º<code>Camera</code>ï¼Œå†æŠŠæ‘„åƒæœºæ‹–åˆ°ä¸‹é¢çš„æ¡†æ¡†é‡Œ</p><img src="https://i.loli.net/2021/08/05/VQnMjOfywAeiNTh.png" style="zoom:80%;" /><p>è¿™æ—¶å€™ç‚¹å‡»è¿è¡Œä¼šå‘ç°æŒ‰é’®ç»™åœºæ™¯é®æŒ¡ä½äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è°ƒä¸€ä¸‹<code>Plane Distance</code>ï¼Œæ¯”å¦‚æ”¹æˆ1ï¼ŒæŒ‰é’®å°±åˆå¯ä»¥çœ‹åˆ°äº†</p><p>æœ€åæˆ‘ä»¬å†æŠŠ<code>Render Mode</code>æ”¹ä¸º<code>World Space</code>ï¼Œç„¶åå°è¯•å‘å‰ç§»åŠ¨ç›¸æœºï¼Œå°±å¯ä»¥å‘ç°è¾¾æˆäº†ç›¸æœºç©¿è¶Šæ ‡é¢˜çš„æ•ˆæœäº†ï¼Œä¹‹æ‰€ä»¥è¦ç»è¿‡ä¸Šé¢çš„æ­¥éª¤æ˜¯å› ä¸ºå¯ä»¥è®©Unityè‡ªåŠ¨è°ƒèŠ‚UIçš„åˆé€‚ä½ç½®</p><h1 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h1><p>UIå»ºç«‹å¥½ä¹‹åæˆ‘ä»¬å°±è¦æ¥å®ç°æŒ‰é’®çš„åŠŸèƒ½äº†</p><img src="https://i.loli.net/2021/08/05/uZCjd6oGp7DJqe3.png" style="zoom:80%;" /><p>æŒ‰é’®æœ€ä¸»è¦å°±æ˜¯ç›‘å¬äº‹ä»¶ï¼Œä¸‹é¢å…ˆå•ç‹¬æ¥å†™å„ç§åŠŸèƒ½çš„æ–¹æ³•ï¼Œæœ€åå†é…ä¸Šæ•´ä¸ªä»£ç æ–‡ä»¶</p><h2 id="Exit"><a href="#Exit" class="headerlink" title="Exit"></a>Exit</h2><p>å…¶ä¸­æœ€ç®€å•çš„å°±æ˜¯é€€å‡ºæ¸¸æˆï¼Œä¸€è¡Œæå®š</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">QuitGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//é€€å‡ºæ¸¸æˆåŠŸèƒ½</span>        Application<span class="token punctuation">.</span><span class="token function">Quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="NewGame"><a href="#NewGame" class="headerlink" title="NewGame"></a>NewGame</h2><p>ç„¶åæ˜¯åˆ›å»ºæ–°æ¸¸æˆï¼Œè¿™é‡Œå°±è¦æ¶‰åŠå¤šä¸ªä»£ç æ–‡ä»¶</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//MainMenu.cs</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">NewGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ¸…æ¥šæ‰€æœ‰å­˜æ¡£</span>        PlayerPrefs<span class="token punctuation">.</span><span class="token function">DeleteAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è½¬æ¢åœºæ™¯</span>        <span class="token comment">//ä¼šåœ¨SceneControlleré‡Œé¢å®Œæˆ</span>        SceneController<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">TransitionToFirstLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŠ è½½ç¬¬ä¸€ä¸ªåœºæ™¯</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//SceneController.cs</span><span class="token comment">//è½¬æ¢åœºæ™¯ï¼Œå¯ç”¨äºåœ¨æ ‡é¢˜ç•Œé¢è¿‡æ¸¡åˆ°ç¬¬ä¸€ä¸ªç•Œé¢ä¸­</span>    <span class="token return-type class-name">IEnumerator</span> <span class="token function">LoadLevel</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> scene<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>scene<span class="token operator">!=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ä¼ å…¥å‚æ•°ä¸ä¸ºç©º</span>            <span class="token comment">//åŠ è½½åœºæ™¯</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> SceneManager<span class="token punctuation">.</span><span class="token function">LoadSceneAsync</span><span class="token punctuation">(</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//åŠ è½½äººç‰©ï¼Œåœ¨GMaeManagerä¸­åˆ›å»ºäº†ä¸€ä¸ªç”¨äºè·å¾—åˆå§‹ä½ç½®çš„æ–¹æ³•</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> player <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>playerPrefab<span class="token punctuation">,</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">GetEntrance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>position<span class="token punctuation">,</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">GetEntrance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//ä¿å­˜æ•°æ®</span>            SaveManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">SavePlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">yield</span> <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//ç»“æŸåç¨‹</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//åŠ è½½ç¬¬ä¸€ä¸ªåœºæ™¯ï¼Œå¯ä»¥å°†è¿™ä¸ªç›´æ¥æ”¾åœ¨æ ‡é¢˜ç•Œé¢çš„åŠŸèƒ½é‡Œ</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TransitionToFirstLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">LoadLevel</span><span class="token punctuation">(</span><span class="token string">"3D RPG"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//GmaeManager.cs</span><span class="token comment">//è·å¾—åœºæ™¯åŠ è½½å…¥å£ï¼Œè¿™é‡Œæ˜¯æ ‡é¢˜ç•Œé¢è¿›å…¥ä¸»åœºæ™¯æ—¶ç”¨äºè·å¾—è½åœ°ç‚¹</span>    <span class="token keyword">public</span> <span class="token return-type class-name">Transform</span> <span class="token function">GetEntrance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> item <span class="token keyword">in</span> <span class="token generic-method"><span class="token function">FindObjectsOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TransitionDestination<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>destinationTag<span class="token operator">==</span>TransitionDestination<span class="token punctuation">.</span>DestinationTag<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span>                <span class="token keyword">return</span> item<span class="token punctuation">.</span>transform<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„è¦æŠŠå‡ ä¸ªManagerå¯¹è±¡å¤åˆ¶åˆ°æ ‡é¢˜åœºæ™¯ä¸­</p><h2 id="Continue"><a href="#Continue" class="headerlink" title="Continue"></a>Continue</h2><p>ç”±äºæˆ‘ä»¬æ¸¸æˆæœ‰å¤šä¸ªåœºæ™¯ï¼Œå› æ­¤åœ¨åŠ è½½åŠŸèƒ½ä¸­æˆ‘ä»¬è¿˜è¦è®°ä½ä¸Šæ¬¡ä¿å­˜ç©å®¶æ˜¯åœç•™åœ¨å“ªä¸€ä¸ªåœºæ™¯ï¼Œä»è€Œåœ¨åŠ è½½å­˜æ¡£æ—¶åˆ¤æ–­è¦åŠ è½½å“ªä¸€ä¸ªåœºæ™¯çš„ç”»é¢</p><p>ä¹Ÿæ˜¯æœ‰å¤šä¸ªä»£ç æ–‡ä»¶éœ€è¦ä¿®æ”¹ï¼Œéœ€è¦æ³¨æ„åŒºåˆ†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//SaveManager.cs</span><span class="token class-name"><span class="token keyword">string</span></span> sceneName<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•ä¿å­˜åœºæ™¯çš„åå­—</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> SceneName<span class="token punctuation">&#123;</span><span class="token keyword">get</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> PlayerPrefs<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span>sceneName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Save</span><span class="token punctuation">(</span><span class="token class-name">UnityEngine<span class="token punctuation">.</span>Object</span> data<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> jsonData <span class="token operator">=</span> JsonUtility<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è½¬æ¢ä¸ºjson</span>        PlayerPrefs<span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å†å»ºç«‹é”®å€¼ä¿å­˜</span>        <span class="token comment">//åœ¨ä¿å­˜æ•°æ®åŒæ—¶ä¿å­˜ç©å®¶åœç•™åœ¨å“ªä¸ªåœºæ™¯</span>        PlayerPrefs<span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span>sceneName<span class="token punctuation">,</span>SceneManager<span class="token punctuation">.</span><span class="token function">GetActiveScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        PlayerPrefs<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//SceneController.cs</span><span class="token comment">//Continue</span>    <span class="token comment">//ç”¨äºåŠ è½½æ¸¸æˆçš„åŠ è½½æ–¹æ³•</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TransitionToLoadGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">string</span></span> sceneName <span class="token operator">=</span> SaveManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>SceneName<span class="token punctuation">;</span><span class="token comment">//è·å¾—ä¸Šæ¬¡ä¿å­˜åœºæ™¯åç§°ï¼Œå¯èƒ½ä¸ºç©º</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>sceneName<span class="token operator">!=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ä¸ä¸ºç©ºçš„è¯å°±åŠ è½½åœºæ™¯</span>            <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">LoadLevel</span><span class="token punctuation">(</span>sceneName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//PlayerController.cs</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ç´ æå¯ç”¨æ—¶æ³¨å†Œäº‹ä»¶</span>MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnMouseClicked<span class="token operator">+=</span>MoveToTarget<span class="token punctuation">;</span>MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnEnemyClicked<span class="token operator">+=</span>EventAttact<span class="token punctuation">;</span>GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">RigisterPlayer</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ³¨å†ŒGmaeManager</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//åŠ è½½äººç‰©æ•°æ®</span>SaveManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">LoadPlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//MainMenu.cs</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ContinueGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è½¬æ¢åœºæ™¯ï¼Œè¯»å–è¿›åº¦</span>        SceneController<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">TransitionToLoadGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ¸¸æˆä¸­Escè¿”å›ä¸»èœå•"><a href="#æ¸¸æˆä¸­Escè¿”å›ä¸»èœå•" class="headerlink" title="æ¸¸æˆä¸­Escè¿”å›ä¸»èœå•"></a>æ¸¸æˆä¸­Escè¿”å›ä¸»èœå•</h2><p>æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯åœ¨æ¸¸æˆå†…å¿…è¦çš„ï¼Œå°±æ˜¯è¿”å›ä¸»èœå•åŠŸèƒ½ï¼Œè¿™é‡Œä¹Ÿæ¥å®ç°ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//SaveManager.cs</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>Escape<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token comment">//æ¸¸æˆä¸­Escå›åˆ°ä¸»èœå•</span>           SceneController<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">TransitionToMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKey</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//ä¿å­˜</span>           <span class="token function">SavePlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKey</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//è¯»å–</span>           <span class="token function">LoadPlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//SceneController.cs</span><span class="token comment">//åŠ è½½æ ‡é¢˜åœºæ™¯åç¨‹</span>    <span class="token return-type class-name">IEnumerator</span> <span class="token function">LoadMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> SceneManager<span class="token punctuation">.</span><span class="token function">LoadSceneAsync</span><span class="token punctuation">(</span><span class="token string">"Main"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//åŠ è½½æ ‡é¢˜æ–¹æ³•</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TransitionToMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">LoadMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ°è¿™æˆ‘ä»¬å°±æˆåŠŸå®ç°äº†ä¸»èœå•åˆ°æ¸¸æˆå†åˆ°ä¸»èœå•çš„è¿‡æ¸¡æ•ˆæœ</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°28-ä¿å­˜æ•°æ®</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B028-%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B028-%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç« æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä½•ä¿å­˜æ•°æ®ï¼Œç”¨åˆ°çš„æœ‰ä¸¤ä¸ªé‡è¦çš„APIï¼Œæ–‡ç« ä¸­ä¼šæœ‰ä»‹ç»åˆ°</p><h1 id="è®¤è¯†API"><a href="#è®¤è¯†API" class="headerlink" title="è®¤è¯†API"></a>è®¤è¯†API</h1><p>è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°ä¸¤ä¸ªAPIï¼Œä¸€ä¸ªæ˜¯**<a href="https://docs.unity.cn/cn/2020.3/ScriptReference/EditorPrefs.html">PlayerPrefs</a><strong>ç±»ï¼Œè™½ç„¶å®˜æ–¹æ–‡æ¡£å†™çš„æ˜¯EditorPrefsï¼Œä½†æ˜¯ä»–ä»¬çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œå¦å¤–ä¸€ä¸ªè¦ç”¨åˆ°çš„APIæ˜¯</strong><a href="https://docs.unity.cn/cn/2020.3/ScriptReference/JsonUtility.ToJson.html">JsonUtility.ToJson</a>**æ–¹æ³•</p><p>PlayerPrefsï¼šç”¨äºæœ¬åœ°æŒä¹…åŒ–ä¿å­˜ä¸è¯»å–çš„ç±»ï¼ŒPlayerPrefsç±»å·¥ä½œåŸç†éå¸¸ç®€å•ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼å°†æ•°æ®ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œç„¶åç¨‹åºå¯ä»¥æ ¹æ®è¿™ä¸ªåç§°å–å‡ºä¸Šæ¬¡ä¿å­˜çš„æ•°å€¼</p><p>JsonUtility.ToJsonï¼šç”Ÿæˆå¯¹è±¡çš„å…¬å…±å­—æ®µçš„ JSON è¡¨ç¤ºå½¢å¼ã€‚</p><h1 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h1><p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ª<code>SaveManager.cs</code>ç„¶åæ¥ç¼–å†™ä¸“é—¨ç®¡ç†ä¿å­˜è¯»å–çš„ç±»</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SaveManager</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Singleton<span class="token punctuation">&lt;</span>SaveManager<span class="token punctuation">></span></span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">DontDestroyOnLoad</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ‡æ¢åœºæ™¯ä¸é”€æ¯</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKey</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//ä¿å­˜</span>            <span class="token function">SavePlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKey</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//è¯»å–</span>            <span class="token function">LoadPlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SavePlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> PlayerData <span class="token operator">=</span> GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">;</span>        <span class="token function">Save</span><span class="token punctuation">(</span>PlayerData<span class="token punctuation">,</span>GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LoadPlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> PlayerData <span class="token operator">=</span> GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">;</span>        <span class="token function">Load</span><span class="token punctuation">(</span>PlayerData<span class="token punctuation">,</span>GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Save</span><span class="token punctuation">(</span><span class="token class-name">UnityEngine<span class="token punctuation">.</span>Object</span> data<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> jsonData <span class="token operator">=</span> JsonUtility<span class="token punctuation">.</span><span class="token function">ToJson</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è½¬æ¢ä¸ºjson</span>        PlayerPrefs<span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å†å»ºç«‹é”®å€¼ä¿å­˜</span>        PlayerPrefs<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Load</span><span class="token punctuation">(</span><span class="token class-name">UnityEngine<span class="token punctuation">.</span>Object</span> data<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>PlayerPrefs<span class="token punctuation">.</span><span class="token function">HasKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœé”®å€¼å­˜åœ¨çš„è¯å°±è¯»å–</span>            JsonUtility<span class="token punctuation">.</span><span class="token function">FromJsonOverwrite</span><span class="token punctuation">(</span>PlayerPrefs<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥è¿›æ¸¸æˆä½“éªŒä¸€ä¸‹äº†ï¼ŒæŒ‰<code>S</code>é”®æ˜¯ä¿å­˜ç©å®¶å½“å‰æ•°æ®ï¼ŒæŒ‰<code>L</code>é”®æ˜¯è¯»å–ï¼Œå¹¶ä¸”ä¿å­˜ååœ¨ä¸‹ä¸€æ¬¡æ¸¸æˆå¯åŠ¨æ—¶ä»ç„¶å¯ä»¥è¯»å–æ•°æ®</p><p>Windowsç³»ç»Ÿå¯ä»¥åœ¨æ³¨å†Œè¡¨ä¸Šçœ‹åˆ°ä¿å­˜çš„æ•°æ®</p><img src="https://i.loli.net/2021/08/04/jTPgFrdWL1wH96N.png" style="zoom:80%;" /><h1 id="è·¨åœºæ™¯ä¿å­˜è¯»å–"><a href="#è·¨åœºæ™¯ä¿å­˜è¯»å–" class="headerlink" title="è·¨åœºæ™¯ä¿å­˜è¯»å–"></a>è·¨åœºæ™¯ä¿å­˜è¯»å–</h1><p>æ—¢ç„¶æˆ‘ä»¬åœ¨ä¸‹ä¸€æ¬¡å¼€å¯æ¸¸æˆä¹Ÿå¯ä»¥è¯»å–ç©å®¶æ•°æ®ï¼Œé‚£ä¹ˆè·¨åœºæ™¯ä¹Ÿä¸åœ¨è¯ä¸‹</p><p>å»åˆ°<code>SceneController.cs</code>ä¿®æ”¹ä¸€ä¸‹ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name">IEnumerator</span> <span class="token function">Transition</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sceneName<span class="token punctuation">,</span><span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ä¿å­˜æ•°æ®</span>        SaveManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">SavePlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>SceneManager<span class="token punctuation">.</span><span class="token function">GetActiveScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token operator">!=</span>sceneName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ä¸åŒåœºæ™¯çš„è¯</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> SceneManager<span class="token punctuation">.</span><span class="token function">LoadSceneAsync</span><span class="token punctuation">(</span>sceneName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åç¨‹åŠ è½½åœºæ™¯</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>playerPrefab<span class="token punctuation">,</span>                <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>                <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŠ è½½ç©å®¶ç´ æå¯¹è±¡</span>                        <span class="token comment">//è¯»å–ç©å®¶æ•°æ®</span>            SaveManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">LoadPlayerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">yield</span> <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//åŠ è½½å¥½åè·³å‡ºåç¨‹</span>                    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ç›¸åŒåœºæ™¯</span>            <span class="token comment">//å…ˆè·å¾—ç©å®¶çš„å¯¹è±¡</span>            player <span class="token operator">=</span> GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>            <span class="token comment">//è·å¾—ç›®çš„åœ°ä¼ é€é—¨å¯¹è±¡</span>            <span class="token class-name"><span class="token keyword">var</span></span> td <span class="token operator">=</span> <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//å…³é—­å¯¼èˆªç§»åŠ¨</span>            player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token comment">//è®¾ç½®å¯¹è±¡çš„åæ ‡å’Œæ—‹è½¬è§’åº¦</span>            player<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">SetPositionAndRotation</span><span class="token punctuation">(</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//æ¢å¤å¯¼èˆªç§»åŠ¨</span>            player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬åœ¨åŠ è½½å¦å¤–ä¸€ä¸ªåœºæ™¯å‰ä¼šå…ˆä¿å­˜æ•°æ®ï¼Œåœ¨åŠ è½½åœºæ™¯å®Œåæˆ‘ä»¬å…ˆè¯»å–æ•°æ®å†é€€å‡ºåç¨‹</p><p>è¿™æ ·å°±å®ç°äº†äººç‰©æ•°æ®çš„ä¿å­˜äº†ï¼Œå½“ç„¶è¿™åªæ˜¯ä¿å­˜è¯»å–äº†äººç‰©çš„ç”Ÿå‘½å€¼ã€ç»éªŒå€¼ç­‰æ•°æ®ï¼Œå…¶å®ƒæ•°æ®ä¹Ÿå¯ä»¥è‡ªç”±å‘æŒ¥</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°27-ä¸åŒåœºæ™¯çš„ä¼ é€</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B027-%E4%B8%8D%E5%90%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E4%BC%A0%E9%80%81/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B027-%E4%B8%8D%E5%90%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E4%BC%A0%E9%80%81/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬æ¥å®ç°ä¸åŒåœºæ™¯çš„ä¼ é€</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æŠŠå¦å¤–ä¸€ä¸ªåœºæ™¯æ­å»ºå¥½å…ˆï¼Œéšåæ‰å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„å·¥ä½œï¼Œè¿™é‡Œå°±è‡ªå·±å‘æŒ¥å§</p><p>æ­å»ºå¥½åœºæ™¯åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼å¼€å§‹æ¥å®ç°å¦‚ä½•è·¨åœºæ™¯ä¼ é€äº†</p><h1 id="è®¾ç½®å¥½ä¼ é€é—¨å±æ€§"><a href="#è®¾ç½®å¥½ä¼ é€é—¨å±æ€§" class="headerlink" title="è®¾ç½®å¥½ä¼ é€é—¨å±æ€§"></a>è®¾ç½®å¥½ä¼ é€é—¨å±æ€§</h1><p>é¦–å…ˆå°±æ˜¯è¦æŠŠä¸¤ä¸ªä¸åŒåœºæ™¯çš„ä¼ é€é—¨å±æ€§è®¾ç½®å¥½ï¼Œæ³¨æ„è¦é€‰æ‹©ä¸åŒåœºæ™¯ä¼ é€å¹¶æŠŠåå­—å¡«ä¸Š</p><p>ä¸‹é¢æ˜¯ä¸»ä¸–ç•Œçš„ä¼ é€é—¨å±æ€§</p><img src="https://i.loli.net/2021/08/03/qSY69TCAibHz8wP.png" style="zoom:80%;" /><p>ä»¥åŠå¦å¤–ä¸€ä¸ªä¸–ç•Œä¼ é€é—¨çš„å±æ€§</p><img src="https://i.loli.net/2021/08/03/O4ymdIfH3CVZA2L.png" style="zoom:80%;" /><h1 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h1><p>ä¸‹é¢çš„ä»£ç å¯èƒ½æœ‰ç‚¹åˆ†æ•£ï¼Œéœ€è¦ä¿®æ”¹çš„æ–‡ä»¶æ¯”è¾ƒå¤šï¼Œä¼šæœ‰æ³¨é‡Šå†™å‡ºæ¥åœ¨å“ªä¸ªæ–‡ä»¶</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//SceneController.csï¼Œæ·»åŠ äº†ä¸åŒåœºæ™¯åŠ è½½æ—¶çš„ä»£ç </span><span class="token keyword">public</span> <span class="token class-name">GameObject</span> playerPrefab<span class="token punctuation">;</span><span class="token comment">//ç©å®¶ç´ æå¯¹è±¡ï¼Œç”¨æ¥ä¸åŒåœºæ™¯æ—¶è¿›è¡ŒåŠ è½½</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TransitiToDestination</span><span class="token punctuation">(</span><span class="token class-name">TransitionPoint</span> transitionPoint<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è€ƒè™‘æ˜¯åŒåœºæ™¯è¿˜æ˜¯ä¸åŒåœºæ™¯çš„ä¼ é€</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>transitionPoint<span class="token punctuation">.</span>transitionType<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> TransitionPoint<span class="token punctuation">.</span>TransitionType<span class="token punctuation">.</span>SameScene<span class="token punctuation">:</span>                <span class="token comment">//åŒåœºæ™¯å¯ä»¥ä¸ç”¨å¼‚æ­¥ï¼Œç›´æ¥ä¼ é€</span>                <span class="token comment">//è¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·å¾—å½“å‰æ´»åŠ¨çª—å£çš„åå­—</span>                <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">Transition</span><span class="token punctuation">(</span>SceneManager<span class="token punctuation">.</span><span class="token function">GetActiveScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>transitionPoint<span class="token punctuation">.</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> TransitionPoint<span class="token punctuation">.</span>TransitionType<span class="token punctuation">.</span>DifferentScene<span class="token punctuation">:</span>                <span class="token comment">//ä¸åŒåœºæ™¯ï¼Œç”¨å¼‚æ­¥åŠ è½½çš„æ–¹å¼</span>                <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">Transition</span><span class="token punctuation">(</span>transitionPoint<span class="token punctuation">.</span>sceneName<span class="token punctuation">,</span>transitionPoint<span class="token punctuation">.</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token return-type class-name">IEnumerator</span> <span class="token function">Transition</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sceneName<span class="token punctuation">,</span><span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//TODO:ä¿å­˜æ•°æ®</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>SceneManager<span class="token punctuation">.</span><span class="token function">GetActiveScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token operator">!=</span>sceneName<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ä¸åŒåœºæ™¯çš„è¯</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> SceneManager<span class="token punctuation">.</span><span class="token function">LoadSceneAsync</span><span class="token punctuation">(</span>sceneName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åç¨‹åŠ è½½åœºæ™¯</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>playerPrefab<span class="token punctuation">,</span>                <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>                <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŠ è½½ç©å®¶ç´ æå¯¹è±¡</span>            <span class="token keyword">yield</span> <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//åŠ è½½å¥½åè·³å‡ºåç¨‹</span>                    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ç›¸åŒåœºæ™¯</span>            <span class="token comment">//å…ˆè·å¾—ç©å®¶çš„å¯¹è±¡</span>            player <span class="token operator">=</span> GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>            <span class="token comment">//è·å¾—ç›®çš„åœ°ä¼ é€é—¨å¯¹è±¡</span>            <span class="token class-name"><span class="token keyword">var</span></span> td <span class="token operator">=</span> <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//å…³é—­å¯¼èˆªç§»åŠ¨</span>            player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token comment">//è®¾ç½®å¯¹è±¡çš„åæ ‡å’Œæ—‹è½¬è§’åº¦</span>            player<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">SetPositionAndRotation</span><span class="token punctuation">(</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//æ¢å¤å¯¼èˆªç§»åŠ¨</span>            player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„è¿™é‡Œæˆ‘ä»¬è¦å¤–ç•ŒæŠŠäººç‰©çš„ç´ ææ‹–è¿›å»ä»£ç ä¸­ï¼Œä»¥ä¿è¯ä¼ é€åˆ°å¦å¤–ä¸€ä¸ªåœºæ™¯æ—¶å¯ä»¥åŠ è½½äººç‰©å‡ºæ¥</p><img src="https://i.loli.net/2021/08/03/xDbVRIcpGHqTy4h.png" style="zoom:80%;" /><h1 id="ä¿®å¤é—®é¢˜"><a href="#ä¿®å¤é—®é¢˜" class="headerlink" title="ä¿®å¤é—®é¢˜"></a>ä¿®å¤é—®é¢˜</h1><h2 id="ä¼ é€æŠ¥é”™"><a href="#ä¼ é€æŠ¥é”™" class="headerlink" title="ä¼ é€æŠ¥é”™"></a>ä¼ é€æŠ¥é”™</h2><p>æ­¤æ—¶æˆ‘ä»¬ä¼ é€æ—¶ä¼šæŠ¥é”™ï¼Œæœ‰å¥½å‡ ä¸ªé—®é¢˜æˆ‘ä»¬æ…¢æ…¢æ¥çœ‹</p><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯è¦æŠŠåœºæ™¯æ”¾åœ¨<code>Scene in Build</code>çš„è®¾ç½®å½“ä¸­</p><img src="https://i.loli.net/2021/08/03/dpRCZcfYrDAUx1V.png" style="zoom:80%;" /><p>ç¬¬äºŒä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬ä¼ é€åˆ°æ–°åœºæ™¯åï¼Œé‚£äº›Manageræ–‡ä»¶éƒ½ä¼šä¸å­˜åœ¨ï¼Œå› æ­¤æˆ‘ä»¬è¦æŠŠå®ƒä»¬åŠ å…¥<code>DontDestory</code>çš„æ¸…å•é‡Œ</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//åœ¨GameManager.cs  SceneController.cs  MouseManager.csåŠ ä¸Šè¿™è¡Œä»£ç </span><span class="token keyword">protected</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">DontDestroyOnLoad</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢æ­¤Manageræ–‡ä»¶åœ¨åˆ‡æ¢åœºæ™¯æ—¶ç»™é”€æ¯</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¦åœ¨<code>GameManager.cs</code>  <code>SceneController.cs</code>  <code>MouseManager.cs</code>åŠ ä¸Šä¸Šé¢ä»£ç ï¼Œå¹¶ä¸”æ˜¯è¦<strong>ç»§æ‰¿å•ä¾‹æ¨¡å¼çš„ä»£ç æ–‡ä»¶</strong></p><h2 id="äººç‰©ä¼ é€åæ— æ³•ç§»åŠ¨"><a href="#äººç‰©ä¼ é€åæ— æ³•ç§»åŠ¨" class="headerlink" title="äººç‰©ä¼ é€åæ— æ³•ç§»åŠ¨"></a>äººç‰©ä¼ é€åæ— æ³•ç§»åŠ¨</h2><p>è¿™æ—¶å€™äººç‰©å¯ä»¥ä¼ é€åˆ°å¦å¤–ä¸€ä¸ªåœºæ™¯äº†ï¼Œä½†æ˜¯ä¸èƒ½ç§»åŠ¨ï¼Œå¯èƒ½æœ‰ä¸‹é¢é—®é¢˜</p><p>ç¬¬ä¸€ä¸ªå¯èƒ½å­˜åœ¨çš„é—®é¢˜å°±æ˜¯æˆ‘ä»¬ç¬¬äºŒä¸ªåœºæ™¯çš„åœ°æ¿æ²¡æœ‰è®¾ç½®æˆ<code>Ground</code>æ ‡ç­¾ï¼Œæˆ‘ä»¬è¦è®¾ç½®ä¸€ä¸‹</p><p>ç¬¬äºŒä¸ªé—®é¢˜æ˜¯æˆ‘ä»¬åœ¨<code>PlayerController.cs</code>ä¸­çš„<code>OnMouseClicked</code>äº‹ä»¶æ²¡æœ‰åŠ è½½å‡ºæ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ç´ æå¯ç”¨æ—¶æ³¨å†Œäº‹ä»¶</span>MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnMouseClicked<span class="token operator">+=</span>MoveToTarget<span class="token punctuation">;</span>MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnEnemyClicked<span class="token operator">+=</span>EventAttact<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//KeyManager.Instance.OnKeyInputMove+=MoveToTarget;</span>GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">RigisterPlayer</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDisable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ç´ æç¦ç”¨æ—¶æ³¨é”€äº‹ä»¶</span>MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnMouseClicked<span class="token operator">-=</span>MoveToTarget<span class="token punctuation">;</span>MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnEnemyClicked<span class="token operator">-=</span>EventAttact<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="äººç‰©ä¼ é€å›æ¥ç›¸æœºæ²¡æœ‰è·Ÿéš"><a href="#äººç‰©ä¼ é€å›æ¥ç›¸æœºæ²¡æœ‰è·Ÿéš" class="headerlink" title="äººç‰©ä¼ é€å›æ¥ç›¸æœºæ²¡æœ‰è·Ÿéš"></a>äººç‰©ä¼ é€å›æ¥ç›¸æœºæ²¡æœ‰è·Ÿéš</h2><p>æ¥ç€è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯å½“æˆ‘ä»¬ä»å¦å¤–ä¸€ä¸ªåœºæ™¯ä¼ é€å›æ¥æ—¶ï¼Œç›¸æœºçš„è·Ÿéšå°±ä¼šå¤±æ•ˆï¼Œè¿™é‡Œæ¥ä¿®å¤è¿™ä¸ªé—®é¢˜</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//GameManager.cs</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RigisterPlayer</span><span class="token punctuation">(</span><span class="token class-name">CharacterStates</span> player<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//é€šè¿‡å¤–ç•Œæ³¨å†Œçš„æ–¹å¼æ¥è·å¾—å¯¹è±¡çš„playerStates</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>playerStates <span class="token operator">=</span> player<span class="token punctuation">;</span>        <span class="token comment">//å¤–ç•Œäººç‰©å¯¹è±¡æ³¨å†ŒåŒæ—¶è®©ç›¸æœºè¿›è¡Œè·Ÿéš</span>        followCamera <span class="token operator">=</span> <span class="token generic-method"><span class="token function">FindObjectOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CinemachineFreeLook<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨åœ°å›¾ä¸­æŸ¥æ‰¾ç›¸æœº</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>followCamera<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœæ‰¾åˆ°ç›¸æœºå°±è®©å®ƒè·Ÿéš</span>            followCamera<span class="token punctuation">.</span>Follow <span class="token operator">=</span> playerStates<span class="token punctuation">.</span>transform<span class="token punctuation">;</span>            followCamera<span class="token punctuation">.</span>LookAt <span class="token operator">=</span> playerStates<span class="token punctuation">.</span>transform<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°26-å®ç°åŒåœºæ™¯çš„ä¼ é€</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B026-%E5%AE%9E%E7%8E%B0%E5%90%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E4%BC%A0%E9%80%81/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B026-%E5%AE%9E%E7%8E%B0%E5%90%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E4%BC%A0%E9%80%81/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œæˆ‘ä»¬å®ç°åŒåœºæ™¯çš„ä¼ é€æ•ˆæœ</p><h1 id="è°ƒæ•´ä¼ é€é—¨"><a href="#è°ƒæ•´ä¼ é€é—¨" class="headerlink" title="è°ƒæ•´ä¼ é€é—¨"></a>è°ƒæ•´ä¼ é€é—¨</h1><p>åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¦æŠŠä¸åŒçš„ä¼ é€é—¨æ‘†æ”¾å¥½å…ˆ</p><p>å¦å¤–æˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ç‚¹å‡»ä¸äº†ä¼ é€é—¨ï¼Œè¿™æ˜¯å› ä¸ºä¼ é€é—¨çš„box collideræŒ¡ä½äº†æˆ‘ä»¬é¼ æ ‡çš„å°„çº¿ï¼Œè¿™é‡ŒæŠŠå®ƒçš„å¤§å°æ”¹ä¸€ä¸‹å°±è¡Œäº†</p><img src="https://i.loli.net/2021/08/02/LHvS6JN4idPbQOA.png" style="zoom:80%;" /><p>ç»™ä¼ é€é—¨åŠ ä¸Š<code>Portal</code>çš„æ ‡ç­¾ï¼Œç„¶åå†å»<code>MouseManager.cs</code>ä¿®æ”¹ä¸€ä¸‹é¼ æ ‡çš„å›¾æ ·</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetCursorTexture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">Ray</span> ray <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">ScreenPointToRay</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span>mousePosition<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>Physics<span class="token punctuation">.</span><span class="token function">Raycast</span><span class="token punctuation">(</span>ray<span class="token punctuation">,</span><span class="token keyword">out</span> hitInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//TODO:åˆ‡æ¢é¼ æ ‡è´´å›¾</span><span class="token keyword">switch</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token string">"Ground"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>åœ°é¢è¡Œèµ°çš„å›¾æ ‡Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>arrow<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">"Enemy"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>ç‚¹å‡»æ•Œäººçš„å›¾æ ‡Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>attack<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">"Portal"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>ç‚¹å‡»ä¼ é€é—¨å›¾æ ‡Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>doorway<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">default</span><span class="token punctuation">:</span>Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//if</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> hitInfo<span class="token punctuation">.</span>collider <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Ground"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Portal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ç‚¹å‡»ä¼ é€é—¨</span>OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç‚¹å‡»æ•Œäººä¼ é€’æ•Œäººçš„gameObject</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Attackable"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç¼–å†™ä¼ é€ç®¡ç†ä»£ç "><a href="#ç¼–å†™ä¼ é€ç®¡ç†ä»£ç " class="headerlink" title="ç¼–å†™ä¼ é€ç®¡ç†ä»£ç "></a>ç¼–å†™ä¼ é€ç®¡ç†ä»£ç </h1><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>SceneController.cs</code>ï¼Œä¹‹æ‰€ä»¥ä¸æ˜¯ç”¨Manageræ˜¯å› ä¸ºåœ¨Unityæœ‰ä¸ª<code>SceneManager</code>åŒåçš„æ–‡ä»¶å­˜åœ¨</p><img src="https://i.loli.net/2021/08/02/FLvOK3csbIP45Xz.png" style="zoom:80%;" /><p>æ³¨æ„æ­¤æ–‡ä»¶ç»§æ‰¿çš„æ˜¯<strong>å•ä¾‹æ¨¡å¼</strong>ç±»</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>SceneManagement</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>AI</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SceneController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Singleton<span class="token punctuation">&lt;</span>SceneController<span class="token punctuation">></span></span></span><span class="token punctuation">&#123;</span>    <span class="token class-name">GameObject</span> player<span class="token punctuation">;</span><span class="token comment">//ç©å®¶</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TransitiToDestination</span><span class="token punctuation">(</span><span class="token class-name">TransitionPoint</span> transitionPoint<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è€ƒè™‘æ˜¯åŒåœºæ™¯è¿˜æ˜¯ä¸åŒåœºæ™¯çš„ä¼ é€</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>transitionPoint<span class="token punctuation">.</span>transitionType<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> TransitionPoint<span class="token punctuation">.</span>TransitionType<span class="token punctuation">.</span>SameScene<span class="token punctuation">:</span>            <span class="token comment">//åŒåœºæ™¯å¯ä»¥ä¸ç”¨å¼‚æ­¥ï¼Œç›´æ¥ä¼ é€</span>            <span class="token comment">//è¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·å¾—å½“å‰æ´»åŠ¨çª—å£çš„åå­—</span>            <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">Transition</span><span class="token punctuation">(</span>SceneManager<span class="token punctuation">.</span><span class="token function">GetActiveScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>transitionPoint<span class="token punctuation">.</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> TransitionPoint<span class="token punctuation">.</span>TransitionType<span class="token punctuation">.</span>DifferentScene<span class="token punctuation">:</span>            <span class="token comment">//ä¸åŒåœºæ™¯ï¼Œç”¨å¼‚æ­¥åŠ è½½çš„æ–¹å¼</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name">IEnumerator</span> <span class="token function">Transition</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sceneName<span class="token punctuation">,</span><span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å…ˆè·å¾—ç©å®¶çš„å¯¹è±¡</span>        player <span class="token operator">=</span> GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>        <span class="token comment">//è·å¾—ç›®çš„åœ°ä¼ é€é—¨å¯¹è±¡</span>        <span class="token class-name"><span class="token keyword">var</span></span> td <span class="token operator">=</span> <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å…³é—­å¯¼èˆªç§»åŠ¨</span>        player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment">//è®¾ç½®å¯¹è±¡çš„åæ ‡å’Œæ—‹è½¬è§’åº¦</span>        player<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">SetPositionAndRotation</span><span class="token punctuation">(</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ¢å¤å¯¼èˆªç§»åŠ¨</span>        player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token return-type class-name">TransitionDestination</span> <span class="token function">GetDestination</span><span class="token punctuation">(</span><span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//é€šè¿‡ä¼ é€é—¨ç›®çš„åœ°çš„æ ‡ç­¾å¯»æ‰¾ç›®çš„åœ°ä¼ é€é—¨æ‰€åœ¨ä½ç½®</span>        <span class="token class-name"><span class="token keyword">var</span></span> entrances <span class="token operator">=</span> <span class="token generic-method"><span class="token function">FindObjectsOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TransitionDestination<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>entrances<span class="token punctuation">.</span>Length<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>entrances<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>destinationTag <span class="token operator">==</span> destinationTag<span class="token punctuation">)</span><span class="token comment">//ç›®çš„åœ°ä¼ é€é—¨æ ‡ç­¾åŒ¹é…çš„è¯</span>                <span class="token keyword">return</span> entrances<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦å¤–å½“æˆ‘ä»¬ç©å®¶åˆ°è¾¾ä¼ é€é—¨ï¼Œæˆ‘å¸Œæœ›å®ƒå¯ä»¥æŒ‰é”®è§¦å‘ä¼ é€çš„ï¼Œæ‰€ä»¥è¿™é‡Œå»åˆ°<code>TransitionPoint.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//è§¦å‘å™¨è®¾ç½®</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> canTrans<span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦è§¦å‘ä¼ é€</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>E<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> canTrans<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æŒ‰é”®è§¦å‘ä¼ é€</span>        SceneController<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">TransitiToDestination</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜æœ‰ä¸€ä¸ªå·¥ä½œå°±æ˜¯è¦æŠŠæˆ‘ä»¬çš„<code>TransitionDestination.cs</code>ä½œä¸ºç»„ä»¶æ·»åŠ åœ¨ä¼ é€é—¨å­å¯¹è±¡çš„ç‚¹ä¸Š</p><img src="https://i.loli.net/2021/08/02/3Jm9QXySOEiqdRF.png" style="zoom:80%;" /><img src="https://i.loli.net/2021/08/02/Hen9PBroRJYcFjp.png" style="zoom:80%;" /><p>è¿™ä¸ªç‚¹æ˜¯ç”¨æ¥è®¾ç½®å½“å‰çš„ç‚¹æ˜¯å±äºå“ªä¸€ä¸ªæ ‡ç­¾çš„ï¼Œæˆ‘ä»¬å°±æŠŠä¸€ä¸ªä¼ é€é—¨å½“åšå…¥å£è®¾ä¸º<code>ENTER</code>ï¼Œå¦ä¸€ä¸ªä¼ é€é—¨å½“åšç›®çš„åœ°è®¾ä¸º<code>A</code></p><p>å¦å¤–å»åˆ°ä¼ é€é—¨ä¸­ï¼Œç›®çš„åœ°ä¹Ÿè¦è¿›è¡Œå¯¹åº”çš„è®¾ç½®ï¼Œå…¥å£ä¼ é€é—¨çš„ç›®çš„åœ°æ˜¯<code>A</code>ï¼Œåè¿‡æ¥å¦å¤–ä¸€ä¸ªä¼ é€é—¨æƒ³è¿‡æ¥å°±è¦è®¾ç½®ç›®çš„åœ°ä¸º<code>ENTER</code></p><p><strong>æ³¨æ„</strong>ï¼šæˆ‘ä»¬æœ€å¥½ä¸è¦è®¾ç½®å¤šä¸ªåŒä¸€æ ‡ç­¾çš„ä¼ é€é—¨ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜</p><p>æœ€åï¼Œå»ºç«‹ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶æŠŠ<code>SceneController.cs</code>ä½œä¸ºç»„ä»¶é™„ä¸Šå»</p><img src="https://i.loli.net/2021/08/02/caN1CyLrJU76bnI.png" style="zoom:80%;" /><h1 id="Triggeræ— æ³•è§¦å‘é—®é¢˜"><a href="#Triggeræ— æ³•è§¦å‘é—®é¢˜" class="headerlink" title="Triggeræ— æ³•è§¦å‘é—®é¢˜"></a>Triggeræ— æ³•è§¦å‘é—®é¢˜</h1><p>å¦‚æœå‡½æ•°å†…çš„Triggeräº‹ä»¶æ²¡æœ‰è§¦å‘çš„è¯ï¼Œå¯èƒ½æ˜¯ç©å®¶ä¸Šæ²¡æœ‰æ·»åŠ é’¢ä½“çš„åŸå› ï¼ŒæŠŠé’¢ä½“æ·»åŠ åœ¨ä¸»åŠ¨ç¢°æ’çš„ç‰©ä½“ä¸Šï¼ˆè¿™é‡Œæ˜¯ç©å®¶ï¼‰ï¼Œç„¶åæŠŠä¼ é€é—¨å’Œç©å®¶çš„ç¢°æ’ä½“ç»„ä»¶ä¸­<code>IsTrigger</code>å‹¾é€‰ä¸Šå°±å¯ä»¥äº†</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°25-åˆ¶ä½œä¼ é€é—¨</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B025-%E5%88%B6%E4%BD%9C%E4%BC%A0%E9%80%81%E9%97%A8/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B025-%E5%88%B6%E4%BD%9C%E4%BC%A0%E9%80%81%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬è¿™ä¸€ç« æ¥åˆ¶ä½œä¸€ä¸ªä¼ é€é—¨ä»¥ä¾›åé¢ç©å®¶åˆ‡æ¢ä¸åŒåœºæ™¯æ—¶ä½¿ç”¨</p><h1 id="åˆ¶ä½œä¼ é€é—¨Shader"><a href="#åˆ¶ä½œä¼ é€é—¨Shader" class="headerlink" title="åˆ¶ä½œä¼ é€é—¨Shader"></a>åˆ¶ä½œä¼ é€é—¨Shader</h1><p>é¦–å…ˆå°±æ˜¯è¦æ¥åˆ¶ä½œä¼ é€é—¨çš„Shaderï¼Œæ–°å»ºä¸€ä¸ª<code>Lit Shader Graph</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰å…‰å½±å“çš„shaderï¼Œèœå•ä¸­è¿˜æœ‰ä¸€ä¸ªå«åšUnlit Shader Graphå°±æ˜¯æ²¡æœ‰å…‰å½±å“çš„</p><p>è¿™é‡Œå»ºå¥½åèµ·åä¸º<code>Portal Shader</code></p><img src="https://i.loli.net/2021/08/01/pd7nMhKZHVBm4ar.png" style="zoom:80%;" /><p>æ³¨æ„é‡Œè¾¹çš„è®¾ç½®ï¼ŒSurfaceé€‰æ‹©<code>Transparent</code>å°±æ˜¯æœ‰é€æ˜é€šé“çš„æ„æ€ï¼Œç„¶åå‹¾é€‰<code>Two Sided</code>æ˜¾ç¤ºä¸¤é¢</p><img src="https://i.loli.net/2021/08/01/k7eZSNDKwTt2Y43.png" style="zoom:80%;" /><p>è¿™é‡Œç›´æ¥ä¸Šåšå¥½çš„å›¾ï¼Œé¢œè‰²çš„å±æ€§é¢æ¿ä¸­æ³¨æ„è¦é€‰æ‹©<code>HDR</code></p><img src="https://i.loli.net/2021/08/01/nwoQLuWKhYSR8lp.png" style="zoom:80%;" /><p>åšå¥½åç‚¹å‡»å·¦ä¸Šè§’<code>Save Asset</code>ä¿å­˜ï¼Œç„¶åå³é”®<code>Shder Graph</code>åˆ›å»ºä¸ºä¸€ä¸ª<code>Materials</code></p><img src="https://i.loli.net/2021/08/01/ecxz9EY5KfGgMOq.png" style="zoom:80%;" /><p>è¿™æ ·ä¸€ä¸ªä¼ é€é—¨çš„Shaderå°±åˆ›å»ºå¥½äº†</p><h1 id="åˆ¶ä½œä¼ é€é—¨"><a href="#åˆ¶ä½œä¼ é€é—¨" class="headerlink" title="åˆ¶ä½œä¼ é€é—¨"></a>åˆ¶ä½œä¼ é€é—¨</h1><p>å›åˆ°åœ°å›¾ä¸Šï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>Quad</code></p><img src="https://i.loli.net/2021/08/01/1ULfhYbuIgzD529.png" style="zoom:80%;" /><p>ç„¶åæŠŠåˆšåˆšçš„ä¼ é€é—¨æè´¨é™„ä¸Šå»ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ°ä¼ é€é—¨çš„é›å½¢äº†</p><img src="https://i.loli.net/2021/08/01/oGMurVFip1O8sjA.png" style="zoom:80%;" /><p>ä¹‹åå¯ä»¥åˆ›å»ºä¸€ä¸ªå­å¯¹è±¡ï¼Œè¡¨ç¤ºä¼ é€ç‚¹ï¼Œä»¥åå½“ç©å®¶è§¦ç¢°è¿™ä¸ªç‚¹ä¾¿å¯ä»¥è§¦å‘ä¼ é€äº‹ä»¶</p><img src="https://i.loli.net/2021/08/01/z65KBjWylxAvGIo.png" style="zoom:80%;" /><p>å¦‚å›¾æˆ‘è¿˜å°†è¿™ä¸ªç‚¹é™„ä¸Šäº†ä¸€ä¸ªè“è‰²å›¾æ ‡ï¼Œä»£è¡¨è¿™ä¸¤ä¸ªä¼ é€é—¨æ˜¯äº’é€šçš„ï¼Œä¸€å¯¹çš„ï¼Œå¯ä»¥èµ·åˆ°ä¸€ä¸ªæ ‡è®°ä½œç”¨</p><h1 id="ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç "><a href="#ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç " class="headerlink" title="ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç "></a>ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç </h1><p>è¿™é‡Œç¼–å†™ä¸€ä¸‹åŸºæœ¬çš„ä¼ é€é—¨ä»£ç ï¼Œè¯¦ç»†çš„ä»£ç å®Œå–„ç•™åœ¨ä¸‹ä¸€ç« èŠ‚</p><img src="https://i.loli.net/2021/08/01/aVGXZyRzq36d8pt.png" style="zoom:80%;" /><p>è¿™é‡Œçš„<code>TransitionPoint</code>æŒ‚è½½åœ¨ä¼ é€é—¨ä¸Šï¼Œè€Œ<code>TransitionDestination</code>æŒ‚è½½åœ¨è“è‰²çš„ç‚¹ä¸Š</p><p>æˆ‘ä»¬å…ˆæ¥ç¼–è¾‘TransitionPoint.cs</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//TransitionPoint.cs</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransitionPoint</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">TransitionType</span><span class="token punctuation">&#123;</span><span class="token comment">//ä¼ é€çŠ¶æ€</span>        SameScene<span class="token punctuation">,</span>DifferentScene    <span class="token punctuation">&#125;</span>        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Transition Infoï¼ˆä¼ é€é—¨è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> sceneName<span class="token punctuation">;</span><span class="token comment">//è®°å½•åœºæ™¯åç§°</span>    <span class="token keyword">public</span> <span class="token class-name">TransitionType</span> transitionType<span class="token punctuation">;</span><span class="token comment">//è®°å½•ä¼ é€çŠ¶æ€ï¼ŒåŒåœºæ™¯ä¼ é€å°±å¤–è¾¹é€‰æ‹©ç¬¬ä¸€ä¸ªï¼Œä¸åŒåœºæ™¯å°±é€‰æ‹©ç¬¬äºŒä¸ª</span>    <span class="token keyword">public</span> <span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">;</span><span class="token comment">//ä¼ é€ç‚¹ç›®çš„åœ°</span>    <span class="token comment">//è§¦å‘å™¨è®¾ç½®</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> canTrans<span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦è§¦å‘ä¼ é€</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerStay</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ç©å®¶åœ¨ä¼ é€é—¨åŒºåŸŸå†…</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            canTrans <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerExit</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ç©å®¶ç¦»å¼€äº†ä¼ é€é—¨åŒºåŸŸ</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            canTrans <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ä¼ é€ç‚¹ç›®çš„åœ°å¯¹åº”çš„åœ¨TransitionDestination.csä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//TransitionDestination.cs</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransitionDestination</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">DestinationTag</span><span class="token punctuation">&#123;</span><span class="token comment">//ä¼ é€ç‚¹æ ‡ç­¾</span>        ENTER<span class="token punctuation">,</span>A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">DestinationTag</span> destinationTag<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œçš„A,B,Cå¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼Œè¡¨ç¤ºçš„æ˜¯ä¸åŒä¼ é€é—¨ä¸­çš„ä¸åŒåœ°æ–¹ï¼Œç±»ä¼¼äºä¸€ä¸ªç«™ç‰Œ</p><p>æˆ‘ä»¬è¿˜æ³¨æ„åˆ°åœ¨å‰é¢<code>TransitionPoint.cs</code>ä¸­æœ‰è§¦å‘çš„ä»£ç ï¼Œè¿™é‡Œè¦åˆ°Unityå±æ€§é¢æ¿ä¸­æŠŠè§¦å‘<code>isTrigger</code>é€‰é¡¹å‹¾ä¸Šï¼Œå¦åˆ™ä¸èƒ½è§¦å‘<code>OnTriggerStay()</code>å’Œ<code>OnTriggerExit()</code>æ–¹æ³•</p><img src="https://i.loli.net/2021/08/01/G7DPlvBtNd5Lw9Y.png" style="zoom:80%;" /><p>å½“ç„¶ï¼Œç°åœ¨ç”¨åˆ°çš„æ˜¯<code>Mesh Collider</code>ï¼Œè¿™é‡Œè§¦å‘é¢ç§¯åªæ˜¯ä¸€ä¸ªå¹³é¢ï¼Œæˆ‘ä»¬å¯ä»¥æ¢æˆ<code>Box Collider</code>ï¼Œè®©å®ƒçš„è§¦å‘é¢ç§¯æ›´å¤§ä¸€äº›</p><img src="https://i.loli.net/2021/08/01/mPRClNHWdA6jufi.png" style="zoom:80%;" /><p>å¼„å¥½è¿™äº›åï¼Œè®°å¾—æŠŠä¼ é€é—¨ä¿å­˜ä¸ºä¸€ä¸ªç´ æ</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°24-åˆ¶ä½œç©å®¶çŠ¶æ€æ¡</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B024-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%8A%B6%E6%80%81%E6%9D%A1/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B024-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%8A%B6%E6%80%81%E6%9D%A1/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç« æ¥åˆ¶ä½œç©å®¶çš„çŠ¶æ€æ¡ï¼Œå¦‚è¡€é‡æ¡ï¼Œç»éªŒæ¡ç­‰</p><h1 id="ç¼–è¾‘UIå¸ƒå±€"><a href="#ç¼–è¾‘UIå¸ƒå±€" class="headerlink" title="ç¼–è¾‘UIå¸ƒå±€"></a>ç¼–è¾‘UIå¸ƒå±€</h1><p>ç¬¬ä¸€æ­¥ä¹Ÿæ˜¯å»ºç«‹ä¸€ä¸ªç”»å¸ƒï¼Œæ¨¡å¼ä½¿ç”¨é»˜è®¤çš„<code>Screen Space</code>è¦†ç›–å±å¹•</p><p>å€¼å¾—æ³¨æ„æ˜¯ä¸ºäº†ä½¿çŠ¶æ€æ¡å¯ä»¥éšç€å±å¹•çš„åˆ†è¾¨ç‡å¤§å°è€Œåˆ‡æ¢ï¼Œæˆ‘ä»¬çš„<code>UI Scale Mode</code>è¦è®¾ç½®æˆ<code>Scale With Scree</code></p><img src="https://www.hualigs.cn/image/6104bb2a28b1d.jpg" style="zoom:80%;" /><p>ä¹‹ååˆ›å»ºå¥½UIï¼Œå¯ä»¥åœ¨<code>Scene</code>è§†å›¾çš„2Dæ¨¡å¼ä¸‹è°ƒæ•´åˆ°åˆé€‚çš„ä½ç½®ï¼Œç„¶ååœ¨<code>Game</code>è§†å›¾ä¸‹é¢„è§ˆæ•ˆæœï¼Œå¯ä»¥è‡ªè¡Œå¤šå¤šå°è¯•</p><p>æœ€åçš„æ•ˆæœå¦‚ä¸‹</p><img src="https://i.loli.net/2021/07/31/xh2a6d1GFWIAQB3.png" style="zoom:80%;" /><p>æ³¨æ„è¿™é‡Œçš„æ–‡å­—æˆ‘ç”¨äº†è‡ªå®šä¹‰çš„å­—ä½“ï¼Œåœ¨Unityä¸­åªç”¨æŠŠä½ æƒ³è¦ç”¨çš„ç‰©ä½“æ‹–æ‹½è¿›æ¥åˆ†ç±»å¥½ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨æ–‡å­—UIè®¾ç½®é¢æ¿ä¸Šé€‰æ‹©ä½¿ç”¨äº†</p><h1 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h1><p>æ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™ä»£ç æ¥ç®¡ç†æˆ‘ä»¬çš„UIäº†</p><img src="https://i.loli.net/2021/07/31/WEluxrQkRazFKf5.png" style="zoom:80%;" /><p>ç„¶åæŠŠä»£ç ä½œä¸ºç»„ä»¶æ·»åŠ åˆ°ä¸Šé¢åˆ›å»ºçš„ç”»å¸ƒå½“ä¸­ï¼Œæ¥ç€å°±æ˜¯ç¼–å†™ä»£ç äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>UI</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerHealthUI</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç”±äºæˆ‘ä»¬çš„äººç‰©ä¿¡æ¯æ æœ€ç»ˆä¼šä¿å­˜ä¸ºä¸€ä¸ªprefab</span>    <span class="token comment">//å› æ­¤æˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨æ‹–æ‹½gameobjectæ–¹å¼æ¥è·å¾—å¯¹è±¡</span>    <span class="token comment">//å¯ä»¥ç›´æ¥ä½¿ç”¨è·å¾—å¯¹è±¡çš„å­å¯¹è±¡æ–¹å¼</span>    <span class="token class-name">Text</span> levelText<span class="token punctuation">;</span><span class="token comment">//è·å¾—textæ–‡æœ¬</span>    <span class="token class-name">Image</span> healthSlider<span class="token punctuation">;</span><span class="token comment">//ç”Ÿå‘½å€¼æ‹–æ‹½æ¡</span>    <span class="token class-name">Image</span> expSlider<span class="token punctuation">;</span><span class="token comment">//ç»éªŒæ‹–æ‹½æ¡</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ³¨æ„GetChildå¡«å†™çš„å‚æ•°ç±»ä¼¼äºæ•°ç»„ä¸‹æ ‡ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡çš„ç´¢å¼•æ˜¯0</span>        levelText <span class="token operator">=</span> transform<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Text<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å¾—æ–‡å­—å¯¹è±¡</span>        healthSlider <span class="token operator">=</span> transform<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Image<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å¾—ç”Ÿå‘½æ‹–æ‹½æ¡</span>        expSlider <span class="token operator">=</span> transform<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Image<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å¾—ç»éªŒå€¼æ‹–æ‹½æ¡</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">UpdateExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">UpdateHealth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        levelText<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"Level  "</span> <span class="token operator">+</span>             GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>currentLevel<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//00æ˜¯è§„å®šç»™å®ƒçš„ä¸€ä¸ªæ ¼å¼ï¼Œæ¯”å¦‚01 02....</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateHealth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¯ä»¥é€šè¿‡GameManagerç±»æ¥è·å¾—playerçš„states</span>        <span class="token class-name"><span class="token keyword">float</span></span> sliderPercent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>currentHealth<span class="token operator">/</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>MaxHealth<span class="token punctuation">;</span>        <span class="token comment">//æ›´æ–°å›¾ç‰‡å¡«å……</span>        healthSlider<span class="token punctuation">.</span>fillAmount <span class="token operator">=</span> sliderPercent<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">float</span></span> sliderPercent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>currentExp<span class="token operator">/</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>baseExp<span class="token punctuation">;</span>        <span class="token comment">//æ›´æ–°å›¾ç‰‡å¡«å……</span>        expSlider<span class="token punctuation">.</span>fillAmount <span class="token operator">=</span> sliderPercent<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ˜¯å€ŸåŠ©äº†<code>GameManager.cs</code>ä¸­çš„å•ä¾‹æ¨¡å¼å®ä¾‹åŒ–çš„æ–¹å¼æ¥è·å¾—playerçš„çŠ¶æ€ä¿¡æ¯ï¼Œå› ä¸ºå…ˆå‰æˆ‘ç”¨äº†å¤–ç•Œæ³¨å†Œçš„æ–¹å¼æŠŠç©å®¶çš„ä¿¡æ¯èµ‹äºˆäº†GameManageré‡Œé¢çš„æˆå‘˜å˜é‡</p><p>åˆ°è¿™æˆ‘ä»¬å°±å¤§åŠŸå‘Šæˆäº†</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°23-åˆ¶ä½œç©å®¶çš„å‡çº§</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B023-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%9A%84%E5%8D%87%E7%BA%A7/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B023-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%9A%84%E5%8D%87%E7%BA%A7/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æœ¬ç« ä¸­æˆ‘ä»¬æ¥åˆ¶ä½œç©å®¶çš„ç»éªŒç³»ç»Ÿï¼Œå¹¶é™„æœ‰å‡çº§åŠŸèƒ½</p><h1 id="æ‰©å±•CharacterData-SO"><a href="#æ‰©å±•CharacterData-SO" class="headerlink" title="æ‰©å±•CharacterData_SO"></a>æ‰©å±•CharacterData_SO</h1><p>æˆ‘ä»¬é¦–å…ˆæ‰“å¼€<code>CharacterData_SO.cs</code>æ·»åŠ ä¸€äº›é¢å¤–çš„å±æ€§è¿›å»ï¼ŒåŒæ—¶å†™ä¸€ä¸ªå‡çº§æ—¶å¤„ç†çš„æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CreateAssetMenu</span><span class="token attribute-arguments"><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Character States/Data"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharacterData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"States Infoï¼ˆå±æ€§ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> maxHealth<span class="token punctuation">;</span><span class="token comment">//æœ€å¤§ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentHealth<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> baseDefence<span class="token punctuation">;</span><span class="token comment">//åŸºç¡€é˜²å¾¡å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentDefence<span class="token punctuation">;</span><span class="token comment">//å½“å‰é˜²å¾¡å€¼</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Killï¼ˆå‡»æ€ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> killPoint<span class="token punctuation">;</span><span class="token comment">//å‡»æ€åæ‰è½çš„ç»éªŒå€¼</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Levelï¼ˆç­‰çº§ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentLevel<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç­‰çº§</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> maxLevel<span class="token punctuation">;</span><span class="token comment">//æœ€å¤§ç­‰çº§æ•°</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> baseExp<span class="token punctuation">;</span><span class="token comment">//åŸºç¡€ç»éªŒå€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentExp<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç»éªŒå€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> levelBuff<span class="token punctuation">;</span><span class="token comment">//æ¯æ¬¡å‡çº§æ•´ä½“å±æ€§æå‡çš„ç™¾åˆ†æ¯”</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">float</span></span> LevelMultiplier<span class="token punctuation">&#123;</span>        <span class="token comment">//å‡çº§æå‡å±æ€§åŠ çš„å€ç‡</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>currentLevel<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> levelBuff<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateExp</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> point<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        currentExp <span class="token operator">+=</span> point<span class="token punctuation">;</span><span class="token comment">//æŠŠå¤–ç•Œçš„ç»éªŒåŠ è¿›æ¥</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>currentExp <span class="token operator">>=</span> baseExp<span class="token punctuation">)</span>            <span class="token function">LevelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LevelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿™ä¸ªæ–¹æ³•ä¸­æ·»åŠ å‡çº§æ—¶æƒ³æå‡çš„æ•°æ®</span>        <span class="token comment">//å°†current+1é™åˆ¶åœ¨[0,maxLevel]é—­åŒºé—´ä¸­</span>        currentLevel <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Clamp</span><span class="token punctuation">(</span>currentLevel<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>maxLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†ç»éªŒå’Œç”Ÿå‘½å€¼æŒ‰ç…§æ¯ä¸€ç­‰çº§ä¸åŒå€ç‡å¢é•¿ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å›ºå®šå€¼level buffï¼‰</span>        baseExp <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>baseExp<span class="token operator">*</span>LevelMultiplier<span class="token punctuation">)</span><span class="token punctuation">;</span>        maxHealth <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>maxHealth <span class="token operator">*</span> LevelMultiplier<span class="token punctuation">)</span><span class="token punctuation">;</span>        currentHealth <span class="token operator">=</span> maxHealth<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€å†å»åˆ°<code>CharacterStates.cs</code>åšæœ€åçš„ä¿®æ”¹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharacterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³æ•°å€¼</span>    <span class="token comment">//å½“å‰æ”»å‡»åŠ›å‡å»ç›®æ ‡çš„é˜²å¾¡åŠ›ï¼Œå¦‚æœé˜²å¾¡åŠ›è¿‡é«˜å°±æ˜¯0ä¼¤å®³</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡ä¹Ÿæ˜¯æœ€å°å€¼é”åœ¨0</span>    Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"&#123;0&#125;æ”»å‡»äº†&#123;1&#125;ï¼Œé€ æˆäº†&#123;2&#125;ç‚¹ä¼¤å®³"</span><span class="token punctuation">,</span>attacker<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>defener<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>damage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­è¢«æ‰“è€…æ˜¯å¦å—åˆ°æš´å‡»å¹¶ä¸”æ’­æ”¾å—ä¼¤åŠ¨ç”»</span>        defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å°†æ¥è¦åšçš„äº‹æƒ…</span>    <span class="token comment">//è¡€é‡æ¡UI</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span>    <span class="token comment">//æ‰“æ­»æ€ªååŠ ç»éªŒ</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>        attacker<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span><span class="token function">UpdateExp</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>killPoint<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//çŸ³å¤´åå‡»çŸ³å¤´äººçš„æ”»å‡»æ–¹å¼</span>    <span class="token class-name"><span class="token keyword">int</span></span> dam <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>damage <span class="token operator">-</span> defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    defener<span class="token punctuation">.</span>currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">-</span> dam<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¡€æ¡äº‹ä»¶</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span>    <span class="token comment">//TODO:åŠ ç»éªŒ</span>    <span class="token comment">//å¯ä»¥é€šè¿‡GameManageræ¥è®¿é—®ç©å®¶çš„å±æ€§</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>    GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span><span class="token function">UpdateExp</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>killPoint<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åæˆ‘ä»¬å»åˆ°äººç‰©çš„<code>PlayerData</code>è¿˜æœ‰æ¯ä¸ªæ•Œäººçš„<code>Data</code>æ·»åŠ å±æ€§å°±å¯ä»¥äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/bc33680758884eb88e5bfed71402eaa5.png" alt="1.png" style="zoom:80%;" />]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°22-åˆ¶ä½œè¡€é‡æ¡UI</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B022-%E5%88%B6%E4%BD%9C%E8%A1%80%E9%87%8F%E6%9D%A1UI/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B022-%E5%88%B6%E4%BD%9C%E8%A1%80%E9%87%8F%E6%9D%A1UI/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬æ¥åˆ¶ä½œä¸€ä¸‹æ•Œäººçš„è¡€é‡æ¡</p><h1 id="åˆ›å»ºè¡€æ¡UI"><a href="#åˆ›å»ºè¡€æ¡UI" class="headerlink" title="åˆ›å»ºè¡€æ¡UI"></a>åˆ›å»ºè¡€æ¡UI</h1><h2 id="åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰"><a href="#åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰" class="headerlink" title="åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰"></a>åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰</h2><p>é¦–å…ˆåœ¨<code>Hierachy</code>çª—å£ä¸­åˆ›å»ºä¸€ä¸ª<code>Canvas</code>ï¼ˆç”»å¸ƒï¼‰ï¼Œå¹¶å°†å®ƒå‘½åä¸º<code>HealthBarCanvas</code></p><img src="https://p26-tt.byteimg.com/origin/pgc-image/a4bddbb255de4c87825a7866dd064269.png" alt="1.png" style="zoom:80%;" /><p>ä¹‹åæˆ‘ä»¬æ”¹ä¸€ä¸‹<code>HealthBarCanvas</code>è®¾ç½®ï¼Œå¹¶æŠŠåæ ‡é‡ç½®</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/7c8fa921e76f4decb29167a49ad882f1.png" alt="2.png" style="zoom:80%;" /><p>éšåæˆ‘ä»¬åœ¨è¿™ä¸ªç”»å¸ƒçš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ª<code>Image</code>ï¼Œå¹¶å°†å®ƒå‘½åä¸º<code>Bar Holder</code>ï¼Œç„¶ååœ¨æŠŠå®ƒçš„åæ ‡æ”¹ä¸€ä¸‹ï¼Œæ”¹æˆåƒä¸€ä¸ªè¡€æ¡çš„å¤§å°</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/48339de2f8e6417f94b09466da3b7428.png" alt="3.png" style="zoom:80%;" /><p>æˆ‘ä»¬å°±å¯ä»¥åœ¨Sceneçª—å£ä¸Šçœ‹åˆ°è¡€æ¡çš„åˆå§‹æ ·å­äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/ccf344e88ab44a2e92fc6563d1339523.png" alt="4.png" style="zoom:80%;" /><h2 id="åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource-Imageï¼‰"><a href="#åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource-Imageï¼‰" class="headerlink" title="åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource Imageï¼‰"></a>åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource Imageï¼‰</h2><p>æ¥ç€æˆ‘ä»¬è¦ä¸º<code>Bar Holder</code>å¯¼å…¥ä¸€ä¸ª<code>Source Image</code>ä½œä¸ºè¡€æ¡çš„åº•å±‚ï¼Œè¿™é‡Œå°±é€‰æ‹©è‡ªå·±åˆ›å»ºä¸€ä¸ªå›¾åƒä½œä¸ºå®ƒçš„åº•å±‚</p><p>é¦–å…ˆè¦æ‰“å¼€<code>Package Manager</code>å®‰è£…ä¸€ä¸‹<code>2D Sprite</code></p><img src="https://p26-tt.byteimg.com/origin/pgc-image/7c103cd1256d4e5cb07ed10165846528.png" alt="5.png" style="zoom:80%;" /><p>æ¥ç€æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè·¯å¾„ä¸“é—¨å­˜æ”¾UIç›¸å…³çš„å¯¹è±¡ï¼Œè¿™é‡Œåˆ›å»ºä¸€ä¸ª<code>Square</code>æ–¹å½¢å›¾åƒ</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/73d842b512f940698760bf2547bbf82c.png" alt="6.png" style="zoom:80%;" /><p>å†æŠŠè¿™ä¸ªæ–¹å½¢å›¾åƒåº”ç”¨åœ¨åˆšåˆšçš„<code>Source Image</code>ä¸­å°±è¡Œäº†</p><p>ç”±äºç°åœ¨æˆ‘ä»¬åˆ›å»ºå‡ºæ¥çš„æ˜¯ä¸€ä¸ªè¡€æ¡çš„åº•å±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçš„é¢œè‰²è®¾ç½®ä¸ºçº¢è‰²åº•ï¼Œå¾…ä¼šæœ‰ä¸ªä¸Šå±‚å›¾åƒè®¾ç½®æˆç»¿è‰²ï¼Œè¿™æ ·å¼„å‡ºæ¥å°±æœ‰è¡€æ¡çš„æ ·å­äº†</p><p>å› æ­¤æˆ‘ä»¬è¿™é‡ŒæŠŠé¢œè‰²æ”¹ä¸ºçº¢è‰²ï¼ˆè¿™é‡Œæˆ‘æŠŠé¢œè‰²çš„é€æ˜åº¦æ”¹æˆäº† 150 ï¼‰</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/9d082235f7dc478ca60891914aaa2de1.png" alt="7.png" style="zoom:80%;" /><h2 id="åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ"><a href="#åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ" class="headerlink" title="åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ"></a>åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ</h2><p>æˆ‘ä»¬åœ¨<code>Bar Holder</code>çš„åŸºç¡€ä¸Šå†åˆ›å»ºä¸€ä¸ªå›¾åƒ<code>Image</code>ï¼Œå‘½åä¸º<code>Current Health</code>ï¼Œå¹¶å°†å®½åº¦å’Œé«˜åº¦è®¾ç½®æˆå’Œåº•å±‚ä¸€æ ·ï¼ˆ2.5å’Œ0.25ï¼‰</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/13abb2c92ea14215973e66d999182fa4.png" alt="8.png" style="zoom:80%;" /><p>åŒæ—¶<code>Source Image</code>è¿˜æ˜¯å’Œåˆšåˆšä¸€æ ·ï¼Œé¢œè‰²è°ƒä¸ºç»¿è‰²</p><p>å”¯ä¸€ä¸åŒçš„æ˜¯å›¾ç‰‡çš„ç±»å‹<code>Image Type</code>è¦è°ƒä¸º<strong>å¡«å……</strong><code>Filled</code>ï¼Œå¡«å……çš„æ–¹å¼ä¸º<strong>æ°´å¹³å¡«å……</strong><code>Horizontal</code>ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è°ƒèŠ‚å¡«å……æ•°é‡<code>Fill Amount</code>æ¥æ§åˆ¶ç»¿è‰²æ¡çš„é•¿åº¦ï¼Œä»è€Œä»£è¡¨è¡€é‡çš„å¤šå°‘äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/f5d505bfb9e74b98a2e2ffdaa4b81b15.png" alt="9.png" style="zoom:80%;" /><p>æ•ˆæœå›¾å¦‚ä¸‹</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/72681600544d4713a09b34e971078333.png" alt="10.png" style="zoom:80%;" /><p>è¿™æ ·ä¸€ä¸ªç®€é™‹çš„è¡€æ¡å°±å¼„å¥½äº†ï¼Œæˆ‘ä»¬å°†å®ƒä¿å­˜ä¸ºä¸€ä¸ªç´ æ</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/7d681c103df74db1921f9235c27f02e1.png" alt="11.png" style="zoom:80%;" /><h2 id="è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®"><a href="#è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®" class="headerlink" title="è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®"></a>è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®</h2><p>ç”±äºæˆ‘ä»¬æ¯ä¸ªæ•Œäººé«˜çŸ®ä¸åŒï¼Œå°±å¯¼è‡´äº†è¡€æ¡åœ¨ä¸åŒæ•Œäººçš„ä½ç½®ä¹Ÿä¸ä¸€æ ·ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬åé¢çš„ä»£ç ï¼Œè¿™é‡Œæˆ‘ä»¬è¦ä¸ºæ¯ä¸ªæ•Œäººè®¾ç½®ä¸€ä¸‹è¡€æ¡åº”è¯¥å‡ºç°çš„ä½ç½®</p><p>æœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯ä¸ºæ¯ä¸ªæ•Œäººå¯¹è±¡å†åˆ›å»ºä¸€ä¸ªå­å¯¹è±¡æ¥è®°å½•è¡€æ¡ä½ç½®</p><p>æˆ‘ä»¬æ‰“å¼€<code>Prefabs ---&gt; Characters</code>ç›®å½•ç¼–è¾‘æ•Œäººç´ æï¼Œè¿™é‡Œæ‹¿å²è±å§†ä¸ºä¾‹å­</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/a4ed16108baa4e62a2c591cb1d263eb6.png" alt="13.png" style="zoom:80%;" /><p>åƒä¸Šé¢å›¾ç‰‡è¿™æ ·ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>HealthBar Point</code>çš„ç©ºå¯¹è±¡æ¥è®°å½•è¡€æ¡çš„ä½ç½®ï¼Œè¿™æ ·å°±å¾ˆæ–¹ä¾¿æˆ‘ä»¬ä»£ç çš„ç¼–å†™äº†</p><p>æœ€åæŒ‰ç…§åŒæ ·çš„æ–¹å¼ç»™æ¯ä¸ªæ•Œäººéƒ½å®‰æ”¾<code>HealthBar Point</code></p><h1 id="ç¼–å†™è¡€æ¡ä»£ç "><a href="#ç¼–å†™è¡€æ¡ä»£ç " class="headerlink" title="ç¼–å†™è¡€æ¡ä»£ç "></a>ç¼–å†™è¡€æ¡ä»£ç </h1><h2 id="åˆ›å»ºäº‹ä»¶"><a href="#åˆ›å»ºäº‹ä»¶" class="headerlink" title="åˆ›å»ºäº‹ä»¶"></a>åˆ›å»ºäº‹ä»¶</h2><p>åœ¨åˆ›å»ºè¡€æ¡ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆåœ¨<code>CharacterStates.cs</code>ä¸­åˆ›å»ºä¸€ä¸ªäº‹ä»¶ï¼Œå³åœ¨é€ æˆä¼¤å®³æ—¶è¦è§¦å‘çš„è¡€æ¡å˜åŠ¨äº‹ä»¶</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//é€ æˆä¼¤å®³æ—¶è¡€æ¡æ”¹å˜çš„äº‹ä»¶</span><span class="token keyword">public</span> <span class="token keyword">event</span> <span class="token class-name">Action<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">></span></span> UpdateHealthBarOnAttack<span class="token punctuation">;</span><span class="token comment">//åœ¨é€ æˆä¼¤å®³æ—¶è°ƒç”¨</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharacterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"&#123;0&#125;æ”»å‡»äº†&#123;1&#125;ï¼Œé€ æˆäº†&#123;2&#125;ç‚¹ä¼¤å®³"</span><span class="token punctuation">,</span>attacker<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>defener<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>damage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span>        defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//TODO:è¡€é‡æ¡UI</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">int</span></span> dam <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>damage <span class="token operator">-</span> defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    defener<span class="token punctuation">.</span>currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">-</span> dam<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¡€æ¡äº‹ä»¶</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åˆ›å»ºè¡€æ¡ä»£ç "><a href="#åˆ›å»ºè¡€æ¡ä»£ç " class="headerlink" title="åˆ›å»ºè¡€æ¡ä»£ç "></a>åˆ›å»ºè¡€æ¡ä»£ç </h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å†™æ§åˆ¶è¡€æ¡çš„è„šæœ¬ä»£ç </p><p>åœ¨ä¸‹å›¾ç›®å½•åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œèµ·åä¸º<code>HealthBarUI.cs</code></p><img src="https://p6-tt.byteimg.com/origin/pgc-image/19ea0718eaf34586b42b44476b56da6c.png" alt="12.png" style="zoom:80%;" /><p>ç„¶åæ‰“å¼€ç¼–å†™ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HealthBarUI</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> healthUIPrefab<span class="token punctuation">;</span><span class="token comment">//ä¾›å¤–ç•Œæä¾›ä¸€ä¸ªè¡€æ¡ç´ æ</span>    <span class="token keyword">public</span> <span class="token class-name">Transform</span> barPoint<span class="token punctuation">;</span><span class="token comment">//è®°å½•è¡€é‡æ¡è¯¥æ˜¾ç¤ºåœ¨æ•Œäººçš„å“ªä¸ªä½ç½®</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"è¡€æ¡æ˜¾ç¤ºè®¾ç½®"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> alwaysVisible<span class="token punctuation">;</span><span class="token comment">//è¡€æ¡æ˜¯å¦ä¸€ç›´å¯è§</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> visibleTime<span class="token punctuation">;</span><span class="token comment">//è¡€æ¡æ˜¾ç¤ºæ—¶é—´ï¼ˆå¦‚æœä¸æ˜¯ä¸€ç›´å¯è§çš„æƒ…å†µä¸‹ï¼‰</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> timeLeft<span class="token punctuation">;</span><span class="token comment">//å‰©ä½™çš„æ˜¾ç¤ºæ—¶é—´</span>    <span class="token class-name">Image</span> healthSlider<span class="token punctuation">;</span><span class="token comment">//æ‹¿åˆ°è¡€æ¡ä¸Šå±‚å›¾åƒ</span>    <span class="token class-name">Transform</span> UIbar<span class="token punctuation">;</span><span class="token comment">//è®°å½•ç”Ÿæˆçš„è¡€æ¡åœ¨çš„ä½ç½®</span>    <span class="token class-name">Transform</span> cam<span class="token punctuation">;</span><span class="token comment">//æ‹¿åˆ°æ‘„åƒæœºä½ç½®ä»¥å¤„ç†è¡€æ¡ä¸€ç›´é¢å‘æˆ‘ä»¬æ‘„åƒæœº</span>    <span class="token class-name">CharacterStates</span> currentStates<span class="token punctuation">;</span><span class="token comment">//è·å–å½“å‰äººç‰©çš„states</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        currentStates <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        currentStates<span class="token punctuation">.</span>UpdateHealthBarOnAttack <span class="token operator">+=</span> UpdateHealthBar<span class="token punctuation">;</span><span class="token comment">//æ³¨å†Œäº‹ä»¶</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//OnEnableåœ¨æ¯æ¬¡åˆ‡æ¢åœ°å›¾æ—¶éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡</span>        cam <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span>transform<span class="token punctuation">;</span><span class="token comment">//è·å–ä¸»ç›¸æœºä½ç½®</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">Canvas</span> canvas <span class="token keyword">in</span> <span class="token generic-method"><span class="token function">FindObjectsOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Canvas<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//éå†æ¯ä¸€ä¸ªç”»å¸ƒ</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>renderMode <span class="token operator">==</span> RenderMode<span class="token punctuation">.</span>WorldSpace<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//æ‰¾åˆ°è¡€æ¡æ‰€åœ¨çš„ç”»å¸ƒï¼Œæœ‰å¤šç§æ–¹æ³•æ¥è·å¾—</span>                <span class="token comment">//ä¹Ÿå¯ä»¥ä¾›å¤–ç•Œæä¾›æ­¤ç”»å¸ƒï¼Œæ›´ä¸¥è°¨ä¸€ç‚¹</span>                UIbar <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>healthUIPrefab<span class="token punctuation">,</span>canvas<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">;</span>                <span class="token comment">//è·å¾—ä¸Šå±‚å›¾åƒï¼ˆç»¿è‰²æ¡ï¼‰çš„å¯¹è±¡ï¼Œä¸‹æ ‡ä¸º0</span>                healthSlider <span class="token operator">=</span> UIbar<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Image<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//æ˜¯å¦ä¸€ç›´å¯è§</span>                UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span>alwaysVisible<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateHealthBar</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> currentHealth<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">int</span></span> maxHealth<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ›´æ–°è¡€é‡</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>currentHealth <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¦‚æœå½“å‰è¡€é‡å°äºç­‰äº0ï¼Œå°±é”€æ¯UIbar</span>            <span class="token function">Destroy</span><span class="token punctuation">(</span>UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//æ¯æ¬¡æ›´æ–°æ—¶å¿…ç„¶å¯è§</span>        UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¾—åˆ°è¡€é‡ç™¾åˆ†æ¯”</span>        <span class="token class-name"><span class="token keyword">float</span></span> sliderPercent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>currentHealth <span class="token operator">/</span> maxHealth<span class="token punctuation">;</span>        <span class="token comment">//æ›´æ–°è¡€æ¡é•¿åº¦</span>        healthSlider<span class="token punctuation">.</span>fillAmount <span class="token operator">=</span> sliderPercent<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LateUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åœ¨Updateåä¸€å¸§æ‰§è¡Œ</span>        <span class="token comment">//æ›´æ–°è¡€æ¡è·Ÿéšæ•Œäººä½ç½®</span>        <span class="token comment">//è¿™é‡Œå…ˆæ£€æµ‹UIbaræœ‰æ²¡æœ‰ç»™é”€æ¯</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>UIbar <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            UIbar<span class="token punctuation">.</span>position <span class="token operator">=</span> barPoint<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//æ›´æ–°åˆ°æ•Œäººä½ç½®</span>            UIbar<span class="token punctuation">.</span>forward <span class="token operator">=</span> cam<span class="token punctuation">.</span>forward<span class="token punctuation">;</span><span class="token comment">//é¢æœæ‘„åƒæœºï¼ˆå³æ‘„åƒæœºçš„æ–¹å‘ï¼‰</span>            <span class="token comment">//è¡€æ¡å‰©ä½™æ˜¾ç¤ºæ—¶é—´</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>timeLeft <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>alwaysVisible<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                timeLeft <span class="token operator">=</span> visibleTime<span class="token punctuation">;</span>                UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span>                timeLeft <span class="token operator">-=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åæŠŠä»£ç è„šæœ¬æŒ‚è½½åˆ°æ¯ä¸ªæ•Œäººèº«ä¸Šï¼Œå†è°ƒæ•´æ•°æ®å°±å¯ä»¥è¿è¡Œè¯•è¯•çœ‹æ•ˆæœäº†</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°21-åå‡»çŸ³å¤´äºº</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B021-%E5%8F%8D%E5%87%BB%E7%9F%B3%E5%A4%B4%E4%BA%BA/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B021-%E5%8F%8D%E5%87%BB%E7%9F%B3%E5%A4%B4%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<p> è¿™ä¸€ç« ä¸­æˆ‘ä»¬æ¥å®ç°çŸ³å¤´äººä¸¢å‡ºçŸ³å¤´æ¥å‡»é£ç©å®¶å¹¶ä¸”é€ æˆä¼¤å®³çš„æ•ˆæœï¼ŒåŒæ—¶ç©å®¶è¿˜å¯ä»¥åˆ©ç”¨çŸ³å¤´åå‡»çŸ³å¤´äºº</p><h1 id="å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³"><a href="#å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³" class="headerlink" title="å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³"></a>å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³</h1><p>æˆ‘ä»¬æ‰“å¼€<code>Rock.cs</code>ï¼Œæˆ‘ä»¬è¦æœ‰åŒºåˆ†æ€§çš„è§¦å‘ä¼¤å®³ï¼Œå¯¹äºç©å®¶å’Œæ•Œäººå¯ä»¥é€ æˆä¼¤å®³ï¼Œä½†æ˜¯å¯¹äºä¸¢åˆ°åœ°é¢çš„æƒ…å†µæ˜¯ä¸èƒ½é€ æˆä¼¤å®³çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥åˆ©ç”¨ä¸€ä¸ªæšä¸¾æ¥åŒºåˆ†å¼€æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">RockStates</span><span class="token punctuation">&#123;</span>HitPlayer<span class="token punctuation">,</span>HitEnemy<span class="token punctuation">,</span>HitNothing<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">public</span>  <span class="token class-name">RockStates</span> rockStates<span class="token punctuation">;</span><span class="token comment">//æšä¸¾å®ä¾‹</span><span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">;</span><span class="token comment">//é€ æˆçš„ä¼¤å®³æ˜¯å¤šå°‘</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionEnter</span><span class="token punctuation">(</span><span class="token class-name">Collision</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//otheræŒ‡è¢«çŸ³å¤´æ‰“åˆ°çš„å¯¹è±¡</span>    <span class="token comment">//å½“å‘ç”Ÿç¢°æ’æ—¶ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>rockStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> RockStates<span class="token punctuation">.</span>HitPlayer<span class="token punctuation">:</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> direction <span class="token operator">*</span> force<span class="token punctuation">;</span><span class="token comment">//å‡»é€€ç©å®¶</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Dizzy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//çœ©æ™•</span>                <span class="token comment">//è¿™é‡Œçš„TakeDamageæ˜¯é‡è½½çš„å…¶ä¸­ä¸€ä¸ªæ–¹æ³•</span>                <span class="token comment">//é€ æˆä¼¤å®³</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>damage<span class="token punctuation">,</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                rockStates <span class="token operator">=</span> RockStates<span class="token punctuation">.</span>HitNothing<span class="token punctuation">;</span><span class="token comment">//å¤åŸçŠ¶æ€ä»¥é˜²ä¸€ç›´æ‰§è¡Œ</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//end switch</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬çœ‹åˆ°å…¶ä¸­çš„<code>TakeDamage()</code>æ˜¯ä¸€ä¸ªé‡è½½æ–¹æ³•ï¼Œæ‰“å¼€<code>CharacterStates.cs</code>æˆ‘ä»¬è¿™é‡Œè¡¥å……ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//å‡½æ•°é‡è½½</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">int</span></span> dam <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>damage <span class="token operator">-</span> defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    defener<span class="token punctuation">.</span>currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">-</span> dam<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åä¿å­˜å…³é—­ï¼Œåˆ«å¿˜äº†è¦åœ¨å¤–è¾¹çŸ³å¤´å¯¹è±¡ä¸Šèµ‹äºˆä¸€ä¸ªåˆå§‹ä¼¤å®³å€¼</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/87f552555d2d4f60b4fe62d0d9c10da6.png" alt="1.png" style="zoom:80%;" /><p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†çŸ³å¤´çš„ç¬¬ä¸€ä¸ªçŠ¶æ€</p><h1 id="å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº"><a href="#å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº" class="headerlink" title="å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº"></a>å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº</h1><p>å…ˆæŠŠä»£ç å®Œå–„å¥½</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">case</span> RockStates<span class="token punctuation">.</span>HitEnemy<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Golem<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è·å¾—äº†çŸ³å¤´äººä»£ç ç»„ä»¶çš„å°±æ˜¯çŸ³å¤´äººçš„ï¼Œå¦åˆ™è¿”å›çš„æ˜¯ç©º</span>    <span class="token class-name"><span class="token keyword">var</span></span> otherStates <span class="token operator">=</span> other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    otherStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>damage<span class="token punctuation">,</span>otherStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Destroy</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæˆ‘ä»¬è¿™é‡Œæ˜¯åå‡»çŸ³å¤´äººï¼Œæ‰€ä»¥è¦æœ‰ä¸ªåˆ¤æ–­é¼ æ ‡ç‚¹å‡»åˆ°äº†çŸ³å¤´ï¼Œä¸€ä¸ªæœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯ç»™æˆ‘ä»¬çš„çŸ³å¤´æ·»åŠ ä¸€ä¸ªæ ‡ç­¾ï¼Œç„¶åå†ä¿®æ”¹ä¸€ä¸‹é¼ æ ‡ç‚¹å‡»æ—¶çš„æ–¹æ³•</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/e18b4dde9c5b4129bba36dd1c9f553b2.png" alt="2.png" style="zoom:80%;" /><p>å›åˆ°<code>PlayerController.cs</code>ä¿®æ”¹ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Attackable"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¦‚æœç‚¹å‡»çš„å¯¹è±¡ä¸æ˜¯æ•Œäººè€Œæ˜¯å…¶å®ƒå¦ç±»å¯æ”»å‡»å¯¹è±¡ï¼Œå¦‚çŸ³å¤´</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rockStates            <span class="token operator">==</span> Rock<span class="token punctuation">.</span>RockStates<span class="token punctuation">.</span>HitNothing<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¦‚æœæ˜¯çŸ³å¤´å¹¶ä¸”çŸ³å¤´ä¸åœ¨ç©ºä¸­è€Œæ˜¯è½åœ°ä¹‹å</span>            attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rockStates <span class="token operator">=</span> Rock<span class="token punctuation">.</span>RockStates<span class="token punctuation">.</span>HitEnemy<span class="token punctuation">;</span>            <span class="token comment">//é˜²æ­¢æ”»å‡»é‚£ä¸€åˆ¹é‚£é€Ÿåº¦å°äº1å¯¼è‡´çŸ³å¤´çŠ¶æ€å‘ç”Ÿæ”¹å˜</span>            attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>one<span class="token punctuation">;</span>                        <span class="token comment">//æ·»åŠ ä¸€ä¸ªç©å®¶æœå‘çš„åŠ›ï¼ŒåŠ›çš„å¤§å°æš‚æ—¶å®š 40</span>            attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">AddForce</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>forward <span class="token operator">*</span> <span class="token number">40</span><span class="token punctuation">,</span>ForceMode<span class="token punctuation">.</span>Impulse<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®¡ç®—ä¼¤å®³</span>        targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¡ä»¶ä¸­æœ‰ä¸€ä¸ªæ˜¯åˆ¤æ–­æ˜¯å¦ä¸º<code>HitNothing</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åˆ¤æ–­çŸ³å¤´æ˜¯å¦ä¸ºæ¥è¿‘äºé™æ­¢æ—¶ä¸ºæ¡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å°±è¦å›å»<code>Rock.cs</code>åšä¸€äº›ä¿®æ”¹äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    rb <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    rb<span class="token punctuation">.</span>velocity <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>one<span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢çŸ³å¤´ä¸€ç”Ÿæˆæ—¶é€Ÿåº¦ä¸º0å¯¼è‡´çŠ¶æ€å‘ç”Ÿæ”¹å˜</span>    <span class="token function">FlyToTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">FixedUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å›ºå®šå¸§æ›´æ–°</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>rb<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>sqrMagnitude <span class="token operator">&lt;</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å‘é‡çš„å¹³æ–¹</span>        rockStates <span class="token operator">=</span> RockStates<span class="token punctuation">.</span>HitNothing<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ååˆ«å¿˜äº†åœ¨<code>MouseManager.cs</code>åŠ ä¸Šä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> hitInfo<span class="token punctuation">.</span>collider <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Ground"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name"><span class="token keyword">var</span></span> point <span class="token operator">=</span> hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç‚¹å‡»æ•Œäººä¼ é€’æ•Œäººçš„gameObject</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Attackable"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//ç‚¹å‡»çŸ³å¤´ç­‰å¯¹è±¡ç”¨</span>            OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ"><a href="#ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ" class="headerlink" title="ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ"></a>ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ</h1><p>æœ€åæˆ‘ä»¬æƒ³åœ¨çŸ³å¤´æ‰“åˆ°çŸ³å¤´äººæ—¶æœ‰ä¸€ä¸ªçˆ†è£‚ç¢çŸ³ç‰¹æ•ˆï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°<code>Particle System</code>äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/efcac51c11a3459cb6e1cfad55ff677a.png" alt="3.png" style="zoom:80%;" /><p>åˆ›å»ºå¥½ä¹‹åæˆ‘ä»¬æŒ‰ç…§ä¸‹å›¾å‚è€ƒè®¾ç½®</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/2a5fef602fe948eab2649b98a3f07f83.png" alt="5.png" style="zoom:80%;" /><img src="https://p5-tt.byteimg.com/origin/pgc-image/529e6ea5fe1141afb30b34135e7b8018.png" alt="6.png" style="zoom:80%;" /><img src="https://p6-tt.byteimg.com/origin/pgc-image/e34343a1983440909f77ce88719261e3.png" alt="7.png" style="zoom:80%;" /><img src="https://p5-tt.byteimg.com/origin/pgc-image/973530a9742240a7bc989b50a5ce86fb.png" alt="8.png" style="zoom:80%;" /><p>è‡ªå·±å¤šå¤šæµ‹è¯•ä¸€ä¸‹æ•ˆæœï¼Œæ»¡æ„ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ”¹ä¸ªåå°†å®ƒä¿å­˜ä¸ºä¸€ä¸ªç´ ææ”¾å¥½å…ˆï¼Œç„¶åä¸è¦å¿˜äº†æŠŠåœ°å›¾ä¸Šåˆšåˆšè°ƒè¯•çš„åˆ é™¤</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/4b40b473872f4223a4aafecdb889c930.png" alt="9.png" style="zoom:80%;" /><p>æœ€åå†åœ¨<code>Rock.cs</code>ä¸Šä¿®æ”¹ä¸€ä¸‹ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token class-name">GameObject</span> RockBreakParticle<span class="token punctuation">;</span><span class="token comment">//çŸ³å¤´çˆ†è£‚ç‰¹æ•ˆï¼Œä¾›å¤–ç•Œæ‹–æ‹½è¿›æ¥</span><span class="token keyword">case</span> RockStates<span class="token punctuation">.</span>HitEnemy<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Golem<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è·å¾—äº†çŸ³å¤´äººä»£ç ç»„ä»¶çš„å°±æ˜¯çŸ³å¤´äººçš„ï¼Œå¦åˆ™è¿”å›çš„æ˜¯ç©º</span>    <span class="token class-name"><span class="token keyword">var</span></span> otherStates <span class="token operator">=</span> other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    otherStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>damage<span class="token punctuation">,</span>otherStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    Instantiate        <span class="token punctuation">(</span>RockBreakParticle<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>Quaternion<span class="token punctuation">.</span>identity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‡»ä¸­æ•Œäººæ—¶äº§ç”Ÿçˆ†è£‚ç‰¹æ•ˆ</span>    <span class="token function">Destroy</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åä¸è¦å¿˜äº†æŠŠçŸ³å¤´çˆ†è£‚çš„ç‰¹æ•ˆæ‹–è¿›å»è®¾ç½®é¢æ¿é‡Œ</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/272290cea6af4b3a8f67fbe952186662.png" alt="10.png" style="zoom:80%;" />]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°20-å®ç°çŸ³å¤´äººä¸¢å‡ºçŸ³å¤´</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B020-%E5%AE%9E%E7%8E%B0%E7%9F%B3%E5%A4%B4%E4%BA%BA%E4%B8%A2%E5%87%BA%E7%9F%B3%E5%A4%B4/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B020-%E5%AE%9E%E7%8E%B0%E7%9F%B3%E5%A4%B4%E4%BA%BA%E4%B8%A2%E5%87%BA%E7%9F%B3%E5%A4%B4/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬å®ç°ä¸€ä¸‹çŸ³å¤´äººçš„ç‰¹æ®Šæ”»å‡»ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆä¸€ä¸ªçŸ³å¤´ç„¶åä¸¢å‘æˆ‘ä»¬ç©å®¶</p><h1 id="ç¼–è¾‘çŸ³å¤´"><a href="#ç¼–è¾‘çŸ³å¤´" class="headerlink" title="ç¼–è¾‘çŸ³å¤´"></a>ç¼–è¾‘çŸ³å¤´</h1><p>é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°çŸ³å¤´ç´ ææ‹–å‡ºæ¥ï¼Œç”±äºæˆ‘ä»¬è¦ç»™å®ƒæ–½åŠ ä¸€ä¸ªåŠ›ï¼Œå› æ­¤è¿™é‡Œå°±è¦ç”¨åˆ°<code>Rigidbody(é’¢ä½“)</code>ç»„ä»¶äº†</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/63ea4e8d49e540acb69a7ded75d37782.png" alt="2.png" style="zoom:80%;" /><p>åŒæ—¶çŸ³å¤´è¿˜è¦ä¸åœ°é¢å‘ç”Ÿç¢°æ’ï¼Œå› æ­¤è¿˜è¦æ·»åŠ ä¸€ä¸ªç¢°æ’ä½“ï¼Œè¿™é‡Œé€‰æ‹©çš„æ˜¯<code>MeshCollider</code>ï¼Œå‹¾é€‰<code>Convex</code>å¯ä»¥çœ‹åˆ°ç¢°æ’ä½“ç§¯åˆšå¥½é€‚é…æˆ‘ä»¬çš„çŸ³å¤´å½¢çŠ¶</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/ddc484a234c94603b2b16b9dd5ea0a42.png" alt="3.png" style="zoom:80%;" /><p>ç„¶åæˆ‘ä»¬å°±è¦æ¥è¿›è¡Œå†™ä»£ç äº†</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/0a42c8f078f8441ea47b3ef4af3302f8.png" alt="1.png" style="zoom:80%;" /><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rock</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Rigidbody</span> rb<span class="token punctuation">;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Basic Settings(æ‰”å‡ºçŸ³å¤´å‚æ•°è®¾ç½®)"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> force<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‡ºå»çš„å†²å‡»åŠ›å¤§å°</span>    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> target<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‘çš„ç›®æ ‡</span>    <span class="token keyword">private</span> <span class="token class-name">Vector3</span> direction<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‡ºå»çš„æ–¹å‘</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        rb <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">FlyToTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">FlyToTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//é˜²æ­¢ä¸¢å‡ºå»é‚£ä¸€åˆ¹é‚£ç©å®¶è„±ç¦»ä¸¢å¤±ç›®æ ‡å¯¼è‡´çŸ³å¤´ç”Ÿæˆä¸å‡ºæ¥</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>target <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            target <span class="token operator">=</span> <span class="token generic-method"><span class="token function">FindObjectOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>PlayerController<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>                <span class="token comment">//Vector3.upæ˜¯æƒ³åœ¨çŸ³å¤´ä¸¢å‡ºå»çš„æ—¶å€™ä¸Šå‡ä¸€ä¸ªé«˜åº¦</span>        direction <span class="token operator">=</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">-</span> transform<span class="token punctuation">.</span>position <span class="token operator">+</span> Vector3<span class="token punctuation">.</span>up<span class="token punctuation">)</span><span class="token punctuation">.</span>normalized<span class="token punctuation">;</span>        <span class="token comment">//Impulseæ˜¯å†²å‡»åŠ›çš„æ¨¡å¼</span>        rb<span class="token punctuation">.</span><span class="token function">AddForce</span><span class="token punctuation">(</span>direction <span class="token operator">*</span> force<span class="token punctuation">,</span>ForceMode<span class="token punctuation">.</span>Impulse<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬å°†çŸ³å¤´ç´ æä¿å­˜ä¸€ä¸ªæ¨¡æ¿å¯¹è±¡</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/735c192da1924614a7f5e0f0ee01b428.png" alt="4.png" style="zoom:80%;" /><h1 id="è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº"><a href="#è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº" class="headerlink" title="è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº"></a>è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº</h1><p>éšåæˆ‘ä»¬å†æ¬¡ç¼–è¾‘çŸ³å¤´äººï¼Œå› ä¸ºæˆ‘ä»¬çš„çŸ³å¤´æ˜¯ä»çŸ³å¤´äººçš„æ‰‹ä¸Šä¸¢å‡ºå»çš„ï¼Œå› æ­¤æˆ‘ä»¬å°±è¦è·å¾—æ‰‹çš„åæ ‡ï¼Œå³ä¸‹é¢çš„å¯¹è±¡åæ ‡</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/0cdbbddf408c42e6a443e151c343ce6b.png" alt="5.png" style="zoom:80%;" /><p>çŸ¥é“è¿™ä¸ªåæˆ‘ä»¬æš‚æ—¶æ”¾åœ¨ä¸€è¾¹ï¼Œæ¥ç¼–å†™ä¸€ä¸‹çŸ³å¤´äººçš„ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Rock Settingsï¼ˆä¸¢çŸ³å¤´æ”»å‡»çš„ç›¸å…³è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token class-name">GameObject</span> rockPrefab<span class="token punctuation">;</span><span class="token comment">//çŸ³å¤´ç´ æ</span><span class="token keyword">public</span> <span class="token class-name">Transform</span> handPos<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‡ºçŸ³å¤´çš„æ‰‹çš„åæ ‡</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ThrowRock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åˆ›å»ºçŸ³å¤´å¯¹è±¡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ—‹è½¬ï¼Œè¿™é‡Œé€‰æ‹©ç»´æŒåˆå§‹æ—‹è½¬</span>        <span class="token class-name">GameObject</span> rock <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>rockPrefab<span class="token punctuation">,</span>handPos<span class="token punctuation">.</span>position<span class="token punctuation">,</span>Quaternion<span class="token punctuation">.</span>identity<span class="token punctuation">)</span><span class="token punctuation">;</span>        rock<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>target <span class="token operator">=</span> attackTarget<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æŠŠçŸ³å¤´äººçš„åŠ¨ç”»äº‹ä»¶æ·»åŠ ä¸Šå»</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/6ec880f34ce24caab5c2270d61e5d04a.png" alt="6.png" style="zoom:80%;" /><p>æœ€ååˆ«å¿˜äº†è¿˜è¦é€‰æ‹©çŸ³å¤´çš„ç´ æï¼ˆå°±æ˜¯æˆ‘ä»¬åˆšåˆšä¿å­˜å¥½çš„ç´ ææ¨¡æ¿ï¼‰ï¼Œä»¥åŠæ‰‹çš„åæ ‡</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/29b7a5e0ae72481a933c5728c35ca1b9.png" alt="7.png" style="zoom:80%;" />]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°19-è®¾ç½®çŸ³å¤´äºº</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B019-%E8%AE%BE%E7%BD%AE%E7%9F%B3%E5%A4%B4%E4%BA%BA/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B019-%E8%AE%BE%E7%BD%AE%E7%9F%B3%E5%A4%B4%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥è®¾ç½®çŸ³å¤´äººï¼Œç”±äºå’Œè®¾ç½®å…½äººç›¸å·®ä¸å¤§ï¼Œç¯‡å¹…æ¯”è¾ƒå°‘</p><h1 id="è®¾ç½®åŠ¨ç”»"><a href="#è®¾ç½®åŠ¨ç”»" class="headerlink" title="è®¾ç½®åŠ¨ç”»"></a>è®¾ç½®åŠ¨ç”»</h1><p>æˆ‘ä»¬å»æµè§ˆçŸ³å¤´äººçš„åŠ¨ç”»å¯ä»¥å‘ç°ï¼Œ<code>Attack01</code>æ˜¯ç±»ä¼¼æ‹¿èµ·çŸ³å¤´ä¸¢æˆ‘ä»¬ï¼Œå®ƒæ‰æ˜¯æŠ€èƒ½æ”»å‡»ï¼Œè€Œ<code>Attack02</code>æ˜¯å‡»æ™•ç©å®¶çš„æ”»å‡»åŠ¨ç”»ï¼Œå¯ä»¥ä½œä¸ºæ™®é€šæ”»å‡»æ¥ä½¿ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è°ƒæ•´æ”»å‡»åŠ¨ç”»æ—¶è¦æ³¨æ„åˆ†æ¸…</p><p>æˆ‘ä»¬çš„åŠ¨ç”»æ§åˆ¶å™¨æ–‡ä»¶å°±é€‰æ‹©æ˜¯åŸºäº<code>å…½äºº</code>çš„åŠ¨ç”»æ¥å®Œæˆï¼Œåˆ›å»ºä¸€ä¸ª<code>New Animator Override Controller</code>ï¼Œæ¨¡æ¿é€‰æ‹©ä¸ºå…½äººï¼Œç„¶åå†ä¸€ä¸ªä¸ªåŠ¨ç”»æ›¿æ¢ä¸Šå»</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/cbf3634f05844a5f98fed856698b1a5a.png" alt="1.png" style="zoom:80%;" /><p>å…¶ä¸­<code>Run</code>å¹¶æ²¡æœ‰è‡ªå¸¦åŠ¨ç”»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>Walk</code>ä»£æ›¿</p><h1 id="ç¼–å†™ä»£ç æ–‡ä»¶"><a href="#ç¼–å†™ä»£ç æ–‡ä»¶" class="headerlink" title="ç¼–å†™ä»£ç æ–‡ä»¶"></a>ç¼–å†™ä»£ç æ–‡ä»¶</h1><p>æˆ‘ä»¬åƒå…½äººä»£ç æ–‡ä»¶é‚£æ ·å•ç‹¬åˆ›ä¸€ä¸ªä»£ç æ–‡ä»¶ç»™çŸ³å¤´äººç”¨ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯è¦ç»§æ‰¿<code>EnemyController</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Golem</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EnemyController</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Skillï¼ˆçŸ³å¤´äººç‰¹æ®Šæ”»å‡»è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> kickForce <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//æ¨å¼€æ•Œäººè·ç¦»</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">kickOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//çŸ³å¤´äººå‡»é£ç©å®¶</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> transform<span class="token punctuation">.</span><span class="token function">IsFacingTarget</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name"><span class="token keyword">var</span></span> targetState <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Vector3</span> direction <span class="token operator">=</span> <span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">.</span>normalized<span class="token punctuation">;</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> direction<span class="token operator">*</span>kickForce<span class="token punctuation">;</span>            targetState<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>characterStates<span class="token punctuation">,</span>targetState<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åå†æ·»åŠ åŠ¨ç”»äº‹ä»¶å°±è¡Œäº†</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°18-æ‰©å±•æ–¹æ³•</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B018-%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B018-%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬æ¥ç†Ÿæ‚‰ä¸€ä¸‹æ‰©å±•æ–¹æ³•ï¼Œæ‰€è°“æ‰©å±•æ–¹æ³•å°±æ˜¯åœ¨ä¸ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä½†æ˜¯å¯ä»¥é¢å¤–ç¼–å†™ä¸€ä¸ªç±»æ¥æ‰©å±•è¿™ä¸ªç±»çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¿™ä¸€ç« æˆ‘ä»¬æƒ³è®©æˆ‘ä»¬æ§åˆ¶ä¸»è§’åœ¨å…½äººåé¢æ—¶å…½äººæ”»å‡»ä¸ä¼šé€ æˆä¼¤å®³ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°<code>transfrom</code>ç±»ï¼Œä½†æ˜¯<code>transfrom</code>é‡Œè¾¹æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±è¦æ¥æ‰©å±•å®ƒ</p><h1 id="æ‰©å±•æ–¹æ³•"><a href="#æ‰©å±•æ–¹æ³•" class="headerlink" title="æ‰©å±•æ–¹æ³•"></a>æ‰©å±•æ–¹æ³•</h1><p>è¦æƒ³æˆ‘ä»¬çš„å…½äººæ•Œäººå¯¹èº«åç©å®¶é€ æˆä¸äº†ä¼¤å®³ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥å†™ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸“é—¨æ¥åˆ¤æ–­ç©å®¶æ˜¯å¦åœ¨å…½äººæ­£å‰æ–¹æ‰‡å½¢åŒºåŸŸï¼Œå¦‚æœåœ¨åˆ™è¿”å›<code>true</code>å¦åˆ™è¿”å›<code>false</code>ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ–¹æ³•åŠ åˆ°è®¡ç®—ä¼¤å®³çš„<code>Hit()</code>å‡½æ•°é‡Œè¾¹è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œç©å®¶åœ¨å…½äººè§†é‡èŒƒå›´å†…å°±é€ æˆä¼¤å®³ï¼Œåä¹‹ä¸é€ æˆ</p><p>è¿™ä¸ªæ‰©å±•æ–¹æ³•æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ä»£ç æ–‡ä»¶</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/1d4a90fb719d4281b68a709f01232cd2.png" alt="1.png" style="zoom:80%;" /><p>æ‰“å¼€ç¼–å†™å®ƒ</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ExtensionMethod</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ‰©å±•æ–¹æ³•ç±»</span>    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> dotThreshold <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token punctuation">;</span> <span class="token comment">//è§†é‡èŒƒå›´å¤§å°</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">IsFacingTarget</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Transform</span> transform <span class="token punctuation">,</span> <span class="token class-name">Transform</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åˆ¤æ–­ç›®æ ‡æ˜¯å¦åœ¨è§†é‡èŒƒå›´å†…</span>        <span class="token class-name"><span class="token keyword">var</span></span> vectorToTarget <span class="token operator">=</span> target<span class="token punctuation">.</span>position <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//è·å¾—æ•Œäººå’Œç©å®¶çš„ç›¸å¯¹ä½ç½®</span>        vectorToTarget<span class="token punctuation">.</span><span class="token function">Normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘é‡åŒ–</span>        <span class="token comment">//Dot:ä¸¤ä¸ªçŸ¢é‡çš„ç‚¹ç§¯ã€‚ ç‚¹ç§¯æ˜¯ä¸€ä¸ªæµ®ç‚¹å€¼ï¼Œç­‰äºä¸¤ä¸ªçŸ¢é‡çš„å¤§å°ç›¸ä¹˜ï¼Œç„¶åä¹˜ä»¥å®ƒä»¬ä¹‹é—´çš„è§’åº¦çš„ä½™å¼¦ã€‚</span>        <span class="token class-name"><span class="token keyword">float</span></span> dot <span class="token operator">=</span> Vector3<span class="token punctuation">.</span><span class="token function">Dot</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>forward<span class="token punctuation">,</span>vectorToTarget<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> dot <span class="token operator">></span> dotThreshold<span class="token punctuation">;</span><span class="token comment">//å¦‚æœç©å®¶åœ¨æ•Œäººå¤¹è§’120Â°(cos120 = 0.5)è§†é‡èŒƒå›´å†…åˆ™è¿”å›true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>Vector3.Dot()</code>æ–¹æ³•ï¼Œå®˜æ–¹APIåœ¨<a href="http://docs.unity3d.com/ScriptReference/Vector3.Dot.html">è¿™é‡Œ</a>ï¼ŒåŒæ—¶ä¹Ÿç”¨äº†<code>transform.forward</code>æ¥è¡¨ç¤ºæ•Œäººé¢å¯¹çš„æ–¹å‘</p><p>åŒæ—¶è¿˜è¦æ³¨æ„åˆ°å‚æ•°æœ‰ä¸ª<code>this</code>ï¼Œè¿™æ ·å¯ä»¥è®©æ–¹æ³•åŠ å…¥åˆ°<code>Transform</code>ç±»é‡Œé¢ï¼Œå˜æˆå®ƒçš„ä¸€ä¸ªæ–¹æ³•</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/f180df5587214500b2f7e3cb8e63072a.png" alt="2.png" style="zoom:80%;" /><p>æœ€åæˆ‘ä»¬å›åˆ°<code>Hit()</code>å‡½æ•°ä¸­ï¼ŒæŠŠåˆ¤æ–­æ¡ä»¶åŠ ä¸Šå°±å®Œæˆäº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç”±äºåœ¨æ•Œäººè¿½ä¸»è§’çš„è¿‡ç¨‹ä¸­ä¸»è§’å¯èƒ½ä¼šè·‘å¼€ï¼Œè¿™æ—¶å€™å¦‚æœæ”»å‡»çš„è¯ç›®æ ‡å°±ä¸¢å¤±äº†</span>    <span class="token comment">//æ‰€ä»¥æˆ‘ä»¬åœ¨æ”»å‡»å‰åˆ¤æ–­ç›®æ ‡æ˜¯å¦ä¸ºç©ºï¼Œä»¥é˜²æŠ¥é”™</span>    <span class="token comment">//åŒæ—¶è¿˜åˆ¤æ–­äº†ç©å®¶æ˜¯å¦åœ¨æ•Œäººçš„è§†é‡èŒƒå›´å†…ï¼Œåœ¨çš„è¯æ‰é€ æˆä¼¤å®³</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> transform<span class="token punctuation">.</span><span class="token function">IsFacingTarget</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>characterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ï¼Œå½“æˆ‘ä»¬çš„ç©å®¶èµ°åˆ°æ•Œäººåè¾¹çš„æ—¶å€™å°±ä¸ä¼šå—åˆ°ä¼¤å®³</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°17-è®¾ç½®å…½äººæ•Œäºº</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B017-%E8%AE%BE%E7%BD%AE%E5%85%BD%E4%BA%BA%E6%95%8C%E4%BA%BA/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B017-%E8%AE%BE%E7%BD%AE%E5%85%BD%E4%BA%BA%E6%95%8C%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<p> åœ¨è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥è®¾ç½®ä¸€ä¸‹å…½äººæ•Œäººï¼Œç”±äºå®ƒçš„<code>Attack02</code>åŠ¨ç”»åŒ…å«ä¸€ä¸ªæ¨äººçš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œå•ç‹¬çš„æµ‹è¯•ï¼Œè€Œä¸æ˜¯ç»§ç»­æ²¿ç”¨ä¹‹å‰çš„<code>EnemyController</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å®ƒåŸºç¡€ä¸Šè¿›è¡Œæ·»åŠ ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©ç»§æ‰¿ç±»æ–¹å¼æ”¹å†™</p><h1 id="ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•"><a href="#ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•" class="headerlink" title="ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•"></a>ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•</h1><p>å› ä¸ºå…½äººæ˜¯ç”¨ç»§æ‰¿çš„ä»£ç ï¼Œæˆ‘ä»¬è¦ä¸“é—¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ”¾ç‰¹å®šæ•Œäººçš„<code>EnemyController</code>å­ç±»ä»£ç </p><img src="https://p5-tt.byteimg.com/origin/pgc-image/2a7f1d824413463f8bbb1701fb464525.png" alt="1.png" style="zoom:80%;" /><p>åŒæ—¶ä¹ŸæŠŠè¿™ä¸ªä»£ç æŒ‚è½½åˆ°å…½äººèº«ä¸Š</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Grunt</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EnemyController</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Skillï¼ˆå…½äººç‰¹æ®Šæ”»å‡»è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> kickForce <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span><span class="token comment">//æ¨å¼€æ•Œäººè·ç¦»</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">kickOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¦‚æœè®¿é—®ä¸äº†attackTargetè¦è¿”å›çˆ¶ç±»ä¿®æ”¹ä¸ºprotectå±æ€§</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Vector3</span> direction <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token operator">-</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>            direction<span class="token punctuation">.</span><span class="token function">Normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é‡åŒ–æ¨å¼€çš„æ–¹å‘</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token comment">//velocityè¡¨ç¤ºé€Ÿåº¦ï¼Œè¿™é‡Œç»™äº†ä¸»è§’ä¸€ä¸ªåå‘é€Ÿåº¦ï¼Œè¾¾åˆ°ç»™æ¨å¼€çš„æ•ˆæœ</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> direction<span class="token operator">*</span>kickForce<span class="token punctuation">;</span>                        attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Dizzy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//äººç‰©è¿›å…¥çœ©æ™•çŠ¶æ€</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æŠŠåŠ¨ç”»äº‹ä»¶æ·»åŠ ä¸Šï¼Œ<code>Attack02</code>ç”¨çš„äº‹ä»¶æ˜¯æˆ‘ä»¬ä¸Šé¢å†™çš„<code>kickOff()</code></p><p>åŒæ—¶è¿™é‡Œæœ‰ä¸ªçœ©æ™•çŠ¶æ€ï¼Œæˆ‘ä»¬æŠŠçœ©æ™•åŠ¨ç”»å¦‚ä¸‹æ·»åŠ å¥½ï¼ŒåŒæ—¶çœ©æ™•åŠ¨ç”»é€Ÿåº¦æˆ‘æ”¹ä¸ºäº†2ï¼Œè®©å®ƒæ’­æ”¾å¿«ä¸€ç‚¹</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/e375df607aa64f32b0779527e3494c29.png" alt="2.png" style="zoom:80%;" /><h1 id="æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º"><a href="#æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º" class="headerlink" title="æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º"></a>æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º</h1><p>æˆ‘ä»¬æŠŠå²è±å§†çš„åŠ¨ç”»å¤åˆ¶ä¸€ä»½ç»™å…½äººï¼Œç„¶åä¸ºäº†ä¿æŒå…½äººåœ¨æ¨å¼€äººç‰©æ—¶äººç‰©è¿›å…¥çœ©æ™•çŠ¶æ€å¹¶ä¸”ä¸èƒ½ç§»åŠ¨ï¼Œæˆ‘ä»¬è¿˜è¦æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸ºï¼ˆ<code>Behaviour</code>ï¼‰</p><p>æ›¿æ¢åŠ¨ç”»è¿‡ç¨‹ä¸å†æè¿°ï¼Œä½†æ˜¯æ³¨æ„è¿™é‡Œ<strong>ä¸èƒ½</strong>é‡‡ç”¨åŠ¨ç”»æ§åˆ¶å™¨ç»§æ‰¿çš„æ–¹å¼</p><p>è¿™é‡Œå°±è¯´ä¸€ä¸‹åŠ¨ç”»è¡Œä¸ºï¼Œæ‰¾åˆ°äººç‰©çš„<code>Dizzy</code>åŠ¨ç”»ï¼Œç‚¹å‡»<code>Add Behaviour</code>ï¼Œåˆ›å»ºä¸€ä¸ªå«åš<code>Stop Agent</code>çš„è¡Œä¸ºï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªä»£ç æ–‡ä»¶ï¼Œåˆ›å»ºå¥½åæˆ‘ä»¬æŠŠè¿™ä¸ªä»£ç æ–‡ä»¶å½’ç±»æ”¾å¥½</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/3b6e539cae684b47ae1971d9d95485de.png" alt="3.png" style="zoom:80%;" /><img src="https://p9-tt.byteimg.com/origin/pgc-image/752bc9fca53d4a6a80c77a7381d9a0f0.png" alt="4.png" style="zoom:80%;" /><p>è¿™ä¸ªä»£ç æ–‡ä»¶æ‰“å¼€å°±å·²ç»æœ‰ä¸€äº›æ³¨é‡Šåœ¨é‚£äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å–æ¶ˆæˆ‘ä»¬è¦ç”¨æ–¹æ³•çš„æ³¨é‡Šï¼Œè¿™é‡Œç”¨åˆ°çš„å°±æ˜¯è¿›å…¥åŠ¨ç”»ã€åŠ¨ç”»æ’­æ”¾æ—¶ä»¥åŠåŠ¨ç”»ç»“æŸæ—¶åˆ»çš„ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StopAgent</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">StateMachineBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token comment">// OnStateEnter is called when a transition starts and the state machine starts to evaluate this state</span>    <span class="token keyword">override</span> <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnStateEnter</span><span class="token punctuation">(</span><span class="token class-name">Animator</span> animator<span class="token punctuation">,</span> <span class="token class-name">AnimatorStateInfo</span> stateInfo<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> layerIndex<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        animator<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// OnStateUpdate is called on each Update frame between OnStateEnter and OnStateExit callbacks</span>    <span class="token keyword">override</span> <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnStateUpdate</span><span class="token punctuation">(</span><span class="token class-name">Animator</span> animator<span class="token punctuation">,</span> <span class="token class-name">AnimatorStateInfo</span> stateInfo<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> layerIndex<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        animator<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// OnStateExit is called when a transition ends and the state machine finishes evaluating this state</span>    <span class="token keyword">override</span> <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnStateExit</span><span class="token punctuation">(</span><span class="token class-name">Animator</span> animator<span class="token punctuation">,</span> <span class="token class-name">AnimatorStateInfo</span> stateInfo<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> layerIndex<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>       animator<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// OnStateMove is called right after Animator.OnAnimatorMove()</span>    <span class="token comment">//override public void OnStateMove(Animator animator, AnimatorStateInfo stateInfo, int layerIndex)</span>    <span class="token comment">//&#123;</span>    <span class="token comment">//    // Implement code that processes and affects root motion</span>    <span class="token comment">//&#125;</span>    <span class="token comment">// OnStateIK is called right after Animator.OnAnimatorIK()</span>    <span class="token comment">//override public void OnStateIK(Animator animator, AnimatorStateInfo stateInfo, int layerIndex)</span>    <span class="token comment">//&#123;</span>    <span class="token comment">//    // Implement code that sets up animation IK (inverse kinematics)</span>    <span class="token comment">//&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹‹åæˆ‘ä»¬å¯ä»¥æŠŠè¡Œä¸ºæ”¾è¿›äººç‰©çš„çœ©æ™•ã€å—ä¼¤ç­‰åŠ¨ç”»ï¼Œç”šè‡³æ˜¯æ•Œäººçš„æ”»å‡»åŠ¨ç”»</p><p>æ³¨æ„çš„æ˜¯æ·»åŠ åˆ°æ•Œäººæ”»å‡»åŠ¨ç”»æ—¶å¯èƒ½ä¼šæœ‰ä¸€ä¸ªæŠ¥é”™ï¼ŒåŸå› æ˜¯æˆ‘ä»¬å¯èƒ½æŠŠæ•Œäººæ‰“æ­»äº†ï¼Œå¯¼è‡´è¡Œä¸ºæ— æ³•è·å¾—agentï¼Œè§£å†³åŠæ³•å¦‚ä¸‹ï¼Œæˆ‘ä»¬å»åˆ°<code>EnemyController.cs</code>ä¿®æ”¹æ•Œäººæ­»äº†ä¹‹åçš„çŠ¶æ€</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>collider<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢æ—¶å€™å¼€ä¸šå†æ¬¡æ”»å‡»</span><span class="token comment">//agent.enabled = false;//ç›´æ¥å…³é—­å¯¼èˆªç»„ä»¶</span>agent<span class="token punctuation">.</span>radius <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//æŠŠagentçš„èŒƒå›´ç¼©å°</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">,</span><span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é”€æ¯æ¸¸æˆå¯¹è±¡ï¼Œå»¶è¿Ÿä¸º2ç§’</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬åŸæœ¬æƒ³å…³é—­agentä»¥è¾¾åˆ°agentæ²¡æœ‰ä½“ç§¯æ•ˆæœï¼Œæ‰€ä»¥å¯ä»¥æŠŠagent.enabled = false;è¯­å¥æ”¹ä¸ºäº†ç›´æ¥æŠŠagentèŒƒå›´ç¼©å°åˆ°0ï¼Œä¹Ÿæ˜¯åŒæ ·çš„æ•ˆæœ</p><p>åˆ°è¿™æˆ‘ä»¬å°±åˆæ­¥è®¾ç½®å¥½äº†å…½äººäº†</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°16-åˆ¶ä½œæ›´å¤šçš„æ•Œäºº</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B016-%E5%88%B6%E4%BD%9C%E6%9B%B4%E5%A4%9A%E7%9A%84%E6%95%8C%E4%BA%BA/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B016-%E5%88%B6%E4%BD%9C%E6%9B%B4%E5%A4%9A%E7%9A%84%E6%95%8C%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<p> è¿™ä¸€ç« æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„æ•Œäººæ•°é‡åˆ¶ä½œåœ°å¤šä¸€äº›ï¼Œæ›´åŠ åœ°å»å®Œå–„æ¸¸æˆ</p><h1 id="åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†"><a href="#åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†" class="headerlink" title="åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†"></a>åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†</h1><p>åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†å¾ˆç®€å•ï¼Œåªç”¨å¯¹ç€ä¹‹å‰çš„å²è±å§†<code>Ctrl + D</code>å¤åˆ¶ä¸€ä¸‹å°±å¯ä»¥</p><p>ä½†æ˜¯è¿™ä¹‹ä¸­ä¹Ÿæœ‰å­˜åœ¨é—®é¢˜ï¼Œå°±æ˜¯å²è±å§†ä¼šå…±ç”¨ä¸€ä¸ª<code>Character Data</code>ï¼Œè¿™å¯ä»¥åœ¨æ¯æ¬¡å¼€å§‹æ¸¸æˆæ—¶åˆ›å»ºä¸€ä¸ªä¸´æ—¶<code>Data</code>ç»™ä»–ä»¬æ¥è§£å†³</p><p>æ‰“å¼€<code>Character States.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token class-name">CharacterData_SO</span> characterData<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">CharacterData_SO</span> templateData<span class="token punctuation">;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>templateData <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token comment">//å¤åˆ¶ä¸€ä¸ªä¸´æ—¶æ¨¡æ¿Data</span>        characterData <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>templateData<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”Ÿæˆå¤šä¸€ä¸ªdata</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå²è±å§†èº«ä¸Šçš„<code>Data</code>å¦‚ä¸‹è®¾ç½®</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/e780aba5845e41caa4a1b38673b38708.png" alt="2.png" style="zoom:80%;" /><h1 id="æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ"><a href="#æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ" class="headerlink" title="æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ"></a>æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ</h1><p>æˆ‘ä»¬çš„å²è±å§†ç´ ææ–‡ä»¶å¤¹ä¸‹æœ‰å¦å¤–ä¸€ä¸ªæ•Œäººåˆºåˆºé¾Ÿï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒæ”¾ç½®ä¸Šæ¥</p><p>ç”±äºå®ƒä¹Ÿæ˜¯ä¾èµ–<code>EnemyController.cs</code>çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¹‹å‰è¿˜è¦æ·»åŠ ä¸€è¡Œå¼ºåˆ¶é™„å¸¦ç»„ä»¶ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">RequireComponent</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">CharacterStates</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±å¯ä»¥å¼ºåˆ¶é™„å¸¦<code>CharacterStates</code>ä»£ç ç»„ä»¶äº†</p><p>åœ¨ç´ æä¸­æ‰¾åˆ°åˆºåˆºé¾ŸæŠŠå®ƒæ”¾ç½®åœ¨åœ°å›¾ä¸Š</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/c0a6ab51762547b5855e2d4d808bb14c.png" alt="3.png" style="zoom:80%;" /><p>ç„¶åä¸ºå®ƒæ·»åŠ <code>EnemyController.cs</code>ï¼Œä»¥åŠè®¾ç½®å¥½åŸºæœ¬ä¿¡æ¯</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/82f0fc3573f7434aa1a235f4fbe931c3.png" alt="4.png" style="zoom:80%;" /><p>è¿˜æœ‰ä¸€ä¸ªå…³é”®çš„åœ°æ–¹åœ¨äºåŠ¨ç”»çš„åˆ‡æ¢ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€ä¸ªæŠ€å·§ï¼ŒæŠŠå²è±å§†åŸæ¥çš„<code>Animations</code>å¤åˆ¶ä¸€ä¸ªå‡ºæ¥ç›´æ¥è¦†ç›–æ›¿æ¢åŠ¨ç”»</p><p>æˆ‘ä»¬åœ¨å³é”®åˆ›å»ºæ—¶é€‰æ‹©<code>Animator Override Controller</code>å°±å¯ä»¥äº†</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/61c8eb67c769464eb07f58ab37b2c59d.png" alt="5.png" style="zoom:80%;" /><p>ç„¶åå±æ€§é¢æ¿ä¸­ç¬¬ä¸€ä¸ªé€‰é¡¹å°±ä¼šé—®æˆ‘ä»¬è¦ä¾é å“ªä¸ª<code>Animation</code>ä¸ºæ¨¡æ¿ï¼Œæˆ‘ä»¬é€‰æ‹©å²è±å§†åŸæ¥çš„åŠ¨ç”»</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/60d1f5873d4b440ba04764b3bdfd5cda.png" alt="6.png" style="zoom:80%;" /><p>ä¹‹åå†å°†å®ƒä»¬æ›¿æ¢å°±å¯ä»¥äº†ï¼Œåˆ«å¿˜äº†<code>Attack01</code>å’Œ<code>Attack02</code>è¦å•ç‹¬å¤åˆ¶å‡ºæ¥ä»¥åŠæ·»åŠ å¸§äº‹ä»¶</p><h1 id="å…½äººå’ŒçŸ³å¤´äºº"><a href="#å…½äººå’ŒçŸ³å¤´äºº" class="headerlink" title="å…½äººå’ŒçŸ³å¤´äºº"></a>å…½äººå’ŒçŸ³å¤´äºº</h1><p>è¿˜æœ‰éœ€è¦æ·»åŠ çš„å°±æ˜¯å…½äººå’ŒçŸ³å¤´äººï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶æ·»åŠ å¥½ç´ æå†æŠŠå®ƒä»¬ç§»åˆ°åœ°å›¾ä¸Šå°±å¥½äº†ï¼Œä¹‹åçš„äº‹æƒ…ä¸‹ä¸€ç« èŠ‚å†å¤„ç†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/712fe6fd05d24f17a782e3bbd8937ab7.png" alt="7.png" style="zoom:80%;" /><img src="https://p5-tt.byteimg.com/origin/pgc-image/c884e6e35d714f3988fb0a5b4109a5cc.png" alt="8.png" style="zoom:80%;" />]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°15-ä½¿ç”¨æ¥å£å®ç°è§‚å¯Ÿè€…æ¨¡å¼çš„è®¢é˜…å’Œå¹¿æ’­</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B015-%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%AE%A2%E9%98%85%E5%92%8C%E5%B9%BF%E6%92%AD/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B015-%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%AE%A2%E9%98%85%E5%92%8C%E5%B9%BF%E6%92%AD/</url>
      
        <content type="html"><![CDATA[<p> è¿™ä¸€ç« æˆ‘ä»¬ä½¿ç”¨æ¥å£æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼çš„è®¢é˜…å’Œå¹¿æ’­ï¼ŒåŒæ—¶ä¹Ÿæ¥å®ç°ç©å®¶æ­»äº†æ¸¸æˆç»“æŸä¹‹åæ•Œäººçš„è·èƒœåŠ¨ç”»</p><h1 id="ç¼–å†™æ¥å£"><a href="#ç¼–å†™æ¥å£" class="headerlink" title="ç¼–å†™æ¥å£"></a>ç¼–å†™æ¥å£</h1><p>åœ¨<code>Tools</code>æ–‡ä»¶å¤¹ä¸‹æˆ‘ä»¬æ–°å»ºä¸€ä¸ªä»£ç æ–‡ä»¶<code>IEndGameObserver.cs</code>è¡¨ç¤ºæ¸¸æˆç»“æŸä¹‹åçš„æ¥å£</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IEndGameObserver</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ³¨æ„æ¥å£åªå†™å£°æ˜ä¸å†™å®šä¹‰</span>    <span class="token comment">//æ¸¸æˆç»“æŸè¦æ“ä½œçš„éƒ½åœ¨è¿™ä¸ªæ¥å£å®ç°</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æ¥åˆ°<code>EnemyController.cs</code>ç¼–å†™ä¸€ä¸ªå¹¿æ’­æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span><span class="token punctuation">,</span><span class="token class-name">IEndGameObserver</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è·èƒœåŠ¨ç”»</span>        <span class="token comment">//åœæ­¢æ‰€æœ‰ç§»åŠ¨</span>        <span class="token comment">//åœæ­¢Agent</span>        isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        attackTarget <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶å®ƒè¦åœ¨æ¸¸æˆç»“æŸæ—¶è¦æœ‰æ“ä½œçš„ä»£ç ä¹Ÿå¯ä»¥åƒè¿™ç§æ–¹å¼æ¥ç»§æ‰¿æ¥å£å¹¶å®ç°æ“ä½œ</p><h1 id="è®¢é˜…æ¥å£"><a href="#è®¢é˜…æ¥å£" class="headerlink" title="è®¢é˜…æ¥å£"></a>è®¢é˜…æ¥å£</h1><p>å› ä¸ºæˆ‘ä»¬ä¼šæœ‰å¾ˆå¤šä¸åŒçš„ä»£ç æ–‡ä»¶éƒ½ä¼šç»§æ‰¿è¿™ä¸ªæ¥å£ï¼Œæ€æ ·æ¥ç®¡ç†è®¢é˜…ä¹Ÿæ˜¯å€¼å¾—è€ƒè™‘çš„äº‹æƒ…</p><p>æ‰“å¼€ä¸Šä¸€ç« åˆ›å»ºçš„<code>GameManager.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GameManager</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Sigltion<span class="token punctuation">&lt;</span>GameManager<span class="token punctuation">></span></span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">CharacterStates</span> playerStates<span class="token punctuation">;</span>    <span class="token comment">//æ¸¸æˆç»“æŸæ—¶è°ƒç”¨çš„æ–¹æ³•çš„æ•°ç»„</span>    List<span class="token operator">&lt;</span>IEndGameObserver<span class="token operator">></span>endGameObservers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>IEndGameObserver<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RigisterPlayer</span><span class="token punctuation">(</span><span class="token class-name">CharacterStates</span> player<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//é€šè¿‡å¤–ç•Œæ³¨å†Œçš„æ–¹å¼æ¥è·å¾—å¯¹è±¡çš„playerStates</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>playerStates <span class="token operator">=</span> player<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddObserve</span><span class="token punctuation">(</span><span class="token class-name">IEndGameObserver</span> gameObserver<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åŠ å…¥å¾…æ“ä½œæ•°ç»„</span>        endGameObservers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>gameObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RemoveObserve</span><span class="token punctuation">(</span><span class="token class-name">IEndGameObserver</span> gameObserver<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å°†ç‰¹å®šçš„è§‚å¯Ÿè€…åœ¨å¾…æ“ä½œæ•°ç»„ä¸­åˆ é™¤</span>        endGameObservers<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>gameObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">NotifyObserves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è°ƒç”¨å¾…æ“ä½œæ•°ç»„ä¸­æ¯ä¸€ä¸ªè§‚å¯Ÿè€…</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">IEndGameObserver</span> gameObserver <span class="token keyword">in</span> endGameObservers<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            gameObserver<span class="token punctuation">.</span><span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæˆ‘ä»¬æ˜¯è¦åœ¨ä¸»è§’æ­»äº†ä¹‹åå¼€å§‹æ¸¸æˆç»“æŸçš„æ“ä½œï¼Œæ‰€ä»¥å›åˆ°<code>PlayerController.cs</code>åœ¨åˆ¤æ–­ä¸»è§’æ­»äº†ä¹‹åè°ƒç”¨å¹¿æ’­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">.</span>currentHealth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//åˆ¤æ–­æ­»äº¡</span>        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">NotifyObserves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ—¶æˆ‘ä»¬åœ¨<code>EnemyController.cs</code>ä¸­è¿˜è¦è¡¥å……ä¸€ä¸ªåŠ å…¥å¾…æ“ä½œæ•°ç»„æ–¹æ³•å’Œç§»é™¤æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//void OnEnable()&#123;//Unityçš„ä¸€ä¸ªå¯åŠ¨æ¸¸æˆæ—¶è‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°</span><span class="token comment">//  GameManager.Instance.AddObserve(this);</span><span class="token comment">// &#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å¼€å§‹æ¸¸æˆæ—¶å…ˆæ£€æµ‹æ˜¯å¦å‹¾é€‰äº†å®ˆå«çŠ¶æ€</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isGuard<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">;</span>        <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//FIXME:åœºæ™¯åˆ‡æ¢åšå¥½åä¿®æ”¹æ‰</span>    GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">AddObserve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDisable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>GameManager<span class="token punctuation">.</span>IsInitialized<span class="token punctuation">)</span>         <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœGameManageræ²¡æœ‰ç»™æ„å»ºçš„è¯å°±ç›´æ¥return</span>        GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">RemoveObserve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äº<code>OnEnable()</code>æ˜¯åœ¨æ¸¸æˆå¼€å§‹æ—¶æ—©æœŸå°±è°ƒç”¨çš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¿™æ ·å†™ä¼šå‘ç”ŸæŠ¥é”™ï¼Œæˆ‘ä»¬è¦ç­‰åˆ°åé¢å†™åœºæ™¯åŠ è½½æ—¶æ‰ç”¨è¿™ç§æ–¹æ³•ï¼Œè¿™é‡Œæš‚æ—¶æŠŠåŠ å…¥å¾…æ“ä½œæ•°ç»„ä»£ç å•ç‹¬å†™åˆ°<code>Start()</code>é‡Œ</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/5e902802764e44b099915b6323377dfb.png" alt="1.png" style="zoom:80%;" /><h1 id="é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»"><a href="#é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»" class="headerlink" title="é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»"></a>é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»</h1><p>æˆ‘ä»¬æ‰“å¼€åŠ¨ç”»ç®¡ç†å™¨ï¼Œé…ç½®æ•Œäººåœ¨æ‰“æ­»ä¸»è§’åçš„åŠ¨ç”»</p><p>æ–°å»ºä¸€ä¸ª<code>Victory Layer</code>ï¼ˆæ³¨æ„æƒé‡å€¼ä¸º1ï¼‰ï¼Œä»¥åŠä¸€ä¸ª<code>Win</code>å¸ƒå°”å€¼æ§åˆ¶åŠ¨ç”»è§¦å‘</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/85512e9ac113448c808c81d1b29dc079.png" alt="1.png" style="zoom:80%;" /><p>è¿”å›<code>EnemyController.cs</code>ä»£ç æˆ‘ä»¬è¦é…ç½®åŠ¨ç”»å˜é‡ä»€ä¹ˆæ—¶å€™è§¦å‘</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">.</span>currentHealth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡å˜0åˆ™æ­»äº¡çŠ¶æ€ä¸ºçœŸ</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//åŠ äº†ä¸ªelseæ˜¯é˜²æ­¢æ­»åæ•Œäººåœ¨èƒœåˆ©åŠ¨ç”»ä¸‹ä¸€å¸§åˆç»™åˆ‡æ¢å›æ™®é€šåŠ¨ç”»</span>        <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        lastAttackTime<span class="token operator">-=</span>Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span><span class="token comment">//æ¯ä¸€å¸§éƒ½å‡å†·å´</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è·èƒœåŠ¨ç”»</span>    <span class="token comment">//åœæ­¢æ‰€æœ‰ç§»åŠ¨</span>    <span class="token comment">//åœæ­¢Agent</span>    anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Win"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    attackTarget <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åæˆ‘ä»¬å‘ç°ä¸»è§’æ­»äº†ä¹‹åè¿˜æ˜¯å¯ä»¥æ§åˆ¶ç§»åŠ¨ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨<code>PlyaerController.cs</code>ä¿®å¤ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveToTarget</span><span class="token punctuation">(</span><span class="token class-name">Vector3</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isDead<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœæ­»äº†å°±ä¸èƒ½ç§»åŠ¨</span><span class="token function">StopAllCoroutines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»ˆæ­¢å…¶å®ƒç§»åŠ¨å‘½ä»¤</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> target<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EventAttact</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isDead<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœæ­»äº†å°±ä¸èƒ½ç§»åŠ¨</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœé¼ æ ‡ç‚¹å‡»çš„ç›®æ ‡ä¸ä¸ºç©ºï¼Œæˆ–è€…ç‚¹å‡»çš„æ•Œäººä¸æ˜¯å±äºæ­»äº¡çŠ¶æ€</span>attactTarget <span class="token operator">=</span> target<span class="token punctuation">;</span><span class="token comment">//åˆ¤æ–­æ˜¯å¦æš´å‡»</span>charcterStates<span class="token punctuation">.</span>isCritical <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">&lt;</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>criticalChance<span class="token punctuation">;</span><span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°14-æ³›å‹å•ä¾‹æ¨¡å¼</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B014-%E6%B3%9B%E5%9E%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B014-%E6%B3%9B%E5%9E%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªæ³›å‹å•ä¾‹æ¨¡å¼çš„ä»£ç ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„é¡¹ç›®ä¸­ä¼šæœ‰å¾ˆå¤šçš„<code>Manager</code>ï¼Œå¦‚æœæ¯ä¸ªéƒ½ä½¿ç”¨å•ä¾‹æ¨¡å¼ä¼šæ›´å¥½åœ°å»ç®¡ç†å’Œä½¿ç”¨</p><p>ä¾‹å¦‚å…¶ä¸­æ§åˆ¶æˆ‘ä»¬æ¸¸æˆçš„å¼€å§‹æš‚åœç­‰ä¸€èˆ¬æ˜¯ç”¨<code>Game Manager</code>æ¥å‘½åï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªä»£ç æ–‡ä»¶ä»¥åŠä¸€ä¸ªç©ºå¯¹è±¡ä½¿å¾—ä»£ç å¯ä»¥ä¾é™„åœ¨å®ƒä¸Šé¢</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/d8bf83d3ad554952a66a0b00aafc1b96.png" alt="1.png" style="zoom:80%;" /><p>è¿™ä¸ªä»£ç æˆ‘ä»¬å…ˆæ”¾åœ¨ä¸€è¾¹ä¹‹åå†è¡¥å……ï¼Œå…ˆæŠŠæ³›å‹å•ä¾‹æ¨¡å¼ä»£ç å†™äº†å…ˆ</p><h1 id="æ³›å‹å•ä¾‹æ¨¡å¼"><a href="#æ³›å‹å•ä¾‹æ¨¡å¼" class="headerlink" title="æ³›å‹å•ä¾‹æ¨¡å¼"></a>æ³›å‹å•ä¾‹æ¨¡å¼</h1><p>åˆ›å»ºç›®å½•æ–‡ä»¶å¦‚ä¸‹</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/86a804f3de9a4c9b960af8c63dd89626.png" alt="2.png" style="zoom:80%;" /><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sigltion<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token keyword">where</span> <span class="token class-name">T</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Sigltion<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">T</span> instance<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">T</span> Instance<span class="token punctuation">&#123;</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> instance<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å…è®¸å­ç±»å¯¹Awakeè¿›è¡Œé‡å†™</span>    <span class="token keyword">protected</span> <span class="token keyword">virtual</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>instance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            instance <span class="token operator">=</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ£€æµ‹å•ä¾‹æ˜¯å¦ç”Ÿæˆ</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> IsInitialized<span class="token punctuation">&#123;</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> instance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å…è®¸å­ç±»ä¿®æ”¹é”€æ¯æ—¶çš„æ“ä½œ</span>    <span class="token keyword">protected</span> <span class="token keyword">virtual</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span>            instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ä¸€æ—¦ä¸€ä¸ªAç±»ç»§æ‰¿äº†<code>Sigltion&lt;A&gt;</code>ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶å®ƒç±»ä¸­è°ƒç”¨Aç±»çš„å•ä¾‹ï¼Œå¦‚ï¼š<code>A.Instance</code></p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°13-æ•Œäººçš„å®ˆå«çŠ¶æ€å’Œæ­»äº¡çŠ¶æ€</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B013-%E6%95%8C%E4%BA%BA%E7%9A%84%E5%AE%88%E5%8D%AB%E7%8A%B6%E6%80%81%E5%92%8C%E6%AD%BB%E4%BA%A1%E7%8A%B6%E6%80%81/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B013-%E6%95%8C%E4%BA%BA%E7%9A%84%E5%AE%88%E5%8D%AB%E7%8A%B6%E6%80%81%E5%92%8C%E6%AD%BB%E4%BA%A1%E7%8A%B6%E6%80%81/</url>
      
        <content type="html"><![CDATA[<p> è¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥åˆ¶ä½œæ•Œäººçš„å®ˆå«çŠ¶æ€å’Œæ­»äº¡çŠ¶æ€</p><h1 id="æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰"><a href="#æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰" class="headerlink" title="æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰"></a>æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰</h1><p>æ‰“å¼€<code>EnemyController.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token class-name">Quaternion</span> guardRotation<span class="token punctuation">;</span><span class="token comment">//è®°å½•æ•Œäººæœ€åˆçš„æ—‹è½¬è§’åº¦ï¼Œç”¨äºè„±ç¦»è¿½å‡»å›å»å®ˆå«ç‚¹ç –å¤´è½¬å¤´</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    guardRotation <span class="token operator">=</span> transform<span class="token punctuation">.</span>rotation<span class="token punctuation">;</span><span class="token comment">//è·å¾—æœ€åˆæ—‹è½¬è§’åº¦</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>å®ˆå«çŠ¶æ€            isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è„±ç¦»è¿½å‡»çŠ¶æ€</span>            <span class="token comment">//å¦‚æœåœ¨è¿½å‡»ä¸»è§’æ—¶å›åˆ°å®ˆå«çŠ¶æ€ï¼Œå°±è¦è·‘å›å®ˆå«ç‚¹</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position <span class="token operator">!=</span> guardPos<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                isWalk <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ’­æ”¾èµ°è·¯åŠ¨ç”»</span>                agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token comment">//å¯¼èˆªå›æœ€åˆå®ˆå«ç‚¹</span>                agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> guardPos<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">SqrMagnitude</span><span class="token punctuation">(</span>guardPos <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">&lt;=</span>agent<span class="token punctuation">.</span>stoppingDistance<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//SqrMagnitudeä¹Ÿæ˜¯å¯ä»¥ç”¨äºæ¯”è¾ƒè·ç¦»çš„æ–¹æ³•ï¼Œæ¯”èµ·Distanceç¨å¾®å¿«ä¸€äº›</span>                    <span class="token comment">//è¿™é‡Œæ˜¯åˆ¤æ–­æ˜¯å¦åˆ°è¾¾æœ€åˆå®ˆå«ç‚¹å¯ä»¥åœæ­¢èŒƒå›´</span>                    isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                    <span class="token comment">//æ…¢æ…¢è½¬å¤´ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°è¶Šæ¥è¿‘1è½¬å¾—è¶Šå¿«</span>                    transform<span class="token punctuation">.</span>rotation <span class="token operator">=</span> Quaternion<span class="token punctuation">.</span><span class="token function">Lerp</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">,</span>guardRotation<span class="token punctuation">,</span><span class="token number">0.01f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬å°±å†™å¥½äº†å®ˆå«çŠ¶æ€çš„ä»£ç ï¼Œå…¶ä¸­<code>SqrMagnitude()</code>ä½œç”¨å’Œ<code>Distance()</code>ä¸€æ ·éƒ½æ˜¯æ¯”è¾ƒä¸¤ä¸ªç‚¹çš„è·ç¦»ï¼Œç„¶åæˆ‘ä»¬è¿˜åŠ äº†æ…¢æ…¢è½¬å¤´çš„æ•ˆæœï¼Œå¦åˆ™æ•Œäººå›åˆ°å®ˆå«ç‚¹æ˜¯ä¸ä¼šè½¬å¤´çš„</p><h1 id="æ­»äº¡çŠ¶æ€"><a href="#æ­»äº¡çŠ¶æ€" class="headerlink" title="æ­»äº¡çŠ¶æ€"></a>æ­»äº¡çŠ¶æ€</h1><p>æˆ‘ä»¬å¸Œæœ›å½“æ•Œäººè¡€é‡ä¸º0æ—¶æ’­æ”¾æ­»äº¡åŠ¨ç”»å¹¶ä¸”å°¸ä½“æ¶ˆå¤±æ‰</p><h2 id="è®¾ç½®æ­»äº¡åŠ¨ç”»"><a href="#è®¾ç½®æ­»äº¡åŠ¨ç”»" class="headerlink" title="è®¾ç½®æ­»äº¡åŠ¨ç”»"></a>è®¾ç½®æ­»äº¡åŠ¨ç”»</h2><p>æ‰“å¼€åŠ¨ç”»æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª<code>Death Layer</code>ï¼Œä¸è¦å¿˜äº†æƒé‡è®¾ä¸º1</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/32be87ac0205413280a7f42a61d7296e.png" alt="1.png" style="zoom:80%;" /><p>è¿™é‡Œæœ‰ä¸ª<code>GetHit</code>æ˜¯ç”¨æ¥åšæš´å‡»ä¼¤å®³å—ä¼¤æ•ˆæœçš„ï¼Œå®ƒæœ‰å·¦è¾¹çš„<code>Hit</code>è§¦å‘ï¼Œè€Œæˆ‘ä»¬çš„æ­»äº¡åŠ¨ç”»<code>Die</code>è¿ç€<code>Any State</code>è¡¨ç¤ºä»»ä½•çŠ¶æ€éƒ½èƒ½è½¬ç§»è¿‡æ¥ï¼Œç”±å¸ƒå°”å€¼<code>Death</code>æ§åˆ¶</p><p><strong>ç‰¹åˆ«è¦æ³¨æ„çš„åœ°æ–¹ï¼š</strong>å…³äºæ­»äº¡åŠ¨ç”»çš„è®¾ç½®<code>Can Transition To</code>ä¸€å®šä¸èƒ½å‹¾é€‰ï¼Œä¸ç„¶ä¼šå‘ç”Ÿé¬¼ç•œ</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/497e554f53c24b17be551acb0694058c.png" alt="2.png" style="zoom:80%;" /><p>æ¥ä¸‹æ¥ä¸»è§’çš„åŠ¨ç”»ä¹Ÿæ˜¯å¦‚æ­¤è®¾ç½®</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/66e702dd2c644d058b5e628fbcf052c6.png" alt="3.png" style="zoom:80%;" /><h2 id="ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç "><a href="#ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç " class="headerlink" title="ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç "></a>ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç </h2><p>å›åˆ°æˆ‘ä»¬çš„<code>EnemyController.cs</code>ä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token class-name">Collider</span> collider<span class="token punctuation">;</span><span class="token comment">//ç¢°æ’ä½“ç»„ä»¶</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isDead<span class="token punctuation">;</span><span class="token comment">//æ­»äº¡çŠ¶æ€æ§åˆ¶</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    collider <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Collider<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">.</span>currentHealth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡å˜0åˆ™æ­»äº¡çŠ¶æ€ä¸ºçœŸ</span>    <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Death"</span><span class="token punctuation">,</span>isDead<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦æ’­æ”¾æ­»äº¡åŠ¨ç”»</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç¬¬ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºæ­»äº¡</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isDead<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœå‘ç°player åˆ‡æ¢åˆ°CHASE</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">;</span>        <span class="token comment">//Debug.LogFormat("æ•Œäºº&#123;0&#125;å‘ç°äº†ç©å®¶",this.name);//æµ‹è¯•ä»£ç </span>    <span class="token punctuation">&#125;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>    collider<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢æ—¶å€™å¼€ä¸šå†æ¬¡æ”»å‡»</span>    agent<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ç›´æ¥å…³é—­å¯¼èˆªç»„ä»¶</span>    <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">,</span><span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é”€æ¯æ¸¸æˆå¯¹è±¡ï¼Œå»¶è¿Ÿä¸º2ç§’</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬è®¾ç½®äº†<code>Death</code>çš„åŠ¨ç”»çŠ¶æ€ï¼Œæ³¨æ„å¼€å¤´<code>if(isDead)</code>çš„ä¸‹ä¸€ä¸ªæ˜¯<code>else if</code>ï¼Œè€Œ<code>Hit</code>çš„çŠ¶æ€å¯ä»¥å»åˆ°<code>CharcterStates.cs</code>ä¸­è®¾ç½®</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharcterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharcterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³æ•°å€¼</span>    <span class="token comment">//å½“å‰æ”»å‡»åŠ›å‡å»ç›®æ ‡çš„é˜²å¾¡åŠ›ï¼Œå¦‚æœé˜²å¾¡åŠ›è¿‡é«˜å°±æ˜¯0ä¼¤å®³</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡ä¹Ÿæ˜¯æœ€å°å€¼é”åœ¨0</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isCritical<span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­è¢«æ‰“è€…æ˜¯å¦å—åˆ°æš´å‡»å¹¶ä¸”æ’­æ”¾å—ä¼¤åŠ¨ç”»</span>        defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å°†æ¥è¦åšçš„äº‹æƒ…</span>    <span class="token comment">//TODO:è¡€é‡æ¡UI</span>    <span class="token comment">//TODO:æ‰“æ­»æ€ªååŠ ç»éªŒ</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸­é—´æˆ‘ä»¬æ‰“äº†ä¸€è¡Œä»£ç ï¼Œç”¨æ¥è·å–è¢«æ‰“è€…çš„Animatorå¹¶è®¾ç½®åŠ¨ç”»<code>Hit</code>çŠ¶æ€ï¼Œè¿™æ ·å°±å¯ä»¥é›†ä¸­ç®¡ç†æš´å‡»å—ä¼¤åŠ¨ç”»äº†</p><p>æœ€åå¯¹äºä¸»è§’æˆ‘ä»¬ä¹Ÿç”¨ç›¸åŒçš„åŠæ³•æ¥å†™è¿™äº›ä»£ç å°±å¤§åŠŸå‘Šæˆäº†</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°12-å®ç°æ”»å‡»æ•°å€¼è®¡ç®—</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B012-%E5%AE%9E%E7%8E%B0%E6%94%BB%E5%87%BB%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B012-%E5%AE%9E%E7%8E%B0%E6%94%BB%E5%87%BB%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/</url>
      
        <content type="html"><![CDATA[<p> è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥å®ç°æ”»å‡»ä¼¤å®³çš„è®¡ç®—ï¼Œç»™äºˆäººç‰©æˆ–æ•ŒäººçœŸå®çš„æ”»å‡»ä¼¤å®³</p><h1 id="è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»"><a href="#è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»" class="headerlink" title="è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»"></a>è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»</h1><p>åœ¨ä¹‹å‰æˆ‘ä»¬è¦ç»™äººç‰©æ·»åŠ ä¸€ä¸‹æš´å‡»åŠ¨ç”»ï¼Œå’Œä¸Šä¸€ç« èŠ‚è®¾ç½®æ•ŒäººåŠ¨ç”»ç±»ä¼¼ï¼Œæ³¨æ„è¦è®¾ç½®åŠ¨ç”»åˆ‡æ¢æ•ˆæœ</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/db2c7f3914614d4ea5ec93211e2b47a7.png" alt="1.png" style="zoom:80%;" /><p>æ‰“å¼€<code>PlayerController.cs</code>ï¼Œä¿®æ”¹ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">></span>          charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>attackRange<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ¯”è¾ƒäººç‰©å’Œæ•Œäººçš„è·ç¦»æ˜¯å¦å¤§äº0æ”»å‡»è·ç¦»ï¼ŒDistance()å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªVector3è·ç¦»</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token comment">//æ”»å‡»åŠ¨ç”»å’ŒCDéƒ½åœ¨ä¸‹é¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>lastAttactTime<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//CDå†·å´å®Œæˆå¯æ‰§è¡Œæ”»å‡»</span>        animator<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Critical"</span><span class="token punctuation">,</span>charcterStates<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¢åŠ äº†ä¼ é€’æ˜¯å¦æš´å‡»</span>        animator<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Attack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ™®é€šæ”»å‡»</span>        lastAttactTime <span class="token operator">=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>coolDown<span class="token punctuation">;</span><span class="token comment">//ä¿®æ”¹äº†è¿™é‡Œçš„CDæ—¶é—´</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬ä¿®æ”¹äº†ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯å¢åŠ äº†æš´å‡»åˆ¤æ–­ï¼Œå¦ä¸€ä¸ªæ˜¯ä¿®æ”¹äº†CDæ—¶é—´åˆ¤æ–­</p><h1 id="å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—"><a href="#å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—" class="headerlink" title="å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—"></a>å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—</h1><p>å‰é¢è¡¥å……å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼æ¥å†™æ”»å‡»ä¼¤å®³çš„æ•°å€¼è®¡ç®—äº†</p><p>æ‰“å¼€<code>CharcterStates.cs</code>ï¼Œæˆ‘ä»¬åœ¨æœ€ä¸‹é¢åŠ ä¸Šæˆ‘ä»¬çš„ä¼¤å®³è®¡ç®—ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EventAttact</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœé¼ æ ‡ç‚¹å‡»çš„ç›®æ ‡ä¸ä¸ºç©ºï¼Œæˆ–è€…ç‚¹å‡»çš„æ•Œäººä¸æ˜¯å±äºæ­»äº¡çŠ¶æ€</span>        attactTarget <span class="token operator">=</span> target<span class="token punctuation">;</span>        <span class="token comment">//éšæœºæš´å‡»ç‡è¯­å¥</span>        charcterStates<span class="token punctuation">.</span>isCritical <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">&lt;</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>criticalChance<span class="token punctuation">;</span>        <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//ä¼¤å®³è®¡ç®—åŒº</span><span class="token preprocessor property">#<span class="token directive keyword">region</span> Charcter Combat</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharcterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharcterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³æ•°å€¼</span>    <span class="token comment">//å½“å‰æ”»å‡»åŠ›å‡å»ç›®æ ‡çš„é˜²å¾¡åŠ›ï¼Œå¦‚æœé˜²å¾¡åŠ›è¿‡é«˜å°±æ˜¯0ä¼¤å®³</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡ä¹Ÿæ˜¯æœ€å°å€¼é”åœ¨0</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­è¢«æ‰“è€…æ˜¯å¦å—åˆ°æš´å‡»å¹¶ä¸”æ’­æ”¾å—ä¼¤åŠ¨ç”»</span>            defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†æ¥è¦åšçš„äº‹æƒ…</span>    <span class="token comment">//TODO:è¡€é‡æ¡UI</span>    <span class="token comment">//TODO:æ‰“æ­»æ€ªååŠ ç»éªŒ</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//åœ¨æ”»å‡»åŠ›èŒƒå›´å†…å–éšæœºæ•°è¿”å›ä¸€ä¸ªéšæœºæ”»å‡»åŠ›</span>    <span class="token class-name"><span class="token keyword">float</span></span> coreDamage <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>attackData<span class="token punctuation">.</span>minDamage<span class="token punctuation">,</span>attackData<span class="token punctuation">.</span>maxDamage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isCritical<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœæš´å‡»çš„è¯è¿˜è¦è®¡ç®—ä¸Šæš´å‡»ç‡</span>        coreDamage <span class="token operator">*=</span>attackData<span class="token punctuation">.</span>criticalMultiplier<span class="token punctuation">;</span><span class="token comment">//ä¹˜ç­‰äº</span>        Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"æš´å‡»äº†ï¼ä¼¤å®³ä¸ºï¼ˆä¸ç®—ç›®æ ‡é˜²å¾¡åŠ›ï¼‰ï¼š&#123;0&#125;"</span><span class="token punctuation">,</span>coreDamage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>coreDamage<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•"><a href="#è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•" class="headerlink" title="è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•"></a>è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•</h1><p>ä¼¤å®³è®¡ç®—ä»£ç å†™å¥½åï¼Œæˆ‘ä»¬å°±è¦å»æƒ³å¦‚ä½•è°ƒç”¨å®ƒï¼Œåœ¨å“ªé‡Œè°ƒç”¨å®ƒäº†</p><p>å‚è€ƒä¸€äº›RPGæ¸¸æˆï¼Œä¸€èˆ¬éƒ½æ˜¯å½“ä½ çš„æ­¦å™¨æŒ¥å‡ºå»åæ¥è§¦åˆ°æ•Œäººé‚£ä¸€ç¬é—´è®¡ç®—ä¼¤å®³ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰ç…§è¿™æ ·æ¥åš</p><h2 id="åœ¨äººç‰©èº«ä¸Šè°ƒç”¨"><a href="#åœ¨äººç‰©èº«ä¸Šè°ƒç”¨" class="headerlink" title="åœ¨äººç‰©èº«ä¸Šè°ƒç”¨"></a>åœ¨äººç‰©èº«ä¸Šè°ƒç”¨</h2><p>é¦–å…ˆè¦è°ƒå‡º<code>Animation</code>çª—å£</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/42623310028b4fbcafc6c49ce9fbc6a6.png" alt="2.png" style="zoom:80%;" /><p>ç„¶åçª—å£å·¦ä¸Šè§’é€‰æ‹©ä¸Šæˆ‘ä»¬çš„æ”»å‡»åŠ¨ç”»<code>Attack01</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æ”»å‡»åŠ¨ç”»é‡Œé¢çš„æŸä¸ªç‰¹å®šå¸§æ·»åŠ äº‹ä»¶äº†</p><p>æˆ‘ä»¬å†æ¬¡ç¼–è¾‘ä¸€ä¸‹<code>PlayerController.cs</code>ä»£ç åŠ ä¸€ä¸ªç”¨æ¥è°ƒç”¨çš„æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//Animation Event</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³</span>    targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å›åˆ°<code>Animation</code>çª—å£ï¼Œå°†å®ƒæ·»åŠ ä¸ºäº‹ä»¶</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/3ebdba5a85864a339407b9a8d21a740f.png" alt="4.png" style="zoom:80%;" /><p><strong>æ³¨æ„ï¼šåŒæ ·çš„æš´å‡»åŠ¨ç”»ä¹Ÿè¦åŠ ä¸Š</strong></p><h2 id="åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨"><a href="#åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨" class="headerlink" title="åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨"></a>åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨</h2><p>ç„¶ååœ¨æ•Œäººèº«ä¸Šæˆ‘ä»¬ä¹Ÿè¦è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œæ‰“å¼€<code>EnemyController.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//EnemyController.cs</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç”±äºåœ¨æ•Œäººè¿½ä¸»è§’çš„è¿‡ç¨‹ä¸­ä¸»è§’å¯èƒ½ä¼šè·‘å¼€ï¼Œè¿™æ—¶å€™å¦‚æœæ”»å‡»çš„è¯ç›®æ ‡å°±ä¸¢å¤±äº†</span>    <span class="token comment">//æ‰€ä»¥æˆ‘ä»¬åœ¨æ”»å‡»å‰åˆ¤æ–­ç›®æ ‡æ˜¯å¦ä¸ºç©ºï¼Œä»¥é˜²æŠ¥é”™</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨ä¸º<code>Animation</code>æ·»åŠ åŠ¨ç”»æ—¶æˆ‘ä»¬å‘ç°å½“å‰å²è±å§†çš„åŠ¨ç”»æ˜¯<code>åªè¯»</code>å±æ€§çš„ï¼Œå¯¹äºè¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥æŠŠåŠ¨ç”»å•ç‹¬å¤åˆ¶åˆ°å…¶å®ƒåœ°æ–¹ï¼Œå†å°†å¤åˆ¶å‡ºæ¥çš„åŠ¨ç”»æ›¿æ¢åŸæ¥çš„ï¼Œå°±å¯ä»¥è¿›è¡Œäº‹ä»¶æ·»åŠ äº†</p><p>å¦‚å›¾å¯¹ç€åŠ¨ç”»æ–‡ä»¶æŒ‰<code>Ctrl+D</code>å¯ä»¥å¿«é€Ÿå¤åˆ¶</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/3831ed71b8dc46cc8d7ce464438e15b3.png" alt="5.png" style="zoom:80%;" /><p>ç„¶åæˆ‘ä»¬å°†å¤åˆ¶å‡ºæ¥çš„åŠ¨ç”»ï¼ˆè¿™é‡Œæœ‰ä¸¤ä¸ªï¼‰åˆ†ç±»æ”¾å¥½</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/cded851a377744a2a2c53f78e2573698.png" alt="6.png" style="zoom:80%;" /><p>ç„¶åè¿›è¡ŒåŠ¨ç”»æ›¿æ¢</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/99667e3e7b754c4f8b286410045bac15.png" alt="7.png" style="zoom:80%;" /><p>æœ€åå†è¿›è¡ŒåŠ¨ç”»å¸§äº‹ä»¶æ·»åŠ æ“ä½œå°±è¡Œäº†</p><p>åˆ°è¿™æˆ‘ä»¬å°±æŠŠä¼¤å®³è®¡ç®—ä»£ç å’Œæ•ˆæœéƒ½å†™å‡ºæ¥äº†ï¼Œä¸‹ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬è¿˜ä¼šå»è¡¥å……å¦‚æœæ•Œäººæˆ–äººç‰©è¡€é‡åˆ°0äº†æ—¶å€™çš„çŠ¶æ€</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ</title>
      <link href="LeetCode/LeetCode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%9C%9F/"/>
      <url>LeetCode/LeetCode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%9C%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ"><a href="#LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ" class="headerlink" title="LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ"></a>LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰ä¸€ç›´æƒ³åœ¨åˆ·é¢˜çš„æ—¶å€™æŠŠæƒ³è¦è®°ä¸‹çš„ç¬”è®°è®°ä¸‹æ¥ï¼Œä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°å¾ˆå¥½çš„åœ°æ–¹ï¼Œä½†æ˜¯ç°åœ¨æœ‰äº†åšå®¢ä¹‹åå°±å¯ä»¥å†™åœ¨è¿™çš„</p><p>å†™è¿™ä¸ªåˆ·é¢˜ç¬”è®°ä¸€ä¸ªæ˜¯æƒ³æ—¶ä¸æ—¶å›æ¥å·©å›ºä¸€ä¸‹ç®—æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯æƒ³è®°å½•ä¸‹è‡ªå·±çš„ç®—æ³•èƒ½åŠ›æˆé•¿çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æƒ³ä¸ºå®ä¹ åšå‡†å¤‡</p><p>å†™è¿™ä¸ªç¬”è®°æ˜¯å¤§äºŒæš‘å‡æ—¶æœŸï¼Œä¹‹å‰ä¹Ÿæœ‰ä¸€äº›ç®—æ³•åŸºç¡€ï¼Œå‚åŠ è¿‡çš„ç®—æ³•ç›¸å…³ç«èµ›åªæœ‰ä¸€æ¬¡è“æ¡¥æ¯ï¼Œä¹Ÿå¸Œæœ›èƒ½å¤Ÿé€šè¿‡åˆ·é¢˜å’Œåšç¬”è®°èƒ½å¤Ÿæœ‰æ‰€é•¿è¿›</p><p>âœ¨æ³¨ï¼šæˆ‘å†™ç®—æ³•çš„è¯­è¨€ä¸»æ‰“C++</p><p>é‚£ä¹ˆï¼Œå°±å¼€å§‹å§ï¼</p><hr><h1 id="è´ªå¿ƒ"><a href="#è´ªå¿ƒ" class="headerlink" title="è´ªå¿ƒ"></a>è´ªå¿ƒ</h1><h2 id="452-ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"><a href="#452-ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ" class="headerlink" title="452.ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"></a>452.<a href="https://leetcode-cn.com/problems/minimum-number-of-arrows-to-burst-balloons/">ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ</a></h2><p>åœ¨äºŒç»´ç©ºé—´ä¸­æœ‰è®¸å¤šçƒå½¢çš„æ°”çƒã€‚å¯¹äºæ¯ä¸ªæ°”çƒï¼Œæä¾›çš„è¾“å…¥æ˜¯æ°´å¹³æ–¹å‘ä¸Šï¼Œæ°”çƒç›´å¾„çš„å¼€å§‹å’Œç»“æŸåæ ‡ã€‚ç”±äºå®ƒæ˜¯æ°´å¹³çš„ï¼Œæ‰€ä»¥çºµåæ ‡å¹¶ä¸é‡è¦ï¼Œå› æ­¤åªè¦çŸ¥é“å¼€å§‹å’Œç»“æŸçš„æ¨ªåæ ‡å°±è¶³å¤Ÿäº†ã€‚å¼€å§‹åæ ‡æ€»æ˜¯å°äºç»“æŸåæ ‡ã€‚</p><p>ä¸€æ”¯å¼“ç®­å¯ä»¥æ²¿ç€ x è½´ä»ä¸åŒç‚¹å®Œå…¨å‚ç›´åœ°å°„å‡ºã€‚åœ¨åæ ‡ x å¤„å°„å‡ºä¸€æ”¯ç®­ï¼Œè‹¥æœ‰ä¸€ä¸ªæ°”çƒçš„ç›´å¾„çš„å¼€å§‹å’Œç»“æŸåæ ‡ä¸º <code>xstart</code>ï¼Œ<code>xend</code>ï¼Œ ä¸”æ»¡è¶³  <code>xstart</code> â‰¤ x â‰¤ <code>xend</code>ï¼Œåˆ™è¯¥æ°”çƒä¼šè¢«å¼•çˆ†ã€‚å¯ä»¥å°„å‡ºçš„å¼“ç®­çš„æ•°é‡æ²¡æœ‰é™åˆ¶ã€‚ å¼“ç®­ä¸€æ—¦è¢«å°„å‡ºä¹‹åï¼Œå¯ä»¥æ— é™åœ°å‰è¿›ã€‚æˆ‘ä»¬æƒ³æ‰¾åˆ°ä½¿å¾—æ‰€æœ‰æ°”çƒå…¨éƒ¨è¢«å¼•çˆ†ï¼Œæ‰€éœ€çš„å¼“ç®­çš„æœ€å°æ•°é‡ã€‚</p><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ points ï¼Œå…¶ä¸­ points [i] = [xstart,xend] ï¼Œè¿”å›å¼•çˆ†æ‰€æœ‰æ°”çƒæ‰€å¿…é¡»å°„å‡ºçš„æœ€å°å¼“ç®­æ•°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼špoints = [[10,16],[2,8],[1,6],[7,12]]<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼šå¯¹äºè¯¥æ ·ä¾‹ï¼Œx = 6 å¯ä»¥å°„çˆ† [2,8],[1,6] ä¸¤ä¸ªæ°”çƒï¼Œä»¥åŠ x = 11 å°„çˆ†å¦å¤–ä¸¤ä¸ªæ°”çƒ</p></blockquote><p>è¿™ä¸€é¢˜æ‹¿åˆ°é¢˜ç›®æ—¶çœ‹äº†å¥½å‡ æ¬¡éƒ½çœ‹ä¸æ‡‚é¢˜ç›®ï¼Œçœ‹äº†ä¸€ä¸‹åˆ«äººç”»çš„å›¾æ‰æ˜ç™½é¢˜çš„æ„æ€ï¼Œå’Œå¦å¤–é¢˜ <code>435. æ— é‡å åŒºé—´</code>æœ‰ç‚¹ç›¸ä¼¼</p><p>æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸€æ¬¡å°„å‡»ç®­çš„æ—¶å€™å°½é‡å¾€ç”¨å°‘ä¸€ç‚¹çš„æ–¹å‘å»æƒ³ï¼Œå½“æ°”çƒé‡å æ—¶ä¾¿ä¸€èµ·å°„ï¼Œè¿™æ˜¯å±€éƒ¨æœ€ä¼˜ï¼Œç„¶åæ¯æ¬¡å±€éƒ¨æœ€ä¼˜æ‰€é€ æˆçš„å°±æ˜¯å…¨å±€æœ€ä¼˜ï¼Œå°„å®Œå…¨éƒ¨æ°”çƒæ‰€ç”¨çš„å¼“ç®­æ˜¯æœ€å°‘ï¼Œè¿™ä¾¿å¯ä»¥ç”¨è´ªå¿ƒç®—æ³•æ¥æ±‚è§£</p><p>å€Ÿç”¨å®˜æ–¹è§£ç­”æ‰€ç»™çš„å›¾æ¥è§£é‡Š</p><p><img src="https://p9-tt.byteimg.com/origin/pgc-image/f83bd4a2e87746078b4cac68d1f4d1d5.png"></p><p>å½“æŠŠå¼“ç®­æŒªåˆ°å³åŒºé—´æœ€å°çš„æ—¶å€™ï¼ˆå¦‚ç¬¬ä¸‰ä¸ªå›¾çš„è“è‰²ï¼‰å°±å¯ä»¥ä¸€ç®­å››é›•ï¼Œå› ä¸ºé¢˜ç›®æ‰€ç»™çš„æ¡ä»¶<code>xstart</code> â‰¤ x â‰¤ <code>xend</code>æ—¶æ°”çƒå°±ä¼šç»™å°„çˆ†ï¼Œè¿™é‡ŒåŒ…å«äº†è¾¹ç•Œå€¼æ¡ä»¶ï¼Œæ‰€ä»¥åœ¨é—­åŒºé—´ä½ç½®ä¹Ÿæ»¡è¶³</p><p>å› æ­¤æˆ‘å°±æœ‰äº†åŸºæœ¬æ€è·¯ï¼Œå…ˆæŠŠè¿™äº›æ°”çƒæ’åˆ—ï¼Œç„¶åä»ç¬¬äºŒä¸ªæ°”çƒéå†ï¼Œæ¯æ¬¡ä¸å‰ä¸€ä¸ªæ°”çƒä½œæ¯”è¾ƒï¼Œå¦‚æœä¸¤ä¸ªæ°”çƒåŒºé—´ç›¸äº¤ï¼Œé‚£å°±å¯ä»¥ç•¥è¿‡å½“å‰æ°”çƒè¿›å…¥ä¸‹ä¸€æ¬¡æ¯”è¾ƒï¼ˆåšä¸ªæ ‡è®°ï¼Œä»£è¡¨å¯ä»¥åœ¨è¿™ä¸€ä¸ªå¼“ç®­å°„å®Œï¼‰ï¼Œå…·ä½“å¦‚ä½•ç•¥è¿‡çœ‹ä»£ç ï¼›å¦‚æœæ°”çƒä¸ç›¸äº¤äº†ï¼Œé‚£å°±è¯æ˜è¦ç”¨å¤šä¸€å‘å¼“ç®­äº†ï¼Œæ­¤æ—¶å¼“ç®­æ•°è¦åŠ ä¸€ï¼Œç„¶åç»§ç»­å¾€ä¸‹æ¯”è¾ƒ</p><p>ä¸‹é¢æ˜¯è‡ªå·±å‚è€ƒåˆ«äººè§£ç­”åå†™å‡ºæ¥çš„ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">VecSort</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">findMinArrowShots</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> points<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> size <span class="token operator">=</span> points<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>size<span class="token punctuation">)</span><span class="token comment">//æ•°ç»„ä¸ºç©º</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token function">sort</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>points<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>VecSort<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æŒ‰æ°”çƒèµ·ç‚¹è¿›è¡Œä»å°åˆ°å¤§æ’åº</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›ç»“æœï¼Œä¸ä¸ºç©ºè‡³å°‘éœ€è¦ä¸€åªç®­</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ä»å‰å¾€åéå†æ°”çƒ</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">></span>points<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å½“å‰æ°”çƒä¸å‰ä¸€ä¸ªæ°”çƒä¸é‡å </span>                res<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//é‡å åˆ™è·³è¿‡å½“å‰æ°”çƒ</span>                <span class="token comment">//ï¼ˆåˆ©ç”¨é—­åŒºé—´æœ€å³ä½ç½®å¯ä»¥å°„åˆ°çš„è§„åˆ™è®©å…¶é•¿åº¦å˜çŸ­ï¼Œä»¥è¾¾åˆ°å¯è·³è¿‡çš„å½“å‰æ°”çƒç›®çš„ï¼‰</span>                points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>std<span class="token operator">::</span><span class="token function">min</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>points<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·åšå‡ºæ¥ä¹‹åæ—¶é—´å¤æ‚åº¦ä¸º<em>O(nlogn)<em>å› ä¸ºç”¨äº†ä¸ªå¿«æ’ï¼Œç©ºé—´å¤æ‚åº¦ä¸º</em>O(1)</em></p><img src="https://p6-tt.byteimg.com/origin/pgc-image/3af7d43845b04870bda4754ca1805c0e.jpg" alt="452.jpg" style="zoom:80%;" /><hr><h2 id="763-åˆ’åˆ†å­—æ¯åŒºé—´"><a href="#763-åˆ’åˆ†å­—æ¯åŒºé—´" class="headerlink" title="763. åˆ’åˆ†å­—æ¯åŒºé—´"></a><a href="https://leetcode-cn.com/problems/partition-labels/">763. åˆ’åˆ†å­—æ¯åŒºé—´</a></h2><p>å­—ç¬¦ä¸² <code>S</code> ç”±å°å†™å­—æ¯ç»„æˆã€‚æˆ‘ä»¬è¦æŠŠè¿™ä¸ªå­—ç¬¦ä¸²åˆ’åˆ†ä¸ºå°½å¯èƒ½å¤šçš„ç‰‡æ®µï¼ŒåŒä¸€å­—æ¯æœ€å¤šå‡ºç°åœ¨ä¸€ä¸ªç‰‡æ®µä¸­ã€‚è¿”å›ä¸€ä¸ªè¡¨ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²ç‰‡æ®µçš„é•¿åº¦çš„åˆ—è¡¨ã€‚</p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼šS = â€œababcbacadefegdehijhklijâ€<br>è¾“å‡ºï¼š[9,7,8]<br>è§£é‡Šï¼š<br>åˆ’åˆ†ç»“æœä¸º â€œababcbacaâ€, â€œdefegdeâ€, â€œhijhklijâ€ã€‚<br>æ¯ä¸ªå­—æ¯æœ€å¤šå‡ºç°åœ¨ä¸€ä¸ªç‰‡æ®µä¸­ã€‚<br>åƒ â€œababcbacadefegdeâ€, â€œhijhklijâ€ çš„åˆ’åˆ†æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºåˆ’åˆ†çš„ç‰‡æ®µæ•°è¾ƒå°‘ã€‚</p></blockquote><p>è¿™ç§é¢˜å‹ç¬¬ä¸€æ¬¡è§ï¼Œä¸æ€ä¹ˆä¼šï¼Œå› ä¸ºå°½å¯èƒ½åœ°è¦åˆ’åˆ†å¤šä¸ªåŒºåŸŸï¼Œä»è€Œè¾¾åˆ°æŸä¸ªæˆ–å¤šä¸ªå­—æ¯åªå‡ºç°åœ¨è¿™ç‰‡åŒºåŸŸä¸­ï¼Œé‚£ä¹ˆå°±å¯ä»¥å…ˆè®°å½•ä¸‹æ¯ä¸ªå­—æ¯æœ€åå‡ºç°çš„ä½ç½®</p><p>ç„¶åå†æ¬¡éå†å­—ç¬¦ä¸²ï¼Œä¸æ–­æ›´æ–°æ ‡è¯†ç¬¦<code>end</code>ï¼Œè¯¥æ ‡è¯†ç¬¦æŒ‡å‘çš„æ˜¯å½“å‰éå†è¿‡çš„å­—æ¯ä¸­ï¼Œæœ€æŒä¹…çš„å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®ï¼Œä¹Ÿç›¸å½“äºæ˜¯è¿™ç‰‡åŒºåŸŸæœ€åçš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬åªç”¨æ‰¾å‡ºè¿™ä¸ªæ ‡è¯†ç¬¦æœ€ç»ˆçš„ä½ç½®å°±èƒ½å¤Ÿåˆ’åˆ†ä¸€ä¸ªåŒºåŸŸå‡ºæ¥äº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">partitionLabels</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> str_size <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>str_size<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str_size <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span>res<span class="token punctuation">;</span>        <span class="token keyword">int</span> map<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ¯ä¸ªå­—æ¯æœ€åå‡ºç°çš„ä½ç½®</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str_size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            map<span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> end<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•åˆ†å‰²æ•°æ®çš„å¼€å¤´å’Œç»“å°¾ä½ç½®</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str_size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            end <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">max</span><span class="token punctuation">(</span>end<span class="token punctuation">,</span>map<span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è´ªå¿ƒç­–ç•¥åœ°æ–¹ï¼Œå°½å¯èƒ½æ‰¾åˆ°å­—æ¯æœ€åå‡ºç°çš„ä½ç½®ä»è€Œåˆ’åˆ†åŒºåŸŸ</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> end<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å¦‚æœæ‰¾åˆ°ä¹‹å‰éå†è¿‡çš„æ‰€æœ‰å­—æ¯çš„æœ€è¿œè¾¹ç•Œï¼Œè¯´æ˜è¿™ä¸ªè¾¹ç•Œå°±æ˜¯åˆ†å‰²ç‚¹äº†</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>end<span class="token operator">-</span>start<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                start <span class="token operator">=</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦<em>O(n)<em>ï¼Œç©ºé—´å¤æ‚åº¦</em>O(1)</em></p><img src="https://p5-tt.byteimg.com/origin/pgc-image/c6d28e63caa845aba5e8479b6f016d58.jpg" alt="763.jpg" style="zoom:80%;" /><hr><h1 id="åŒæŒ‡é’ˆ"><a href="#åŒæŒ‡é’ˆ" class="headerlink" title="åŒæŒ‡é’ˆ"></a>åŒæŒ‡é’ˆ</h1><h2 id="88-åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„â€”ï¼ˆç®€å•ï¼‰"><a href="#88-åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„â€”ï¼ˆç®€å•ï¼‰" class="headerlink" title="88. åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„â€”ï¼ˆç®€å•ï¼‰"></a><a href="https://leetcode-cn.com/problems/merge-sorted-array/">88. åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„</a>â€”ï¼ˆç®€å•ï¼‰</h2><p>ç»™ä½ ä¸¤ä¸ªæœ‰åºæ•´æ•°æ•°ç»„ nums1 å’Œ nums2ï¼Œè¯·ä½ å°† nums2 åˆå¹¶åˆ° nums1 ä¸­ï¼Œä½¿ nums1 æˆä¸ºä¸€ä¸ªæœ‰åºæ•°ç»„ã€‚</p><p>åˆå§‹åŒ– nums1 å’Œ nums2 çš„å…ƒç´ æ•°é‡åˆ†åˆ«ä¸º m å’Œ n ã€‚ä½ å¯ä»¥å‡è®¾ nums1 çš„ç©ºé—´å¤§å°ç­‰äº m + nï¼Œè¿™æ ·å®ƒå°±æœ‰è¶³å¤Ÿçš„ç©ºé—´ä¿å­˜æ¥è‡ª nums2 çš„å…ƒç´ ã€‚</p><p>ç¤ºä¾‹1ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [1,2,3,0,0,0], m = 3, nums2 = [2,5,6], n = 3<br>è¾“å‡ºï¼š[1,2,2,3,5,6]</p></blockquote><p>ç¤ºä¾‹2ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [1], m = 1, nums2 = [], n = 0<br>è¾“å‡ºï¼š[1]</p></blockquote><p>è¿™é“é¢˜æ˜¯å¤šæŒ‡é’ˆä¸­çš„ä¸€ç§é¢˜å‹ï¼Œä½†æ˜¯å®ƒéœ€è¦çš„æ˜¯é€†å‘æŒ‡é’ˆï¼ŒçŸ¥é“åŸç†åæ¯”è¾ƒç®€å•</p><p>å› ä¸ºè¿™ä¸¤ä¸ªæ•°ç»„å·²ç»æ’å¥½åºï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ªæ•°ç»„çš„æœ«å°¾ï¼Œå³ nums1 çš„m - 1 ä½å’Œ nums2 çš„ n - 1 ä½æ¯æ¬¡å°†è¾ƒå¤§çš„é‚£ä¸ªæ•°å­—å¤åˆ¶åˆ° nums1 çš„åè¾¹ï¼Œç„¶åå‘å‰ç§»åŠ¨ä¸€ä½ã€‚å› ä¸ºæˆ‘ä»¬ä¹Ÿè¦å®šä½ nums1 çš„æœ«å°¾ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç¬¬ä¸‰ä¸ªæŒ‡é’ˆï¼Œä»¥ä¾¿å¤åˆ¶ã€‚<br>åœ¨ä»¥ä¸‹çš„ä»£ç é‡Œï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨ m å’Œ n å½“ä½œä¸¤ä¸ªæ•°ç»„çš„æŒ‡é’ˆï¼Œå†é¢å¤–åˆ›ç«‹ä¸€ä¸ª pos æŒ‡é’ˆï¼Œèµ·å§‹ä½ç½®ä¸º m + n - 1ã€‚æ¯æ¬¡å‘å‰ç§»åŠ¨ m æˆ– n çš„æ—¶å€™ï¼Œä¹Ÿè¦å‘å‰ç§»åŠ¨ posã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœ nums1çš„æ•°å­—å·²ç»å¤åˆ¶å®Œï¼Œä¸è¦å¿˜è®°æŠŠ nums2 çš„æ•°å­—ç»§ç»­å¤åˆ¶ï¼›å¦‚æœ nums2 çš„æ•°å­—å·²ç»å¤åˆ¶å®Œï¼Œå‰©ä½™nums1 çš„æ•°å­—ä¸éœ€è¦æ”¹å˜ï¼Œå› ä¸ºå®ƒä»¬å·²ç»è¢«æ’å¥½åºã€‚  </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">merge</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums2<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> size1 <span class="token operator">=</span> nums1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> size2 <span class="token operator">=</span> nums2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>size2<span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token comment">//éœ€è¦ä¸‰ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«æ˜¯m-1,n-1å’Œm+n-1ï¼Œå‰ä¸¤ä¸ªå¯ä»¥ç”¨m n ä»£æ›¿</span>        <span class="token keyword">int</span> pos <span class="token operator">=</span> m<span class="token operator">+</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        n<span class="token operator">--</span><span class="token punctuation">;</span>m<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">>=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> m<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            nums1<span class="token punctuation">[</span>pos<span class="token operator">--</span><span class="token punctuation">]</span><span class="token operator">=</span>nums1<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token operator">></span>nums2<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">?</span>nums1<span class="token punctuation">[</span>m<span class="token operator">--</span><span class="token punctuation">]</span><span class="token operator">:</span>nums2<span class="token punctuation">[</span>n<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            nums1<span class="token punctuation">[</span>pos<span class="token operator">--</span><span class="token punctuation">]</span><span class="token operator">=</span>nums2<span class="token punctuation">[</span>n<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦<em>O(m+n)<em>ï¼Œå› ä¸ºæŒ‡é’ˆæœ€å¤šéå†m+nä¸ªæ•°ï¼Œç©ºé—´å¤æ‚åº¦</em>O(1)</em></p><hr><h2 id="142-ç¯å½¢é“¾è¡¨-IIâ€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#142-ç¯å½¢é“¾è¡¨-IIâ€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="142. ç¯å½¢é“¾è¡¨ IIâ€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/linked-list-cycle-ii/">142. ç¯å½¢é“¾è¡¨ II</a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¿”å›é“¾è¡¨å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœé“¾è¡¨æ— ç¯ï¼Œåˆ™è¿”å› nullã€‚</p><p>ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼Œpos ä»…ä»…æ˜¯ç”¨äºæ ‡è¯†ç¯çš„æƒ…å†µï¼Œå¹¶ä¸ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚</p><p>è¯´æ˜ï¼šä¸å…è®¸ä¿®æ”¹ç»™å®šçš„é“¾è¡¨ã€‚</p><p><em>è¿›é˜¶ï¼š</em></p><p><em>ä½ æ˜¯å¦å¯ä»¥ä½¿ç”¨ O(1) ç©ºé—´è§£å†³æ­¤é¢˜ï¼Ÿ</em></p><blockquote><p>ç¤ºä¾‹ï¼š</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/aeba8d5b296441c6a8d25a7bc3e7eb31.png" alt="1" style="zoom:80%;" /><p>è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1<br>è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 1 çš„é“¾è¡¨èŠ‚ç‚¹<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</p></blockquote><p>æœ¬é¢˜ç¬¬ä¸€æ¬¡åšç¨å¾®æœ‰éš¾åº¦ï¼Œæ¶‰åŠåˆ°ä¸€äº›æ•°å­¦çŸ¥è¯†</p><p>æ‰€ä½¿ç”¨çš„æ˜¯å¿«æ…¢æŒ‡é’ˆï¼Œä¸¤ä¸ªæŒ‡é’ˆéƒ½æ˜¯ä»å¤´ç»“ç‚¹å¼€å§‹ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ ¼ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ ¼ï¼Œå¦‚æœä»–ä»¬å¯ä»¥ç›¸é‡ï¼Œå°±ä»£è¡¨é“¾è¡¨æ˜¯æœ‰ç¯çš„ï¼Œå› ä¸ºå¿«æŒ‡é’ˆæ¯æ¬¡èµ°çš„æ¯”æ…¢æŒ‡é’ˆå¤š<code>1</code>æ ¼ï¼Œåªè¦æ˜¯æœ‰ç¯è·¯è‚¯å®šèƒ½ç›¸é‡</p><p>å…¶æ¬¡ï¼Œåœ¨ç¬¬ä¸€æ¬¡ç›¸é‡åï¼Œæˆ‘ä»¬å°†å¿«æŒ‡é’ˆé‡ç½®ä¸ºå¤´ç»“ç‚¹ä½ç½®ï¼Œä¹‹åå¿«æ…¢æŒ‡é’ˆ<code>åŒæ—¶èµ°</code>ï¼Œæ¯æ¬¡éƒ½æ˜¯èµ°<code>1</code>æ­¥ï¼Œç›´åˆ°ä¸¤æŒ‡é’ˆå†ä¸€æ¬¡ç›¸é‡å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç¯å…¥å£äº†ï¼Œå…·ä½“æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸‹é¢çš„å›¾</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/c1f26d9f0524448ebd0245449d12eb45.png" alt="code" style="zoom:80%;" /><p>æˆ‘ä»¬è®¾<code>x</code>æ˜¯å¤´ç»“ç‚¹åˆ°ç¯å½¢å…¥å£èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°ï¼Œ<code>y</code>æ˜¯ä»å…¥å£èŠ‚ç‚¹åˆ°ä¸¤ä¸ªæŒ‡é’ˆç¬¬ä¸€æ¬¡ç›¸é‡çš„èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°ï¼Œå½“ç¬¬ä¸€æ¬¡ä¸¤æŒ‡é’ˆåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ç›¸é‡æ—¶ï¼Œæ…¢æŒ‡é’ˆèµ°äº†<code>x+y</code>ï¼Œå¿«æŒ‡é’ˆèµ°äº†<code>x+y+n(z+y)</code>å…¶ä¸­<code>n(z+y)</code>æ˜¯åœ¨ç¯å†…å¤šèµ°äº†<code>n</code>åœˆ</p><p>åˆå› ä¸ºå¿«æŒ‡é’ˆèµ°çš„èŠ‚ç‚¹æ•°æ˜¯æ…¢æŒ‡é’ˆçš„ä¸¤å€åˆ™æœ‰æ–¹ç¨‹ï¼š<code>2(x+y)=x+y+n(z+y)</code>ï¼ŒåŒ–ç®€çš„å‡º<code>x=n(y+z)-y</code>ï¼Œä»n(y+z)æå‡ºä¸€ä¸ªy+zå¾—å‡ºå…¬å¼ï¼š<code>x=(n-1)(y+z)+z</code>ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‡è®¾<code>n=1</code>ï¼Œå³å¿«æŒ‡é’ˆåªç”¨åœ¨ç¯å†…å¤šèµ°ä¸€åœˆå°±ï¼Œå°±å¯ä»¥å¾—å‡º<code>x=z</code></p><p>è¿™æ ·å°±å¾—å‡ºäº†æœ€ç»ˆçš„ç»“è®ºï¼šå½“ä¸¤ä¸ªæŒ‡é’ˆåœ¨ç¬¬ä¸€æ¬¡ç›¸é‡åï¼Œæ­¤æ—¶ç›¸é‡èŠ‚ç‚¹åˆ°ç¯å½¢å…¥å£èŠ‚ç‚¹é•¿åº¦<code>ç­‰äº</code>å¤´ç»“ç‚¹åˆ°ç¯å½¢å…¥å£é•¿åº¦ï¼Œé‚£ä¹ˆé—®é¢˜å°±å¾ˆå®¹æ˜“äº†ï¼Œæˆ‘ä»¬éšä¾¿å°†ä¸€ä¸ªæŒ‡é’ˆ<code>é‡ç½®</code>å›å¤´ç»“ç‚¹ï¼Œå†è®©ä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶å‡ºå‘ï¼Œå¹¶ä¸”æ¯ä¸€æ­¥åªèµ°<code>ä¸€æ ¼</code>é•¿åº¦ï¼Œå½“å†æ¬¡ç›¸é‡æ—¶ï¼Œä½ç½®å°±æ˜¯ç¯å½¢å…¥å£èŠ‚ç‚¹äº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/** * Definition for singly-linked list. * struct ListNode &#123; *     int val; *     ListNode *next; *     ListNode(int x) : val(x), next(NULL) &#123;&#125; * &#125;; */</span><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    ListNode <span class="token operator">*</span><span class="token function">detectCycle</span><span class="token punctuation">(</span>ListNode <span class="token operator">*</span>head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token operator">||</span>head<span class="token operator">-></span>next<span class="token operator">==</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>        ListNode<span class="token operator">*</span> slow <span class="token operator">=</span> head<span class="token punctuation">;</span><span class="token comment">//å¿«æŒ‡é’ˆ</span>        ListNode<span class="token operator">*</span> fast <span class="token operator">=</span> head<span class="token punctuation">;</span><span class="token comment">//æ…¢æŒ‡é’ˆ</span>        <span class="token comment">//ç¬¬ä¸€æ¬¡ç›¸é‡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ç¯è·¯</span>        <span class="token keyword">do</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fast<span class="token operator">||</span><span class="token operator">!</span>fast<span class="token operator">-></span>next<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>            fast<span class="token operator">=</span>fast<span class="token operator">-></span>next<span class="token operator">-></span>next<span class="token punctuation">;</span>            slow<span class="token operator">=</span>slow<span class="token operator">-></span>next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>slow<span class="token operator">!=</span>fast<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//é‡ç½®å¿«æŒ‡é’ˆ</span>        fast <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token comment">//ç¬¬äºŒæ¬¡ç›¸é‡åˆ™æ˜¯å…¥å£</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>fast<span class="token operator">!=</span>slow<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            fast <span class="token operator">=</span> fast<span class="token operator">-></span>next<span class="token punctuation">;</span>            slow <span class="token operator">=</span> slow<span class="token operator">-></span>next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> slow<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸ºï¼š<em>O(n)<em>ï¼Œç©ºé—´å¤æ‚åº¦ä¸º</em>O(1)</em></p><hr><h2 id="76-æœ€å°è¦†ç›–å­ä¸²â€”ï¼ˆå›°éš¾ï¼‰"><a href="#76-æœ€å°è¦†ç›–å­ä¸²â€”ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="76. æœ€å°è¦†ç›–å­ä¸²â€”ï¼ˆå›°éš¾ï¼‰"></a><a href="https://leetcode-cn.com/problems/minimum-window-substring/">76. æœ€å°è¦†ç›–å­ä¸²</a>â€”ï¼ˆå›°éš¾ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ã€ä¸€ä¸ªå­—ç¬¦ä¸² t ã€‚è¿”å› s ä¸­æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚å¦‚æœ s ä¸­ä¸å­˜åœ¨æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² â€œâ€ ã€‚</p><p>æ³¨æ„ï¼š</p><p>å¯¹äº t ä¸­é‡å¤å­—ç¬¦ï¼Œæˆ‘ä»¬å¯»æ‰¾çš„å­å­—ç¬¦ä¸²ä¸­è¯¥å­—ç¬¦æ•°é‡å¿…é¡»ä¸å°‘äº t ä¸­è¯¥å­—ç¬¦æ•°é‡ã€‚<br>å¦‚æœ s ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œADOBECODEBANCâ€, t = â€œABCâ€<br>è¾“å‡ºï¼šâ€BANCâ€</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œaâ€, t = â€œaâ€<br>è¾“å‡ºï¼šâ€aâ€</p></blockquote><p>ç¤ºä¾‹ 3:</p><blockquote><p>è¾“å…¥: s = â€œaâ€, t = â€œaaâ€<br>è¾“å‡º: â€œâ€<br>è§£é‡Š: t ä¸­ä¸¤ä¸ªå­—ç¬¦ â€˜aâ€™ å‡åº”åŒ…å«åœ¨ s çš„å­ä¸²ä¸­ï¼Œ<br>å› æ­¤æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­å­—ç¬¦ä¸²ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p></blockquote><p>è¿™ä¸ªé¢˜ç›®ä¸­è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²tæ˜¯å¯ä»¥åŒ…å«<em>é‡å¤</em>å­—æ¯çš„</p><p>æ‰€è¿ç”¨çš„æ˜¯æ»‘åŠ¨çª—å£ï¼Œç”±äºä¹‹å‰æ²¡æœ‰åšè¿‡æ»‘åŠ¨çª—å£çš„é¢˜ï¼Œæ‰€ä»¥å…ˆçœ‹äº†è§£é‡Šæ‰å¼€å§‹åšçš„ï¼Œæ›´å¤šç»†èŠ‚åœ¨<a href="https://leetcode-cn.com/problems/minimum-window-substring/solution/zui-xiao-fu-gai-zi-chuan-by-leetcode-solution/">å®˜æ–¹è§£æ</a>å’Œè§†é¢‘ï¼Œæ»‘åŠ¨çª—å£å›¾ç¤ºå¦‚ä¸‹ï¼š</p><img src="https://cube-resources.lenovo.com.cn/cube/86cf648e03a1a5daceab2cfbdb802819.gif" alt="æ»‘åŠ¨çª—å£" style="zoom:80%;" /><p>é¦–å…ˆæ˜¯è¿ç”¨ä¸¤ä¸ªæ•°ç»„ï¼Œä¸€ä¸ªæ˜¯è®°å½•æ»‘åŠ¨çª—å£ä¸­éå†åˆ°çš„tå­—ç¬¦ä¸²å«æœ‰çš„å­—æ¯ä¸ªæ•°ï¼Œè€Œå¦ä¸€ä¸ªåˆ™æ˜¯è®°å½•tå­—ç¬¦ä¸²æ¯ä¸ªå­—æ¯çš„ä¸ªæ•°ã€‚ç„¶åè¿˜æœ‰ä¸ªæ¯”è¾ƒé‡è¦çš„å°±æ˜¯<code>distance</code>ï¼Œè¿™ä¸ªå˜é‡æ˜¯ç”¨æ¥è®°å½•å½“å‰æ»‘åŠ¨çª—å£åŒºåŸŸä¸­æ‹¥æœ‰å¯¹ç…§å­—ç¬¦ä¸²tä¸­æ‰€éœ€è¦çš„å­—ç¬¦ä¸ªæ•°</p><p>æ•´ä¸ªæ»‘åŠ¨çª—å£æµç¨‹å¤§è‡´æ˜¯ï¼š</p><p>å½“å³æŒ‡é’ˆå‰è¿›æ—¶éå†åˆ°ä¸€ä¸ªæ‰€éœ€å­—ç¬¦åˆ™<code>distance+1</code>ï¼Œç›´åˆ°<code>distance == t.size()</code>æ—¶åœæ­¢å‰è¿›ï¼Œ<strong>æ³¨æ„å½“ä¸€ä¸ªå­—ç¬¦å‡ºç°è¶…è¿‡æ‰€éœ€æ•°ä½†æ˜¯distanceè¿˜æ²¡è¾¾æ ‡æ—¶ï¼Œdistanceä¸å¢åŠ </strong>ï¼Œå¦‚ä¸‹é¢ä»£ç ä¸­çš„<code>winFre[s[right]]&gt;=tFre[s[right]]</code>æ—¶distanceä¸ä¼šå†ç»§ç»­åŠ 1ã€‚</p><p>ä¹‹åè½®åˆ°å·¦æŒ‡é’ˆå‰è¿›ï¼Œå®ƒä¼šè·³è¿‡ä¸€äº›å¤šä½™çš„å­—ç¬¦ä»¥å°½å¯èƒ½åœ°ç¼©å°åŒºåŸŸï¼Œå®ƒä¹Ÿè¦å‰”é™¤é‡å¤çš„å­—ç¬¦æ•°ï¼Œå½“<code>winFre[s[right]]&gt;tFre[s[right]]</code>æ—¶distanceä¸ä¼šç›¸å‡ï¼Œå› æ­¤<code>distance</code>çš„ä½œç”¨å¯ä»¥çœ‹åšæ˜¯ä¸¤è¾¹å­—æ¯çš„è¾¹ç•Œå€¼ã€‚åœ¨å·¦æŒ‡é’ˆé‡åˆ°ä¸èƒ½å†ç»§ç»­å‰è¿›æ—¶ä¼šæ¯”è¾ƒå½“å‰æœ€å°çš„è¦†ç›–å­ä¸²åŒºé—´æ˜¯å¦è¦æ›´æ–°ï¼Œæœ€åä¸‹ä¸€æ¬¡å¾ªç¯ä¸­åˆè¦æ¢å¤ä¸ºå³åŒºé—´å‰è¿›ï¼Œç›´åˆ°å³åŒºé—´åˆ°è¾¾tå­—ç¬¦ä¸²çš„é•¿åº¦æ‰ä¼šé€€å‡ºå¾ªç¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    string <span class="token function">minWindow</span><span class="token punctuation">(</span>string s<span class="token punctuation">,</span> string t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> sLen <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> tLen <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>sLen<span class="token operator">&lt;</span>tLen<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">//ç‰¹æ®Šæƒ…å†µ</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> s<span class="token punctuation">;</span>        <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å·¦æŒ‡é’ˆ</span>        <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å³æŒ‡é’ˆ</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token function">winFre</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ»‘åŠ¨çª—å£ä¸­æ‰€åŒ…å«å¯¹ç…§å­—ç¬¦ä¸²æ¯ä¸ªå­—æ¯çš„ä¸ªæ•°</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token function">tFre</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•å¯¹ç…§å­—ç¬¦ä¸²ä¸­æ‰€å«æœ‰çš„æ¯ä¸ªå­—æ¯çš„ä¸ªæ•°</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">char</span> i<span class="token operator">:</span>t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//éå†å¯¹ç…§å­—ç¬¦ä¸²t</span>            tFre<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•è¿”å›å­—ç¬¦ä¸²çš„å¼€å§‹ä¸‹æ ‡ä½ç½®</span>        <span class="token keyword">int</span> minLen <span class="token operator">=</span> sLen<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•å½“å‰éå†å¾—åˆ°çš„æœ€å°è¦†ç›–å­ä¸²é•¿åº¦</span>        <span class="token keyword">int</span> distance <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ»‘åŠ¨çª—å£ä¸­æ‰€åŒ…å«çš„å­—æ¯ä¸ªæ•°å’Œå¯¹ç…§å­—ç¬¦ä¸²æ‰€éœ€è¦çš„å­—æ¯ä¸ªæ•°å·®è·ï¼ˆç›¸åŒæ—¶ä¸åŠ ï¼‰</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>right<span class="token operator">&lt;</span>sLen<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¾ªç¯ç»“æŸæ¡ä»¶æ˜¯å³æŒ‡é’ˆåˆ°è¾¾æœ€åä¸€ä¸ªå­—ç¬¦</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//é¦–å…ˆæ˜¯å³æŒ‡é’ˆå¾€å³èµ°ï¼Œé‡åˆ°ä¸æ˜¯æ‰€éœ€è¦æ‰¾çš„å­—ç¬¦è·³è¿‡</span>                right<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                distance<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//æ»‘åŠ¨çª—å£é‡åˆ°ä¸å¤Ÿå­—æ¯æ€»æ•°æ—¶distanceåŠ ä¸€</span>            winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>            right<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>distance <span class="token operator">==</span> tLen<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//æ»‘åŠ¨çª—å£å·¦æŒ‡é’ˆå‰è¿›</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    left<span class="token operator">++</span><span class="token punctuation">;</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                    distance<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//é‡åˆ°åˆšå¥½æ»¡è¶³å­—ç¬¦æ•°æ¡ä»¶æ—¶å‡å»distanceï¼Œä»¥ä½¿æ¢å¤ä¸‹ä¸€æ¬¡å¾ªç¯æ˜¯å³æŒ‡é’ˆå‰è¿›</span>                <span class="token keyword">int</span> tempWinLen <span class="token operator">=</span> right <span class="token operator">-</span> left<span class="token punctuation">;</span><span class="token comment">//å½“å‰æ»‘åŠ¨çª—å£çš„å­—ç¬¦é•¿åº¦</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>minLen<span class="token operator">></span>tempWinLen<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//å¦‚æœå½“å‰è®°å½•åœ¨å†…çš„æœ€å°åŒºé—´æ²¡æœ‰æ–°çš„å°åˆ™æ›¿æ¢å®ƒ</span>                    minLen <span class="token operator">=</span> tempWinLen<span class="token punctuation">;</span>                    begin <span class="token operator">=</span> left<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                                winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span>                left<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//cout&lt;&lt;begin&lt;&lt;" "&lt;&lt;minLen;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>minLen <span class="token operator">==</span> sLen <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>begin<span class="token punctuation">,</span>minLen<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(k)ï¼Œkä¸ºä¸¤ä¸ªä¼ è¿›æ¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¹‹å’Œ</p><hr><h2 id="524-é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#524-é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="524. é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/longest-word-in-dictionary-through-deleting/">524. é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯</a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s å’Œä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ dictionary ä½œä¸ºå­—å…¸ï¼Œæ‰¾å‡ºå¹¶è¿”å›å­—å…¸ä¸­æœ€é•¿çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡åˆ é™¤ s ä¸­çš„æŸäº›å­—ç¬¦å¾—åˆ°ã€‚</p><p>å¦‚æœç­”æ¡ˆä¸æ­¢ä¸€ä¸ªï¼Œè¿”å›é•¿åº¦æœ€é•¿ä¸”å­—å…¸åºæœ€å°çš„å­—ç¬¦ä¸²ã€‚å¦‚æœç­”æ¡ˆä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œabpcpleaâ€, dictionary = [â€œaleâ€,â€appleâ€,â€monkeyâ€,â€pleaâ€]<br>è¾“å‡ºï¼šâ€appleâ€</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œabpcpleaâ€, dictionary = [â€œaâ€,â€bâ€,â€câ€]<br>è¾“å‡ºï¼šâ€aâ€</p></blockquote><p>æ³¨æ„è¿™é‡Œçš„<code>å­—å…¸åº</code>æ¦‚å¿µï¼šåŸºäºå­—æ¯é¡º<em>åº</em>æ’åˆ—çš„å•è¯æŒ‰å­—æ¯é¡º<em>åº</em>æ’åˆ—çš„æ–¹æ³•ï¼Œä¾‹ï¼šabc &lt; bbcï¼Œå¯ä»¥ç”¨C++ä¸­<code>string</code>ç±»è‡ªå¸¦çš„æˆå‘˜å‡½æ•°ï¼ˆéstaticï¼‰<code>a.compare(string&amp; b)</code>æ¥æ¯”è¾ƒ</p><p>è¿™é“é¢˜åˆšå¼€å§‹æƒ³å°±æ˜¯æ™®é€šåœ°æŠŠå­—å…¸ä¸­çš„å­—ç¬¦ä¸²æ¯ä¸ªéå†ï¼Œå¹¶ä½œæ¯”è¾ƒæ˜¯å¦ä¸ºså­—ç¬¦ä¸²çš„å­ä¸²ï¼Œæ¯”è¾ƒä¹‹åå†æ¯”è¾ƒå­—å…¸åºã€‚ä»¥ä¸ºè¿™ä¸ªæ–¹æ³•æ•ˆç‡ä¸è¡Œï¼Œæƒ³ä¸åˆ°å®˜æ–¹è§£ç­”ç»™å‡ºæœ€æœ‰æ•ˆç‡çš„å°±æ˜¯è¿™ä¸ªäº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    string <span class="token function">findLongestWord</span><span class="token punctuation">(</span>string s<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> dictionary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> sLen <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> dSize <span class="token operator">=</span> dictionary<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        string maxStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æœ€åè¦è¿”å›çš„é•¿åº¦æœ€é•¿ä¸”å­—å…¸åºæœ€å°çš„å­—ç¬¦ä¸²</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> str <span class="token operator">:</span> dictionary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsSubStr</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> maxStr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> maxStr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>maxStr<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    maxStr <span class="token operator">=</span> str<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> maxStr<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">IsSubStr</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> a<span class="token punctuation">,</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ£€æµ‹bæ˜¯ä¸æ˜¯açš„å­ä¸²</span>        <span class="token keyword">int</span> subSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> bLen <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch <span class="token operator">:</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>ch <span class="token operator">==</span> b<span class="token punctuation">[</span>subSize<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token operator">++</span>subSize<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>subSize <span class="token operator">==</span> bLen<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸º<em>O(nÂ·x)<em>å…¶ä¸­næ˜¯å­—å…¸æ•°ç»„é•¿åº¦ï¼Œxæ˜¯æ•°ç»„ä¸­å­—ç¬¦ä¸²å¹³å‡é•¿åº¦ï¼Œ</em>O(x)</em></p><hr><h1 id="äºŒåˆ†æ³•"><a href="#äºŒåˆ†æ³•" class="headerlink" title="äºŒåˆ†æ³•"></a>äºŒåˆ†æ³•</h1><h2 id="154-å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼-IIâ€”ï¼ˆå›°éš¾ï¼‰"><a href="#154-å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼-IIâ€”ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="154. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼ IIâ€”ï¼ˆå›°éš¾ï¼‰"></a><a href="https://leetcode-cn.com/problems/find-minimum-in-rotated-sorted-array-ii/">154. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼ II</a>â€”ï¼ˆå›°éš¾ï¼‰</h2><p>å·²çŸ¥ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ï¼Œé¢„å…ˆæŒ‰ç…§å‡åºæ’åˆ—ï¼Œç»ç”± 1 åˆ° n æ¬¡ æ—‹è½¬ åï¼Œå¾—åˆ°è¾“å…¥æ•°ç»„ã€‚ä¾‹å¦‚ï¼ŒåŸæ•°ç»„ nums = [0,1,4,4,5,6,7] åœ¨å˜åŒ–åå¯èƒ½å¾—åˆ°ï¼š<br>è‹¥æ—‹è½¬ 4 æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° [4,5,6,7,0,1,4]<br>è‹¥æ—‹è½¬ 7 æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° [0,1,4,4,5,6,7]<br>æ³¨æ„ï¼Œæ•°ç»„ [a[0], a[1], a[2], â€¦, a[n-1]] æ—‹è½¬ä¸€æ¬¡ çš„ç»“æœä¸ºæ•°ç»„ [a[n-1], a[0], a[1], a[2], â€¦, a[n-2]] ã€‚</p><p>ç»™ä½ ä¸€ä¸ªå¯èƒ½å­˜åœ¨ é‡å¤ å…ƒç´ å€¼çš„æ•°ç»„ nums ï¼Œå®ƒåŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åˆ—çš„æ•°ç»„ï¼Œå¹¶æŒ‰ä¸Šè¿°æƒ…å½¢è¿›è¡Œäº†å¤šæ¬¡æ—‹è½¬ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›æ•°ç»„ä¸­çš„ æœ€å°å…ƒç´  ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><blockquote><p>è¾“å…¥ï¼šnums = [1,3,5]<br>è¾“å‡ºï¼š1</p></blockquote><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><blockquote><p>è¾“å…¥ï¼šnums = [2,2,2,0,1]<br>è¾“å‡ºï¼š0</p></blockquote><p>è¿™é“é¢˜æ„Ÿè§‰LeetCodeéš¾åº¦åˆ†çš„æŒºè¿·çš„ï¼Œè¯´æ˜¯å›°éš¾å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¹Ÿæ˜¯ä½¿ç”¨<code>left,mid,right</code>ä¸‰ä¸ªæŒ‡é’ˆï¼Œåªè¦åªè¦è€ƒè™‘å‡ ç‚¹å°±è¡Œäº†</p><p>è¿™é‡Œæœ‰ä¸‰ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯ï¼š</p><p>1ã€<code>nums[mid]</code>å°äº<code>nums[right]</code>ï¼Œè¯æ˜æˆ‘ä»¬è¦æ‰¾çš„æœ€å°å€¼åœ¨å‰åŠæ®µæˆ–è€…æ˜¯<code>nums[mid]</code>æœ¬èº«ï¼Œå› æ­¤æˆ‘ä»¬æŠŠ<code>right = mid</code></p><p>2ã€<code>nums[mid]</code>å¤§äº<code>nums[right]</code>ï¼Œè¯æ˜æœ€å°å€¼é€šè¿‡æ•°ç»„æ—‹è½¬ç»™è°ƒåˆ°æœ‰åŠæ®µå»äº†ï¼Œè€Œä¸”æ­¤æ—¶çš„<code>nums[mid]</code>è‚¯å®šä¸æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†<code>left = mid + 1</code></p><p>3ã€æ’é™¤ä¸Šé¢ä¸¤ç§æƒ…å†µä¹‹åï¼Œå°±è¦è€ƒè™‘æ•°ç»„ä¸­æœ‰é‡å¤çš„æ•°å­—ï¼Œè€Œä¸”å¯èƒ½å°±æ˜¯å½“å‰æŒ‡é’ˆæŒ‡ç€çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å³æŒ‡é’ˆå¾€å‰èµ°å°±è¡Œäº†<code>--right</code>ï¼Œè‡³äºä¸ºä»€ä¹ˆä¸æ˜¯å·¦æŒ‡é’ˆå¾€åèµ°ï¼Œæ˜¯å› ä¸ºï¼š</p><ul><li>æ­¤æ“ä½œä¸ä¼šä½¿æ•°ç»„è¶Šç•Œï¼šå› ä¸ºè¿­ä»£æ¡ä»¶ä¿è¯äº† right &gt; left &gt;= 0ï¼›</li><li>æ­¤æ“ä½œä¸ä¼šä½¿æœ€å°å€¼ä¸¢å¤±ï¼šå‡è®¾<code>nums[right]</code>æ˜¯æœ€å°å€¼ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š</li><li>1ï¼‰è‹¥ <code>nums[right]</code> æ˜¯å”¯ä¸€æœ€å°å€¼ï¼šé‚£å°±ä¸å¯èƒ½æ»¡è¶³åˆ¤æ–­æ¡ä»¶ <code>nums[mid] == nums[right]</code>ï¼Œå› ä¸º <code>mid &lt; right</code>ï¼ˆleft != right  ä¸” mid = (left + right) / 2 å‘ä¸‹å–æ•´ï¼‰ï¼›</li><li>2ï¼‰è‹¥ nums[right] ä¸æ˜¯å”¯ä¸€æœ€å°å€¼ï¼Œç”±äº<code> mid &lt; right</code> è€Œ <code>nums[mid] == nums[right]</code>ï¼Œå³è¿˜æœ‰æœ€å°å€¼å­˜åœ¨äº <code>[left, right - 1]</code>åŒºé—´ï¼Œå› æ­¤ä¸ä¼šä¸¢å¤±æœ€å°å€¼ã€‚</li></ul><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span><span class="token punctuation">:</span>    <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">findMin</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">int</span></span> nLen <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name"><span class="token keyword">int</span></span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token class-name"><span class="token keyword">int</span></span> right <span class="token operator">=</span> nLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token class-name"><span class="token keyword">int</span></span> mid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å‰åŠéƒ¨åˆ†æ˜¯å¢åºåºåˆ—</span>                right <span class="token operator">=</span> mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ååŠéƒ¨åˆ†ä¸ºé™åºåºåˆ—</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token operator">--</span>right<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ O(logN)ï¼Œæœ€åæƒ…å†µä¹Ÿåªåˆ° O(N)ï¼Œæ¯”å¦‚ç»™å®šçš„æ•°ç»„æ¯ä¸ªæ•°å­—éƒ½æ˜¯ä¸€æ ·çš„ {1,1,1,1,1}</p><hr><h2 id="540-æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#540-æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="540. æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/single-element-in-a-sorted-array/">540. æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ </a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™å®šä¸€ä¸ªåªåŒ…å«æ•´æ•°çš„æœ‰åºæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½ä¼šå‡ºç°ä¸¤æ¬¡ï¼Œå”¯æœ‰ä¸€ä¸ªæ•°åªä¼šå‡ºç°ä¸€æ¬¡ï¼Œæ‰¾å‡ºè¿™ä¸ªæ•°ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: nums = [1,1,2,3,3,4,4,8,8]<br>è¾“å‡º: 2</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: nums =  [3,3,7,7,10,11,11]<br>è¾“å‡º: 10</p></blockquote><p><strong>æç¤º:</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 105</code></li><li><code>0 &lt;= nums[i] &lt;= 105</code></li></ul><p>è¿™é“é¢˜å¯ä»¥è§‚å¯Ÿé¢˜æ„å‘ç°ï¼Œåœ¨å‡ºç°ç‹¬ç«‹æ•°ä¹‹å‰ï¼Œæ•°ç»„çš„ä¸‹æ ‡éƒ½æ˜¯æœ‰è§„å¾‹çš„ï¼Œå¶æ•°ï¼ˆåŒ…å«0ï¼‰å¯¹åº”ä¸€å¯¹é‡å¤æ•°çš„ç¬¬ä¸€ä¸ªï¼Œå¥‡æ•°å¯¹åº”ç¬¬äºŒä¸ªã€‚ä¸€æ—¦ç‹¬ç«‹æ•°å‡ºç°ä¹‹åï¼Œæƒ…å†µå°±åè¿‡æ¥äº†</p><p>æ€»ä½“ä¸Šçœ‹çš„è¯ï¼Œæ•´ä¸ªæ•°ç»„è‚¯å®šæ˜¯å¥‡æ•°ä¸ªçš„ï¼Œå› ä¸ºå…¶ä½™é‡å¤æ•°æ˜¯å¶æ•°ä¸ªå†åŠ ä¸Šä¸€ä¸ªç‹¬ç«‹æ•°å°±æ˜¯å¥‡æ•°ä¸ª</p><p>å› æ­¤å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œå½“æˆ‘ä»¬æŠŠä¸€ä¸ªæ•°ç»„çš„ä¸­ä¸­é—´çš„ä¸€å¯¹å…ƒç´ ç§»é™¤ä¹‹åï¼Œå‰©ä¸‹å·¦è¾¹çš„æ•°ç»„å…¨æ˜¯é‡å¤çš„å…ƒç´ ï¼Œä¸ªæ•°ä¸ºå¶æ•°ï¼›è€Œå³è¾¹å«æœ‰ä¸€ä¸ªç‹¬ç«‹æ•°å…ƒç´ ï¼Œä¸ªæ•°ä¸ºå¥‡æ•°ã€‚</p><p><img src="https://i.loli.net/2021/07/31/njUaBzt62Sv5OIf.png" alt="1.png"></p><p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ¤æ–­å·¦å³å­æ•°ç»„å«æœ‰å…ƒç´ çš„ä¸ªæ•°æ˜¯å¥‡è¿˜æ˜¯å¶æ¥è¿›è¡Œä¸‹ä¸€æ­¥å¾€å“ªè¾¹åˆ¤æ–­</p><p>ä¸‹é¢æœ‰å‡ ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥æ¥åˆ†æä¸€ä¸‹ï¼Œå‡è®¾å·¦æŒ‡é’ˆæ˜¯<code>lo</code>ï¼Œå³æŒ‡é’ˆæ˜¯<code>hi</code></p><p>æƒ…å†µ1ï¼š</p><p>ä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å³è¾¹ï¼Œä¸”è¢« mid åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¶æ•°ã€‚</p><p>æˆ‘ä»¬å°†å³å­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å³å­æ•°ç»„å…ƒç´ ä¸ªæ•°å˜æˆå¥‡æ•°ï¼Œæˆ‘ä»¬åº”å°† <code>lo</code> è®¾ç½®ä¸º <code>mid + 2</code></p><p><img src="https://i.loli.net/2021/07/31/bnv7lY6X3uTIWw9.png" alt="2.jpg"></p><p>æƒ…å†µ2ï¼š</p><p>ä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å³è¾¹ï¼Œä¸”è¢« <code>mid</code> åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¥‡æ•°ã€‚</p><p>æˆ‘ä»¬å°†å³å­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å³å­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å˜ä¸ºå¶æ•°ï¼Œæˆ‘ä»¬åº”å°† <code>hi</code> è®¾ç½®ä¸º <code>mid - 1</code></p><p><img src="https://i.loli.net/2021/07/31/mfnQIPMUGhT5sED.png" alt="3.png"></p><p>ä¾‹å­ 3ï¼šä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å·¦è¾¹ï¼Œä¸”è¢« mid åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¶æ•°ã€‚</p><p>æˆ‘ä»¬å°†å·¦å­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å·¦å­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å˜ä¸ºå¥‡æ•°ï¼Œæˆ‘ä»¬åº”å°† hi è®¾ç½®ä¸º mid - 2ã€‚</p><p><img src="https://i.loli.net/2021/07/31/25rqAzunOkFvGPU.png" alt="4.png"></p><p>ä¾‹å­ 4ï¼šä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å·¦è¾¹ï¼Œä¸”è¢« mid åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¥‡æ•°ã€‚</p><p>æˆ‘ä»¬å°†å·¦å­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å·¦å­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å˜ä¸ºå¶æ•°ï¼Œæˆ‘ä»¬åº”å°† lo è®¾ç½®ä¸º mid + 1ã€‚</p><p><img src="https://i.loli.net/2021/07/31/xSkLFir6aE1oIPc.png" alt="5.png"></p><p>è¿˜æœ‰æœ€åä¸€ç§æƒ…å†µï¼Œå°±æ˜¯åˆšå¥½æˆ‘ä»¬çš„ä¸­é—´æŒ‡é’ˆæŒ‡å‘çš„æ•°å’Œå‰é¢åé¢çš„æ•°éƒ½ä¸ç›¸ç­‰ï¼Œå°±ä»£è¡¨è¿™ä¸ªæ•°å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç‹¬ç«‹æ•°äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç›´æ¥return</p><p>æ˜ç™½åŸç†ä¹‹åå°±å¯ä»¥å†™ä»£ç äº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">singleNonDuplicate</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//O(log n)æ—¶é—´å¤æ‚åº¦æ–¹æ³•</span>        <span class="token keyword">int</span> nLen <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>nLen <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//åªæœ‰ä¸€ä¸ªæ•°ç›´æ¥è¿”å›</span>        <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> right <span class="token operator">=</span> nLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ä¸­é—´æŒ‡é’ˆçš„æ•°ä¸å‰ä¸€ä¸ªæ•°ç›¸ç­‰</span>                mid<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//ä¸­é—´æŒ‡é’ˆåé€€ä»¥ä¾¿è®¡ç®—å·¦è¾¹å­æ•°ç»„çš„ä¸ªæ•°</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mid<span class="token operator">-</span>left<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//å·¦è¾¹æ˜¯å¶æ•°çš„è¯å”¯ä¸€æ•°åœ¨å³è¾¹</span>                    left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token keyword">else</span><span class="token comment">//å¦åˆ™å”¯ä¸€æ•°åœ¨å·¦è¾¹</span>                    right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token operator">==</span>nums<span class="token punctuation">[</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ä¸­é—´æŒ‡é’ˆå’Œåé¢ä¸€ä¸ªæ•°ç›¸ç­‰çš„è¯</span>                mid<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//ä¸­é—´æŒ‡é’ˆå‰è¿›ä¸€æ ¼ï¼Œä»¥ä¾¿è®¡ç®—å³è¾¹å­æ•°ç»„çš„ä¸ªæ•°</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">-</span> mid<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                    right <span class="token operator">=</span> mid <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ä¸­é—´æ•°ä¸å‰åçš„æ•°éƒ½ä¸ç›¸ç­‰ï¼Œä»£è¡¨æˆ‘ä»¬æ‰¾åˆ°äº†è¦çš„é‚£ä¸ªæ•°</span>                <span class="token keyword">return</span> nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</p><p>åœ¨æ­¤é¢˜ç›®çš„å®˜æ–¹é¢˜è§£ä¸­è¿˜æœ‰ç¬¬ä¸‰ç§è§£æ³•ï¼Œ<a href="https://leetcode-cn.com/problems/single-element-in-a-sorted-array/solution/you-xu-shu-zu-zhong-de-dan-yi-yuan-su-by-leetcode/"><strong>æ–¹æ³•ä¸‰ï¼šä»…å¯¹å¶æ•°ç´¢å¼•è¿›è¡ŒäºŒåˆ†æœç´¢</strong></a>ï¼Œè¿™ä¸ªè§£æ³•æ—¶é—´å¤æ‚åº¦ä¸ºO(n/2) = O(n)ï¼Œæ¯”èµ·ä¸Šé¢çš„ç®—æ³•æ›´ä¼˜é›…ä¸€äº›ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹</p><hr><h1 id="æ’åºç®—æ³•"><a href="#æ’åºç®—æ³•" class="headerlink" title="æ’åºç®—æ³•"></a>æ’åºç®—æ³•</h1><p>æ’åºè¦æ‡‚å¾—å¸¸ç”¨çš„é‚£å‡ ä¸ªæ’åºï¼ŒåŒæ—¶è¿˜è¦æ±‚å¯ä»¥é»˜å†™å‡ºæ¥ï¼Œæ­¤åä¼šæœ‰ä¸“é—¨çš„æ–‡ç« æ¥è®°å½•å„ç§å¸¸ç”¨çš„æ’åºç®—æ³•çš„ä»£ç ï¼Œè¿™é‡Œæš‚æ—¶è·³è¿‡ï¼Œç›´æ¥çœ‹ä¸€ä¸ªåŸºäºå¿«é€Ÿæ’åºçš„<strong>å¿«é€Ÿé€‰æ‹©ç®—æ³•</strong>é¢˜ç›®</p><h2 id="215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/kth-largest-element-in-an-array/">215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ </a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™å®šæ•´æ•°æ•°ç»„ nums å’Œæ•´æ•° kï¼Œè¯·è¿”å›æ•°ç»„ä¸­ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ ã€‚</p><p>è¯·æ³¨æ„ï¼Œä½ éœ€è¦æ‰¾çš„æ˜¯æ•°ç»„æ’åºåçš„ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯ç¬¬ k ä¸ªä¸åŒçš„å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: [3,2,1,5,6,4] å’Œ k = 2<br>è¾“å‡º: 5</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: [3,2,3,1,2,4,5,5,6] å’Œ k = 4<br>è¾“å‡º: 4</p></blockquote><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= k &lt;= nums.length &lt;= 104</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li></ul><p>é‡åˆ°è¿™ç§å¯»æ‰¾æ•°ç»„ä¸­ç¬¬xä¸ªæœ€å¤§ï¼ˆå°ï¼‰å…ƒç´ çš„é¢˜ç›®ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨å¿«é€Ÿé€‰æ‹©çš„æ–¹æ³•æ¥è§£å†³</p><p>å› ä¸ºæˆ‘ä»¬åªç”¨æ‰¾æŸä¸ªç¬¬xä¸ªæœ€å¤§ï¼ˆå°ï¼‰çš„æ•°ï¼Œå› æ­¤å¹¶ä¸ç”¨å¯¹æ•´ä¸ªæ•°ç»„æ’åºï¼Œä»è€ŒæŠŠå¿«é€Ÿæ’åºçš„O(n*log n)çš„å¹³å‡æ—¶é—´å¤æ‚åº¦é™åˆ°O(n)ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯æœ€å·®æƒ…å†µä¸‹è¿˜æ˜¯å¯èƒ½O(n^2)</p><p>å¿«é€Ÿæ’åºæ˜¯ä¸€ç§åˆ†æ²»ç®—æ³•ï¼Œè€Œå¿«é€Ÿé€‰æ‹©ä¹Ÿç±»ä¼¼ï¼Œå‡è®¾è¿™é‡Œæœ‰ä¸€ä¸ªæ•°ç»„<strong>a[lâ€¦r]<strong>ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°æ•°ç»„</strong>ç¬¬kå¤§</strong>çš„æ•°ï¼Œå¿«é€Ÿé€‰æ‹©å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li><strong>åˆ†è§£</strong>ï¼šå°†æ•°ç»„åˆ†ä¸ºa[lâ€¦q-1]ï¼Œa[q]ï¼Œa[q+1â€¦r]ï¼Œå…¶ä¸­å·¦åŠè¾¹çš„å­æ•°ç»„a[lâ€¦q-1]æ¯ä¸€ä¸ªå…ƒç´ éƒ½å°äºç­‰äºa[q]ï¼Œè€Œå¯¹äºå³åŠè¾¹çš„å­æ•°ç»„ï¼Œa[q]éƒ½ä¼šå°äºç­‰äºå³åŠè¾¹å­æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ </li><li><strong>è§£å†³</strong>ï¼šä¸åƒå¿«é€Ÿæ’åºï¼Œæˆ‘ä»¬ä¸ç”¨æŠŠå·¦å³ä¸¤è¾¹å­æ•°ç»„è¿›è¡Œæ’åºï¼Œåªç”¨å¤„ç†å¥½a[q]ä¸¤è¾¹å­æ•°ç»„æ»¡è¶³<code>åˆ†è§£</code>æ­¥éª¤çš„è¦æ±‚å°±è¡Œäº†ã€‚å› ä¸ºå½“åˆ†è§£å¥½åï¼Œa[q]åœ¨æ•°ç»„ä¸­çš„ä½ç½®å°±æ˜¯æˆ‘ä»¬å¿«æ’åæœ€ç»ˆå®ƒæ‰€åœ¨çš„ä½ç½®ï¼Œå½“åˆ†è§£åˆ°a[q]çš„ä¸‹æ ‡qæ­£å¥½æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ä¸‹æ ‡æ—¶å°±ç›´æ¥return a[q]</li></ul><p>æ—¶é—´å¤æ‚åº¦ï¼š</p><p>æˆ‘ä»¬çŸ¥é“å¿«é€Ÿæ’åºçš„æ€§èƒ½å’Œã€Œåˆ’åˆ†ã€å‡ºçš„å­æ•°ç»„çš„é•¿åº¦å¯†åˆ‡ç›¸å…³ã€‚ç›´è§‚åœ°ç†è§£å¦‚æœæ¯æ¬¡è§„æ¨¡ä¸º n çš„é—®é¢˜æˆ‘ä»¬éƒ½åˆ’åˆ†æˆ 1å’Œ n - 1ï¼Œæ¯æ¬¡é€’å½’çš„æ—¶å€™åˆå‘ n - 1 çš„é›†åˆä¸­é€’å½’ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€åçš„ï¼Œæ—¶é—´ä»£ä»·æ˜¯ O(n ^ 2)<br> )ã€‚æˆ‘ä»¬å¯ä»¥å¼•å…¥éšæœºåŒ–æ¥åŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œå®ƒçš„æ—¶é—´ä»£ä»·çš„æœŸæœ›æ˜¯ O(n)ï¼Œè¯æ˜è¿‡ç¨‹å¯ä»¥å‚è€ƒã€Œã€Šç®—æ³•å¯¼è®ºã€‹9.2ï¼šæœŸæœ›ä¸ºçº¿æ€§çš„é€‰æ‹©ç®—æ³•ã€ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">QuickSelect</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span><span class="token keyword">int</span> left<span class="token punctuation">,</span><span class="token keyword">int</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span>left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//nums[l]æ˜¯å“¨å…µæ•°</span>        <span class="token keyword">int</span> j<span class="token operator">=</span>right<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>right<span class="token operator">></span>i<span class="token operator">&amp;&amp;</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token operator">++</span>i<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>j<span class="token operator">></span>left<span class="token operator">&amp;&amp;</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">>=</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token operator">--</span>j<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">>=</span>j<span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> j<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">findKthLargest</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> r <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> traget <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>k<span class="token punctuation">;</span><span class="token comment">//ç›®æ ‡</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token function">QuickSelect</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>mid<span class="token operator">==</span>traget<span class="token punctuation">)</span>                <span class="token keyword">return</span> nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>mid <span class="token operator">&lt;</span> traget<span class="token punctuation">)</span><span class="token comment">//ç›®æ ‡åœ¨å³è¾¹å­æ•°ç»„</span>                l<span class="token operator">=</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">else</span><span class="token comment">//ç›®æ ‡åœ¨å·¦è¾¹å­æ•°ç»„</span>                r<span class="token operator">=</span>mid<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h1><p>æœç´¢ä¸€èˆ¬åˆ†ä¸º<strong>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</strong>å’Œ<strong>å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰</strong>ï¼Œå®ƒä»¬è¢«å¹¿æ³›è¿ç”¨åœ¨å›¾å’Œæ ‘ç­‰ç»“æ„ä¸­</p><p><strong>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆdepth-first seachï¼Œ DFSï¼‰</strong>ï¼šåœ¨æœç´¢åˆ°ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ—¶ï¼Œç«‹å³å¯¹è¯¥æ–°èŠ‚ç‚¹è¿›è¡Œé<br>å†ï¼›å› æ­¤éå†éœ€è¦ç”¨<strong>å…ˆå…¥åå‡ºçš„æ ˆ</strong>æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸æ ˆç­‰ä»·çš„<strong>é€’å½’</strong>æ¥å®ç°ã€‚å¯¹äºæ ‘ç»“æ„è€Œè¨€ï¼Œ<br>ç”±äºæ€»æ˜¯å¯¹æ–°èŠ‚ç‚¹è°ƒç”¨éå†ï¼Œå› æ­¤çœ‹èµ·æ¥æ˜¯å‘ç€â€œæ·±â€çš„æ–¹å‘å‰è¿›ã€‚  </p><p><strong>æ·±åº¦ä¼˜å…ˆæœç´¢</strong>ä¹Ÿå¯ä»¥ç”¨æ¥<strong>æ£€æµ‹ç¯è·¯</strong>ï¼šè®°å½•æ¯ä¸ªéå†è¿‡çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œè‹¥ä¸€ä¸ªèŠ‚ç‚¹è¢«å†æ¬¡é<br>å†ä¸”çˆ¶èŠ‚ç‚¹ä¸åŒï¼Œåˆ™è¯´æ˜æœ‰ç¯ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¹‹åä¼šè®²åˆ°çš„æ‹“æ‰‘æ’åºåˆ¤æ–­æ˜¯å¦æœ‰ç¯è·¯ï¼Œè‹¥æœ€åå­˜<br>åœ¨å…¥åº¦ä¸ä¸ºé›¶çš„ç‚¹ï¼Œåˆ™è¯´æ˜æœ‰ç¯ã€‚<br>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦å¯¹å·²ç»æœç´¢è¿‡çš„èŠ‚ç‚¹è¿›è¡Œæ ‡è®°ï¼Œä»¥é˜²æ­¢åœ¨éå†æ—¶é‡å¤æœç´¢æŸä¸ªèŠ‚ç‚¹ï¼Œè¿™<br>ç§åšæ³•å«åš<strong>çŠ¶æ€è®°å½•</strong>æˆ–<strong>è®°å¿†åŒ–ï¼ˆmemoizationï¼‰</strong>ã€‚  </p><p><strong>å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆbreadth-first searchï¼Œ BFSï¼‰</strong>ï¼šä¸åŒä¸æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå®ƒæ˜¯ä¸€å±‚å±‚è¿›è¡Œéå†çš„ï¼Œå› <br>æ­¤éœ€è¦ç”¨<strong>å…ˆå…¥å…ˆå‡ºçš„é˜Ÿåˆ—</strong>è€Œéå…ˆå…¥åå‡ºçš„æ ˆè¿›è¡Œéå†ã€‚ç”±äºæ˜¯æŒ‰å±‚æ¬¡è¿›è¡Œéå†ï¼Œå¹¿åº¦ä¼˜å…ˆæœç´¢æ—¶<br>æŒ‰ç…§â€œå¹¿â€çš„æ–¹å‘è¿›è¡Œéå†çš„ï¼Œä¹Ÿå¸¸å¸¸ç”¨æ¥å¤„ç†æœ€çŸ­è·¯å¾„ç­‰é—®é¢˜ã€‚  </p><p>è¿™é‡Œè¦æ³¨æ„ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢å’Œå¹¿åº¦ä¼˜å…ˆæœç´¢éƒ½å¯ä»¥å¤„ç†<strong>å¯è¾¾æ€§</strong>é—®é¢˜ï¼Œå³ä»ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹æ˜¯å¦<br>èƒ½è¾¾åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å› ä¸ºæ·±åº¦ä¼˜å…ˆæœç´¢å¯ä»¥åˆ©ç”¨é€’å½’å¿«é€Ÿå®ç°ï¼Œå¾ˆå¤šäººä¼šä¹ æƒ¯ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢<br>åˆ·æ­¤ç±»é¢˜ç›®ã€‚å®é™…è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œå¾ˆå°‘è§åˆ°é€’å½’çš„å†™æ³•ï¼Œå› ä¸ºä¸€æ–¹é¢éš¾ä»¥ç†è§£ï¼Œå¦ä¸€æ–¹é¢å¯èƒ½<br>äº§ç”Ÿæ ˆæº¢å‡ºçš„æƒ…å†µï¼›è€Œç”¨æ ˆå®ç°çš„æ·±åº¦ä¼˜å…ˆæœç´¢å’Œç”¨é˜Ÿåˆ—å®ç°çš„å¹¿åº¦ä¼˜å…ˆæœç´¢åœ¨å†™æ³•ä¸Šå¹¶æ²¡æœ‰å¤ª<br>å¤§å·®å¼‚ï¼Œå› æ­¤ä½¿ç”¨å“ªä¸€ç§æœç´¢æ–¹å¼éœ€è¦æ ¹æ®å®é™…çš„åŠŸèƒ½éœ€æ±‚æ¥åˆ¤æ–­ã€‚  </p><h2 id="934-æœ€çŸ­çš„æ¡¥â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#934-æœ€çŸ­çš„æ¡¥â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="934. æœ€çŸ­çš„æ¡¥â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/shortest-bridge/">934. æœ€çŸ­çš„æ¡¥</a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>åœ¨ç»™å®šçš„äºŒç»´äºŒè¿›åˆ¶æ•°ç»„ A ä¸­ï¼Œå­˜åœ¨ä¸¤åº§å²›ã€‚ï¼ˆå²›æ˜¯ç”±å››é¢ç›¸è¿çš„ 1 å½¢æˆçš„ä¸€ä¸ªæœ€å¤§ç»„ã€‚ï¼‰</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† <code>0</code> å˜ä¸º <code>1</code>ï¼Œä»¥ä½¿ä¸¤åº§å²›è¿æ¥èµ·æ¥ï¼Œå˜æˆä¸€åº§å²›ã€‚</p><p>è¿”å›å¿…é¡»ç¿»è½¬çš„ <code>0</code> çš„æœ€å°æ•°ç›®ã€‚ï¼ˆå¯ä»¥ä¿è¯ç­”æ¡ˆè‡³å°‘æ˜¯ <code>1 </code>ï¼‰</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šA = [[0,1],[1,0]]<br>è¾“å‡ºï¼š1</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šA = [[0,1,0],[0,0,0],[0,0,1]]<br>è¾“å‡ºï¼š2</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šA = [[1,1,1,1,1],[1,0,0,0,1],[1,0,1,0,1],[1,0,0,0,1],[1,1,1,1,1]]<br>è¾“å‡ºï¼š1</p></blockquote><p>ç¤ºä¾‹4ï¼š</p><blockquote><p>è¾“å…¥ï¼š<br>[[1,1,1,1,1],<br>[1,0,0,0,1],<br>[1,0,1,0,1],<br>[1,0,0,0,1],<br>[1,1,1,1,1]]<br>è¾“å‡ºï¼š1  </p></blockquote><p><strong>æç¤ºï¼š</strong></p><ul><li><code>2 &lt;= A.length == A[0].length &lt;= 100</code></li><li><code>A[i][j] == 0</code> æˆ– <code>A[i][j] == 1</code></li></ul><p>å²›å±¿é—®é¢˜ä¸€èˆ¬éƒ½æ˜¯ä¸dfsæœ‰å…³ç³»ï¼Œå¤§å¤šéƒ½æ˜¯å¥—æ¨¡æ¿</p><p>è¿™é‡Œæœ‰é¢˜ç›®å¾—çŸ¥ä¸€å…±æœ‰ä¸¤ä¸ªå²›å±¿ï¼Œå…¶ä½™çš„éƒ½æ˜¯æ°´ï¼Œè¿™é‡Œç”¨ç¤ºä¾‹4æ¥è¯´</p><p>åˆšå¼€å§‹ä¸¤åº§å²›å±¿æ˜¯éš”å¼€çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆéå†å…¶ä¸­ä¸€ä¸ªå²›å±¿ï¼Œå¹¶æŠŠæ•´ä¸ªå²›å±¿éå†å®Œï¼ŒåŒæ—¶è¾¹éå†è¾¹æŠŠè¿™ä¸ªå²›çš„<code>1</code>æ”¹æˆ<code>2</code>ä½œä¸ºæ ‡è®°</p><p>å½“æŠŠè¿™ä¸ªå²›å…¨éƒ¨éå†å®Œæ—¶ï¼Œæ­¤æ—¶åœ°å›¾ä¸Šæœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šå²›å±¿1ã€å²›å±¿2å’Œæ°´</p><p>ç´§æ¥ç€å†é€‰æ‹©ä¸€ä¸ªå²›å±¿ï¼ˆè¿™é‡Œå‡è®¾é€‰æ‹©å²›å±¿1ï¼‰ï¼Œä½¿ç”¨å¹¿åº¦æœç´¢å±‚å±‚éå†ï¼Œå½“ç¬¬ä¸€æ¬¡é‡åˆ°å²›å±¿2æ—¶èµ°è¿‡çš„å±‚æ•°å°±æ˜¯æœ€çŸ­æ¡¥</p><p>ä»£ç æœ‰ç‚¹å¤šï¼Œå¤§è‡´åˆ†ä¸ºå››ä¸ªæ­¥éª¤</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> direction<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//æ–¹å‘æ•°ç»„</span>    <span class="token keyword">int</span> <span class="token function">shortestBridge</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> map<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//æ­¥éª¤1ï¼šéå†ä¸€ä¸ªå²›ï¼ŒæŠŠ1æ”¹æˆ2ä½œä¸ºæ ‡è®°</span>        <span class="token comment">//dfs</span>        <span class="token keyword">int</span> findFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ˜¯å¦æ‰¾åˆ°å²›å±¿äº†</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ç¬¬ä¸€å±‚</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ç¬¬äºŒå±‚</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//æ‰¾åˆ°äº†å²›å±¿</span>                    map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>                    <span class="token function">dfs</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ­¥éª¤2ï¼šæ·±åº¦æœç´¢åŒæ—¶æŠŠå½“å‰æ•´ä¸ªå¤§é™†æ¶‚ä¸Š2</span>                    findFlag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°å²›å±¿ï¼Œæ ‡è®°ä»¥ä¾¿é€€å‡ºå¾ªç¯ï¼Œå› ä¸ºæ‰¾åˆ°ä¸€å—å…¶å®ƒç›¸è¿çš„éƒ½ä¼šåœ¨dfsä¸­æ¶‚ä¸Š2</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°åå°±é€€å‡ºäº†</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>findFlag<span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ­¤æ—¶ï¼Œè¿é€šå—å·²æ¶‚è‰²ï¼Œåˆ†ä¸ºä¸‰å—ï¼Œ0æ˜¯æ°´ï¼Œ1å’Œ2ä»£è¡¨ä¸¤ä¸ªè¿é€šå—ï¼ˆå²›1å’Œå²›2ï¼‰</span>        <span class="token comment">//æ­¥éª¤3ï¼šå†é€‰æ‹©ä¸€ä¸ªå²›å±¿ï¼ˆè¿™é‡Œé€‰æ‹©å²›å±¿1ï¼‰ï¼Œä¸ºå¹¿åº¦æœç´¢é˜Ÿåˆ—åšå‡†å¤‡è€Œå…¥åˆ—</span>        <span class="token keyword">int</span> step<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•å±‚æ•°ï¼Œæœ€ç»ˆè¿”å›çš„ç­”æ¡ˆ</span>        queue<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">>></span> qMap<span class="token punctuation">;</span><span class="token comment">//é€‰æ‹©pairæ˜¯ä¸ºäº†å­˜å‚¨åæ ‡</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//æŠŠå²›å±¿1çš„ç‚¹åæ ‡å…¨éƒ¨å…¥åˆ—</span>                    qMap<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ­¥éª¤4ï¼šå¹¿åº¦æœç´¢é˜Ÿåˆ—ä¸­çš„å²›å±¿ï¼Œå±‚å±‚æ¨è¿›å‘å¤–æ‰©å¼ </span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>qMap<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//é˜Ÿåˆ—ä¸ä¸ºç©ºå°±åœ¨å¾ªç¯å†…</span>            <span class="token keyword">int</span> size <span class="token operator">=</span> qMap<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å½“å‰å±‚è¦éå†çš„æ¬¡æ•°</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span> cur <span class="token operator">=</span> qMap<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> x<span class="token operator">=</span>cur<span class="token punctuation">.</span>first<span class="token punctuation">;</span>                <span class="token keyword">int</span> y<span class="token operator">=</span>cur<span class="token punctuation">.</span>second<span class="token punctuation">;</span>                qMap<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>index<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token operator">++</span>index<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//å‘å››å‘¨æ‰©æ•£</span>                    <span class="token keyword">int</span> x_next<span class="token operator">=</span>x<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">int</span> y_next<span class="token operator">=</span>y<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>x_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>x_next<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//æ‰¾åˆ°å²›å±¿2ï¼Œå¯ä»¥è¿”å›äº†</span>                            <span class="token keyword">return</span> step<span class="token punctuation">;</span>                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//éå†çš„è¿˜æ˜¯å½“å‰å²›å±¿çš„ç‰ˆå—ï¼Œç»§ç»­æœç´¢</span>                            <span class="token keyword">continue</span><span class="token punctuation">;</span>                        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                            <span class="token comment">//éå†çš„æ˜¯æµ·æ´‹</span>                            qMap<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>x_next<span class="token punctuation">,</span>y_next<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å…¥é˜Ÿåˆ—</span>                            map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//æ¶‚è‰²ï¼Œé˜²æ­¢éå†é‡å¤</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            step<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//éå†ä¸€å±‚ç»“æŸï¼Œç­”æ¡ˆåŠ ä¸€</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ·±åº¦æœç´¢ï¼Œå°†æ•´å—å¤§é™†çš„1æ”¹æˆ2</span>    <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> map<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>index<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token operator">++</span>index<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¾€å››ä¸ªæ–¹å‘æ‰©å¼ </span>            <span class="token keyword">int</span> x_next<span class="token operator">=</span>x<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> y_next<span class="token operator">=</span>y<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>x_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>x_next<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//é™åˆ¶æ¡ä»¶ï¼Œæ‰€å¯»æ‰¾çš„ä¸‹ä¸€ä¸ªç‚¹æ²¡æœ‰è¶Šç•Œï¼ŒåŒæ—¶ä¸‹ä¸€ä¸ªç‚¹ä¹Ÿæ˜¯å±äºé™†åœ°</span>                map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//æ¶‚è‰²</span>                <span class="token function">dfs</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span>x_next<span class="token punctuation">,</span>y_next<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»§ç»­æœç´¢</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ï¼šO(MN)ï¼Œå…¶ä¸­ M å’Œ N åˆ†åˆ«æ˜¯æ•°ç»„è¡Œæ•°å’Œåˆ—æ•°</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(MN)</p><hr><h2 id="126-å•è¯æ¥é¾™-II-â€”ï¼ˆå›°éš¾ï¼‰"><a href="#126-å•è¯æ¥é¾™-II-â€”ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="126. å•è¯æ¥é¾™ II  â€”ï¼ˆå›°éš¾ï¼‰"></a><a href="https://leetcode-cn.com/problems/word-ladder-ii/">126. å•è¯æ¥é¾™ II</a>  â€”ï¼ˆå›°éš¾ï¼‰</h2><p>æŒ‰å­—å…¸ wordList å®Œæˆä»å•è¯ beginWord åˆ°å•è¯ endWord è½¬åŒ–ï¼Œä¸€ä¸ªè¡¨ç¤ºæ­¤è¿‡ç¨‹çš„ è½¬æ¢åºåˆ— æ˜¯å½¢å¼ä¸Šåƒ beginWord -&gt; s1 -&gt; s2 -&gt; â€¦ -&gt; sk è¿™æ ·çš„å•è¯åºåˆ—ï¼Œå¹¶æ»¡è¶³ï¼š</p><ul><li>æ¯å¯¹ç›¸é‚»çš„å•è¯ä¹‹é—´ä»…æœ‰å•ä¸ªå­—æ¯ä¸åŒã€‚</li><li>è½¬æ¢è¿‡ç¨‹ä¸­çš„æ¯ä¸ªå•è¯ siï¼ˆ1 &lt;= i &lt;= kï¼‰å¿…é¡»æ˜¯å­—å…¸ wordList ä¸­çš„å•è¯ã€‚æ³¨æ„ï¼ŒbeginWord ä¸å¿…æ˜¯å­—å…¸ wordList ä¸­çš„å•è¯ã€‚</li><li>sk == endWord</li></ul><p>ç»™ä½ ä¸¤ä¸ªå•è¯ beginWord å’Œ endWord ï¼Œä»¥åŠä¸€ä¸ªå­—å…¸ wordList ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›æ‰€æœ‰ä» beginWord åˆ° endWord çš„ æœ€çŸ­è½¬æ¢åºåˆ— ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„è½¬æ¢åºåˆ—ï¼Œè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚æ¯ä¸ªåºåˆ—éƒ½åº”è¯¥ä»¥å•è¯åˆ—è¡¨ [beginWord, s1, s2, â€¦, sk] çš„å½¢å¼è¿”å›</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šbeginWord = â€œhitâ€, endWord = â€œcogâ€, wordList = [â€œhotâ€,â€dotâ€,â€dogâ€,â€lotâ€,â€logâ€,â€cogâ€]<br>è¾“å‡ºï¼š[[â€œhitâ€,â€hotâ€,â€dotâ€,â€dogâ€,â€cogâ€],[â€œhitâ€,â€hotâ€,â€lotâ€,â€logâ€,â€cogâ€]]<br>è§£é‡Šï¼šå­˜åœ¨ 2 ç§æœ€çŸ­çš„è½¬æ¢åºåˆ—ï¼š<br>â€œhitâ€ -&gt; â€œhotâ€ -&gt; â€œdotâ€ -&gt; â€œdogâ€ -&gt; â€œcogâ€<br>â€œhitâ€ -&gt; â€œhotâ€ -&gt; â€œlotâ€ -&gt; â€œlogâ€ -&gt; â€œcogâ€</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šbeginWord = â€œhitâ€, endWord = â€œcogâ€, wordList = [â€œhotâ€,â€dotâ€,â€dogâ€,â€lotâ€,â€logâ€]<br>è¾“å‡ºï¼š[]<br>è§£é‡Šï¼šendWord â€œcogâ€ ä¸åœ¨å­—å…¸ wordList ä¸­ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ç¬¦åˆè¦æ±‚çš„è½¬æ¢åºåˆ—ã€‚</p></blockquote><p><strong>æç¤ºï¼š</strong></p><ul><li>1 &lt;= beginWord.length &lt;= 7</li><li>endWord.length == beginWord.length</li><li>1 &lt;= wordList.length &lt;= 5000</li><li>wordList[i].length == beginWord.length</li><li>beginWordã€endWord å’Œ wordList[i] ç”±å°å†™è‹±æ–‡å­—æ¯ç»„æˆ</li><li>beginWord != endWord</li><li>wordList ä¸­çš„æ‰€æœ‰å•è¯ <strong>äº’ä¸ç›¸åŒ</strong></li></ul><p>é¢˜ç›®ç¬¬ä¸€çœ¼çœ‹ä¸Šå»å¾ˆå¤æ‚ï¼Œéœ€è¦å¤šè¯»å‡ éï¼Œæ³¨æ„åˆ°ç¤ºä¾‹1ä¸­å‡è®¾æœ‰å¤šæ¡æœ€çŸ­çš„è½¬æ¢åºåˆ—ï¼Œè¿™äº›åºåˆ—éƒ½è¦è¿”å›ï¼Œè¿™ä¸ªç‚¹ä¸èƒ½å¿˜è®°ã€‚å…¶æ¬¡æ˜¯<code>beginWord</code>å¯ä»¥ä¸åœ¨å­—å…¸å†…ï¼Œä½†æ˜¯<code>endWord</code>ä¸€å®šè¦åœ¨é‡Œè¾¹ï¼Œå¦‚æœä¸åœ¨çš„è¯å°±è¦è¿”å›ç©ºæ•°ç»„</p><p>è¿™é“é¢˜æˆ‘ä»¬æŠŠå­—å…¸é‡Œçš„æ¯ä¸ªå•è¯çœ‹æˆä¸åŒçš„èŠ‚ç‚¹ï¼Œå€Ÿç”¨LeetCodeå®˜æ–¹è§£ç­”çš„å›¾å°±æ˜¯ä¸‹é¢è¿™æ ·</p><p><img src="https://i.loli.net/2021/08/02/JtMma8hzRXOT4uS.png"></p><p>ç„¶åä»å¼€å§‹çš„å•è¯å¾ªåºæ¸è¿›åˆ°æœ€åä¸€ä¸ªå•è¯çš„è¿‡ç¨‹å¦‚ä¸‹</p><p><img src="F:\ç¼–ç¨‹\LeetCodeåˆ·é¢˜ç¬”è®°\å›¾ç‰‡\ç¬¬ä¸€æœŸ\æ·±åº¦æœç´¢\126\126_fig2.png" alt="126_fig2"></p><p>æ˜ç™½è¿™ä¸ªä¹‹åï¼Œæˆ‘ä»¬å°±è¦æ€è€ƒæ€ä¹ˆéå†å®ƒä»¬</p><p>æˆ‘ä»¬å¯ä»¥æŠŠèµ·å§‹å­—ç¬¦ä¸²ã€ç»ˆæ­¢å­—ç¬¦ä¸²ã€ä»¥åŠå•è¯è¡¨é‡Œæ‰€æœ‰çš„å­—ç¬¦ä¸²æƒ³è±¡æˆèŠ‚ç‚¹ã€‚è‹¥ä¸¤ä¸ªå­—ç¬¦<br>ä¸²åªæœ‰ä¸€ä¸ªå­—ç¬¦ä¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬ç›¸è¿ã€‚å› ä¸ºé¢˜ç›®éœ€è¦è¾“å‡ºä¿®æ”¹æ¬¡æ•°æœ€å°‘çš„æ‰€æœ‰ä¿®æ”¹æ–¹å¼ï¼Œå› æ­¤æˆ‘<br>ä»¬å¯ä»¥ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œæ±‚å¾—èµ·å§‹èŠ‚ç‚¹åˆ°ç»ˆæ­¢èŠ‚ç‚¹çš„æœ€çŸ­è·ç¦»</p><p>ä¸ºä»€ä¹ˆä¸ç”¨DFSçš„åŸå› æ˜¯DFSéœ€è¦å‰ªæï¼Œå¤„ç†èµ·æ¥æ¯”è¾ƒéº»çƒ¦</p><p>ä¸€èˆ¬çš„BFSæ¨¡æ¿å¥—è·¯å¦‚ä¸‹</p><blockquote><p>å®šä¹‰ å±‚èŠ‚ç‚¹ å®¹å™¨<br>æ ¹èŠ‚ç‚¹ å‹å…¥å®¹å™¨å†…<br>while (å®¹å™¨éç©º) {<br>    è·å–å®¹å™¨å†…èŠ‚ç‚¹çš„ä¸ªæ•°ï¼ˆå³å½“å‰å¤„ç†å±‚èŠ‚ç‚¹ä¸ªæ•°ï¼‰<br>    for (å½“å‰å±‚èŠ‚ç‚¹ä¸ªæ•°) {<br>        ä»å®¹å™¨ä¸­è·å–ä¸€ä¸ªèŠ‚ç‚¹<br>        æŒ‰ä¸šåŠ¡é€»è¾‘å¤„ç†å•ä¸ªèŠ‚ç‚¹<br>        è·å–å½“å‰èŠ‚ç‚¹çš„ å­èŠ‚ç‚¹ å‹å…¥å®¹å™¨å†…<br>    }<br>}</p></blockquote><p>è¿™é¢˜åŒæ ·æ˜¯å¯ä»¥å¥—ç”¨è¿™ä¸ªæ¨¡ç‰ˆæ¥è§£å†³ï¼Œéœ€è¦ä¿®æ”¹çš„ç‚¹ï¼š</p><ul><li>éœ€è¦æ”¹ä¸€ä¸‹ å•ä¸ªèŠ‚ç‚¹ çš„ æ•°æ®ç»“æ„</li><li>å¤„ç†å•ä¸ªèŠ‚ç‚¹çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå›æº¯åšä¸šåŠ¡ï¼ŒHashMapè¾…åŠ©ä¸šåŠ¡é€»è¾‘ï¼‰</li></ul><p>å•ä¸ªèŠ‚ç‚¹çš„ç»“æ„ä½¿ç”¨ <code>vector&lt;string&gt;</code> ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è‡ªä¸Šè€Œä¸‹å•æ¬¡ è½¬æ¢åº çš„ç´¯åŠ å€¼ã€‚</p><pre><code>      hit         \         hit,hot      /          \  hit,hot,dot    hit,hot,lot  /                 \hit,hot,dot,dog     hit,hot,lot,log   /                      \hit,hot,dot,dog,cog       hit,hot,lot,log,cog</code></pre><p>è€ŒèŠ‚ç‚¹å†…çš„æœ€åä¸€ä¸ª string å…ƒç´ å†³å®šäº† ä¸‹å±‚ï¼ˆä¹Ÿå°±æ˜¯æ ‘å‹ç»“æ„çš„å­èŠ‚ç‚¹ï¼‰èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ wordList å†…çš„å€¼ã€‚<br>åœ¨è·å–åˆ°ä¸‹å±‚èŠ‚ç‚¹æ—¶ï¼Œæ˜¯éœ€è¦æŠŠä» wordList é‡Œé¢æ‰¾åˆ°çš„å…ƒç´ ç»™åˆ é™¤ï¼Œé¿å… é‡å¤è½¬æ¢ è¿›å…¥æ­»å¾ªç¯ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åŒå‘æ¥æœç´¢ï¼Œå³ä»èµ·å§‹èŠ‚ç‚¹å’Œç»ˆæ­¢èŠ‚ç‚¹åˆ†åˆ«è¿›è¡Œå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œæ¯æ¬¡åªå»¶å±•å½“å‰å±‚èŠ‚ç‚¹æ•°æœ€å°‘<br>çš„é‚£ä¸€ç«¯ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å‡å°‘æœç´¢çš„æ€»ç»“ç‚¹æ•°ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æœ€çŸ­è·ç¦»ä¸º 4ï¼Œå¦‚æœæˆ‘ä»¬åªä»ä¸€<br>ç«¯æœç´¢ 4 å±‚ï¼Œæ€»éå†èŠ‚ç‚¹æ•°æœ€å¤šæ˜¯ 1 + 2 + 4 + 8 + 16 = 31ï¼›è€Œå¦‚æœæˆ‘ä»¬ä»ä¸¤ç«¯å„æœç´¢ä¸¤å±‚ï¼Œæ€»é<br>å†èŠ‚ç‚¹æ•°æœ€å¤šåªæœ‰ 2 Ã— (1 + 2 + 4) = 14ã€‚  </p><p><strong>åŒå‘éå†ç†è§£èµ·æ¥æ¯”è¾ƒéš¾ï¼Œä¸å¼ºæ±‚ä¸€ä¸‹å­å°±èƒ½æ˜ç™½ï¼Œå¯ä»¥å…ˆç†è§£å¥½å•å‘éå†ï¼Œåˆ°æ—¶å€™å›æ¥å†çœ‹çœ‹åŒå‘çš„å¯èƒ½å°±æ˜ç™½äº†</strong></p><p>è¿™é‡Œå…ˆæ”¾å•å‘éå†çš„ä»£ç </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> <span class="token function">findLadders</span><span class="token punctuation">(</span>string beginWord<span class="token punctuation">,</span> string endWord<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> wordList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//å°†å­—å…¸çš„æ¯ä¸ªå•è¯å½•å…¥å“ˆå¸Œè¡¨ä¸­ï¼Œæ–¹ä¾¿åé¢æŸ¥æ‰¾</span>        unordered_set<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token function">search</span><span class="token punctuation">(</span>wordList<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>wordList<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> res<span class="token punctuation">;</span><span class="token comment">//å¾…è¿”å›ç­”æ¡ˆ</span>        deque<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> worker<span class="token punctuation">;</span><span class="token comment">//å±‚èŠ‚ç‚¹å®¹å™¨ï¼Œè®°å½•æ¯ä¸€å±‚ä¸­å¾—åˆ°çš„è½¬æ¢åºåˆ—</span>        worker<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>beginWord<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”±ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å¼€å§‹å‡ºå‘ï¼Œå°†ä»–ä½œä¸ºæ ¹èŠ‚ç‚¹</span>        <span class="token comment">//bfs</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>worker<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//è®°å½•è¿™ä¸€å±‚å·²ç»è½¬åŒ–çš„ç‚¹ï¼Œåœ¨è¿™ä¸€è½®ç»“æŸæ—¶åœ¨å­—å…¸ä¸­åˆ é™¤ï¼Œé˜²æ­¢ä¸‹æ¬¡å†è®¿é—®</span>            unordered_set<span class="token operator">&lt;</span>string<span class="token operator">></span> visited<span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> worker<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å±‚éå†ï¼Œ</span>                <span class="token comment">//ï¼ˆè¿™é‡Œæ¢æˆint i = 0; i &lt; worker.size(); ++iä¼šè¶…æ—¶ï¼‰</span>                <span class="token comment">//è·å–èŠ‚ç‚¹å®¹å™¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶popæ‰</span>                vector<span class="token operator">&lt;</span>string<span class="token operator">></span> sub <span class="token operator">=</span> worker<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>worker<span class="token punctuation">.</span><span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                <span class="token comment">//å–å¾—è¿™ä¸€è¡Œè½¬æ¢åºåˆ—çš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒå†³å®šä¸‹ä¸€ä¸ªè¦å¯»æ‰¾çš„å…ƒç´ </span>                string tail <span class="token operator">=</span> sub<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>tail<span class="token operator">==</span>endWord<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœå–å¾—çš„æ˜¯æƒ³è¦çš„å­—ç¬¦ä¸²</span>                    res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span><span class="token comment">//?</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>tail<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//å›æº¯è¯•æ¢ï¼Œæ”¹å˜ä¸åŒå­—ç¬¦æ¥è·å–ä¸‹ä¸€ä¸ªè¦èµ°çš„ç‚¹</span>                    <span class="token keyword">char</span> temp <span class="token operator">=</span> tail<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ä¿å­˜åŸæ¥çš„å­—ç¬¦ä»¥ä¾¿æ¢å¤</span>                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">;</span>c<span class="token operator">&lt;=</span><span class="token string">'z'</span><span class="token punctuation">;</span><span class="token operator">++</span>c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">==</span>temp<span class="token punctuation">)</span>                            <span class="token keyword">continue</span><span class="token punctuation">;</span>                        tail<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>c<span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>search<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>tail<span class="token punctuation">)</span><span class="token punctuation">)</span>                            <span class="token keyword">continue</span><span class="token punctuation">;</span>                        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                            <span class="token comment">//è¯•æ¢å­—å…¸ä¸­æ˜¯å¦åŒ…å«å½“å‰ä¸´æ—¶å­—ç¬¦ä¸²</span>                            <span class="token comment">//å¦‚æœåŒ…å«çš„è¯</span>                            visited<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†è¯¥å­—ç¬¦ä¸²è®°å½•ä¸ºå·²è½¬åŒ–çš„ç‚¹</span>                                                        <span class="token comment">//è®°å½•å½“å‰å±‚</span>                            sub<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span>                            worker<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘å®¹å™¨ä¿å­˜å¥½å­èŠ‚ç‚¹</span>                            sub<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å›æº¯æ¢å¤</span>                        <span class="token punctuation">&#125;</span>                                            <span class="token punctuation">&#125;</span>                    tail<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">;</span><span class="token comment">//æŠŠå­—ç¬¦ä¸²æ¢å¤å¥½ï¼Œä»¥å¤‡ä¸‹ä¸€ä¸ªå­—ç¬¦çš„è¯•æ¢</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token comment">//å½“resçš„æ•°ç›®å¤§äº0å°±è¯æ˜æ‰¾åˆ°äº†æ‰€æœ‰è·¯å¾„äº†</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> str<span class="token operator">:</span>visited<span class="token punctuation">)</span>                search<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤å­—å…¸ä¸­å·²ç»ç”¨è¿‡çš„å•è¯ï¼Œé˜²æ­¢ä¸‹æ¬¡å¾ªç¯ç»§ç»­èµ‹å€¼</span>        <span class="token punctuation">&#125;</span><span class="token comment">//end while</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//é»˜è®¤æƒ…å†µè¿”å›ç©º</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œn ä¸º wordList çš„ä¸ªæ•°ï¼›å¿½ç•¥ string çš„å¤åˆ¶å¸¦æ¥æ—¶é—´ï¼Œå’Œ 26 ä¸ªå­—æ¯éå†çš„ç³»æ•°ã€‚</p><p><strong>åŒå‘éå†è§£æ³•è¿™é‡Œå¾…è¡¥å……ï¼Œåªæ”¾ä¸ªä»£ç å…ˆï¼Œå…·ä½“è®²è§£å¯ä»¥å»çœ‹<a href="https://leetcode-cn.com/problems/word-ladder-ii/solution/2chong-jie-fa-jian-ji-dai-ma-qing-xi-jie-3sjt/">è¿™ä¸ªé¢˜è§£</a></strong></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> <span class="token function">findLadders</span><span class="token punctuation">(</span>string beginWord<span class="token punctuation">,</span> string endWord<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> wordList<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//é¦–å…ˆéœ€è¦ä½¿ç”¨é›†åˆä¿å­˜wordListï¼Œå› ä¸ºéœ€è¦åˆ¤æ–­æŸå•è¯æ˜¯å¦åœ¨å•è¯è¡¨ä¸­(countæ–¹æ³•)</span>        vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> result<span class="token punctuation">;</span>        unordered_set<span class="token operator">&lt;</span>string<span class="token operator">></span> words<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span> str <span class="token operator">:</span> wordList<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            words<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//åˆ¤æ–­ç»“æŸå•è¯æ˜¯å¦åœ¨å•è¯åˆ—è¡¨ä¸­ï¼Œå¦‚æœä¸åœ¨ï¼Œåˆ™ç›´æ¥è¿”å›ç©ºè¡¨</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>words<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>endWord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> result<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//åˆ›å»ºä¸¤ä¸ªé›†åˆï¼Œå®ç°åŒå‘æŸ¥æ‰¾</span>        unordered_set<span class="token operator">&lt;</span>string<span class="token operator">></span> q1<span class="token punctuation">&#123;</span>beginWord<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> q2<span class="token punctuation">&#123;</span>endWord<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        words<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>beginWord<span class="token punctuation">)</span><span class="token punctuation">;</span>        words<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>endWord<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//åˆ›å»ºmapé›†åˆä¿å­˜æ¯ä¸ªå•è¯ä¸­ä¸€ä¸ªå­—æ¯å‘ç”Ÿå˜åŒ–å¹¶ä¸”å­˜åœ¨äºå•è¯è¡¨ä¸­çš„å•è¯åˆ—è¡¨</span>        <span class="token comment">//æ­¤mapç”¨äºå¹¿åº¦éå†</span>        unordered_map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> next<span class="token punctuation">;</span>        <span class="token comment">//åŒé›†åˆå¯»æ‰¾ï¼Œæ ‡å¿—å…·ä½“æ˜¯å“ªä¸ªé›†åˆå¯»æ‰¾</span>        <span class="token keyword">bool</span> reversed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">bool</span> find <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment">//nextæ•°æ®çš„æœå¯»</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q1<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//éœ€è¦åˆ›å»ºæ–°çš„é›†åˆä¿å­˜ä¸€è½®éå†ä¸‹æ¥ï¼Œæ¯ä¸ªå•è¯åªæ”¹å˜ä¸€ä¸ªå­—æ¯ä¸”åœ¨å•è¯è¡¨ä¸­çš„å•è¯</span>            <span class="token comment">//å³ä¿å­˜ç¬¬äºŒå±‚éœ€è¦éå†çš„å•è¯</span>            unordered_set<span class="token operator">&lt;</span>string<span class="token operator">></span> q<span class="token punctuation">;</span>            <span class="token comment">//éå†q1ä¸­çš„æ¯ä¸ªå•è¯</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span> w <span class="token operator">:</span> q1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                string s <span class="token operator">=</span> w<span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> j <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//ä¿å­˜æ”¹å˜çš„å­—ç¬¦ï¼Œåœ¨æ¯ä¸€è½®æœ€åå¤åŸå•è¯</span>                    <span class="token keyword">char</span> ch <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">char</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span> <span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'a'</span><span class="token punctuation">;</span>                        <span class="token comment">//å¦‚æœq2é›†åˆä¸­æœ‰æ­¤å•è¯åˆ™è¯´æ˜æŸ¥æ‰¾æˆåŠŸ</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>q2<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            reversed <span class="token operator">?</span> next<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token operator">:</span> next<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>                            find <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            reversed <span class="token operator">?</span> next<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token operator">:</span> next<span class="token punctuation">[</span>w<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>                            q<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment">//words.erase(s);</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token comment">//æ”¹å›æ¥</span>                    s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> ch<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>find<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span> s<span class="token operator">:</span> q<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                words<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">//q1ä¿å­˜ä¸‹ä¸€è¶Ÿéœ€è¦éå†çš„å•è¯é›†åˆ</span>            <span class="token comment">//q2åˆ™ä¿å­˜å¦ä¸€ä¸ªé›†åˆ</span>            <span class="token comment">//è°å°éå†è°ï¼Œå‡å°å¼€é”€</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> q2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                q1 <span class="token operator">=</span> q<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                q1 <span class="token operator">=</span> q2<span class="token punctuation">;</span>                q2 <span class="token operator">=</span> q<span class="token punctuation">;</span>                reversed <span class="token operator">=</span> <span class="token operator">!</span>reversed<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>        <span class="token comment">//ç°åœ¨éœ€è¦å¯¹æ„é€ å¥½çš„nextè¿›è¡ŒæŸ¥æ‰¾,å¹¶æ‰¾åˆ°æ‰€æœ‰è·¯å¾„</span>        vector<span class="token operator">&lt;</span>string<span class="token operator">></span> path<span class="token punctuation">&#123;</span> beginWord <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token function">bfs</span><span class="token punctuation">(</span>next<span class="token punctuation">,</span> result<span class="token punctuation">,</span> path<span class="token punctuation">,</span> beginWord<span class="token punctuation">,</span> endWord<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">bfs</span><span class="token punctuation">(</span>unordered_map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span><span class="token operator">&amp;</span> next<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>string<span class="token operator">>></span> <span class="token operator">&amp;</span>result<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token operator">&amp;</span>path <span class="token punctuation">,</span> string <span class="token operator">&amp;</span> src<span class="token punctuation">,</span> string <span class="token operator">&amp;</span> des<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>src <span class="token operator">==</span> des<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            result<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">auto</span> <span class="token operator">&amp;</span> s <span class="token operator">:</span> next<span class="token punctuation">[</span>src<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            path<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">bfs</span><span class="token punctuation">(</span>next <span class="token punctuation">,</span> result <span class="token punctuation">,</span> path <span class="token punctuation">,</span> s <span class="token punctuation">,</span> des<span class="token punctuation">)</span><span class="token punctuation">;</span>            path<span class="token punctuation">.</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="130-è¢«å›´ç»•çš„åŒºåŸŸ-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#130-è¢«å›´ç»•çš„åŒºåŸŸ-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="130. è¢«å›´ç»•çš„åŒºåŸŸ  â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/surrounded-regions/">130. è¢«å›´ç»•çš„åŒºåŸŸ</a>  â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ª <code>m x n</code> çš„çŸ©é˜µ <code>board</code> ï¼Œç”±è‹¥å¹²å­—ç¬¦ <code>&#39;X&#39;</code> å’Œ <code>&#39;O&#39;</code> ï¼Œæ‰¾åˆ°æ‰€æœ‰è¢« <code>&#39;X&#39;</code> å›´ç»•çš„åŒºåŸŸï¼Œå¹¶å°†è¿™äº›åŒºåŸŸé‡Œæ‰€æœ‰çš„ <code>&#39;O&#39;</code> ç”¨ <code>&#39;X&#39;</code> å¡«å……ã€‚</p><p>ç¤ºä¾‹1ï¼š</p><img src="https://i.loli.net/2021/08/03/uURHlsoYcjTyCXt.jpg" style="zoom:80%;" /><blockquote><p>è¾“å…¥ï¼šboard = [[â€œXâ€,â€Xâ€,â€Xâ€,â€Xâ€],[â€œXâ€,â€Oâ€,â€Oâ€,â€Xâ€],[â€œXâ€,â€Xâ€,â€Oâ€,â€Xâ€],[â€œXâ€,â€Oâ€,â€Xâ€,â€Xâ€]]<br>è¾“å‡ºï¼š[[â€œXâ€,â€Xâ€,â€Xâ€,â€Xâ€],[â€œXâ€,â€Xâ€,â€Xâ€,â€Xâ€],[â€œXâ€,â€Xâ€,â€Xâ€,â€Xâ€],[â€œXâ€,â€Oâ€,â€Xâ€,â€Xâ€]]<br>è§£é‡Šï¼šè¢«å›´ç»•çš„åŒºé—´ä¸ä¼šå­˜åœ¨äºè¾¹ç•Œä¸Šï¼Œæ¢å¥è¯è¯´ï¼Œä»»ä½•è¾¹ç•Œä¸Šçš„ â€˜Oâ€™ éƒ½ä¸ä¼šè¢«å¡«å……ä¸º â€˜Xâ€™ã€‚ ä»»ä½•ä¸åœ¨è¾¹ç•Œä¸Šï¼Œæˆ–ä¸ä¸è¾¹ç•Œä¸Šçš„ â€˜Oâ€™ ç›¸è¿çš„ â€˜Oâ€™ æœ€ç»ˆéƒ½ä¼šè¢«å¡«å……ä¸º â€˜Xâ€™ã€‚å¦‚æœä¸¤ä¸ªå…ƒç´ åœ¨æ°´å¹³æˆ–å‚ç›´æ–¹å‘ç›¸é‚»ï¼Œåˆ™ç§°å®ƒä»¬æ˜¯â€œç›¸è¿â€çš„ã€‚</p></blockquote><p>ç¤ºä¾‹2ï¼š</p><blockquote><p>è¾“å…¥ï¼šboard = [[â€œXâ€]]<br>è¾“å‡ºï¼š[[â€œXâ€]]</p></blockquote><p>æç¤ºï¼š</p><ul><li>m == board.length</li><li>n == board[i].length</li><li>1 &lt;= m, n &lt;= 200</li><li>board[i][j] ä¸º â€˜Xâ€™ æˆ– â€˜Oâ€™</li></ul><p>è¿™é“é¢˜åˆšå¼€å§‹æˆ‘å°±æ‹¿æ¥è‡ªå·±åšï¼Œåšæ³•æ˜¯æŒ‰é¡ºåºæ‰«æï¼Œç„¶ååšæ ‡è®°ç­‰ï¼Œä½†æ˜¯åšåˆ°åé¢çš„ç”¨ä¾‹éƒ½ä¼šæœ‰å‡ ä¸ªè¿‡ä¸äº†ï¼Œä¸€ç›´æ”¹æ¥æ”¹å»å¯¼è‡´ä»£ç è‡ƒè‚¿ï¼Œè¾¾åˆ°äº†ä¸€ç™¾å¤šè¡Œï¼Œå› æ­¤åªèƒ½æ¢ç§æ–¹æ³•</p><p>å…ˆæ¥åˆ†æé¢˜å¹²ï¼Œæœ¬é¢˜ç»™å®šçš„çŸ©é˜µä¸­æœ‰ä¸‰ç§å…ƒç´ ï¼š  å­—æ¯ Xï¼› è¢«å­—æ¯ X åŒ…å›´çš„å­—æ¯ Oï¼› æ²¡æœ‰è¢«å­—æ¯ X åŒ…å›´çš„å­—æ¯ Oã€‚æœ¬é¢˜è¦æ±‚å°†æ‰€æœ‰è¢«å­—æ¯ X åŒ…å›´çš„å­—æ¯ Oéƒ½å˜ä¸ºå­—æ¯ X ï¼Œä½†å¾ˆéš¾åˆ¤æ–­å“ªäº› O æ˜¯è¢«åŒ…å›´çš„ï¼Œå“ªäº› O ä¸æ˜¯è¢«åŒ…å›´çš„ã€‚</p><p>æ­¤é¢˜ç›®ä¸­è¦æ³¨æ„çš„æ˜¯åœ¨<strong>è¾¹ç•Œ</strong>ä¸­çš„ <code>O</code>éƒ½ä¸ä¼šç»™å¡«å……æˆ<code>X</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä»è¿™é‡Œä¸‹æ‰‹ï¼Œå…ˆæ¢æµ‹è¾¹ç•Œä¸­æœ‰<code>O</code>çš„åœ°æ–¹ï¼Œä¹‹åå†ç”±æ­¤å»¶å±•åˆ°å†…éƒ¨ï¼Œå°†ç›¸è¿çš„Oéƒ½æ ‡è®°ä¸ºä¸€ä¸ªå€¼ï¼ˆå‡è®¾æ ‡è®°ä¸º<code>B</code>ï¼‰</p><p>å¾…åˆ°å…¨éƒ¨è¾¹ç•ŒOä»¥åŠä¸å®ƒç›¸è¿çš„Oéƒ½æ ‡è®°å®Œåï¼Œæ­¤æ—¶çš„å¹³é¢ä¸Šåªæœ‰ä¸‰ç§å€¼ï¼Œä¸€ä¸ªæ˜¯<code>X</code>ï¼Œä¸€ä¸ªæ˜¯<code>O</code>ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯<code>B</code>ï¼Œè¿™ä¸ªæ—¶å€™çš„Béƒ½æ˜¯ä¸å¯ä»¥å¡«å……çš„ï¼Œå› ä¸ºä»–ä»¬éƒ½ä¸è¾¹ç•Œå€¼ç›¸è¿ï¼Œä¸æ»¡è¶³æ¡ä»¶ã€‚å› æ­¤æˆ‘ä»¬åªç”¨æŠŠå‰©ä¸‹çš„Oå¡«å……ä¸ºXå°±è¡Œäº†</p><p>æˆ‘ä»¬å°±å¯ä»¥å†æ¬¡æŒ‰é¡ºåºæ‰«æï¼Œé‡åˆ°Bå›æ»šä¸ºOï¼Œé‡åˆ°Oåˆ™å¡«å……ä¸ºXï¼Œè¿™é‡Œä¸ç”¨æ‹…å¿ƒä¼šææ··ï¼Œå› ä¸ºæ˜¯æŒ‰é¡ºåºæ‰«æçš„</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token comment">//å…¨å±€å˜é‡ï¼Œä¸ç”¨é‡å¤è®¡ç®—</span>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> col <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> direction<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//æ–¹å‘ä¸Šã€å·¦ã€ä¸‹ã€å³</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">solve</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token operator">&amp;</span> board<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        row <span class="token operator">=</span> board<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¡Œæ•°</span>        col <span class="token operator">=</span> board<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ—æ•°</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>x <span class="token operator">&lt;</span> row<span class="token punctuation">;</span><span class="token operator">++</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ç¬¬ä¸€å±‚éå†</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>y <span class="token operator">&lt;</span> col<span class="token punctuation">;</span><span class="token operator">++</span>y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ç¬¬äºŒå±‚éå†</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span>x<span class="token operator">==</span>row<span class="token operator">-</span><span class="token number">1</span><span class="token operator">||</span>y<span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span>y<span class="token operator">==</span>col<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'O'</span><span class="token punctuation">)</span>                    <span class="token function">dfs</span><span class="token punctuation">(</span>board<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token comment">//end y</span>        <span class="token punctuation">&#125;</span><span class="token comment">//end x</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>x <span class="token operator">&lt;</span> row<span class="token punctuation">;</span><span class="token operator">++</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ç¬¬ä¸€å±‚éå†</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>y <span class="token operator">&lt;</span> col<span class="token punctuation">;</span><span class="token operator">++</span>y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ç¬¬äºŒå±‚éå†</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'B'</span><span class="token punctuation">)</span>                    board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'O'</span><span class="token punctuation">;</span>                <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'O'</span><span class="token punctuation">)</span>                    board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'X'</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token comment">//end y</span>        <span class="token punctuation">&#125;</span><span class="token comment">//end x</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">>></span><span class="token operator">&amp;</span> board<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ˜¯Oçš„è¯å°±æ ‡è®°ä¸ºB</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>x<span class="token operator">></span>row<span class="token operator">-</span><span class="token number">1</span><span class="token operator">||</span>y<span class="token operator">&lt;</span><span class="token number">0</span><span class="token operator">||</span>y<span class="token operator">></span>col<span class="token operator">-</span><span class="token number">1</span><span class="token operator">||</span>board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token string">'O'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'O'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            board<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//ä»è¾¹ç•Œå¾€é‡Œé¢æ‰©å±•ï¼Œæ ‡è®°ä¸ºB</span>        <span class="token keyword">int</span> x_next<span class="token punctuation">;</span>        <span class="token keyword">int</span> y_next<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¾€ä¸åŒæ–¹å‘æœç´¢</span>            x_next<span class="token operator">=</span>x<span class="token operator">+</span>direction<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            y_next<span class="token operator">=</span>y<span class="token operator">+</span>direction<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>board<span class="token punctuation">,</span>x_next<span class="token punctuation">,</span>y_next<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸ºO(M*N)ï¼ŒMä¸ºå¹³é¢è¡Œæ•°ï¼ŒNä¸ºå¹³é¢åˆ—æ•°ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªç‚¹è‡³å¤šåªä¼šè¢«æ ‡è®°ä¸€æ¬¡ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ä¸ºO(M*N)ï¼Œä¸»è¦ä¸ºæ·±åº¦ä¼˜å…ˆæœç´¢çš„æ ˆçš„å¼€é”€ã€‚</p><hr><h1 id="åˆ†æ²»æ³•"><a href="#åˆ†æ²»æ³•" class="headerlink" title="åˆ†æ²»æ³•"></a>åˆ†æ²»æ³•</h1><p>é¡¾åæ€ä¹‰ï¼Œ åˆ†æ²»é—®é¢˜ç”±â€œåˆ†â€ï¼ˆdivideï¼‰å’Œâ€œæ²»â€ï¼ˆconquerï¼‰ä¸¤éƒ¨åˆ†ç»„æˆï¼Œé€šè¿‡æŠŠåŸé—®é¢˜åˆ†ä¸ºå­é—®é¢˜ï¼Œå†å°†å­é—®é¢˜è¿›è¡Œå¤„ç†åˆå¹¶ï¼Œä»è€Œå®ç°å¯¹åŸé—®é¢˜çš„æ±‚è§£ã€‚  </p><p>å½’å¹¶æ’åºå°±æ˜¯å…¸å‹çš„åˆ†æ²»é—®é¢˜ï¼Œå…¶ä¸­â€œåˆ†â€å³ä¸ºæŠŠå¤§æ•°ç»„å¹³å‡åˆ†æˆä¸¤ä¸ªå°æ•°ç»„ï¼Œé€šè¿‡é€’å½’å®ç°ï¼Œæœ€ç»ˆæˆ‘ä»¬ä¼šå¾—åˆ°å¤šä¸ªé•¿åº¦ä¸º 1 çš„å­æ•°ç»„;â€œæ²»â€å³ä¸ºæŠŠå·²ç»æ’å¥½åºçš„ä¸¤ä¸ªå°æ•°ç»„åˆæˆä¸ºä¸€ä¸ªæ’å¥½åºçš„å¤§æ•°ç»„ï¼Œä»é•¿åº¦ä¸º 1 çš„å­æ•°ç»„å¼€å§‹ï¼Œæœ€ç»ˆåˆæˆä¸€ä¸ªå¤§æ•°ç»„ã€‚  </p><p>æˆ‘ä»¬ä¹Ÿä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼æ¥è¡¨ç¤ºè¿™ä¸ªè¿‡ç¨‹ã€‚å®šä¹‰ T(n) è¡¨ç¤ºå¤„ç†ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„çš„æ—¶é—´å¤æ‚åº¦ï¼Œåˆ™å½’å¹¶æ’åºçš„æ—¶é—´å¤æ‚åº¦é€’æ¨å…¬å¼ä¸º T(n) = 2T(n/2) + O(n)ã€‚å…¶ä¸­ 2T(n/2) è¡¨ç¤ºæˆ‘ä»¬åˆ†æˆäº†ä¸¤ä¸ªé•¿åº¦å‡åŠçš„å­é—®é¢˜ï¼Œ O(n) åˆ™ä¸ºåˆå¹¶ä¸¤ä¸ªé•¿åº¦ä¸º n/2 æ•°ç»„çš„æ—¶é—´å¤æ‚åº¦ã€‚é‚£ä¹ˆæ€ä¹ˆåˆ©ç”¨è¿™ä¸ªé€’æ¨å…¬å¼å¾—åˆ°æœ€ç»ˆçš„æ—¶é—´å¤æ‚åº¦å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è‘—åçš„ä¸»å®šç†ï¼ˆMaster theoremï¼‰æ±‚è§£ï¼š</p><p>å®šç† 8.1. ä¸»å®šç†</p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210804175401668.png" alt="image-20210804175401668" style="zoom:80%;" /><p>é€šè¿‡ä¸»å®šç†æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå½’å¹¶æ’åºå±äºç¬¬äºŒç§æƒ…å†µï¼Œä¸”æ—¶é—´å¤æ‚åº¦ä¸º O(n log n)ã€‚å…¶ä»–çš„åˆ†æ²»é—®é¢˜ä¹Ÿå¯ä»¥é€šè¿‡ä¸»å®šç†æ±‚å¾—æ—¶é—´å¤æ‚åº¦  </p><h2 id="241-ä¸ºè¿ç®—è¡¨è¾¾å¼è®¾è®¡ä¼˜å…ˆçº§-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#241-ä¸ºè¿ç®—è¡¨è¾¾å¼è®¾è®¡ä¼˜å…ˆçº§-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="241. ä¸ºè¿ç®—è¡¨è¾¾å¼è®¾è®¡ä¼˜å…ˆçº§  â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/different-ways-to-add-parentheses/">241. ä¸ºè¿ç®—è¡¨è¾¾å¼è®¾è®¡ä¼˜å…ˆçº§</a>  â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™å®šä¸€ä¸ªå«æœ‰æ•°å­—å’Œè¿ç®—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œä¸ºè¡¨è¾¾å¼æ·»åŠ æ‹¬å·ï¼Œæ”¹å˜å…¶è¿ç®—ä¼˜å…ˆçº§ä»¥æ±‚å‡ºä¸åŒçš„ç»“æœã€‚ä½ éœ€è¦ç»™å‡ºæ‰€æœ‰å¯èƒ½çš„ç»„åˆçš„ç»“æœã€‚æœ‰æ•ˆçš„è¿ç®—ç¬¦å·åŒ…å« +, - ä»¥åŠ Ã—ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: â€œ2-1-1â€<br>è¾“å‡º: [0, 2]<br>è§£é‡Š:<br>((2-1)-1) = 0<br>(2-(1-1)) = 2</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: â€œ2Ã—3-4Ã—5â€<br>è¾“å‡º: [-34, -14, -10, -10, 10]<br>è§£é‡Š:<br>(2Ã—(3-(4Ã—5))) = -34<br>((2Ã—3)-(4Ã—5)) = -14<br>((2Ã—(3-4))Ã—5) = -10<br>(2Ã—((3-4)Ã—5)) = -10<br>(((2Ã—3)-4)Ã—5) = 10</p></blockquote><p>æ­¤é¢˜ä¸€çœ‹æ˜¯æŒºå¤æ‚çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æ…¢æ…¢æ¥åˆ†æï¼Œç”±ç¤ºä¾‹çš„æ‹¬å·å¯ä»¥çœ‹å‡ºï¼Œæ¯æ¬¡çš„æ‹¬å·å‡ºç°éƒ½æ˜¯åœ¨ç¬¦å·å‡ºç°çš„å‰åï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›ç¬¦å·é€’å½’ä¸‹æ‰‹ï¼Œé‡åˆ°ç¬¦å·å°±åˆ†å¼€ä¸¤ä¸ªæ•°ï¼Œç„¶åè¿›è¡Œè®¡ç®—ç»“æœï¼Œæœ€åå±‚å±‚é€’å½’å¾—åˆ°æœ€ç»ˆç­”æ¡ˆ</p><p>ä»¥ 2 * 3 - 4 * 5 ä¸ºä¾‹ã€‚</p><p>2 å’Œ 3 - 4 * 5 ä¸¤éƒ¨åˆ†ï¼Œä¸­é—´æ˜¯ * å·ç›¸è¿ã€‚</p><p>2 * 3 å’Œ 4 * 5 ä¸¤éƒ¨åˆ†ï¼Œä¸­é—´æ˜¯ - å·ç›¸è¿ã€‚</p><p>2 * 3 - 4 å’Œ 5 ä¸¤éƒ¨åˆ†ï¼Œä¸­é—´æ˜¯ * å·ç›¸è¿ã€‚</p><p>æœ‰äº†ä¸¤éƒ¨åˆ†çš„ç»“æœï¼Œç„¶åå†é€šè¿‡ä¸­é—´çš„ç¬¦å·ä¸¤ä¸¤è®¡ç®—åŠ å…¥åˆ°æœ€ç»ˆçš„ç»“æœä¸­å³å¯ã€‚</p><p>æ¯”å¦‚ç¬¬ä¸€ç§æƒ…å†µï¼Œ2 å’Œ 3 - 4 * 5 ä¸¤éƒ¨åˆ†ï¼Œä¸­é—´æ˜¯ * å·ç›¸è¿ã€‚</p><p>2 çš„è§£å°±æ˜¯ [2]ï¼Œ3 - 4 * 5 çš„è§£å°±æ˜¯ [-5, -17]ã€‚</p><p>æŠŠä¸¤éƒ¨åˆ†è§£é€šè¿‡ * å·è®¡ç®—ï¼Œæœ€ç»ˆç»“æœå°±æ˜¯ [-10, -34]ã€‚</p><p>å¦å¤–ä¸¤ç§æƒ…å†µä¹Ÿç±»ä¼¼ã€‚</p><p>ç„¶åè¿˜éœ€è¦é€’å½’å‡ºå£ã€‚</p><p>å¦‚æœç»™å®šçš„å­—ç¬¦ä¸²åªæœ‰æ•°å­—ï¼Œæ²¡æœ‰è¿ç®—ç¬¦ï¼Œé‚£ç»“æœå°±æ˜¯ç»™å®šçš„å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ï¼Œè¿™ä¸ªå°±è¦ä½œä¸ºé€’å½’å‡ºå£çš„æ¡ä»¶</p><p>æ¯”å¦‚ä¸Šè¾¹çš„ç¬¬ä¸€ç§æƒ…å†µï¼Œ2 çš„è§£å°±æ˜¯ [2]ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">diffWaysToCompute</span><span class="token punctuation">(</span>string expression<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> sLen <span class="token operator">=</span> expression<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>sLen<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> ways<span class="token punctuation">;</span><span class="token comment">//æœ€ç»ˆè¿”å›çš„ç­”æ¡ˆ</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>sLen<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ä»ç¬¬ä¸€ä½å¼€å§‹éå†</span>            <span class="token keyword">char</span> currentChar <span class="token operator">=</span> expression<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å½“å‰éå†åˆ°çš„å­—ç¬¦ä¸²</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>currentChar <span class="token operator">==</span> <span class="token string">'+'</span><span class="token operator">||</span>currentChar <span class="token operator">==</span> <span class="token string">'-'</span><span class="token operator">||</span>currentChar <span class="token operator">==</span> <span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å¦‚æœå½“å‰å­—ç¬¦æ˜¯æœ‰æ•ˆè¿ç®—ç¬¦å·çš„è¯</span>                vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> left <span class="token operator">=</span> <span class="token function">diffWaysToCompute</span><span class="token punctuation">(</span>expression<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é€’å½’ç¬¦å·å‰é¢çš„</span>                vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> right <span class="token operator">=</span> <span class="token function">diffWaysToCompute</span><span class="token punctuation">(</span>expression<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é€’å½’ç¬¦å·åè¾¹çš„</span>                <span class="token comment">//cout&lt;&lt;"size: "&lt;&lt;left.size()&lt;&lt;" "&lt;&lt;right.size()&lt;&lt;endl;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> l <span class="token operator">:</span> left<span class="token punctuation">)</span>                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">&amp;</span> r <span class="token operator">:</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token comment">//cout&lt;&lt;"num: "&lt;&lt;l&lt;&lt;" "&lt;&lt;r&lt;&lt;endl;</span>                        <span class="token keyword">switch</span><span class="token punctuation">(</span>currentChar<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            <span class="token keyword">case</span> <span class="token string">'+'</span><span class="token operator">:</span>ways<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>l<span class="token operator">+</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>                            <span class="token keyword">case</span> <span class="token string">'-'</span><span class="token operator">:</span>ways<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>l<span class="token operator">-</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>                            <span class="token keyword">case</span> <span class="token string">'*'</span><span class="token operator">:</span>ways<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>l<span class="token operator">*</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>ways<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            ways<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">stoi</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ways<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†™å®Œè¿™ä¸ªä¹‹åå¯ä»¥å‘ç°ï¼Œåœ¨é€’å½’è¿‡ç¨‹ä¸­æœ‰è®¸å¤šæ•°æ®è¿›è¡Œäº†é‡å¤è®¡ç®—ï¼Œè¿™æ—¶å€™å°±å¯ä»¥åŠ ä¸€ä¸ªè®°å¿†è¡¨æ¥è®°å½•æ¯æ¬¡è®¡ç®—çš„ç»“æœä»¥ä¾¿åé¢ç›´æ¥è·å¾—è€Œä¸æ˜¯å†æ¬¡è®¡ç®—</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/*åŠ¨æ€è§„åˆ’    é¦–å…ˆå°†å­—ç¬¦ä¸²ä¸­çš„æ•°å­—å’Œæ“ä½œç¬¦åˆ†åˆ«å­˜å‚¨ä¸‹æ¥    ç¬¬iä¸ªæ“ä½œç¬¦å¯¹åº”çš„æ•°å­—æ˜¯iå’Œi+1ï¼ŒåŒç†ç¬¬iä¸ªæ•°çš„å‰é¢çš„æ“ä½œç¬¦æ˜¯i-1ï¼Œåé¢çš„ä¸€ä¸ªæ˜¯iï¼ˆiè¡¨ç¤ºåœ¨æ•°ç»„ä¸­çš„åºå·ï¼‰    dp[i][j]è¡¨ç¤ºä»ç¬¬iä¸ªæ•°å­—åˆ°ç¬¬jä¸ªæ•°å­—çš„æ‰€æœ‰æƒ…å†µ        ï¼ˆ1ï¼‰i==j            ç­‰äºæ•°å­—æœ¬èº«çš„å€¼        ï¼ˆ2ï¼‰i != j(jè‚¯å®šæ˜¯å¤§äºiçš„)             å°†i-jåˆ†æˆä¸¤ä¸ªå¼å­æ¥çœ‹ï¼Œ[i,i]op[i+1,j],[i,i+1]op[i+2,j]...[[i,j-1]]op[j,j]            å°†ä¸Šé¢çš„æ‰€æœ‰æƒ…å†µå…¨éƒ¨ç»„åˆèµ·æ¥            ç°åœ¨éœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜æ˜¯[i,i+k]op[i+k+1,j]çš„opåº”è¯¥æ˜¯opsæ•°ç»„é‡Œé¢çš„å“ªä¸€ä¸ªï¼Œåº”è¯¥æ˜¯ops[i+k]    æœ‰äº†ä»¥ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºåŠ¨æ€è§„åˆ’äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œï¼ˆ2ï¼‰æƒ…å†µä¹Ÿå°±æ˜¯ä¸€ä¸ªéå†ï¼Œä½†æ˜¯éå†çš„é¡ºåºéœ€è¦æ³¨æ„ï¼Œä¸åº”è¯¥æ˜¯[0,j]->[j-1,j]è€Œåº”è¯¥æ˜¯[j-1,j]->[0->j]ã€‚å¦‚æœæ˜¯ä»[0,j]å¼€å§‹ï¼Œä½ ä¼šå‘ç°[1,j]..[j-1,j]è¿™äº›ä½ éœ€è¦çš„éƒ½è¿˜æ²¡ç®—*/</span><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">diffWaysToCompute</span><span class="token punctuation">(</span>string input<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> nums<span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">></span> ops<span class="token punctuation">;</span>        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> input<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isOp</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                nums<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>                ops<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>input<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span>                num <span class="token operator">=</span> num <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> input<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        nums<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">></span> <span class="token function">dp</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> i<span class="token punctuation">;</span> k <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> r1 <span class="token operator">:</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> r2 <span class="token operator">:</span> dp<span class="token punctuation">[</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">calculate</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span>ops<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>r2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">bool</span> <span class="token function">isOp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> c<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> c <span class="token operator">==</span> <span class="token string">'+'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'-'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'*'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> num1<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">&amp;</span> op<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&amp;</span> num2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token string">'+'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>op <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> num1 <span class="token operator">-</span> num2<span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token keyword">return</span> num1 <span class="token operator">*</span> num2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="æ•°å­¦é—®é¢˜"><a href="#æ•°å­¦é—®é¢˜" class="headerlink" title="æ•°å­¦é—®é¢˜"></a>æ•°å­¦é—®é¢˜</h1><h2 id="æœ€å¤§å…¬å› æ•°å’Œæœ€å°å…¬å€æ•°å…¬å¼"><a href="#æœ€å¤§å…¬å› æ•°å’Œæœ€å°å…¬å€æ•°å…¬å¼" class="headerlink" title="æœ€å¤§å…¬å› æ•°å’Œæœ€å°å…¬å€æ•°å…¬å¼"></a>æœ€å¤§å…¬å› æ•°å’Œæœ€å°å…¬å€æ•°å…¬å¼</h2><p>åˆ©ç”¨è¾—è½¬ç›¸é™¤æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ±‚å¾—ä¸¤ä¸ªæ•°çš„æœ€å¤§å…¬å› æ•°ï¼ˆgreatest common divisorï¼Œ gcdï¼‰</p><p>å°†ä¸¤ä¸ªæ•°ç›¸ä¹˜å†é™¤ä»¥æœ€å¤§å…¬å› æ•°å³å¯å¾—åˆ°æœ€å°å…¬å€æ•°ï¼ˆleast common multiple, lcmï¼‰  </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">gcd</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> a <span class="token operator">:</span> <span class="token function">gcd</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">%</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">lcm</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> a <span class="token operator">*</span> b <span class="token operator">/</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿›ä¸€æ­¥åœ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆextended gcdï¼‰åœ¨æ±‚å¾— a å’Œ b æœ€å¤§å…¬å› æ•°çš„åŒæ—¶ï¼Œä¹Ÿå¾—åˆ°å®ƒä»¬çš„ç³»æ•° x å’Œ yï¼Œä»è€Œä½¿ ax + by = gcd(a, b)  </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">xGCD</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> a<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> gcd <span class="token operator">=</span> <span class="token function">xGCD</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">,</span> x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">;</span>    x <span class="token operator">=</span> y1<span class="token punctuation">,</span> y <span class="token operator">=</span> x1 <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">/</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y1<span class="token punctuation">;</span>    <span class="token keyword">return</span> gcd<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="204-è®¡æ•°è´¨æ•°-â€”ï¼ˆç®€å•ï¼‰"><a href="#204-è®¡æ•°è´¨æ•°-â€”ï¼ˆç®€å•ï¼‰" class="headerlink" title="204. è®¡æ•°è´¨æ•°  â€”ï¼ˆç®€å•ï¼‰"></a><a href="https://leetcode-cn.com/problems/count-primes/">204. è®¡æ•°è´¨æ•°</a>  â€”ï¼ˆç®€å•ï¼‰</h2><p>ç»Ÿè®¡æ‰€æœ‰å°äºéè´Ÿæ•´æ•° <em><code>n</code></em> çš„è´¨æ•°çš„æ•°é‡ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šn = 10<br>è¾“å‡ºï¼š4<br>è§£é‡Šï¼šå°äº 10 çš„è´¨æ•°ä¸€å…±æœ‰ 4 ä¸ª, å®ƒä»¬æ˜¯ 2, 3, 5, 7 ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šn = 0<br>è¾“å‡ºï¼š0</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šn = 1<br>è¾“å‡ºï¼š0</p></blockquote><p>æç¤ºï¼š</p><p><code>0 &lt;= n &lt;= 5 * 10^6</code></p><p>è¿™é“é¢˜ä¸»è¦æ˜¯è¦çŸ¥é“åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•ï¼ˆSieve of Eratosthenesï¼Œç®€ç§°åŸƒæ°ç­›æ³•ï¼‰ ï¼Œå…¶åŸç†æ˜¯ä» 1 åˆ° n éå†ï¼Œå‡è®¾å½“å‰éå†åˆ°mï¼Œåˆ™æŠŠæ‰€æœ‰å°äº n çš„ã€ä¸”æ˜¯ m çš„å€æ•°çš„æ•´æ•°æ ‡ä¸ºå’Œæ•°ï¼›éå†å®Œæˆåï¼Œæ²¡æœ‰è¢«æ ‡ä¸ºå’Œæ•°çš„æ•°å­—å³ä¸ºè´¨æ•°   </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">countPrimes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span> <span class="token function">isPrime</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>isPrime<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token operator">++</span>count<span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">;</span> i<span class="token operator">*</span>j <span class="token operator">&lt;</span> n <span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    isPrime<span class="token punctuation">[</span>i<span class="token operator">*</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> count<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬åˆ©ç”¨è´¨æ•°çš„ä¸€äº›æ€§è´¨è¿˜å¯ä»¥å°†ç®—æ³•ä¼˜åŒ–ï¼Œè·³è¿‡ä¸å¿…è¦çš„å¶æ•°ï¼Œå‡å°‘æ—¶é—´å¤æ‚åº¦</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">countPrimes</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//åˆ©ç”¨è´¨æ•°çš„ä¸€äº›æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–è¯¥ç®—æ³•ã€‚</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span> <span class="token function">prime</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> sqrtn <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> n <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//å¶æ•°ä¸€å®šä¸æ˜¯è´¨æ•°</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> sqrtn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//æœ€å°è´¨å› å­ä¸€å®šå°äºç­‰äºå¼€æ–¹æ•°</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i <span class="token operator">*</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j <span class="token operator">+=</span> <span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">// é¿å…å¶æ•°å’Œé‡å¤éå†</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>prime<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token operator">--</span>count<span class="token punctuation">;</span>                    prime<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">do</span><span class="token punctuation">&#123;</span>                i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> sqrtn <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>prime<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// é¿å…å¶æ•°å’Œé‡å¤éå†</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> count<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="264-ä¸‘æ•°-II-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#264-ä¸‘æ•°-II-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="264. ä¸‘æ•° II  â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/ugly-number-ii/">264. ä¸‘æ•° II</a>  â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªæ•´æ•° <code>n</code> ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›ç¬¬ <code>n</code> ä¸ª <strong>ä¸‘æ•°</strong> ã€‚</p><p><strong>ä¸‘æ•°</strong> å°±æ˜¯åªåŒ…å«è´¨å› æ•° <code>2</code>ã€<code>3</code> å’Œ/æˆ– <code>5</code> çš„æ­£æ•´æ•°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šn = 10<br>è¾“å‡ºï¼š12<br>è§£é‡Šï¼š[1, 2, 3, 4, 5, 6, 8, 9, 10, 12] æ˜¯ç”±å‰ 10 ä¸ªä¸‘æ•°ç»„æˆçš„åºåˆ—ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šn = 1<br>è¾“å‡ºï¼š1<br>è§£é‡Šï¼š1 é€šå¸¸è¢«è§†ä¸ºä¸‘æ•°ã€‚</p></blockquote><p>æç¤ºï¼š</p><p><code>1 &lt;= n &lt;= 1690</code></p><p>è¿™é“é¢˜ä¸»è¦æ˜¯ç†è§£ä¸‘æ•°æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼Œå¦‚æœä»1å¼€å§‹è‡ªåº•å‘ä¸Šè®¡ç®—ï¼Œä¸‘æ•°åˆ™æ˜¯ä¸€ä¸ªç‰¹å®šçš„åºåˆ—ï¼Œæ¯ä¸ªæ•°è¦ä¹ˆæ˜¯2çš„å€æ•°ï¼Œè¦ä¹ˆæ˜¯3çš„å€æ•°æˆ–è€…è¦ä¹ˆæ˜¯5çš„å€æ•°ï¼Œä¾‹å¦‚6ã€8éƒ½æ˜¯ä¸‘æ•°ï¼Œä½†7ã€14ä¸æ˜¯ï¼Œå› ä¸ºå®ƒä»¬åŒ…å«<a href="https://baike.baidu.com/item/%E8%B4%A8%E5%9B%A0%E5%AD%90/10720836">è´¨å› å­</a>7ã€‚ ä¹ æƒ¯ä¸Šæˆ‘ä»¬æŠŠ1å½“åšæ˜¯ç¬¬ä¸€ä¸ªä¸‘æ•°ã€‚</p><p>åˆä¾‹å¦‚å‰20ä¸ªä¸‘æ•°ä¸ºï¼š1, 2, 3, 4, 5, 6, 8, 9, 10, 12, 15, 16, 18, 20, 24, 25, 27, 30, 32, 36</p><p>ç†è§£å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥çœ‹é¢˜ç›®äº†ï¼Œé¢˜ç›®è¦æ±‚æˆ‘ä»¬è¾“å‡ºç¬¬nä¸ªä¸‘æ•°ï¼Œnæ˜¯å¤–ç•Œä¼ è¿›æ¥çš„å‚æ•°ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³•æ¥æ¨ç®—å‡ºç¬¬nä¸ªä¸‘æ•°</p><p>è¿™é‡Œç»™äº†ä¸¤ç§æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯æœ€å°å †æ³•ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯ä¸‰æŒ‡é’ˆæ–¹æ³•</p><h3 id="æœ€å°å †æ³•"><a href="#æœ€å°å †æ³•" class="headerlink" title="æœ€å°å †æ³•"></a>æœ€å°å †æ³•</h3><p>æ¯”è¾ƒç®€å•çš„è§£æ³•æ˜¯ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥å®ç°æœ€å°å †ï¼š</p><ol><li>èµ·å§‹å…ˆå°†æœ€å°ä¸‘æ•° 1 æ”¾å…¥é˜Ÿåˆ—</li><li>æ¯æ¬¡ä»é˜Ÿåˆ—å–å‡ºæœ€å°å€¼ xï¼Œå³<code>top()</code>å€¼ï¼Œç„¶åå†åˆ†åˆ«å°†xä¸2ã€3ã€5ç›¸ä¹˜å¾—å‡ºæ¥çš„ç­”æ¡ˆå…¥é˜Ÿ</li><li>å¯¹æ­¥éª¤ 2 å¾ªç¯å¤šæ¬¡ï¼Œç¬¬ n æ¬¡å‡ºé˜Ÿçš„å€¼å³æ˜¯ç­”æ¡ˆ</li></ol><p>åŒæ—¶ä¸ºäº†é˜²æ­¢å¤šä¸ªç›¸åŒçš„æ•°å…¥é˜Ÿå¯¼è‡´ç´¢å¼•é”™ä¹±ï¼Œè¿™é‡Œå¦å¤–ç”¨äº†ä¸ª<code>set</code>æ¥åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦å…¥é˜Ÿè¿‡ï¼Œå¦‚æœæ²¡æœ‰åˆ™å…¥é˜Ÿåˆ—</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">nthUglyNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> nums<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        set<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token operator">></span> s<span class="token punctuation">;</span><span class="token comment">//é›†åˆï¼Œåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦å…¥é˜Ÿè¿‡</span>        priority_queue<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token operator">></span><span class="token punctuation">,</span> greater<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token operator">>></span> q<span class="token punctuation">;</span><span class="token comment">//æœ€å°å †</span>                <span class="token comment">//å°†1ä½œä¸ºç¬¬ä¸€ä¸ªä¸‘æ•°</span>        s<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">long</span> x <span class="token operator">=</span> q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> n<span class="token punctuation">)</span><span class="token comment">//æ¨ç®—åˆ°ç¬¬nä¸ªä¸‘æ•°ç›´æ¥è¿”å›</span>                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>x<span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> num <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> num<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token comment">//å°†xå€¼åˆ†åˆ«ä¸2,3,5ç›¸ä¹˜</span>                <span class="token keyword">long</span> t <span class="token operator">=</span> nums<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">*</span> x<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>s<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­å½“å‰çš„æ•°æ˜¯å¦å…¥é˜Ÿè¿‡ï¼Œå¦‚æœå·²å­˜åœ¨åˆ™è·³è¿‡</span>                <span class="token punctuation">&#123;</span>                    s<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>                    q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n log n)ï¼Œå…¶ä¸­å¾€ä¼˜å…ˆé˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´ èŠ±è´¹O(log n)æ—¶é—´</p><p>ç©ºé—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><h3 id="ä¸‰æŒ‡é’ˆæ³•"><a href="#ä¸‰æŒ‡é’ˆæ³•" class="headerlink" title="ä¸‰æŒ‡é’ˆæ³•"></a>ä¸‰æŒ‡é’ˆæ³•</h3><p>ç”±äºä¸‘æ•°åºåˆ—å¯ä»¥è‡ªåº•å‘ä¸Šæ¨ç®—ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºæ¥å®ƒçš„æ¨ç®—å…¬å¼</p><p>ç”±è´¨å› æ•°2æ¨ç®—ï¼š1Ã—2ã€ 2Ã—2ã€3Ã—2ã€4Ã—2ã€5Ã—2ã€6Ã—2ã€8Ã—2 â€¦â€¦</p><p>ç”±è´¨å› æ•°3æ¨ç®—ï¼š1Ã—3ã€ 2Ã—3ã€3Ã—3ã€4Ã—3ã€5Ã—3ã€6Ã—3ã€8Ã—3 â€¦â€¦</p><p>ç”±è´¨å› æ•°5æ¨ç®—ï¼š1Ã—5ã€ 2Ã—5ã€3Ã—5ã€4Ã—5ã€5Ã—5ã€6Ã—5ã€8Ã—5 â€¦â€¦</p><p>é‰´äºä¸Šé¢çš„å…¬å¼å› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ä¸‰ä¸ªæŒ‡é’ˆï¼ˆä¾‹å¦‚ï¼š<code>p2,p3,p5</code>ï¼‰åˆ†åˆ«æŒ‡å‘è´¨å› æ•°2ã€3ã€5å®ƒä»¬è‡ªå·±çš„å…¬å¼åˆ—</p><p>ç„¶åæ¯æ¬¡éƒ½å°†å®ƒä»¬æ‰€æŒ‡çš„æ•°ä¹˜ä¸Šå¯¹åº”çš„2ã€3æˆ–5ï¼ˆ<code>p2 Ã— 2</code>ã€<code>p3 Ã— 3</code>ã€<code>p5 Ã— 5</code>ï¼‰ï¼Œå¾—å‡ºçš„ä¸‰ä¸ªç»“æœå†å–å‡ºæœ€å°çš„ç»“æœ</p><p>ä¹‹åå†åˆ¤æ–­è¿™ä¸ªç»“æœæ˜¯å“ªå‡ ä¸ªæŒ‡é’ˆä¹˜å‡ºæ¥çš„ï¼Œå¹¶å°†è¯¥æŒ‡é’ˆå¾€å‰è¿›ï¼ˆè¿™ä¸€æ­¥å°±æ˜¯ä¸ºäº†ä»å°åˆ°å¤§æ’åºï¼Œè‡ªåº•å‘ä¸Šæ¨ç®—ï¼‰</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//ä¸‰æŒ‡é’ˆæ–¹æ³•</span><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">nthUglyNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span><span class="token operator">*</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å»ºç«‹æ¨æ¼”æ•°ç»„ï¼Œarr[0]ä¸ç”¨</span>        arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//1ä½œä¸ºç¬¬ä¸€ä¸ªä¸‘æ•°</span>        <span class="token keyword">int</span> p2<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>p3<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>p5<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ä¸‰æŒ‡é’ˆåˆå§‹åŒ–</span>        <span class="token keyword">int</span> index<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//ç´¢å¼•å€¼</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">;</span>index<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>index<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> a<span class="token operator">=</span>arr<span class="token punctuation">[</span>p2<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span>b<span class="token operator">=</span>arr<span class="token punctuation">[</span>p3<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span>c<span class="token operator">=</span>arr<span class="token punctuation">[</span>p5<span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">5</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> minNum <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token function">min</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å–ä¸‰ä¸ªæ•°ä¹˜å‡ºæ¥æœ€å°çš„æ•°å€¼</span>            <span class="token comment">//è¿™é‡Œä¸èƒ½ç”¨else if</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>minNum<span class="token operator">==</span>a<span class="token punctuation">)</span> <span class="token operator">++</span>p2<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>minNum<span class="token operator">==</span>b<span class="token punctuation">)</span> <span class="token operator">++</span>p3<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>minNum<span class="token operator">==</span>c<span class="token punctuation">)</span> <span class="token operator">++</span>p5<span class="token punctuation">;</span>            arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">=</span>minNum<span class="token punctuation">;</span><span class="token comment">//èµ‹å€¼ï¼Œè¿™æ ·å°±å¯ä»¥æŒ‰é¡ºåºä»å°åˆ°å¤§æ¨æ¼”</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> res<span class="token operator">=</span>arr<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span>arr<span class="token punctuation">;</span>                <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><p>ç©ºé—´å¤æ‚åº¦ä¸ºï¼šO(n)</p><hr><h2 id="313-è¶…çº§ä¸‘æ•°-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#313-è¶…çº§ä¸‘æ•°-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="313. è¶…çº§ä¸‘æ•°  â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/super-ugly-number/">313. è¶…çº§ä¸‘æ•°</a>  â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>è¶…çº§ä¸‘æ•° æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œå¹¶æ»¡è¶³å…¶æ‰€æœ‰è´¨å› æ•°éƒ½å‡ºç°åœ¨è´¨æ•°æ•°ç»„ primes ä¸­ã€‚</p><p>ç»™ä½ ä¸€ä¸ªæ•´æ•° n å’Œä¸€ä¸ªæ•´æ•°æ•°ç»„ primes ï¼Œè¿”å›ç¬¬ n ä¸ª è¶…çº§ä¸‘æ•° ã€‚</p><p>é¢˜ç›®æ•°æ®ä¿è¯ç¬¬ n ä¸ª è¶…çº§ä¸‘æ•° åœ¨ 32-bit å¸¦ç¬¦å·æ•´æ•°èŒƒå›´å†…ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šn = 12, primes = [2,7,13,19]<br>è¾“å‡ºï¼š32<br>è§£é‡Šï¼šç»™å®šé•¿åº¦ä¸º 4 çš„è´¨æ•°æ•°ç»„ primes = [2,7,13,19]ï¼Œå‰ 12 ä¸ªè¶…çº§ä¸‘æ•°åºåˆ—ä¸ºï¼š[1,2,4,7,8,13,14,16,19,26,28,32] ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šn = 1, primes = [2,3,5]<br>è¾“å‡ºï¼š1<br>è§£é‡Šï¼š1 ä¸å«è´¨å› æ•°ï¼Œå› æ­¤å®ƒçš„æ‰€æœ‰è´¨å› æ•°éƒ½åœ¨è´¨æ•°æ•°ç»„ primes = [2,3,5] ä¸­ã€‚</p></blockquote><p>æç¤ºï¼š</p><ul><li>1 &lt;= n &lt;= 106</li><li>1 &lt;= primes.length &lt;= 100</li><li>2 &lt;= primes[i] &lt;= 1000</li><li>é¢˜ç›®æ•°æ® ä¿è¯ primes[i] æ˜¯ä¸€ä¸ªè´¨æ•°</li><li>primes ä¸­çš„æ‰€æœ‰å€¼éƒ½ äº’ä¸ç›¸åŒ ï¼Œä¸”æŒ‰ é€’å¢é¡ºåº æ’åˆ—</li></ul><p>è¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜å”¯ä¸€ä¸åŒçš„åœ°æ–¹å°±æ˜¯åœ¨äºç»™å®šçš„è´¨å› æ•°ä¸å›ºå®šï¼Œè¿™ä¸€é¢˜çš„è´¨å› æ•°æ˜¯ç”±å¤–ç•Œæä¾›çš„ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ç”¨å¤šæŒ‡é’ˆçš„æ–¹æ³•æ¥è§£å†³</p><p>å› ä¸ºç»™çš„è´¨å› æ•°ä¸ç¡®å®šï¼Œæˆ‘ä»¬å°±ç”¨ä¸€ä¸ªæ•°ç»„ä¸“é—¨ä¿å­˜è´¨å› æ•°æŒ‡é’ˆ<code>(pointers)</code>ï¼ŒåŒæ—¶ç”¨ä¸€ä¸ªæ•°ç»„ä¿å­˜æ¯ä¸€å›åˆå¾ªç¯æ±‚å‡ºæ¥çš„æ–°ä¸‘æ•°åºåˆ—<code>(newUglyNum)</code>ï¼Œå†å°†å®ƒä»¬æœ€å°çš„æ”¾åœ¨æ¨ç®—æ•°ç»„ä¸­ï¼Œè€Œè¿™ä¸ªæ¨ç®—æ•°ç»„å®é™…ä¸Šæ˜¯åŠ¨æ€è§„åˆ’ï¼Œå› æ­¤è¿™é‡Œä»£ç å‘½åä¸º<code>dp</code></p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">//æ€è·¯ï¼š 1. ç¬¬ n ä¸ªè¶…çº§ä¸‘æ•°æ˜¯åŸºäº å‰é¢æŸä¸€ä¸ªè¶…çº§ä¸‘æ•°ä¹˜ä»¥æŸä¸€ä¸ª primes[i] å¾—åˆ°çš„ï¼ŒåŸºäºè¿™ä¸€é€’æ¨å…³ç³»ï¼Œ</span><span class="token comment">//          å¯ä»¥ä½¿ç”¨ã€ŒåŠ¨æ€è§„åˆ’ã€ã€‚</span><span class="token comment">//       2. </span><span class="token comment">// æ—¶é—´ Oï¼ˆn * mï¼‰ ï¼Œç©ºé—´ O ï¼ˆn + mï¼‰</span><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">nthSuperUglyNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> primes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token function">dp</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//dp</span>        dp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//ç¬¬ä¸€ä¸ªä¸‘æ•°ä¸º1</span>        <span class="token keyword">int</span> pLen<span class="token operator">=</span>primes<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è´¨å› æ•°åºåˆ—é•¿åº¦</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">pointers</span><span class="token punctuation">(</span>pLen<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•è´¨å› æ•°å¯¹åº”çš„æŒ‡é’ˆæŒ‡å‘</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">newUglyNum</span><span class="token punctuation">(</span>pLen<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¸´æ—¶è®°å½•å½“å‰æ–°çš„ä¸‘æ•°åºåˆ—</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span>n<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> minNum <span class="token operator">=</span> INT_MAX<span class="token punctuation">;</span><span class="token comment">//è¿™å›åˆå¾ªç¯æ‰€æ±‚å¾—çš„ä¸‘æ•°åºåˆ—ä¸­çš„æœ€å°å€¼</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>pLen<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                newUglyNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>pointers<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">*</span>primes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//æ–°çš„ä¸‘æ•°åºåˆ—=æ—§åºåˆ—*å¯¹åº”çš„è´¨å› æ•°</span>                minNum <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>minNum<span class="token punctuation">,</span>newUglyNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> minNum<span class="token punctuation">;</span><span class="token comment">//æ›´æ–°dp</span>            <span class="token comment">//æ›´æ–°æŒ‡é’ˆåºåˆ—</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>pLen<span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>newUglyNum<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span>minNum<span class="token punctuation">)</span>                    <span class="token operator">++</span>pointers<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> dp<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸ºï¼š Oï¼ˆn * mï¼‰ï¼Œmæ˜¯è´¨å› æ•°æ•°ç»„é•¿åº¦</p><p>ç©ºé—´å¤æ‚åº¦ä¸ºï¼šO ï¼ˆn + mï¼‰ï¼Œmæ˜¯è´¨å› æ•°æ•°ç»„é•¿åº¦</p><hr><h2 id="384-æ‰“ä¹±æ•°ç»„-æ´—ç‰Œç®—æ³•-â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#384-æ‰“ä¹±æ•°ç»„-æ´—ç‰Œç®—æ³•-â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="384. æ‰“ä¹±æ•°ç»„(æ´—ç‰Œç®—æ³•)  â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/shuffle-an-array/">384. æ‰“ä¹±æ•°ç»„</a>(æ´—ç‰Œç®—æ³•)  â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œè®¾è®¡ç®—æ³•æ¥æ‰“ä¹±ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„æ•°ç»„ã€‚</p><p>å®ç° Solution class:</p><ul><li>Solution(int[] nums) ä½¿ç”¨æ•´æ•°æ•°ç»„ nums åˆå§‹åŒ–å¯¹è±¡</li><li>int[] reset() é‡è®¾æ•°ç»„åˆ°å®ƒçš„åˆå§‹çŠ¶æ€å¹¶è¿”å›</li><li>int[] shuffle() è¿”å›æ•°ç»„éšæœºæ‰“ä¹±åçš„ç»“æœ</li></ul><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥</p><p>[â€œSolutionâ€, â€œshuffleâ€, â€œresetâ€, â€œshuffleâ€]<br>[[[1, 2, 3]], [], [], []]<br>è¾“å‡º<br>[null, [3, 1, 2], [1, 2, 3], [1, 3, 2]]</p><p>è§£é‡Š</p><p>Solution solution = new Solution([1, 2, 3]);<br>solution.shuffle();    // æ‰“ä¹±æ•°ç»„ [1,2,3] å¹¶è¿”å›ç»“æœã€‚ä»»ä½• [1,2,3]çš„æ’åˆ—è¿”å›çš„æ¦‚ç‡åº”è¯¥ç›¸åŒã€‚ä¾‹å¦‚ï¼Œè¿”å› [3, 1, 2]<br>solution.reset();      // é‡è®¾æ•°ç»„åˆ°å®ƒçš„åˆå§‹çŠ¶æ€ [1, 2, 3] ã€‚è¿”å› [1, 2, 3]<br>solution.shuffle();    // éšæœºè¿”å›æ•°ç»„ [1, 2, 3] æ‰“ä¹±åçš„ç»“æœã€‚ä¾‹å¦‚ï¼Œè¿”å› [1, 3, 2]</p></blockquote><p>æç¤ºï¼š</p><ul><li>1 &lt;= nums.length &lt;= 200</li><li>-106 &lt;= nums[i] &lt;= 106</li><li>nums ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ å”¯ä¸€çš„</li><li>æœ€å¤šå¯ä»¥è°ƒç”¨ 5 * 104 æ¬¡ reset å’Œ shuffle</li></ul><p>è¿™ä¸€é¢˜ä¸»è¦æ˜¯äº†è§£ä¸€ä¸ªç»å…¸çš„ç®—æ³•â€”â€”<strong>Fisher-Yates æ´—ç‰Œç®—æ³•</strong>ï¼Œå…¶åŸç†å°±åƒæˆ‘ä»¬å¹³æ—¶æ‰“ç‰Œæ—¶æ´—ç‰Œæ–¹æ³•ä¸€æ ·ï¼Œé€šè¿‡éšæœºäº¤æ¢ä½ç½®æ¥å®ç°éšæœºæ‰“ä¹±ï¼ŒåŒæ—¶è¯¥ç®—æ³•åˆæœ‰æ­£å‘å’Œåå‘åŒºåˆ†</p><p>æˆ‘è¿™é‡Œç”¨çš„æ˜¯åå‘æ´—ç‰Œï¼Œç®€å•æ¥è¯´å°±æ˜¯ä»æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ å¼€å§‹å¾€å‰æ´—ç‰Œï¼Œæ¯ä¸€æ¬¡å°†å½“å‰éå†åˆ°çš„å…ƒç´ ä¸å‰é¢éšæœºä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œç›´åˆ°éå†å®Œå°±æ˜¯åå‘æ´—ç‰Œäº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">private</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> myVec<span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token function">Solution</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token operator">-></span>myVec<span class="token operator">=</span>nums<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token comment">/** Resets the array to its original configuration and return it. */</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> myVec<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token comment">/** Returns a random shuffling of the array. */</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">arr</span><span class="token punctuation">(</span>myVec<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¯ä»¥ä½¿ç”¨åå‘æˆ–è€…æ­£å‘æ´—ç‰Œï¼Œ æ•ˆæœç›¸åŒã€‚</span>        <span class="token comment">// åå‘æ´—ç‰Œï¼š</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span>myVec<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">--</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">swap</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ­£å‘æ´—ç‰Œï¼š</span>        <span class="token comment">// for (int i = 0; i &lt; n; ++i) &#123;</span>        <span class="token comment">// int pos = rand() % (n - i);</span>        <span class="token comment">// swap(shuffled[i], shuffled[i+pos]);</span>        <span class="token comment">// &#125;</span>                <span class="token keyword">return</span> arr<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/** * Your Solution object will be instantiated and called as such: * Solution* obj = new Solution(nums); * vector&lt;int> param_1 = obj->reset(); * vector&lt;int> param_2 = obj->shuffle(); */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸ºï¼šO(N)</p><hr><h1 id="å‰‘æŒ‡ä¸‰å‰‘å®¢ä¹‹ä¸€ï¼šé“¾è¡¨"><a href="#å‰‘æŒ‡ä¸‰å‰‘å®¢ä¹‹ä¸€ï¼šé“¾è¡¨" class="headerlink" title="å‰‘æŒ‡ä¸‰å‰‘å®¢ä¹‹ä¸€ï¼šé“¾è¡¨"></a>å‰‘æŒ‡ä¸‰å‰‘å®¢ä¹‹ä¸€ï¼šé“¾è¡¨</h1><h2 id="206-åè½¬é“¾è¡¨-â€”ï¼ˆç®€å•ï¼‰"><a href="#206-åè½¬é“¾è¡¨-â€”ï¼ˆç®€å•ï¼‰" class="headerlink" title="206. åè½¬é“¾è¡¨   â€”ï¼ˆç®€å•ï¼‰"></a><a href="https://leetcode-cn.com/problems/reverse-linked-list/">206. åè½¬é“¾è¡¨</a>   â€”ï¼ˆç®€å•ï¼‰</h2><p>ç»™ä½ å•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>head</code> ï¼Œè¯·ä½ åè½¬é“¾è¡¨ï¼Œå¹¶è¿”å›åè½¬åçš„é“¾è¡¨ã€‚</p><img src="https://i.loli.net/2021/10/14/weZdSAOvHo9Y6VQ.png" style="zoom:80%;" /><p><strong>æç¤ºï¼š</strong></p><ul><li><p>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯ <code>[0, 5000]</code></p></li><li><p><code>-5000 &lt;= Node.val &lt;= 5000</code></p></li></ul><p><strong>è¿›é˜¶ï¼š</strong>é“¾è¡¨å¯ä»¥é€‰ç”¨è¿­ä»£æˆ–é€’å½’æ–¹å¼å®Œæˆåè½¬ã€‚ä½ èƒ½å¦ç”¨ä¸¤ç§æ–¹æ³•è§£å†³è¿™é“é¢˜ï¼Ÿ</p><p>æœ¬é¢˜ç›®å¦‚åŒè¿›é˜¶æ‰€è¯´çš„æœ‰ä¸¤ä¸ªè§£å†³æ–¹æ³•ï¼Œè¿­ä»£å’Œé€’å½’ï¼Œéƒ½æŒºç®€å•æŒæ¡çš„ï¼Œä¸»è¦æ˜¯è¦è‡ªå·±ç”»å›¾ç†è§£ï¼Œ<strong>é“¾è¡¨é¢˜é¦–å…ˆè¦æå¥½çš„å°±æ˜¯å¯ä»¥æŠŠå›¾ç”»å‡ºæ¥</strong></p><h3 id="åŒæŒ‡é’ˆ-1"><a href="#åŒæŒ‡é’ˆ-1" class="headerlink" title="åŒæŒ‡é’ˆ"></a>åŒæŒ‡é’ˆ</h3><img src="https://i.loli.net/2021/10/14/VTz2ubdKR8BQFX4.gif" style="zoom:80%;" /><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    ListNode<span class="token operator">*</span> <span class="token function">reverseList</span><span class="token punctuation">(</span>ListNode<span class="token operator">*</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        ListNode<span class="token operator">*</span> cur <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token operator">*</span>pre <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>pre <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            ListNode<span class="token operator">*</span> t <span class="token operator">=</span> pre<span class="token operator">-></span>next<span class="token punctuation">;</span>            pre<span class="token operator">-></span>next <span class="token operator">=</span> cur<span class="token punctuation">;</span>            cur <span class="token operator">=</span> pre<span class="token punctuation">;</span>            pre <span class="token operator">=</span> t<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> cur<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h3><img src="https://i.loli.net/2021/10/14/sEJCNMY7Ad1Q3xq.gif" style="zoom:80%;" /><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    ListNode<span class="token operator">*</span> <span class="token function">reverseList</span><span class="token punctuation">(</span>ListNode<span class="token operator">*</span> head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> head<span class="token operator">-></span>next <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> head<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        ListNode<span class="token operator">*</span> ret <span class="token operator">=</span> <span class="token function">reverseList</span><span class="token punctuation">(</span>head<span class="token operator">-></span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>        head<span class="token operator">-></span>next<span class="token operator">-></span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>        head<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr>]]></content>
      
      
      <categories>
          
          <category> LeetCodeåˆ·é¢˜ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°11-æ·»åŠ æ”»å‡»å±æ€§</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B011-%E6%B7%BB%E5%8A%A0%E6%94%BB%E5%87%BB%E5%B1%9E%E6%80%A7/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B011-%E6%B7%BB%E5%8A%A0%E6%94%BB%E5%87%BB%E5%B1%9E%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<p>åœ¨è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥ç»™äººç‰©è¿˜æœ‰å²è±å§†æ·»åŠ æ”»å‡»çš„å±æ€§ï¼ŒåŒæ—¶ä¹Ÿç»™å²è±å§†è¡¥å……ä¸Šæ”»å‡»çš„åŠ¨ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹å§</p><h1 id="åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject"><a href="#åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject" class="headerlink" title="åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject"></a>åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject</h1><p>é¦–å…ˆè¿˜æ˜¯æ–°å»ºæ–‡ä»¶å¤¹å’Œä»£ç æ–‡ä»¶ğŸ‘‡</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/b58fb07a9dd74e99a87414a252bf97d5.png" alt="1.png" style="zoom:80%;" /><p>æ‰“å¼€è¿™ä¸ªä»£ç ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸‹æœ‰å…³æ”»å‡»çš„å±æ€§</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CreateAssetMenu</span><span class="token attribute-arguments"><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Attack/Attack Data"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AttackData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®°å½•æ”»å‡»ç›¸å…³å±æ€§</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> attackRange<span class="token punctuation">;</span><span class="token comment">//è¿‘æˆ˜æ”»å‡»èŒƒå›´</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> skillRange<span class="token punctuation">;</span><span class="token comment">//è¿œç¨‹æ”»å‡»èŒƒå›´</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> coolDown<span class="token punctuation">;</span><span class="token comment">//CDå†·å´</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> minDamage<span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æœ€å°ä¼¤å®³</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> maxDamage<span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æœ€å¤§ä¼¤å®³</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> criticalMultiplier<span class="token punctuation">;</span><span class="token comment">//æš´å‡»åŠ æˆç™¾åˆ†æ¯”</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> criticalChance<span class="token punctuation">;</span><span class="token comment">//æš´å‡»ç‡</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å®Œä»£ç ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªæœ‰å…³æ”»å‡»çš„<code>ScriptableObject</code>äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/ab9faff156ca410f9a77dd7090b983e8.png" alt="2.png" style="zoom:80%;" /><p>ç„¶åæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚è¿›è¡Œå±æ€§å€¼è®¾å®š</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/cc0abf9d1c1f4e6d8accc357cba98c51.png" alt="3.png" style="zoom:80%;" /><p>åŒæ—¶æˆ‘ä»¬è¿˜è¦å°†å®ƒæŒ‚è½½åˆ°äººç‰©å’Œæ•Œäººèº«ä¸Šï¼Œæˆ‘ä»¬æ‰“å¼€<code>Monobehavior</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>CharcterStates.cs</code>ä»£ç æ–‡ä»¶ï¼Œè¿™ä¸ªä»£ç æ–‡ä»¶æ˜¯æŒ‚è¾…åŠ©å°†ScriptableObjectæŒ‚è½½çš„</p><p>ç„¶åæ·»åŠ ä¸€è¡Œä»£ç ï¼Œæ¥å—å¤–ç•Œæä¾›çš„<code>Player BaseAttackData</code>çš„ScriptableObject</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token class-name">AttackData_SO</span> attackData<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å›åˆ°å²è±å§†ä¸ŠæŒ‚è½½äº†</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/ba22aeebd6224df78664695acf1c927f.png" alt="4.png" style="zoom:80%;" /><h1 id="è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç "><a href="#è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç " class="headerlink" title="è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç "></a>è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç </h1><p>è¿˜è®°å¾—ä¹‹å‰åœ¨å†™äººç‰©å’Œå²è±å§†æ”»å‡»æ—¶ç•™ä¸‹æ¥çš„ä¸€äº›å¾…è¡¥å……ä»£ç å—ï¼Ÿæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥é€æ­¥æ¥å®Œå–„å®ƒä»¬äº†</p><p>ç¬¬ä¸€ä¸ªè¦ä¿®æ”¹çš„æ˜¯<code>PlayerController.cs</code>é‡Œé¢äººç‰©çš„æ”»å‡»è·ç¦»ï¼Œä¹‹å‰æˆ‘ä»¬ä¸€ç›´æ˜¯é»˜è®¤ä¸º1ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬å¯ä»¥æ¥è¡¥å……å®ƒäº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//ScriptableObjectç›¸å…³å˜é‡</span><span class="token keyword">private</span> <span class="token class-name">CharcterStates</span> charcterStates<span class="token punctuation">;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    charcterStates <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//TODO:æ·»åŠ äººç‰©æ”»å‡»è·ç¦»</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">></span>          charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>attackRange<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ¯”è¾ƒäººç‰©å’Œæ•Œäººçš„è·ç¦»æ˜¯å¦å¤§äº0æ”»å‡»è·ç¦»ï¼ŒDistance()å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªVector3è·ç¦»</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å£°æ˜ä¸€ä¸ª<code>CharcterStates</code>åï¼Œæˆ‘ä»¬è¦æŠŠè¿™é‡Œçš„whileåˆ¤æ–­æ¡ä»¶å³è¾¹çš„1æ”¹æˆ<code>charcterStates.attackData.attackRange</code>ä»¥è·å–æ”»å‡»è·ç¦»åˆ¤æ–­</p><p>ç„¶åæ˜¯<code>EnemyController.cs</code>ï¼Œè¿™é‡Œä¿®æ”¹é‡æ¯”è¾ƒå¤§</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//ScriptableObjectç›¸å…³å˜é‡</span><span class="token keyword">private</span> <span class="token class-name">CharcterStates</span> charcterStates<span class="token punctuation">;</span><span class="token comment">//è¿™ä¸ªæ•Œäººæ”»å‡»ç›¸å…³çš„</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> lastAttackTime<span class="token punctuation">;</span><span class="token comment">//ä¸Šä¸€æ¬¡æ”»å‡»çš„æ—¶é—´ï¼ˆç”¨æ¥å®ç°CDå†·å´æ•ˆæœï¼‰</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    charcterStates <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    lastAttackTime <span class="token operator">=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>coolDown<span class="token punctuation">;</span><span class="token comment">//å¼€å§‹è·å–å†·å´æ—¶é—´</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>    lastAttackTime<span class="token operator">-=</span>Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span><span class="token comment">//æ¯ä¸€å¸§éƒ½å‡å†·å´</span><span class="token punctuation">&#125;</span><span class="token comment">//åˆ¤æ–­æ”»å‡»è·ç¦»å‡½æ•°</span><span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//äººç‰©åœ¨æ•Œäººçš„æ”»å‡»è·ç¦»å†…</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span>            <span class="token operator">&lt;=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>attackRange<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//äººç‰©åœ¨æ•Œäººçš„è¿œç¨‹æ”»å‡»è·ç¦»å†…</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span>            <span class="token operator">&lt;=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>skillRange<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»            <span class="token comment">//...</span>            <span class="token comment">//TODO:åœ¨æ”»å‡»èŒƒå›´æ”»å‡»</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//åœæ­¢è·Ÿéš</span>                agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//åœä¸‹æ¥</span>                <span class="token comment">//æ”»å‡»å†·å´å®Œæˆè¿›è¡Œæ”»å‡»ï¼Œåœ¨å‰é¢å£°æ˜äº†</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>lastAttackTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    lastAttackTime <span class="token operator">=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>coolDown<span class="token punctuation">;</span>                    <span class="token comment">//æš´å‡»åˆ¤æ–­ï¼Œéšæœºè·å–çš„æ•°å€¼ï¼ˆ0åˆ°1ä¹‹é—´ï¼‰åœ¨æš´å‡»ç‡å†…åˆ™æ˜¯æš´å‡»</span>                    <span class="token comment">//charcterStates.isCriticalä¸‹é¢ä¼šè®²ï¼Œç”¨æ¥è®°å½•æ˜¯å¦æš´å‡»çš„å˜é‡</span>                    charcterStates<span class="token punctuation">.</span>isCritical <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">&lt;</span>                        charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>criticalChance<span class="token punctuation">;</span>                    <span class="token comment">//æ‰§è¡Œæ”»å‡»</span>                    <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//æ”»å‡»æ§åˆ¶å‡½æ•°</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æ—¶æ•Œäººçœ‹å‘ç›®æ ‡</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿‘èº«æ”»å‡»åŠ¨ç”»</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿œç¨‹æˆ–æŠ€èƒ½æ”»å‡»åŠ¨ç”»</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬çœ‹åˆ°ä¸­é—´æ§åˆ¶æ”»å‡»çš„æ—¶å€™æœ‰ä¸€ä¸ª<code>charcterStates.isCritical</code>çš„æ–°å˜é‡ï¼Œè¿™æ˜¯åœ¨<code>CharcterStates.cs</code>ä¸­æ–°å£°æ˜çš„ï¼Œå¯ä»¥ä¾›å¤–ç•Œè®¿é—®çš„å¸ƒå°”å€¼ï¼Œç”¨æ¥è®°å½•å½“å‰æ˜¯å¦ä¸ºæš´å‡»ï¼ŒåŒæ—¶è™½ç„¶å®ƒæ˜¯publicå±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨<code>[HideInInspector]</code>å°†å…¶éšè—èµ·æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//CharcterStates.cs</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterStates</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HideInInspector</span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> isCritical<span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦æš´å‡»</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç å¼€å§‹å¤æ‚äº†èµ·æ¥ï¼Œéœ€è¦å¥½å¥½ç†è§£å“¦</p><h1 id="æ·»åŠ æ”»å‡»åŠ¨ç”»"><a href="#æ·»åŠ æ”»å‡»åŠ¨ç”»" class="headerlink" title="æ·»åŠ æ”»å‡»åŠ¨ç”»"></a>æ·»åŠ æ”»å‡»åŠ¨ç”»</h1><p>æˆ‘ä»¬çœ‹åˆ°ä¸Šé¢çš„ä»£ç æœ‰ä¸¤ä¸ªåŠ¨ç”»éœ€è¦æˆ‘ä»¬æ¥æ·»åŠ ï¼Œä¸€ä¸ªæ˜¯è¿‘èº«æ”»å‡»åŠ¨ç”»ï¼Œä¸€ä¸ªæ˜¯è¿œç¨‹æˆ–æŠ€èƒ½åŠ¨ç”»</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/3d2834012c04439d824cd2b2bbb56556.png" alt="5.png" style="zoom:80%;" /><p>æˆ‘ä»¬æŒ‰ä¸Šå›¾è¿™æ ·ç¼–è¾‘åŠ¨ç”»æ§åˆ¶å™¨ï¼Œå»ºç«‹ä¸¤ä¸ª<code>Trigger</code>ç±»å‹çš„å˜é‡æ¥åˆ†åˆ«æ§åˆ¶<code>Attack01</code>å’Œ<code>Attack02</code>çš„åŠ¨ç”»è§¦å‘æ¡ä»¶ï¼Œå…¶æ¬¡è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯ç”±å·¡é€»çŠ¶æ€åˆ‡æ¢è¿‡å»æ”»å‡»çŠ¶æ€æ—¶å¹¶ä¸éœ€è¦åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœï¼ŒåŒæ—¶è®°å¾—ä¸è¦å¿˜è®°æŠŠè§¦å‘æ¡ä»¶é€‰æ‹©ä¸Š</p><p>ç„¶åæˆ‘ä»¬å›åˆ°ä»£ç ä¸­ï¼Œæ‰¾åˆ°æ§åˆ¶æ”»å‡»çš„<code>Attack()</code>å‡½æ•°è¡¥å……ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ§åˆ¶æ•Œäººæ”»å‡»çš„å‡½æ•°</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æ—¶æ•Œäººçœ‹å‘ç›®æ ‡</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿‘èº«æ”»å‡»åŠ¨ç”»</span>        anim<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Attack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿œç¨‹æˆ–æŠ€èƒ½æ”»å‡»åŠ¨ç”»</span>        anim<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Skill"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†åŸºæœ¬çš„æ”»å‡»æ•ˆæœ</p><p>æˆ‘ä»¬è¿˜å¯ä»¥æŠŠæš´å‡»æ•ˆæœåŠ ä¸Šï¼Œå¯ä»¥æŠŠSkillåŠ¨ç”»æ¢æˆæˆ‘ä»¬çš„æš´å‡»æ•ˆæœåŠ¨ç”»</p><p>å†æ¬¡æ‰“å¼€åŠ¨ç”»æ§åˆ¶å™¨ï¼Œæ·»åŠ ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å˜é‡<code>Critical</code></p><p>æˆ‘ä»¬æŠŠ<code>Attack02</code>å½“åšæš´å‡»åŠ¨ç”»ï¼Œç„¶åè°ƒæ•´ä¸€ä¸‹åŠ¨ç”»çš„åˆ‡æ¢è¿‡ç¨‹</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/d665b2ca32e840c8868baf19b0e587cf.png" alt="6.png" style="zoom:80%;" /><p>è¿™é‡Œæ³¨æ„ä¸€ç‚¹å°±æ˜¯è¿˜è¦åŒºåˆ«æ™®é€šæ”»å‡»æ—¶<code>Critical</code>è§¦å‘çŠ¶æ€åº”è¯¥æ˜¯<code>false</code>ï¼Œä»¥é˜²åŠ¨ç”»å†²çª</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/4745d79d02704b0c9ef1bf7903896d5b.png" alt="7.png" style="zoom:80%;" /><p>ç„¶åè¿”å›ä»£ç ï¼Œæˆ‘ä»¬è¦æ—¶åˆ»è·å–æ˜¯å¦ä¸ºæš´å‡»çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥å¦‚ä¸‹æ“ä½œ</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//å®æ—¶æ›´æ–°Animatoré‡Œé¢å²è±å§†çš„çŠ¶æ€å¸ƒå°”å€¼</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Critical"</span><span class="token punctuation">,</span>charcterStates<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ—¶åˆ»è·å–æ˜¯å¦ä¸ºæš´å‡»</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äº<code>SwitchAnimation()</code>æ˜¯æ”¾åœ¨Update()é‡Œé¢è¿è¡Œçš„ï¼Œæ‰€ä»¥å¯ä»¥æŠŠæš´å‡»çŠ¶æ€æ”¾åœ¨è¿™é‡Œè®©å®ƒæ¯ä¸€åˆ»éƒ½è·å–æš´å‡»çŠ¶æ€</p><h1 id="ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜"><a href="#ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜" class="headerlink" title="ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜"></a>ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜</h1><p>æœ€åï¼Œæˆ‘ä»¬æœ‰ä¸ªå°é—®é¢˜è¦ä¿®å¤ä¸€ä¸‹</p><p>ç”±äºä¹‹å‰æˆ‘ä»¬å†™äº†å‘ç°æ•Œäººæ—¶æ•Œäººå°±è¦åœä¸‹æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥ï¼Œå¦‚æœäººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´æ—¶æˆ‘ä»¬å°±è¦æŠŠåœæ­¢çŠ¶æ€å–æ¶ˆæ‰ï¼Œä¸ç„¶å°±ä¼šå‡ºç°æ•Œäººåœç•™åœ¨åŸåœ°çš„ç°è±¡</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»<span class="token comment">//...</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>        agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//äººç‰©è„±ç¦»è¿½å‡»èŒƒå›´åï¼Œæ•Œäººåœåœ¨å½“å‰ä½ç½®</span>        isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        isFollow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°äººç‰©å°±è·‘ç€è¿½</span>        agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//&lt;-----------åœæ­¢çŠ¶æ€å–æ¶ˆ</span>        agent<span class="token punctuation">.</span>speed<span class="token operator">=</span>speed<span class="token punctuation">;</span>        <span class="token comment">//äººç‰©è¿›åˆ°æ•Œäººçš„èŒƒå›´ä¼šç»™è¿½å‡»</span>        agent<span class="token punctuation">.</span>destination<span class="token operator">=</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆåˆ°è¿™ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ç»™äººç‰©å’Œæ•Œäººæ·»åŠ æ”»å‡»å±æ€§ï¼Œå¹¶ä¸”è¿˜ä¸ºæ•ŒäººåŠ äº†æ™®é€šæ”»å‡»å’Œæš´å‡»ç­‰æ”»å‡»åŠ¨ç”»ï¼Œè®©æ¸¸æˆå¼€å§‹å˜å¾—æœ‰æ¨¡æœ‰æ ·èµ·æ¥</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°10-ä¸ºäººç‰©æ·»åŠ å±æ€§</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B010-%E4%B8%BA%E4%BA%BA%E7%89%A9%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B010-%E4%B8%BA%E4%BA%BA%E7%89%A9%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<p>ğŸˆ<strong>æ³¨æ„</strong>ï¼šä»è¿™ä¸€ç« å¼€å§‹ï¼Œç¬”è®°å†…å®¹ä¼šåœ¨ä¸€äº›æ¯”è¾ƒç®€å•çš„åœ°æ–¹è¿›è¡Œç®€ç•¥</p><h1 id="è®¤è¯†Scriptable-Object"><a href="#è®¤è¯†Scriptable-Object" class="headerlink" title="è®¤è¯†Scriptable Object"></a>è®¤è¯†Scriptable Object</h1><p>è¿™ä¸€ç« å¼€å§‹æˆ‘ä»¬ä¼šé¢‘ç¹åœ°ä½¿ç”¨ä»£ç ä»¥åŠæ›´å¤šåœ°<code>ScriptableObject</code>èµ·æ¥ï¼Œä»€ä¹ˆæ˜¯Scriptable Objectå‘¢ï¼Ÿå°±åƒä¸‹å›¾æˆ‘ä»¬çš„<code>Pipeline Setting</code>æ–‡ä»¶å¤¹ä¸‹çš„ä¸œè¥¿å°±æ˜¯æˆ‘ä»¬ä¸€ç§Scriptable Objectå®ç°æ–¹å¼</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/158275c63e164f448921282c6cefad4a.png" alt="1.png" style="zoom:80%;" /><p>å…³äºå®ƒçš„æ›´å¤šç‰¹æ€§å¯ä»¥ä¸Šç½‘æœç´¢èµ„æ–™ï¼Œè¿™é‡Œä¸è¿‡å¤šæè¿°</p><p>é‚£ä¹ˆæˆ‘ä»¬è¿™æ¬¡å°±æ‹¿å®ƒæ¥ç»™æˆ‘ä»¬çš„äººç‰©åŒ…æ‹¬æ•Œäººåˆ›å»ºä¸€äº›åŸºæœ¬çš„å±æ€§å€¼ï¼Œå¦‚ï¼šè¡€é‡ã€é˜²å¾¡å€¼ç­‰ç­‰</p><h1 id="ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼"><a href="#ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼" class="headerlink" title="ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼"></a>ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼</h1><p>é¦–å…ˆè¦åœ¨<code>Scripts</code>æ–‡ä»¶å¤¹åˆ›å»ºä¸€äº›æ–‡ä»¶å¤¹ä»¥ä¾¿æ—¥åç®¡ç†</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/5a19a7e92b1e41d1ad6996dbb1a0563a.png" alt="2.png" style="zoom:80%;" /><p>ä¸¤ä¸ªæ–‡ä»¶å¤¹åˆ†åˆ«æ˜¯å­˜æ”¾æŒ‚è½½ï¼ˆMonoBehaviorï¼‰ä¸å»ºç«‹ï¼ˆScriptableObjectï¼‰æˆ‘ä»¬çš„Scriptable Objectçš„ä»£ç æ–‡ä»¶ç”¨çš„</p><p>é™¤äº†ä¸Šé¢çš„ä¸¤ä¸ªæ–‡ä»¶å¤¹å¤–ï¼Œè¿˜æœ‰ä¸“é—¨æœ‰ç”¨æ¥å­˜æ”¾<code>ScriptableObject</code>æ•°æ®çš„æ–‡ä»¶å¤¹</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/dd8e1a4b80a646f5835de7c6834b4f19.png" alt="3.png" style="zoom:80%;" /><h2 id="åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable-Object"><a href="#åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable-Object" class="headerlink" title="åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable Object"></a>åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable Object</h2><p>ä¹‹åå†åœ¨<code>Charcter States/ScriptableObject</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸ªä»£ç è„šæœ¬æ–‡ä»¶<code>CharcterData_SO.cs</code></p><p>ä»£ç å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//æ·»åŠ å³é”®èœå•</span><span class="token punctuation">[</span><span class="token function">CreateAssetMenu</span><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Charcter States/Data"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token comment">//æ³¨æ„è¿™ä¸ªç±»ç»§æ‰¿çš„æ˜¯ScriptableObjectç±»</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ®µä»£ç å¯ä»¥åœ¨å³é”®èœå•ä¸­æ·»åŠ ä¸€ä¸ªé€‰é¡¹</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/54d3f5656d33441fa14682fcf33ee71f.png" alt="4.1.png" style="zoom:80%;" /><p>åˆ›å»ºå‡ºæ¥çš„å°±æ˜¯ä¸€ä¸ªåŸºäº<code>CharcterData_SO</code>çš„ScriptableObjectï¼Œæˆ‘ä»¬å°†å…¶å‘½åä¸º<code>Player Data</code></p><img src="https://p3-tt.byteimg.com/origin/pgc-image/5ff5985ea4a742efa56703027a071053.png" alt="4.png" style="zoom:80%;" /><img src="https://p26-tt.byteimg.com/origin/pgc-image/b6c7ca8158fb45f89fa331bffdba9eba.png" alt="5.png" style="zoom:80%;" /><p>è¿™ä¸ªæ—¶å€™è¿˜æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰çš„ï¼Œæˆ‘ä»¬é‡æ–°æ‰“å¼€<code>CharcterData_SO.cs</code>ç»§ç»­å¡«å†™ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//æ·»åŠ å³é”®èœå•</span><span class="token punctuation">[</span><span class="token function">CreateAssetMenu</span><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Charcter States/Data"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"States Infoï¼ˆå±æ€§ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> maxHealth<span class="token punctuation">;</span><span class="token comment">//æœ€å¤§ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentHealthl<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> baseDefence<span class="token punctuation">;</span><span class="token comment">//åŸºç¡€é˜²å¾¡å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentDefence<span class="token punctuation">;</span><span class="token comment">//å½“å‰é˜²å¾¡å€¼</span>    <span class="token comment">//æ”»å‡»åŠ›æ¯”è¾ƒå¤æ‚ï¼Œæ‰“ç®—åˆ†å¼€å†™ï¼Œè¿™é‡Œæš‚æ—¶ä¸å†™ç€å…ˆ</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬èµ‹äºˆäº†4ä¸ªå±æ€§ï¼Œå½“Unityç¼–è¯‘ä¹‹ååœ¨æˆ‘ä»¬åˆšåˆšæ–°åˆ›å»ºçš„<code>Player Data</code>å°±æœ‰äº†æ”¹å˜ï¼Œå¤šäº†å‡ ä¸ªå±æ€§å€¼å‡ºæ¥</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/a9cdd098cf54461a8f0387b00d539f9b.png" alt="6.png" style="zoom:80%;" /><h2 id="æŒ‚è½½Scriptable-Object"><a href="#æŒ‚è½½Scriptable-Object" class="headerlink" title="æŒ‚è½½Scriptable Object"></a>æŒ‚è½½Scriptable Object</h2><p>é‚£ä¹ˆæœ‰äº†å­˜æ”¾çš„ScriptableObjectä¹‹åï¼Œæˆ‘ä»¬è¿˜è¦æƒ³åŠæ³•å°†å…¶è¿ç”¨ï¼ˆå³æŒ‚è½½ï¼‰åˆ°äººç‰©èº«ä¸Šï¼Œæ–¹ä¾¿æ•°æ®ä¹‹é—´çš„è¯»å–</p><p>æˆ‘ä»¬åœ¨<code>Charcter States/MonoBehavior</code>ä¸­æ–°å»ºä¸€ä¸ªä»£ç è„šæœ¬ï¼Œå‘½åä¸º<code>CharcterStates.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterStates</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">CharcterData_SO</span> charcterData<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> MaxHealth<span class="token punctuation">&#123;</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span><span class="token comment">//å–å€¼å±æ€§</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>charcterData <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> charcterData<span class="token punctuation">.</span>maxHealth<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">set</span><span class="token punctuation">&#123;</span><span class="token comment">//èµ‹å€¼å±æ€§</span>            charcterData<span class="token punctuation">.</span>maxHealth <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//TODO:ç…§ä¸Šé¢æ¨¡å¼å†™å‡ºå…¶å®ƒå‡ ä¸ªå±æ€§å€¼</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç ä¸­ç”¨åˆ°äº†C#çš„<strong>å±æ€§</strong>ï¼Œå³<code>get</code>å’Œ<code>set</code>æ¥è¯»å–æˆ–å†™å…¥äººç‰©çš„æœ€å¤§ç”Ÿå‘½å€¼ï¼Œå‰©ä¸‹çš„å‡ ä¸ªå±æ€§å€¼ä¹Ÿæ˜¯åŒæ ·æ–¹æ³•æ¥å†™</p><p>å†™å¥½ä¹‹åæˆ‘ä»¬ä¿å­˜ä¸€ä¸‹ä»£ç ï¼Œå°†ä»£ç æ–‡ä»¶å½“ä½œç»„ä»¶æ·»åŠ åˆ°äººç‰©ä¸Šé¢</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/4ccad37c1e6e4765a5459eef8bf7e044.png" alt="7.png" style="zoom:80%;" /><p>å¯ä»¥çœ‹åˆ°å®ƒéœ€è¦æ¥å—ä¸€ä¸ª<code>CharcterData_SO</code>ç±»å‹çš„</p><p>â€‹    </p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°9-æ•Œäººçš„éšæœºå·¡é€»</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B09-%E6%95%8C%E4%BA%BA%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%B7%A1%E9%80%BB/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B09-%E6%95%8C%E4%BA%BA%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%B7%A1%E9%80%BB/</url>
      
        <content type="html"><![CDATA[<p>â€‹    åœ¨ä¸Šä¸€ç« èŠ‚æˆ‘ä»¬å®ç°äº†æ•Œäººçš„è¿½å‡»æ•ˆæœï¼Œä¹Ÿå°±æ˜¯æ•Œäººçš„è¿½å‡»çŠ¶æ€ï¼Œè€Œè¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥å®ç°å®ƒçš„å·¡é€»çŠ¶æ€æ•ˆæœ</p><h1 id="å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´"><a href="#å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´" class="headerlink" title="å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´"></a>å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´</h1><p>â€‹    ç”±äºä¹‹åä¼šæœ‰ä¸€ä¸ªè®°å½•æ•Œäººå·¡é€»èŒƒå›´çš„å˜é‡ï¼Œå› æ­¤ä¸ºäº†æ–¹ä¾¿åˆ°æ—¶å€™çš„è®¾ç½®ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªå‡½æ•°å¯ä»¥å®æ—¶åœ¨<code>Scene</code>çª—å£ä¸Šæ˜¾ç¤ºè¿™ä¸ªèŒƒå›´å‡ºæ¥</p><p>â€‹    å› ä¸ºè¿™ä¸ªå˜é‡æ˜¯åœ¨<code>EnemyController.cs</code>ä»£ç æ–‡ä»¶é‡Œå£°æ˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç›´æ¥åœ¨æ­¤ä»£ç æ–‡ä»¶é‡Œç”¨è¿™ä¸ªå‡½æ•°</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Patrol Stateï¼ˆå·¡é€»çŠ¶æ€çš„è®¾ç½®é¡¹ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> potralRange<span class="token punctuation">;</span><span class="token comment">//å·¡é€»åœˆçš„åŠå¾„å¤§å°</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDrawGizmosSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        Gizmos<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>blue<span class="token punctuation">;</span>        Gizmos<span class="token punctuation">.</span><span class="token function">DrawWireSphere</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨æ•Œäººå½“å‰ä½ç½®ç”»ä¸€ä¸ªçƒå½¢èŒƒå›´çš„çº¿</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    <code>OnDrawGizmosSelected()</code>æ˜¯æ¥è‡ªäº<code>MonoBehaviour</code>ç±»çš„ä¸€ä¸ªå‡½æ•°ï¼Œè¿™é‡Œä»£ç æ„æ€æ˜¯åªè¦é€‰ä¸­äº†ä»£ç æ‰€åœ¨çš„å¯¹è±¡ä¸Šå°±ä¼šç»˜ç”»å‡ºä¸€ä¸ªçƒå½¢çš„çº¿ï¼Œè€Œè¿™ä¸ªçƒå½¢çš„åŠå¾„å°±æ˜¯<code>potralRange</code>ï¼Œä¾‹å¦‚å½“æ­¤å€¼è°ƒæˆä¸º2æ—¶ï¼Œçƒå½¢å¦‚ä¸‹å›¾æ‰€ç¤ºğŸ‘‡</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/8c138a5dc08f44ed92287bc624597238.png" alt="1.png" style="zoom:80%;" /><p>â€‹    å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ·»åŠ å…¶å®ƒå‚æ•°çš„å¯è§†åŒ–æ•ˆæœï¼Œå¯ä»¥è‡ªç”±å‘æŒ¥</p><h1 id="å®ç°æ•Œäººå·¡é€»"><a href="#å®ç°æ•Œäººå·¡é€»" class="headerlink" title="å®ç°æ•Œäººå·¡é€»"></a>å®ç°æ•Œäººå·¡é€»</h1><p>â€‹    æ¥ä¸‹æ¥å°±è¿›å…¥æ­£é¢˜ï¼Œå¦‚ä½•å®ç°æ•Œäººå·¡é€»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®ƒè®¾å®šçš„å·¡é€»èŒƒå›´å†…è·å¾—ä¸€ä¸ªç‚¹ï¼Œç„¶åå†è®©æ•Œäººèµ°è¿‡å»ï¼Œåå¤æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œï¼Œå°±å¯ä»¥è®©æ•Œäººå·¡é€»èµ·æ¥äº†</p><h2 id="éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹"><a href="#éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹" class="headerlink" title="éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹"></a>éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹</h2><p>â€‹    è¦è·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬å°±è¦æœ‰ä¸€ä¸ªVector3å˜é‡æ¥è®°å½•è¿™ä¸ªç‚¹ï¼Œç„¶åæ¯æ¬¡ä½¿ç”¨éšæœºæ•°æ¥æ”¹å˜å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥ä¸“é—¨éšæœºè·å¾—è¿™ä¸ªç‚¹çš„å€¼</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token class-name">Vector3</span> wayPoint<span class="token punctuation">;</span><span class="token comment">//æ•Œäººå·¡é€»çš„ä¸‹ä¸€ä¸ªéšæœºç›®æ ‡ç‚¹</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»çš„éšæœºç›®æ ‡ç‚¹</span>    <span class="token comment">//Yè½´æ˜¯æ§åˆ¶é«˜åº¦çš„ï¼Œæ‰€ä»¥ä¸ç”¨è·å–ï¼Œä¿æŒåŸæ¥çš„å°±è¡Œ</span>    <span class="token comment">//è·å–çš„èŒƒå›´æ—¶[-potralRange,potralRange]</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomX <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomZ <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åœ¨æ•Œäººè‡ªå·±æœ¬èº«çš„åæ ‡ç‚¹ä¸Šè¿›è¡Œå–éšæœºç‚¹</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//FIXME:æœ‰å¯èƒ½å‡ºç°é—®é¢˜</span>    wayPoint <span class="token operator">=</span> randomPoint<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ç”±äºYè½´æ˜¯è®°å½•æ•Œäººæ‰€åœ¨çš„é«˜åº¦çš„ï¼Œæ‰€ä»¥è¿™é‡Œæš‚æ—¶ä¸ç”¨è·å–éšæœºæ•°ï¼Œä¿æŒåŸæ¥æ•ˆæœ</p><p>â€‹    åŒæ—¶ä¸Šé¢ä»£ç ä¸­ç»™æ ‡è®°äº†ä¸€ä¸ªFIXMEï¼Œæœ‰å¯èƒ½å‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ”¾ä¸€è¾¹åˆ°æ—¶å€™å†æ¥å‘ç°ä¿®æ”¹</p><h2 id="ä¿®æ”¹çŠ¶æ€åˆ‡æ¢"><a href="#ä¿®æ”¹çŠ¶æ€åˆ‡æ¢" class="headerlink" title="ä¿®æ”¹çŠ¶æ€åˆ‡æ¢"></a>ä¿®æ”¹çŠ¶æ€åˆ‡æ¢</h2><p>â€‹    è·å–äº†éšæœºç‚¹åï¼Œæˆ‘ä»¬è¿˜è¦å›åˆ°<code>SwitchStates()</code>å‡½æ•°ä¸­ä¿®æ”¹ä¸€ä¸‹çŠ¶æ€çš„è¡”æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>å·¡é€»        isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ä¸æ˜¯è¿½é€åŠ¨ç”»</span>        agent<span class="token punctuation">.</span>speed <span class="token operator">=</span> speed<span class="token operator">*</span><span class="token number">0.5f</span><span class="token punctuation">;</span><span class="token comment">//å·¡é€»é€Ÿåº¦æ˜¯è¿½é€é€Ÿåº¦çš„ä¸€åŠ</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>wayPoint<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> agent<span class="token punctuation">.</span>stoppingDistance<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¦‚æœä¸‹ä¸€ä¸ªå·¡é€»ç‚¹å’Œå½“å‰äººç‰©çš„åæ ‡ç‚¹å°äºç­‰äºå¯ç§»åŠ¨è·ç¦»åˆ™ä¸ç§»åŠ¨</span>            isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ä¸æ’­æ”¾èµ°è·¯çš„åŠ¨ç”»</span>            <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»ç‚¹éšæœºæ•°</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token comment">//æ»¡è¶³è¡Œèµ°æ¡ä»¶</span>            isWalk <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ•ŒäººåŠ¨ç”»æ”¹ä¸ºèµ°è·¯åŠ¨ç”»</span>            agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> wayPoint<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ä¸Šé¢å°±æ˜¯åˆ¤æ–­åˆ°æ•Œäººä¸ºå·¡é€»çŠ¶æ€æ—¶è¦åšçš„äº‹æƒ…ï¼Œé‡Œé¢è¿˜æœ‰ä¸€ä¸ªifè¯­å¥æ˜¯ç”¨äºåˆ¤æ–­å¦‚æœä¸‹ä¸€ä¸ªå·¡é€»çš„ç‚¹å°äºæˆ–ç­‰äºå¯¼èˆªç»„ä»¶å¯ä»¥ç§»åŠ¨çš„èŒƒå›´æ—¶å°±ä¸ç§»åŠ¨ï¼Œå†è·å¾—ä¸‹ä¸€ä¸ªå·¡é€»ç‚¹</p><p>ğŸ„è€Œ <a href="https://docs.unity.cn/cn/2020.3/ScriptReference/AI.NavMeshAgent-stoppingDistance.html">stoppingDistance</a> æ˜¯<code>Nav Mesh Agent</code>ç»„ä»¶é‡Œçš„ä¸€ä¸ªå±æ€§ï¼Œä»£è¡¨<code>åœæ­¢è·ç¦»</code>ï¼Œå³å¦‚æœç»™å®šçš„ç›®çš„ç‚¹ä¸å½“å‰ç‚¹çš„è·ç¦»å°äºè¿™ä¸ªå€¼çš„è¯ï¼Œæ•Œäººæ—¶ä¸ä¼šè¿›è¡Œç§»åŠ¨çš„ï¼Œè¿™ä¸ªå€¼æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å±æ€§é¢æ¿ä¸­è¿›è¡Œè°ƒæ•´</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/107272d76d03463c8012565f3e821a87.png" alt="2.png" style="zoom:80%;" /><p>â€‹    äº†è§£åˆ°è¿™äº›ä¹‹åæˆ‘ä»¬ç»§ç»­å›åˆ°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å†™äº†å·¡é€»çŠ¶æ€æ—¶è¦åšçš„äº‹æƒ…ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥æ€æ ·åˆ¤æ–­å¹¶è¿›å…¥å·¡é€»çŠ¶æ€å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å°±æ¥å†™ä¸€ä¸‹è¿™äº›ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Basic Settings"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//...</span><span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> isGuard<span class="token punctuation">;</span><span class="token comment">//å½“å‰æ•Œäººæ˜¯å¦ä¸ºè­¦å«ï¼ˆè­¦æˆ’çŠ¶æ€ï¼‰</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å¼€å§‹æ¸¸æˆæ—¶å…ˆæ£€æµ‹æ˜¯å¦å‹¾é€‰äº†å®ˆå«çŠ¶æ€</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isGuard<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">;</span>        <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢å¼€å§‹æ—¶å·¡é€»ç‚¹æ˜¯ç©ºçš„é»˜è®¤èµ°åˆ°åœ°å›¾(0,0,0)ä½ç½®</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™é‡Œæˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ªå…¬å¼€çš„å¸ƒå°”å€¼å˜é‡<code>isGuard</code>ï¼Œå¯ä»¥ç›´æ¥åœ¨å±æ€§é¢æ¿å‹¾é€‰ï¼Œç”¨æ¥åˆ¤æ–­å½“å‰æ•Œäººæ˜¯å¦ä¸ºä¸€ä¸ªå®ˆå«ï¼Œå¦‚æœä¸ºå®ˆå«å°±ä¸ä¼šè¿›è¡Œå·¡é€»äº†</p><p>â€‹    åœ¨å¼„å¥½è¿™äº›ä¹‹åï¼Œæ•Œäººå·¡é€»çš„åŸºæœ¬åŠŸèƒ½å°±å®ç°äº†ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å»è¯•ç©ä¸€ä¸‹äº†</p><h2 id="ä¿®å¤ä¸€äº›é—®é¢˜"><a href="#ä¿®å¤ä¸€äº›é—®é¢˜" class="headerlink" title="ä¿®å¤ä¸€äº›é—®é¢˜"></a>ä¿®å¤ä¸€äº›é—®é¢˜</h2><p>â€‹    åœ¨è¯•ç©çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢å°±æ¥ä¿®å¤å®ƒä»¬</p><h3 id="æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ"><a href="#æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ" class="headerlink" title="æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ"></a>æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ</h3><p>â€‹    é¦–å…ˆæ˜¯æ•Œäººå·¡é€»èŒƒå›´çš„é—®é¢˜ï¼Œå¦‚æœåªä¾ç…§ä¸Šé¢çš„ä»£ç æˆ‘ä»¬ä¼šå‘ç°æ•Œäººçš„å·¡é€»èŒƒå›´ä¼šè¶Šæ¥è¶Šè¿œï¼Œè¿™æ˜¯å› ä¸ºå–éšæœºåæ ‡ç‚¹çš„ä»£ç é€»è¾‘è€ƒè™‘ä¸å¯¹åŠ²</p><p>â€‹    æˆ‘ä»¬å›åˆ°ä¸Šé¢çš„æ ‡æœ‰FIXMEä»£ç å—ä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//åœ¨æ•Œäººè‡ªå·±æœ¬èº«çš„åæ ‡ç‚¹ä¸Šè¿›è¡Œå–éšæœºç‚¹</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>â€‹    å‡ºç°é—®é¢˜çš„å°±æ˜¯åœ¨ä¸Šé¢è¿™ä¸€å¥ä»£ç ï¼Œæˆ‘ä»¬å–åˆ°çš„ä¸‹ä¸€ä¸ªéšæœºç›®æ ‡ç‚¹æ˜¯åŸºäºæ•Œäººç°åœ¨çš„ä½ç½®åŸºç¡€ä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡å–åˆ°çš„éšæœºç‚¹éƒ½ä¸ç°åœ¨ä½ç½®ç›¸åŠ ï¼Œè¿™å°±ä¸å¯¹äº†ï¼Œå¦‚æœä¸€ç›´å¾€åŒä¸€ä¸ªæ–¹å‘ç›¸åŠ ï¼Œåªä¼šå¯¼è‡´æ•Œäººèµ°çš„è¶Šæ¥è¶Šè¿œ</p><p>â€‹    å› æ­¤è¿™é‡Œ<strong>ä¸åº”è¯¥</strong><code>transform.position+xxx</code></p><p>â€‹    </p><p>â€‹    é‚£ä¹ˆè§£å†³æ–¹æ¡ˆæ€ä¹ˆæ ·åšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨æ¸¸æˆå¼€å§‹åˆå§‹åŒ–æŠŠå½“å‰æ•Œäººæ‰€åœ¨çš„ä½ç½®è®°å½•ä¸‹æ¥ï¼Œç„¶åæ¯æ¬¡å–éšæœºç‚¹æ˜¯åŸºäºè¿™ä¸ªç‚¹æ¥è¿›è¡Œåæ ‡ç›¸åŠ çš„</p><p>â€‹    åŒæ—¶è¿™ä¸ªåæ ‡ç‚¹ä¹Ÿä¸æ­¢åœ¨å·¡é€»çŠ¶æ€è¿™é‡Œç”¨å¾—åˆ°ï¼Œæˆ‘ä»¬åœ¨å®ˆå«çŠ¶æ€ä¸‹ä¹Ÿéœ€è¦è¿™ä¸ªåˆå§‹åæ ‡ç‚¹ï¼Œå®ˆå«çŠ¶æ€ä¸‹å¦‚æœè¿½å‡»æ•Œäººè„±æˆ˜ä¹‹åï¼Œæˆ‘ä»¬å¿…é¡»è®©æ•Œäººå›åˆ°è¿™ä¸ªåˆå§‹åæ ‡ç‚¹ç»§ç»­å®ˆå«</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token class-name">Vector3</span> puardPos<span class="token punctuation">;</span><span class="token comment">//å½“å‰æ•Œäººæ¸¸æˆå¼€å§‹æ—¶çš„åˆå§‹ä½ç½®</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span> guardPos <span class="token operator">=</span> guardPos <span class="token operator">=</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>guardPos<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>guardPos<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    æŒ‰ç…§ä¸Šé¢çš„ä»£ç ä¿®æ”¹ï¼Œæˆ‘ä»¬å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜</p><p>â€‹    ğŸˆ<strong>è¦æ³¨æ„</strong>ï¼šæ–°çš„åæ ‡ç‚¹çš„Yè½´è¿˜æ˜¯ä»¥æ•Œäººå½“å‰ä½ç½®ä¸ºåŸºç¡€çš„</p><h3 id="æ•Œäººç§»åŠ¨å¡ä½"><a href="#æ•Œäººç§»åŠ¨å¡ä½" class="headerlink" title="æ•Œäººç§»åŠ¨å¡ä½"></a>æ•Œäººç§»åŠ¨å¡ä½</h3><p>â€‹    ç¬¬äºŒä¸ªå¯èƒ½é‡åˆ°çš„é—®é¢˜å°±æ˜¯å¯èƒ½æ•Œäººèµ°ç€èµ°ç€ä¼šçªç„¶ç»™å¡ä½ï¼Œä½†å®ƒä»ç„¶å¤„äºç§»åŠ¨çŠ¶æ€ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºæ‰€è·å–çš„ç›®æ ‡ç‚¹ä¸º<strong>ä¸å¯ç§»åŠ¨åŒºåŸŸ</strong>é€ æˆçš„ï¼Œä¾‹å¦‚æ ‘æœ¨ã€çŸ³å¤´æ‰€åœ¨çš„ç‚¹</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/e5d07eb926e74385a3d3454bf171703c.png" alt="3.png" style="zoom:80%;" /><p>â€‹    å› æ­¤è§£å†³æ–¹æ³•å°±æ˜¯æˆ‘ä»¬åœ¨è·å–ç‚¹ä¹‹åè¦åˆ¤æ–­ä¸€ä¸‹æ‰€è·å¾—çš„ç‚¹æ˜¯å¦ä¸ºåˆ°è¾¾çš„ç‚¹ï¼Œå¦‚æœä¸æ˜¯å°±å†è·å–ä¸€é</p><p>â€‹    è¿™é‡Œå¯ä»¥ç”¨åˆ° <a href="https://docs.unity.cn/cn/2020.3/ScriptReference/AI.NavMeshAgent.html">NavMeshAgent</a> çš„ä¸€ä¸ªæ–¹æ³• <a href="https://docs.unity.cn/cn/2020.3/ScriptReference/AI.NavMeshAgent.SamplePathPosition.html">SamplePathPosition()</a> ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¥åˆ¤æ–­æ•Œäººåˆ°ç›®æ ‡ç‚¹æ˜¯å¦å¯ä»¥è¡Œèµ°ï¼Œæˆ‘ä»¬å›åˆ°<code>GetNewWayPoint()</code>å‡½æ•°ä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»çš„éšæœºç›®æ ‡ç‚¹</span>    <span class="token comment">//Yè½´æ˜¯æ§åˆ¶é«˜åº¦çš„ï¼Œæ‰€ä»¥ä¸ç”¨è·å–ï¼Œä¿æŒåŸæ¥çš„å°±è¡Œ</span>    <span class="token comment">//è·å–çš„èŒƒå›´æ—¶[-potralRange,potralRange]</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomX <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomZ <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>guardPos<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>guardPos<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ£€æµ‹ä¸‹ä¸ªç‚¹æ˜¯å¦å¯è¡Œ</span>    <span class="token class-name">NavMeshHit</span> hit<span class="token punctuation">;</span>    wayPoint <span class="token operator">=</span><span class="token comment">//å¦‚æœæ–°çš„ç›®æ ‡ç‚¹å¯ä»¥åˆ°è¾¾åˆ™èµ‹å€¼ï¼Œå¦åˆ™åˆ™æŠŠæ•Œäººå½“å‰æ‰€åœ¨ç‚¹èµ‹å€¼</span>        NavMesh<span class="token punctuation">.</span><span class="token function">SamplePosition</span><span class="token punctuation">(</span>randomPoint<span class="token punctuation">,</span><span class="token keyword">out</span> hit<span class="token punctuation">,</span>potralRange<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> hit<span class="token punctuation">.</span>position <span class="token punctuation">:</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>    <span class="token comment">//æä¾›ä¸€ä¸ªå‚è€ƒç‚¹ï¼Œè¾“å‡ºå±æ€§çš„ç½‘æ ¼ä¿¡æ¯</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·æˆ‘ä»¬å°±è§£å†³äº†æ•Œäººä¼šå¡ä½çš„é—®é¢˜</p><h3 id="å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´"><a href="#å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´" class="headerlink" title="å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´"></a>å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´</h3><p>â€‹    è¿˜æœ‰ä¸€ä¸ªå¯ä»¥å®Œå–„çš„åœ°æ–¹å°±æ˜¯æ•Œäººåœ¨ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ç‚¹åï¼Œå®ƒä¼šç«‹å³åˆå‰å¾€ä¸‹ä¸€ä¸ªåœ°ç‚¹ï¼Œè¿™é‡Œå¯ä»¥ä¸ºå®ƒå¢åŠ ä¸€äº›ç­‰å¾…æ—¶é—´</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Patrol Stateï¼ˆå·¡é€»çŠ¶æ€çš„è®¾ç½®é¡¹ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//...</span><span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> lookAtTime<span class="token punctuation">;</span><span class="token comment">//æ•Œäººåˆ°è¾¾ä¸€ä¸ªç‚¹åœç•™çš„æ—¶é—´</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> remainLookAtTime<span class="token punctuation">;</span><span class="token comment">//è¿˜å‰©ä¸‹çš„åœç•™æ—¶é—´</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//è„±ç¦»æˆ˜æ–—ååˆ¤æ–­å›åˆ°å®ˆå«çŠ¶æ€è¿˜æ˜¯å·¡é€»çŠ¶æ€</span>                enemyStates <span class="token operator">=</span> isGuard <span class="token punctuation">?</span> EnemyStates<span class="token punctuation">.</span>GUARD <span class="token punctuation">:</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">//åˆ¤æ–­æ˜¯å¦åˆ°äº†éšæœºå·¡é€»ç‚¹</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>wayPoint<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> agent<span class="token punctuation">.</span>stoppingDistance<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å¦‚æœä¸‹ä¸€ä¸ªå·¡é€»ç‚¹å’Œå½“å‰äººç‰©çš„åæ ‡ç‚¹å°äºç­‰äºå¯ç§»åŠ¨è·ç¦»åˆ™ä¸ç§»åŠ¨</span>                isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ä¸æ’­æ”¾èµ°è·¯çš„åŠ¨ç”»</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>remainLookAtTime <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//å¦‚æœå‰©ä½™ç­‰å¾…æ—¶é—´å¤§äº0åˆ™ç»§ç»­ç­‰å¾…</span>                    remainLookAtTime <span class="token operator">-=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>                <span class="token keyword">else</span>                    <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»ç‚¹éšæœºæ•°</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//æ»¡è¶³è¡Œèµ°æ¡ä»¶</span>                isWalk <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ•ŒäººåŠ¨ç”»æ”¹ä¸ºèµ°è·¯åŠ¨ç”»</span>                agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> wayPoint<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//PATROL</span>    <span class="token punctuation">&#125;</span><span class="token comment">//...</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»çš„éšæœºç›®æ ‡ç‚¹</span>    remainLookAtTime <span class="token operator">=</span> lookAtTime<span class="token punctuation">;</span><span class="token comment">//é‡ç½®å‰©ä½™ç­‰å¾…æ—¶é—´</span>    <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªå˜é‡ï¼Œ<code>lookAtTime</code>è¡¨ç¤ºéœ€è¦ç­‰å¾…æ—¶é—´çš„é•¿åº¦ï¼ˆå¯ä¾›å¤–ç•Œè¿›è¡Œè°ƒæ•´ï¼‰ï¼Œ<code>remainLookAtTime</code>è¡¨ç¤ºå½“å‰æ•Œäººè¿˜å‰©ä½™çš„ç­‰å¾…æ—¶é—´ï¼Œç„¶åæˆ‘ä»¬åœ¨<code>SwitchEnemyStates()</code>å‡½æ•°é‡Œçš„è¿½å‡»çŠ¶æ€ä¸­åˆ¤æ–­æ•Œäººåˆ°è¾¾äº†ç›®æ ‡ç‚¹å°±å¼€å§‹é€å¸§é€’å‡<code>remainLookAtTime</code>ï¼Œå½“å‡åˆ°å°äº0æ•Œäººæ‰ä¼šå¼€å§‹èµ°åŠ¨ï¼ŒåŒæ—¶å†ä¸€æ¬¡è°ƒç”¨<code>GetNewWayPoint()</code>æ—¶ä¼šé‡ç½®<code>remainLookAtTime</code></p><p>â€‹    ğŸˆæ³¨æ„ï¼š<code>lookAtTime</code>çš„å•ä½æ˜¯<strong>ç§’</strong></p><p>â€‹    åœ¨switchä»£ç å‰é¢è¿˜æ·»åŠ äº†ä¸€æ¡è¯­å¥ç”¨æ¥åˆ¤æ–­è„±ç¦»æˆ˜æ–—åæ•Œäººå›åˆ°å®ˆå«çŠ¶æ€è¿˜æ˜¯å·¡é€»çŠ¶æ€ï¼Œè¿™å¯ä»¥è®©æˆ‘ä»¬æ•Œäººæ›´åŠ å®Œå–„</p><p>â€‹    åˆ°è¿™é‡Œï¼Œæœ¬ç« çš„ç›®çš„å°±å®ç°äº†ï¼Œæˆ‘ä»¬è®©æ•Œäººéšæœºå·¡é€»äº†èµ·æ¥ï¼Œå¿«å»æ¸¸æˆä¸­è¯•è¯•å§ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°8--ä¸ºæ•Œäººæ·»åŠ è¿½å‡»æ•ˆæœä»¥åŠåŠ¨ç”»åˆ‡æ¢ç®¡ç†</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B08-%E4%B8%BA%E6%95%8C%E4%BA%BA%E6%B7%BB%E5%8A%A0%E8%BF%BD%E5%87%BB%E6%95%88%E6%9E%9C%E4%BB%A5%E5%8F%8A%E5%8A%A8%E7%94%BB%E5%88%87%E6%8D%A2%E7%AE%A1%E7%90%86/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B08-%E4%B8%BA%E6%95%8C%E4%BA%BA%E6%B7%BB%E5%8A%A0%E8%BF%BD%E5%87%BB%E6%95%88%E6%9E%9C%E4%BB%A5%E5%8F%8A%E5%8A%A8%E7%94%BB%E5%88%87%E6%8D%A2%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<!--ç»ˆäºæœŸæœ«è€ƒå®Œè¯•äº†ï¼Œå¯ä»¥å›åˆ°Unityä¸Šæ¥äº†ğŸ˜ƒ--><p>â€‹    æˆ‘ä»¬æ¥ç»§ç»­å®Œå–„æ•Œäººï¼Œè¿˜è®°å¾—æˆ‘ä»¬æœ‰ä¸ªåŠ¨ç”»åˆ‡æ¢çš„æ¡†æ¶ä»£ç æ‘†åœ¨é‚£å—ï¼Ÿè¿™ä¸€æ¬¡æˆ‘ä»¬æ¥ä¸ºæ•Œäººæ·»åŠ è¿½å‡»æ•ˆæœå¹¶ä¸”å¯¹ä¸åŒçŠ¶æ€ä¸‹çš„åŠ¨ç”»åˆ‡æ¢è¿›è¡Œç®¡ç†</p><h1 id="ä¿å­˜ä¿®æ”¹åçš„ç´ æ"><a href="#ä¿å­˜ä¿®æ”¹åçš„ç´ æ" class="headerlink" title="ä¿å­˜ä¿®æ”¹åçš„ç´ æ"></a>ä¿å­˜ä¿®æ”¹åçš„ç´ æ</h1><p>â€‹    åœ¨è¿›è¡Œåˆ‡æ¢åŠ¨ç”»ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå°†ä¸Šä¸€æ¬¡ä¿®æ”¹åçš„ä¸»è§’å’Œå²è±å§†ä¿å­˜ä¸ºä¸€ä¸ªç´ æå¯¹è±¡ï¼Œè¿™æ–¹ä¾¿ä»¥åæˆ‘ä»¬çš„ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯å²è±å§†ï¼Œå°†å…¶ä¿å­˜ä¸ºç´ æå¯¹è±¡åå°±å¯ä»¥æ‰¹é‡åˆ›å»ºæ•Œäººäº†</p><h2 id="ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡"><a href="#ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡" class="headerlink" title="ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡"></a>ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡</h2><p>â€‹    ç”±äºæˆ‘ä»¬çš„ä¸»è§’å°ç‹—åœ¨ä¹‹å‰å°±ä¿å­˜ä¸ºç´ æäº†ï¼Œè€Œåœ¨ä¸Šä¸€ç« æˆ‘ä»¬ä¸ºå…¶æ·»åŠ äº†ä¸€ä¸ªèƒ¶å›Šç¢°æ’ä½“ï¼Œè¿™é‡Œæˆ‘ä»¬åªç”¨å°†èƒ¶å›Šç¢°æ’ä½“ä¿å­˜ä¸€ä¸‹å°±è¡Œäº†</p><p>â€‹    åœ¨<code>Hierarchy</code>è§†å›¾é€‰æ‹©æˆ‘ä»¬çš„å°äºº<code>Player</code>ï¼Œç„¶åæ‰¾åˆ°èƒ¶å›Šç¢°æ’ä½“ç»„ä»¶ï¼Œå³é”®å®ƒï¼ŒæŒ‰ä¸‹å›¾æ‰¾åˆ°<code>Added Component-&gt;Apply to Prefab &#39;Player&#39;</code>ï¼Œç‚¹å‡»å®ƒå°±å¯ä»¥å°†æ–°å¢åŠ çš„èƒ¶å›Šç¢°æ’ä½“åº”ç”¨åœ¨åŸæœ¬çš„ç´ æä¸Šäº†</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/f15d609363c14d13b3e1a79616db15e6.png" alt="1.png" style="zoom:80%;" /><h2 id="ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡"><a href="#ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡" class="headerlink" title="ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡"></a>ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡</h2><p>â€‹    ä¿å­˜å²è±å§†ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„äº‹æƒ…ï¼Œåªç”¨åœ¨<code>Hierarchy</code>è§†å›¾ä¸‹å°†å²è±å§†æ‹–æ‹½åˆ°åˆ°<code>Prefab-&gt;Characters</code>æ–‡ä»¶å¤¹ä¸‹å°±è¡Œäº†ï¼Œæ³¨æ„åœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©<code>Original Prefab</code></p><img src="https://p3-tt.byteimg.com/origin/pgc-image/e4d3d1be8f5a4a63aae9fa7f85938fdb.png" alt="2.png" style="zoom:80%;" /><h1 id="æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ"><a href="#æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ" class="headerlink" title="æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ"></a>æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ</h1><p>â€‹    å¯¹äºæ•Œäººè¿½å‡»æˆ‘ä»¬äººç‰©ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯æ•Œäººçš„ç§»åŠ¨ç›®æ ‡æ˜¯æˆ‘ä»¬çš„äººç‰©ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸæœ‰çš„ä»£ç åŸºç¡€ä¸Šæ¥å®ç°è¿½å‡»æ•ˆæœ</p><p>â€‹    æ‰“å¼€æˆ‘ä»¬çš„<code>EnemyController.cs</code>ä»£ç æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåœ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ª<code>attackTarget</code>çš„å˜é‡ï¼Œè¿™ä¸ªä»£è¡¨ç€æˆ‘ä»¬æ•Œäººè¿½å‡»çš„ç›®æ ‡ï¼Œå¹¶åœ¨å…ˆå‰å†™çš„<code>FoundPlayer</code>å‡½æ•°é‡Œå¯¹å…¶èµ‹äºˆç›®æ ‡ï¼ˆå³å°†åœ¨æ•Œäººä¸€å®šèŒƒå›´æ‰¾åˆ°äººç‰©æ—¶ï¼Œè¿½å‡»ç›®æ ‡ä¸ºæ•Œäººï¼‰</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">GameObject</span> attackTarget<span class="token punctuation">;</span>        <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Collider<span class="token punctuation">[</span><span class="token punctuation">]</span></span> colliders <span class="token operator">=</span> Physics<span class="token punctuation">.</span><span class="token function">OverlapSphere</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>sightRadius<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ¥å—ä¸€ä¸ªåœ†ç‚¹ï¼Œä¸€ä¸ªåŠå¾„çš„å‚æ•°ï¼Œè¿”å›çš„æ˜¯ç¢°æ’ä½“æ•°ç»„</span>                <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> target <span class="token keyword">in</span> colliders<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¾ªç¯ç¢°æ’ä½“æ•°ç»„ï¼Œé€ä¸ªæŸ¥æ‰¾</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å½“å‰å¾ªç¯åˆ°çš„ç¢°æ’ä½“çš„æ ‡ç­¾ä¸ºPlayerå°±ä»£è¡¨æ‰¾åˆ°äººç‰©äº†</span>                attackTarget<span class="token operator">=</span>target<span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>                                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    åšå¥½ä¸Šé¢è¿™äº›åï¼Œæˆ‘ä»¬è¦å›åˆ°<code>SwitchEnemyStates</code>å‡½æ•°é‡Œè¿›è¡Œå®Œå–„Switchæ¡†æ¶</p><p>â€‹    åœ¨è¿½å‡»ä¸­ï¼Œæˆ‘ä»¬è¦æ€è€ƒä¸€ä¸‹åœ¨è¿™è¿‡ç¨‹æœ‰å“ªäº›è¡Œä¸ºï¼Œé¦–å…ˆæ˜¯è¿½å‡»æ•Œäººï¼Œè¿½å‡»åˆ°äº†çš„è¯ä¼šè¿›è¡Œæ”»å‡»ï¼Œå¦‚æœç›®æ ‡è„±ç¦»äº†è¿½å‡»èŒƒå›´åˆ™åº”è¯¥å›åˆ°ä¸Šä¸€ä¸ªçŠ¶æ€ï¼ŒåŒæ—¶è¿™æ•´ä¸ªæµç¨‹éƒ½è¦æœ‰åŠ¨ç”»çš„åˆ‡æ¢ã€‚ä»¥ä¸‹ä»£ç ä¸­ä¾¿ç”¨äº†TODOæ¥æè¿°è¦åšçš„äº‹æƒ…</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token comment">//...</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»                <span class="token comment">//TODO:è¿½å‡»Player</span>                <span class="token comment">//TODO:åœ¨æ”»å‡»èŒƒå›´æ”»å‡»</span>                <span class="token comment">//TODO:é…åˆåŠ¨ç”»</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//TODO:æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//äººç‰©è¿›åˆ°æ•Œäººçš„èŒƒå›´ä¼šç»™è¿½å‡»</span>                    agent<span class="token punctuation">.</span>destination<span class="token operator">=</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    å†™äº†ä»¥ä¸Šçš„ä»£ç åï¼Œå½“æˆ‘ä»¬çš„äººç‰©é è¿‘æ•Œäººæ—¶å°±è¢«è¿½å‡»äº†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»™ä¸åŒçš„çŠ¶æ€èµ‹äºˆä¸åŒçš„é€Ÿåº¦ï¼Œå¦‚å®ˆå«çŠ¶æ€ç§»åŠ¨é€Ÿåº¦æ…¢ä¸€ç‚¹ï¼Œè€Œè¿½å‡»é€Ÿåº¦å¿«ä¸€ç‚¹ç­‰ç­‰</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> speed<span class="token punctuation">;</span><span class="token comment">//æ•Œäººçš„é€Ÿåº¦</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        agent <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        speed<span class="token operator">=</span>agent<span class="token punctuation">.</span>speed<span class="token punctuation">;</span><span class="token comment">//åœ¨åˆå§‹åŒ–æ—¶é€Ÿåº¦åˆå§‹åŒ–ä¸ºåŸæ¥é»˜è®¤çš„é€Ÿåº¦</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨<code>Switch</code>ä¸­ä¸åŒçŠ¶æ€ä¸‹ç»™å®šä¸åŒçš„é€Ÿåº¦å€¼äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//ä¸¾ä¸ªæ —å­</span><span class="token comment">//case xxx:</span>speed <span class="token operator">=</span> <span class="token number">1.0f</span><span class="token punctuation">;</span>agent<span class="token punctuation">.</span>speed<span class="token operator">=</span>speed<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç»™æ•Œäººæ·»åŠ åŠ¨ç”»"><a href="#ç»™æ•Œäººæ·»åŠ åŠ¨ç”»" class="headerlink" title="ç»™æ•Œäººæ·»åŠ åŠ¨ç”»"></a>ç»™æ•Œäººæ·»åŠ åŠ¨ç”»</h1><h2 id="ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹"><a href="#ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹"></a>ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹</h2><p>â€‹    ä¸Šé¢çš„ä»£ç æˆ‘ä»¬æ‰“å¥½åå…ˆæ”¾åœ¨ä¸€è¾¹ï¼Œå…ˆæ¥çœ‹çœ‹å²è±å§†çš„åŠ¨ç”»å¦‚ä½•æ·»åŠ </p><p>â€‹    å’Œä¹‹å‰çš„å°ç‹—ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç´ æçš„æ–‡ä»¶å¤¹ä¸‹é¢„è§ˆåŠ¨ç”»çš„æ•ˆæœ</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/cbd42713bc444c18836fedb8b0b42622.png" alt="3.png" style="zoom:80%;" /><p>â€‹    ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ª<code>Idleï¼ˆé—²ç½®ï¼‰</code>çš„åŠ¨ç”»æ•ˆæœï¼Œå…¶ä¸­çš„<code>IdleBattle</code>æ˜¯åœ¨æ”»å‡»ç©å®¶ä¸­é—´CDæ—¶é—´æ—¶çš„é—²ç½®åŠ¨ä½œï¼Œè€Œ<code>IdleNormal</code>åˆ™æ˜¯åœ¨ä¸€èˆ¬é—²ç½®çŠ¶æ€ä¸‹çš„é—²ç½®æ•ˆæœï¼Œè¿™é‡Œè¦æ³¨æ„åŒºåˆ†</p><p>â€‹    çŸ¥é“è¿™äº›åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†æ¬¡ä½¿ç”¨åŠ¨ç”»æ§åˆ¶å™¨æ¥ç®¡ç†åŠ¨ç”»çš„åˆ‡æ¢äº†</p><h2 id="ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»"><a href="#ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»" class="headerlink" title="ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»"></a>ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»</h2><p>â€‹    é¦–å…ˆåœ¨<code>Animations</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª<code>Animator Controller</code>ä¸“é—¨ç”¨æ¥ç®¡ç†å²è±å§†çš„åŠ¨ç”»ï¼Œè¿™é‡Œæˆ‘å°†å®ƒå‘½åä¸º<code>Enemy _Slime</code>ï¼ŒğŸˆè®°ä½åˆ›å»ºå¥½åè¦æ‹–æ‹½åˆ°å²è±å§†çš„å±æ€§é¢æ¿ä¸Šåº”ç”¨è¯¥Animator Controller</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/7fbb2f64cba8440f93954e02b86e2f50.png" alt="4.png" style="zoom:80%;" /><p>â€‹    æ¥ç€åŒå‡»æ‰“å¼€ä»–è¿›å…¥åŠ¨ç”»ç®¡ç†å™¨</p><p>â€‹    å› ä¸ºæ•Œäººæœ‰å¤šç§çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è€ƒè™‘å¦‚ä½•æ¥è§„åˆ’è¿™äº›åŠ¨ç”»ã€‚è€Œè¿™é‡Œåˆ™å¯ä»¥ä½¿ç”¨ä¸åŒçš„<code>Layer</code>æ¥å®ç°ä¸åŒçš„çŠ¶æ€</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/d35a90c16257478d823a52b598c87578.png" alt="5.png" style="zoom:80%;" /><center>å¯ä»¥åœ¨ä¸åŒçš„Layerä¸­å®ç°ä¸åŒçŠ¶æ€çš„åŠ¨ç”»</center><h3 id="Base-Layer"><a href="#Base-Layer" class="headerlink" title="Base Layer"></a>Base Layer</h3><p>â€‹    åˆšå¼€å§‹æˆ‘ä»¬åªç”¨åˆ°<code>Base Layer</code>ï¼Œå…¶å®ƒçš„layeræˆ‘ä»¬ä¹‹åå†åˆ›å»ºã€‚è€Œåœ¨æœ€å¼€å§‹çš„<code>Base Layer</code>å½“ä¸­ï¼Œæˆ‘ä»¬å®Œæˆæœ€åŸºæœ¬çš„çŠ¶æ€ï¼šæ™®é€šé—²ç½®å’Œè¡Œèµ°ï¼ˆå·¡é€»çŠ¶æ€ï¼‰</p><p>â€‹    å¦‚ä¸‹å›¾æ‰¾åˆ°å¯¹åº”çš„åŠ¨ç”»å¹¶æ‹–æ‹½åˆ°åŠ¨ç”»æ§åˆ¶å™¨ä¸­ï¼Œå¹¶è¿›è¡ŒçŠ¶æ€è½¬ç§»çš„è®¾ç½®</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/138c62781a3b47deb564aacdc3bd0e6f.png" alt="6.png" style="zoom:80%;" /><p>â€‹    é‚£ä¹ˆé—²ç½®çŠ¶æ€åˆ‡æ¢åˆ°è¡Œèµ°çŠ¶æ€çš„æ¡ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨ä¹‹å‰æˆ‘ä»¬æ§åˆ¶å°äººè¡Œèµ°çš„åŠ¨ç”»åˆ‡æ¢æ˜¯é€šè¿‡é¼ æ ‡ç‚¹å‡»çš„æ–¹å¼æ¥åˆ¤æ–­ï¼Œè€Œè¿™é‡Œæ•Œäººçš„çŠ¶æ€åˆ‡æ¢å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªé€»è¾‘çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªå¸ƒå°”å˜é‡æ¥æ§åˆ¶å®ƒä»¬çš„åˆ‡æ¢ï¼Œè¿™é‡Œå‘½åä¸º<code>Walk</code></p><img src="https://p5-tt.byteimg.com/origin/pgc-image/fc09aba486814ef9942061481e2d610e.png" alt="7.png" style="zoom:80%;" /><p>â€‹    ç„¶åå¡«å†™åŠ¨ç”»ä¹‹é—´çš„åˆ‡æ¢æ¡ä»¶</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/9bfd3f46132a4c938c0dddaf775ab53b.png" alt="8.png" style="zoom:80%;" /><center>ä¸¤ä¸ªåˆ‡æ¢éƒ½è¦ï¼ˆä¸€ä¸ªä¸ºtrueï¼Œä¸€ä¸ªä¸ºfalseï¼‰</center><p>â€‹    </p><h3 id="Attack-Layerï¼ˆå®ç°è¿½å‡»ï¼‰"><a href="#Attack-Layerï¼ˆå®ç°è¿½å‡»ï¼‰" class="headerlink" title="Attack Layerï¼ˆå®ç°è¿½å‡»ï¼‰"></a>Attack Layerï¼ˆå®ç°è¿½å‡»ï¼‰</h3><p>â€‹    æ¥ä¸‹æ¥æˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–°çš„Layerï¼Œå¹¶å°†å…¶å‘½åä¸º<code>Attack Layer</code>ï¼Œæˆ‘ä»¬çš„è¿½å‡»åŠ¨ç”»åˆ‡æ¢å°±åœ¨è¿™é‡Œé¢æ¥å®ç°</p><p>â€‹    æ–°å»ºå¥½åæˆ‘ä»¬è¦è®¾ç½®ä¸€ä¸‹è¿™ä¸ªLayerçš„æƒé‡å€¼ï¼Œè¿™é‡Œè¦è°ƒæ•´<code>Weight</code>å€¼ä¸ºæœ€å¤§<code>1</code>ï¼Œè¡¨ç¤ºåœ¨åŠ¨ç”»è§¦å‘çš„æ—¶å€™æ˜¯å®Œå…¨è¦†ç›–åŸæ¥çš„Base Layeré‡Œçš„åŠ¨ç”»ï¼Œå¦‚æœä¸æ˜¯1çš„è¯å°±ç›¸å½“äºæ˜¯å åŠ åŸæ¥çš„åŠ¨ç”»ï¼Œä¸¤è€…è¿›è¡Œæ··åˆ</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/f5282b22821c4d0b919674b2c68cca85.png" alt="9.png" style="zoom:80%;" /><p>â€‹    é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦‚ä½•çŸ¥é“ä¸Šä¸€ä¸ªçŠ¶æ€æ˜¯æ€ä¹ˆåˆ‡æ¢åˆ°å½“å‰çš„Layerå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨æ–°å»ºçš„Layerä¸­åˆ›å»ºä¸€ä¸ª<code>Empty State</code>å¹¶å°†å®ƒå‘½åä¸º<code>Base State</code>ï¼Œè¿™ä¸ªç©ºçš„Stateå¯ä»¥ä»£è¡¨æˆ‘ä»¬ä¹‹å‰ä»»æ„ä¸€ä¸ªLayerï¼Œå½“æ»¡è¶³æ¡ä»¶çš„æ—¶å€™å®ƒå°±ä¼šåˆ‡æ¢è¿‡æ¥å¹¶è¿›ä¸€æ­¥åˆ‡æ¢åŠ¨ç”»</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/ac40128c56244e46893c469a70178825.png" alt="10.png" style="zoom:80%;" /><p>â€‹    åˆ‡æ¢è¿‡æ¥<code>Attack Layer</code>çš„æ—¶å€™æˆ‘ä»¬æœ€å…ˆè¦è¿›å…¥çš„æ˜¯ä¸€ä¸ªé—²ç½®çŠ¶æ€ï¼Œå†åŠ ä¸Šè¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºè¿½å‡»çš„Layerï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Idle_Battle</code>è¿™ä¸ªåŠ¨ç”»</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/38b8683f9e2644ab8d281f80bcdd34fd.png" alt="11.png" style="zoom:80%;" /><p>â€‹    åŒæ ·æˆ‘ä»¬åˆ‡æ¢æ¡ä»¶ä¹Ÿæ˜¯å¯ä»¥å»ºç«‹ä¸€ä¸ª<code>å¸ƒå°”å€¼</code>å˜é‡æ¥æ§åˆ¶ï¼Œè¿™é‡Œå–åä¸º<code>Chase</code></p><p>â€‹    ä¸Šé¢çš„æ˜¯ä¸€ä¸ªæ•Œäººæ”»å‡»ç©ºå½“æ—¶CDåŠ¨ç”»ï¼Œå½“ç„¶æˆ‘ä»¬è¿˜è¦æœ‰ä¸€ä¸ªè¿½çš„åŠ¨ç”»ï¼Œä¹Ÿæ˜¯è¦é ä¸€ä¸ª<code>å¸ƒå°”å€¼</code>å˜é‡æ¥æ§åˆ¶ï¼Œå¦‚ä¸‹å›¾</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/43a30493ed3d4be0a6204f23af878588.png" alt="12.png" style="zoom:80%;" /><p>â€‹    è¿™é‡Œæˆ‘æŠŠè¿½å‡»çš„åŠ¨ç”»ï¼ˆ<code>RunFWD</code>ï¼‰åŠ äº†ä¸Šå»ï¼Œå¹¶ç”¨ä¸€ä¸ªæ–°çš„å¸ƒå°”å€¼<code>Follow</code>æ¥ä½œä¸ºå®ƒä¸<code>IdleBattle</code>ä¹‹é—´çš„åˆ‡æ¢åˆ¤æ–­æ¡ä»¶</p><p>â€‹    ğŸˆæ³¨æ„å°†ä¸‰ä¸ªå¸ƒå°”å€¼éƒ½åº”ç”¨åˆ°å¯¹åº”çš„åŠ¨ç”»åˆ‡æ¢åˆ¤æ–­ä¸Šå»å“¦ï¼</p><p>â€‹    è¿™æ ·ä¸€æ¥å°±æœ‰äº†ä¸€ä¸ªé€»è¾‘ï¼šå¦‚æœæ•Œäººå‘ç°äº†æˆ‘ä»¬çš„æ§åˆ¶çš„å°äººï¼Œå¹¶ä¸”ä¸¤è€…è·ç¦»å¤§äºæ•Œäººçš„æ”»å‡»è·ç¦»ï¼Œæ•Œäººåˆ™ä¼šè¿›è¡Œè¿½å‡»æˆ‘ä»¬çš„å°äººï¼Œå½“é è¿‘ååˆ™ä¼šè¿›è¡Œæ”»å‡»CDçŠ¶æ€ï¼Œç­‰åˆ°ä¸‹ä¸€ä¸ªæ”»å‡»åˆ°æ¥ï¼ˆæ”»å‡»åŠ¨ç”»æ•ˆæœè¿™é‡Œè¿˜æ²¡å®ç°ï¼‰</p><h2 id="ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢"><a href="#ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢" class="headerlink" title="ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢"></a>ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢</h2><p>â€‹    å®ŒæˆåŠ¨ç”»ç®¡ç†å™¨ä¸­çš„å‰ç½®å·¥ä½œåï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹æ¥å†™ä»£ç ä»è€Œé…åˆæˆ‘ä»¬çš„åŠ¨ç”»åˆ‡æ¢äº†</p><p>â€‹    æ‰“å¼€<code>EnemyController.cs</code>ï¼Œé¦–å…ˆè¦è·å–<code>Animator</code>ç»„ä»¶çš„ä¿¡æ¯</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token class-name">Animator</span> anim<span class="token punctuation">;</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//...</span>        anim <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ç„¶åè¦å£°æ˜ä¸‰ä¸ªå¸ƒå°”å˜é‡å¯¹ç…§ç€åŠ¨ç”»ç®¡ç†å™¨çš„é‚£ä¸‰ä¸ªå¸ƒå°”å˜é‡ï¼ˆWalkã€Chaseã€Followï¼‰</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span><span class="token comment">//åŠ¨ç”»æ§åˆ¶çš„ä¸‰ä¸ªå¸ƒå°”å€¼å˜é‡</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isWalk<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isChase<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isFollow<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™ä¸‰ä¸ªå˜é‡æ˜¯ç”¨æ¥å®æ—¶æ›´æ–°åŠ¨ç”»æ§åˆ¶å™¨é‡Œçš„å¸ƒå°”å˜é‡çš„ï¼Œå› æ­¤æˆ‘ä»¬è¦ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å°†å®ƒæ”¾åœ¨<code>Update()</code>é‡Œè¾¹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>        <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//å®æ—¶æ›´æ–°Animatoré‡Œé¢å²è±å§†çš„ä¸‰ä¸ªå¸ƒå°”å€¼</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Walk"</span><span class="token punctuation">,</span>isWalk<span class="token punctuation">)</span><span class="token punctuation">;</span>        anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Chase"</span><span class="token punctuation">,</span>isChase<span class="token punctuation">)</span><span class="token punctuation">;</span>        anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Follow"</span><span class="token punctuation">,</span>isFollow<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬åœ¨å…¶å®ƒå‡½æ•°é‡Œæ›´æ”¹äº†è¿™ä¸‰ä¸ªiså¸ƒå°”å€¼çš„è¯ï¼Œä»–ä»¬å°±å¯ä»¥å®æ—¶åŒæ­¥åˆ°Animatoré‡Œé¢äº†</p><p>â€‹    ç´§æ¥ç€æˆ‘ä»¬å›åˆ°<code>SwitchEnemyStates()</code>å‡½æ•°é‡Œé¢ä¿®æ”¹ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//...</span><span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token comment">//...</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»<span class="token comment">//TODO:è¿½å‡»Player</span>    <span class="token comment">//TODO:åœ¨æ”»å‡»èŒƒå›´æ”»å‡»</span>            <span class="token comment">//TODO:é…åˆåŠ¨ç”»</span>        isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è¿½å‡»æ—¶å°±ä¸æ˜¯èµ°è·¯äº†</span>        isChase <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//åˆ‡æ¢åˆ°è¿½å‡»çš„Layerå±‚åŠ¨ç”»</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">//TODO:æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>        isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        isFollow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°äººç‰©å°±è·‘ç€è¿½</span>      agent<span class="token punctuation">.</span>speed<span class="token operator">=</span>speed<span class="token punctuation">;</span>        <span class="token comment">//äººç‰©è¿›åˆ°æ•Œäººçš„èŒƒå›´ä¼šç»™è¿½å‡»</span>        agent<span class="token punctuation">.</span>destination<span class="token operator">=</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>   <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    åˆ°è¿™é‡Œæˆ‘ä»¬å°±å®ç°äº†æ•Œäººè¿½å‡»æˆ‘ä»¬çš„çŠ¶æ€å•¦ï¼Œå¿«å»æ¸¸æˆä¸­è¯•ä¸€ä¸‹å§</p><h1 id="è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜"><a href="#è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜" class="headerlink" title="è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜"></a>è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜</h1><p>â€‹    è¯•è¿‡æ¸¸æˆåæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“æˆ‘ä»¬äººç‰©è„±ç¦»æ•Œäººè¿½å‡»èŒƒå›´æ—¶æ•Œäººä¼šå†èµ°ä¸€å°æ®µè·¯æ‰ä¼šåœä¸‹æ¥ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰åŠæ—¶ä¿®æ”¹æ•Œäººç§»åŠ¨çš„ç›®çš„åœ°ï¼Œä¹Ÿå°±æ˜¯<code>agent.destination</code>ï¼Œå½“è„±ç¦»è¿½å‡»èŒƒå›´åï¼Œæ•Œäººçš„ç›®çš„åœ°è¿˜åœ¨åé¢ä¸€å°æ®µè·¯ï¼Œä»è€Œå¯¼è‡´äº†å»¶è¿Ÿçš„æ•ˆæœ</p><p>â€‹    è¿™é‡Œä¿®æ”¹å®ƒä¹Ÿå¾ˆç®€å•ï¼Œåœ¨ä¸Šé¢ä»£ç æ·»åŠ ä¸€æ¡è¯­å¥å°±å¯ä»¥äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//...</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>    agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//äººç‰©è„±ç¦»è¿½å‡»èŒƒå›´åï¼Œæ•Œäººåœåœ¨å½“å‰ä½ç½®</span>    isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span class="token comment">//...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·ï¼Œæ•Œäººåœ¨è„±ç¦»è¿½å‡»çŠ¶æ€æ—¶å°±ä¼šç«‹åˆ»åœåœ¨å½“å‰ä½ç½®äº†</p><p>â€‹    ğŸ‰åˆ°è¿™é‡Œï¼Œæœ¬ç« æˆ‘ä»¬å°±æˆåŠŸå®ç°äº†æ•Œäººçš„ä¸€ä¸ªç®€å•çš„è¿½å‡»çŠ¶æ€åŠåŠ¨ç”»åˆ‡æ¢ç®¡ç†ï¼Œä¸‹ä¸€ç« æˆ‘ä»¬å°†æ›´åŠ å®Œå–„æ•Œäººå…¶å®ƒä¸€äº›çŠ¶æ€ï¼Œä¾‹å¦‚å·¡é€»æ•ˆæœç­‰</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°7--ä¿®æ”¹ç›¸æœºç§»åŠ¨è§†è§’ä»¥åŠæ·»åŠ æ•ŒäººèŒƒå›´æ£€æµ‹</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B07-%E4%BF%AE%E6%94%B9%E7%9B%B8%E6%9C%BA%E7%A7%BB%E5%8A%A8%E8%A7%86%E8%A7%92%E4%BB%A5%E5%8F%8A%E6%B7%BB%E5%8A%A0%E6%95%8C%E4%BA%BA%E8%8C%83%E5%9B%B4%E6%A3%80%E6%B5%8B/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B07-%E4%BF%AE%E6%94%B9%E7%9B%B8%E6%9C%BA%E7%A7%BB%E5%8A%A8%E8%A7%86%E8%A7%92%E4%BB%A5%E5%8F%8A%E6%B7%BB%E5%8A%A0%E6%95%8C%E4%BA%BA%E8%8C%83%E5%9B%B4%E6%A3%80%E6%B5%8B/</url>
      
        <content type="html"><![CDATA[<p>â€‹    è¿™ä¸€ç« æˆ‘ä»¬å°†å¯¹é¡¹ç›®åšä¸€äº›è°ƒæ•´ï¼ŒåŒ…æ‹¬ï¼šè®¾ç½®è‡ªç”±ç§»åŠ¨è§†è§’çš„ç›¸æœºã€æ£€æµ‹äººç‰©æ˜¯å¦åˆ°è¾¾æ•Œäººé™„è¿‘ã€åˆ‡æ¢åˆ°è¿½å‡»æ¨¡å¼ç­‰ã€‚ä»¥åæˆ‘ä»¬å¯èƒ½ä¼šå¤šæ¬¡åœ¨é¡¹ç›®å¼€å‘é€”ä¸­åœä¸‹æ¥åšä¸€äº›å°å°çš„ä¼˜åŒ–ä¹‹ç±»çš„ï¼Œè¿™äº›éƒ½æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚</p><h1 id="å°†ç›¸æœºæ”¹æˆå¯è‡ªç”±ç§»åŠ¨è§†è§’"><a href="#å°†ç›¸æœºæ”¹æˆå¯è‡ªç”±ç§»åŠ¨è§†è§’" class="headerlink" title="å°†ç›¸æœºæ”¹æˆå¯è‡ªç”±ç§»åŠ¨è§†è§’"></a>å°†ç›¸æœºæ”¹æˆå¯è‡ªç”±ç§»åŠ¨è§†è§’</h1><p>â€‹    åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬çš„ç›¸æœºè™½ç„¶éƒ½æ˜¯å¯ä»¥è·Ÿéšäººç‰©ç§»åŠ¨çš„ï¼Œä½†æ˜¯å®ƒè§†è§’æ˜¯å›ºå®šçš„ï¼Œä¸èƒ½è‡ªç”±åœ°å»ç§»åŠ¨è§†è§’ã€‚å¦‚æœä½ æƒ³æ›´æ”¹æˆè‡ªç”±è§†è§’çš„ç›¸æœºçš„è¯ï¼Œé‚£ä¹ˆå°±ç°åœ¨æ¥å®ç°å§ï¼</p><p>â€‹    è¿™é‡Œæœ€ä¸»è¦çš„å°±æ˜¯å°†<code>Cinemachine</code>æ’ä»¶ä¸­çš„<code>Virtual Camera</code>æ¢æˆ<code>FreeLook Camera</code></p><p>â€‹    å› æ­¤æˆ‘ä»¬é€‰æ‹©åŸæ¥åˆ›å»ºçš„<code>Virtual Camera</code>ï¼Œç„¶åå°†å®ƒå…³é—­ï¼ˆå¦‚æœä½ å·²ç»å†³å®šä¸æƒ³ä½¿ç”¨å¯ä»¥ç›´æ¥åˆ é™¤ï¼‰ï¼Œå…·ä½“å…³é—­æ–¹æ³•å°±æ˜¯å–æ¶ˆä¸‹å›¾æ‰€ç¤ºçš„å‹¾å‹¾</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/be709270a95a408ca723e83e24f0df33.png" alt="1.png" style="zoom:80%;" /><p>â€‹    å‡¡æ˜¯å…³é—­åçš„å¯¹è±¡åœ¨åˆ—è¡¨ä¸­éƒ½ä¼šå˜æˆæ·¡ç°è‰²çš„</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/076433cd57354d968359194bacc2c638.png" alt="2.png" style="zoom:80%;" /><p>â€‹    ä¹‹åæˆ‘ä»¬å†é€‰ä¸­ä¸»æ‘„åƒæœºï¼Œ<code>Main Camera</code>ï¼Œåœ¨Unityä¸Šæ–¹èœå•ä¸­é€‰æ‹©<code>Cinemachine</code>æ’ä»¶åˆ—è¡¨èœå•é¡¹ğŸ‘‰ä¹‹åå†é€‰æ‹©å¦‚å›¾ç¬¬äºŒä¸ªé€‰é¡¹<code>FreeLook Camera</code></p><img src="https://p3.toutiaoimg.com/origin/pgc-image/487625f3bdce4f8db3115e37d2e53046.png" alt="3.png" style="zoom:80%;" /><p>â€‹    åˆ›å»ºå®Œæ¯•åï¼Œæˆ‘ä»¬å°†æ–°çš„ç›¸æœºå’Œæ—§çš„ç›¸æœºéƒ½å‘½åä¸€ä¸‹ï¼Œé˜²æ­¢ææ··ã€‚</p><p>â€‹    æˆ‘ä»¬åŒæ ·è¦æ¥é€‰æ‹©ä¸€ä¸‹ç›¸æœºçš„è·Ÿè¸ªå¯¹è±¡å’Œè§‚å¯Ÿå¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠæ§åˆ¶äººç‰©<code>Player</code>æ‹–è¿›å»</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/586146b0a6ab4820958b1903848901a8.png" alt="4.png" style="zoom:80%;" /><p>â€‹    æˆ‘ä»¬åœ¨çª—å£ä¸­å¯ä»¥çœ‹åˆ°æ‘„åƒæœºæ—è¾¹æœ‰ä¸Šä¸­ä¸‹ä¸‰ä¸ªçº¢è‰²åœˆåœˆï¼ŒåŒæ—¶è¿˜æœ‰ä¸€æ¡å¼§çº¿åŒ…è£¹ä½å®ƒä»¬ï¼Œè¿™æ˜¯ä»£è¡¨ç€æˆ‘ä»¬ç›¸æœºå¯ä»¥åœ¨è¿™ä¸‰ä¸ªç»´åº¦é‡Œé¢è‡ªç”±æ—‹è½¬åˆ‡æ¢æ‘„åƒæœºè§’åº¦ï¼ŒåŒæ—¶å¯ä»¥è¿›è¡Œä¸Šä¸‹è§’åº¦çš„åˆ‡æ¢ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å–œå¥½æ¥è°ƒæ•´è¿™å‡ ä¸ªåœˆåœˆ</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/7dacd6ce8f324399aa660d3d593e8e2c.png" alt="5.png" style="zoom:80%;" /><p>â€‹    ç„¶åå°±æ˜¯å¦‚ä½•æ¥æ§åˆ¶æ‘„åƒæœºç§»åŠ¨äº†ï¼Œæˆ‘ä»¬åœ¨<code>FreeLook Camera</code>çš„å±æ€§é¢æ¿ä¸­å¯ä»¥çœ‹åˆ°æœ‰ä¸ª<code>Axis Control</code>çš„é¡¹ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ§åˆ¶Yè½´ç§»åŠ¨çš„æ˜¯<code>Mouse Y</code>ï¼Œæ§åˆ¶Xè½´ç§»åŠ¨çš„æ˜¯<code>Mouse X</code>ï¼Œå³é»˜è®¤æƒ…å†µæ˜¯é¼ æ ‡ç§»åŠ¨æ¥æ§åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤ä¿®æ”¹å®ƒ</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/d5c98a365df147d79a90ce4fa823e67e.png" alt="6.png" style="zoom:80%;" /><p>â€‹    æˆ‘ä»¬æ‰“å¼€<code>Project Setting...</code>ï¼Œé‡Œé¢æœ‰ä¸ª<code>Input Manager</code>ï¼Œåœ¨è¿™é‡Œå°±å¯ä»¥ä¿®æ”¹å…·ä½“å…³äº<code>Axis</code>æŒ‰é”®çš„è®¾ç½®</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/3d0286059bc547ccabd4c79efcf82bef.png" alt="7.png" style="zoom:80%;" /><p>â€‹    åœ¨Mouse Yä¸‹é¢æœ‰ä¸€ä¸ª<code>Mouse ScrollWheel</code>ï¼Œè¿™ä¸ªå°±æ˜¯é¼ æ ‡çš„æ»šè½®ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è¿›è¡Œè§†è§’çš„æ‹‰è¿œå’Œæ‹‰è¿‘</p><p>â€‹    è¿˜æœ‰ä¸€ä¸ª<code>Horizontal</code>çš„é€‰é¡¹ï¼Œè¿™ä¸ªå¯ä»¥æ¥æ§åˆ¶è§†è§’å·¦å³ç§»åŠ¨ï¼Œå¹¶ä¸”å®ƒå¯ä»¥åˆ©ç”¨æˆ‘ä»¬æä¾›çš„è‡ªå®šä¹‰æŒ‰é”®ï¼Œå¦‚ï¼šAå’ŒDï¼Œåªéœ€è¦åœ¨<code>Negative Button</code>å’Œ<code>Positive Button</code>åˆ†åˆ«å¡«å…¥ä½ æƒ³è¦çš„æŒ‰é”®</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/20c6e5d985d34974b7e52ecdafb2ff24.png" alt="8.png" style="zoom:80%;" /><p>â€‹    è‡ªå®šä¹‰å¥½æŒ‰é”®ä¹‹åï¼Œæˆ‘ä»¬è¦æŠŠå…·ä½“çš„<code>Axes</code>åç§°å¤åˆ¶åˆ°æ‘„åƒæœºå±æ€§é¢æ¿ä¸­ï¼Œå¦‚æœæµ‹è¯•çš„æ—¶å€™å‘ç°è§†è§’ç§»åŠ¨æ˜¯åå‘çš„å¯ä»¥æŠŠ<code>Invert</code>å¯é€‰æ¡†çš„å‹¾å‹¾å»æ‰ï¼Œè½¬å‘é€Ÿåº¦å¤ªæ…¢å¯ä»¥ä¿®æ”¹<code>Speed</code>é‡Œçš„æ•°å€¼</p><p>â€‹    ğŸˆåœ¨è°ƒè¯•ä¹‹å‰å¯ä»¥æŠŠ<code>Save During Play</code>é€‰ä¸Šï¼Œè¿™æ ·ä¾¿å¯ä»¥ç‚¹<code>Game</code>æ¸¸ç©æ—¶è¾¹ç©è¾¹è°ƒæ•´ï¼Œå¹¶ä¸”ä¿®æ”¹çš„æ•°æ®å¯ä»¥ä¿å­˜ä¸‹æ¥</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/1dd06a7a2f0e49d39f3622ffa4bead06.png" alt="9.png" style="zoom:80%;" /><p>â€‹    è¿™æ ·ï¼Œæˆ‘ä»¬çš„æ‘„åƒæœºè§†è§’æ§åˆ¶å°±è‡ªå®šä¹‰å¥½äº†</p><p>â€‹    å¦‚æœå‘ç°æ‘„åƒæœºç¦»äººç‰©å¤ªè¿‘ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä»¥ä¸‹çš„å‚æ•°</p><p>â€‹    <code>Orbits</code>é¡¹åˆ†åˆ«æœ‰ä¸‰ä¸ª<code>Rig</code>çš„ä¿®æ”¹å‚æ•°æ¡†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¿®æ”¹</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/54045622e4a64873846e612a7e679804.png" alt="10.png" style="zoom:80%;" /><p>â€‹    è¿™é‡Œæˆ‘çš„å‚æ•°ä¿®æ”¹å¦‚ä¸‹</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/eeb5b826c51240e3bcf20c7f1ae81ac3.png" alt="11.png" style="zoom:80%;" /><p>â€‹    åˆ°è¿™æˆ‘ä»¬çš„è‡ªç”±è§†è§’ç›¸æœºå°±è®¾ç½®å¥½äº†</p><h1 id="æ£€æµ‹äººç‰©æ˜¯å¦åœ¨æ•Œäººé™„è¿‘"><a href="#æ£€æµ‹äººç‰©æ˜¯å¦åœ¨æ•Œäººé™„è¿‘" class="headerlink" title="æ£€æµ‹äººç‰©æ˜¯å¦åœ¨æ•Œäººé™„è¿‘"></a>æ£€æµ‹äººç‰©æ˜¯å¦åœ¨æ•Œäººé™„è¿‘</h1><p>â€‹    æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°è®©æ•Œäººæ£€æµ‹äººç‰©æ˜¯å¦åœ¨å®ƒè‡ªèº«çš„é™„è¿‘</p><p>â€‹    æˆ‘ä»¬æ‰“å¼€ä¹‹å‰å·²ç»å†™äº†ä¸€ç‚¹æ¡†æ¶çš„<code>EnemyController.cs</code>ä»£ç æ–‡ä»¶ï¼Œå…ˆä¿®æ”¹ä¸€ä¸‹å‰é¢å£°æ˜çš„<code>enemyStates</code>ï¼Œå°†å…¶æ”¹ä¸º<code>private</code>ï¼Œå› ä¸ºè¿™ä¸ªæ•ŒäººçŠ¶æ€æ˜¯é åé¢ä»£ç è‡ªåŠ¨æ”¹å˜çš„ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ¥å¼„ï¼Œæ²¡æœ‰å¿…è¦è®¾æˆpublic</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token class-name">EnemyStates</span> enemyStates<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â€‹    </p><p>â€‹    ç„¶åæˆ‘ä»¬å¯ä»¥å¼„ä¸€ä¸ªå˜é‡ï¼Œè¡¨ç¤ºæ•Œäººçš„å¯è§†èŒƒå›´</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Basic Settings"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> sightRadius<span class="token punctuation">;</span><span class="token comment">//æ•Œäººçš„å¯è§†èŒƒå›´</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>â€‹    è¿™é‡Œæˆ‘ç”¨äº†ä¸€ä¸ª<code>[Header(&quot;Basic Settings&quot;)]</code>ï¼Œè¿™æ ·åšå¯ä»¥åœ¨å¯¹è±¡çš„å±æ€§é¢æ¿æœ‰ä¸€ä¸ªåˆ’åˆ†çš„ä½œç”¨ï¼Œä»¥åæˆ‘ä»¬éƒ½å¯ä»¥è¿™æ ·æ¥åˆ’åˆ†ä¸€äº›ä»£ç å…¬å¼€ç»™å¤–ç•Œçš„è®¾ç½®é¡¹ğŸ‘‡</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/6c60b7836bf74b1fb0671f9c2af7253f.png" alt="12.png" style="zoom:80%;" /><p>â€‹    ç„¶åå°±åˆ°äº†æˆ‘ä»¬å…³é”®çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œå†™ä¸€ä¸ªæ£€æµ‹æ•Œäººé™„è¿‘æ˜¯å¦æœ‰äººç‰©çš„å‡½æ•°ï¼Œè¿™é‡Œæ˜¯åˆ©ç”¨äº† <a href="https://docs.unity3d.com/ScriptReference/Physics.OverlapSphere.html">Physics.OverlapSphere</a> çš„æ–¹æ³•ï¼Œè¿™ä¸ªå‡½æ•°æ£€æµ‹äº†ä¸€ä¸ªçƒä½“èŒƒå›´å†…æ˜¯å¦æœ‰ç¢°æ’ä½“ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸ºäººç‰©æ·»åŠ ä¸€ä¸ªç¢°æ’ä½“å†ç»“åˆè¿™ä¸ªæ–¹æ³•æ¥å®ç°</p><p>â€‹    æˆ‘ä»¬å…ˆæ¥å†™å®ç°ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Collider<span class="token punctuation">[</span><span class="token punctuation">]</span></span> colliders <span class="token operator">=</span> Physics<span class="token punctuation">.</span><span class="token function">OverlapSphere</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>sightRadius<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ¥å—ä¸€ä¸ªåœ†ç‚¹ï¼Œä¸€ä¸ªåŠå¾„çš„å‚æ•°ï¼Œè¿”å›çš„æ˜¯ç¢°æ’ä½“æ•°ç»„</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> target <span class="token keyword">in</span> colliders<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¾ªç¯ç¢°æ’ä½“æ•°ç»„ï¼Œé€ä¸ªæŸ¥æ‰¾</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å½“å‰å¾ªç¯åˆ°çš„ç¢°æ’ä½“çš„æ ‡ç­¾ä¸ºPlayerå°±ä»£è¡¨æ‰¾åˆ°äººç‰©äº†</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    å› ä¸º<code>OverlapSphere</code>è¿”å›çš„æ˜¯ç¢°æ’ä½“æ•°ç»„ï¼Œæˆ‘ä»¬ä¹‹ååªè¦åœ¨è¿™æ•°ç»„ä¸­éå†æŸ¥æ‰¾æ˜¯å¦æœ‰æ ‡ç­¾ä¸º<code>Player</code>çš„å¯¹è±¡å°±è¡Œäº†</p><p>â€‹    ç„¶åä¿®æ”¹ä¸€ä¸‹ä¹‹å‰çš„<code>SwitchEnemyStates</code>å‡½æ•°</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¦‚æœå‘ç°player åˆ‡æ¢åˆ°CHASE</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">;</span>            Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"æ•Œäºº&#123;0&#125;å‘ç°äº†ç©å®¶"</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æµ‹è¯•ä»£ç </span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    å†™å®Œä»£ç ååˆ«å¿˜äº†æˆ‘ä»¬è¦ä¸ºäººç‰©æ·»åŠ ä¸€ä¸ªç¢°æ’ä½“ï¼Œè¿™é‡Œæˆ‘é€‰ç”¨çš„å°±æ˜¯èƒ¶å›Šç¢°æ’ä½“<code>Capsule Collider</code>ï¼Œç„¶åè°ƒæ•´ä¸€ä¸‹èƒ¶å›Šçš„å¤§å°</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/31bf56dfd4ae4f998acbbc3320e577de.png" alt="13.png" style="zoom:80%;" /><img src="https://p3.toutiaoimg.com/origin/pgc-image/12273ccf82704bbdb3a69d8ff64a940c.png" alt="15.png" style="zoom:80%;" /><p>â€‹    æœ€åå†æŠŠäººç‰©çš„æ ‡ç­¾è®¾ä¸º<code>Player</code>ï¼Œç„¶åæŠŠä¹‹å‰è®¾çš„å…¬å¼€å˜é‡<code>Sight Radius</code>è§†é‡èŒƒå›´èµ‹äºˆä¸€ä¸ªå€¼</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/5fa32863fb39401ba974cd2e18443420.png" alt="14.png" style="zoom:80%;" /><img src="https://p3.toutiaoimg.com/origin/pgc-image/3892abc4f74f4700b0078adcbe3aa7ac.png" alt="16.png" style="zoom:80%;" /><p>â€‹    è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†æ•ŒäººèŒƒå›´æ£€æµ‹äººç‰©çš„åŠŸèƒ½äº†ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°6-åˆ›å»ºæ•Œäºº</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B06-%E5%88%9B%E5%BB%BA%E6%95%8C%E4%BA%BA/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B06-%E5%88%9B%E5%BB%BA%E6%95%8C%E4%BA%BA/</url>
      
        <content type="html"><![CDATA[<p>â€‹     åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ å¦‚ä½•åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ•Œäººå¹¶æ·»åŠ ä¸€äº›å…³äºç§»å‘æ•Œäººçš„ä»£ç å’Œæ”»å‡»åŠ¨ç”»ï¼Œä»è€Œä½¿æˆ‘ä»¬çš„æ¸¸æˆæ›´åŠ å®Œå–„</p><h1 id="ä¸‹è½½å¹¶å®‰è£…æ•Œäººç´ æ"><a href="#ä¸‹è½½å¹¶å®‰è£…æ•Œäººç´ æ" class="headerlink" title="ä¸‹è½½å¹¶å®‰è£…æ•Œäººç´ æ"></a>ä¸‹è½½å¹¶å®‰è£…æ•Œäººç´ æ</h1><p>â€‹    æˆ‘ä»¬ä»Šå¤©è¦ä¸‹è½½çš„æ•Œäººç´ æåå­—æ˜¯<strong>RPG Monster Duo PBR Polyart</strong>ï¼Œå¤§å®¶å¯ä»¥å» Assert Store ä¸Šä¸‹è½½ä¸‹æ¥</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/06c4964d32aa45fa89ebb17df55275cf.jpg" alt="1.1.jpg" style="zoom:80%;" /><p>â€‹    åŒæ ·çš„ï¼Œä¸‹è½½å®Œåæˆ‘ä»¬é€‰æ‹© <code>Import</code> åŠ è½½è¿›æˆ‘ä»¬çš„é¡¹ç›®é‡Œï¼Œå†æŠŠæ–°ç´ æçš„æ–‡ä»¶å¤¹åˆ†ç±»æ”¾å¥½</p><p>â€‹    æˆ‘ä»¬å¯ä»¥é¢„è§ˆä¸€ä¸‹åˆšä¸‹å¥½çš„ç´ æï¼Œä½†æ˜¯å‘ç°æ˜¯æ²¡æœ‰è´´å›¾çš„ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æŠŠç´ æå‡çº§åˆ°URPï¼Œæˆ‘ä»¬å°†ç´ æå‡çº§ä¸€ä¸‹å°±å¯ä»¥æ˜¾ç¤ºæ­£å¸¸äº†ï¼Œè¿˜è®°å¾—å¦‚ä½•å°†ç´ æå‡çº§URPå—ï¼Ÿä¸è®°å¾—çš„è¯å¯ä»¥ç¿»çœ‹å‰é¢çš„æ–‡ç« å“¦</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/9190e65818cf49a5ba851b0aabec2db9.png" alt="2.png" style="zoom:80%;" /><h1 id="å¸ƒç½®å¹¶è®¾ç½®æ•Œäººçš„åŸºæœ¬å±æ€§å’ŒçŠ¶æ€"><a href="#å¸ƒç½®å¹¶è®¾ç½®æ•Œäººçš„åŸºæœ¬å±æ€§å’ŒçŠ¶æ€" class="headerlink" title="å¸ƒç½®å¹¶è®¾ç½®æ•Œäººçš„åŸºæœ¬å±æ€§å’ŒçŠ¶æ€"></a>å¸ƒç½®å¹¶è®¾ç½®æ•Œäººçš„åŸºæœ¬å±æ€§å’ŒçŠ¶æ€</h1><h2 id="ä½¿ç”¨ä»£ç çº¦æŸçš„æ–¹å¼æ¥æ·»åŠ ç»„ä»¶"><a href="#ä½¿ç”¨ä»£ç çº¦æŸçš„æ–¹å¼æ¥æ·»åŠ ç»„ä»¶" class="headerlink" title="ä½¿ç”¨ä»£ç çº¦æŸçš„æ–¹å¼æ¥æ·»åŠ ç»„ä»¶"></a>ä½¿ç”¨ä»£ç çº¦æŸçš„æ–¹å¼æ¥æ·»åŠ ç»„ä»¶</h2><p>å®‰è£…å¥½æ•Œäººç´ æåï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ•Œäººæ‹–åˆ°åœ°å›¾ä¸­äº†ï¼Œå°†å®ƒæ”¾åˆ°ä½ å–œæ¬¢çš„ä½ç½®ä¹‹åï¼Œå°±å¯ä»¥ç€æ‰‹æ¥ä¿®æ”¹ä¸€ä¸‹å®ƒçš„åŸºæœ¬å±æ€§äº†</p><p>â€‹    ä»è¿™é‡Œå¼€å§‹æˆ‘ä»¬è¦é•¿è¿œè€ƒè™‘ï¼Œæˆ‘ä»¬ä»¥åéœ€è¦æ·»åŠ çš„æ•Œäººä¼šæœ‰å¾ˆå¤šï¼Œè€Œè¿™äº›æ•Œäººéƒ½éœ€è¦æŒ‚è½½ä¸€äº›ç›¸åŒçš„ç»„ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ç§æ›´å¥½çš„æ–¹æ³•æ¥ä¸ºä»¥åæ•Œäººä¸€é”®æ·»åŠ è¿™äº›ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸€ä¸ªæ¥æ·»åŠ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹å§</p><p>â€‹    é¦–å…ˆåœ¨ä¸‹å›¾çš„<code>ScriptsğŸ‘‰Charcters</code>æ–‡ä»¶å¤¹ä½ç½®æ–°å»ºä¸€ä¸ª C# ä»£ç æ–‡ä»¶ï¼Œå¯ä»¥å‘½åä¸º <strong>EnemyController</strong>ï¼Œç„¶åæ‰“å¼€ç¼–è¾‘</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/30321fb536f94b068f6b998b8e2b663e.png" alt="3.png" style="zoom:80%;" /><p>â€‹    è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æ¥æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ•Œäººéœ€è¦å“ªäº›ç»„ä»¶å‘¢ï¼Ÿé¦–å…ˆæƒ³åˆ°çš„æ˜¯æ™ºèƒ½å¯¼èˆª <code>NavMeshAgent</code>ï¼Œé‚£æˆ‘ä»¬è¦ç¡®ä¿å®ƒæ•Œäººå¯¹è±¡è‚¯å®šæŒ‚è½½è¿™ä¸ªç»„ä»¶çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥çº¦æŸå®ƒ</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>AI</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">RequireComponent</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">NavMeshAgent</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>â€‹    æŠŠ<code>[RequireComponent()]</code>è¿™ä¸€ä¸ªçº¦æŸå¥å­æ”¾åœ¨ä»£ç æ–‡ä»¶å¼€å¤´çš„ä½ç½®ï¼Œå°±å¯ä»¥å®ç°å½“ä½ æŠŠä»£ç ä½œä¸ºä¸€ä¸ªç»„ä»¶æ·»åŠ åˆ°æ•Œäººæˆ–å…¶å®ƒUnityå¯¹è±¡ä¸­æ—¶ï¼Œè‡ªåŠ¨æ·»åŠ ç»™çº¦æŸçš„ç»„ä»¶äº†</p><p>â€‹    æŒ‰ä¸Šé¢ä»£ç æ¥ä¸¾æ —å­ï¼Œå½“æˆ‘æŠŠåŒ…å«ä¸Šé¢ä»£ç çš„æ–‡ä»¶ä½œä¸ºç»„ä»¶æ·»åŠ åˆ°æˆ‘ä»¬çš„æ•Œäººä¸­æ—¶ï¼Œä¼šè‡ªåŠ¨é™„å¸¦ä¸€ä¸ª<code>NavMeshAgent</code>ç»„ä»¶äº†</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/ff7fb226a3524c7e8aec1e566b2a0e43.png" alt="4.png" style="zoom:80%;" /><p>â€‹    è€Œä¸”å½“ä½ è¯•å›¾åˆ é™¤<code>NavMeshAgent</code>ç»„ä»¶æ—¶Unityè¿˜ä¼šå‘å‡ºè­¦å‘Šæç¤ºä¸èƒ½åˆ é™¤</p><img src="https://p9.toutiaoimg.com/origin/pgc-image/85dda0a8a4a2418cb95ff0402e2a5292.png" alt="5.png" style="zoom:80%;" /><p>â€‹    æ‰€ä»¥å½“ä½ çš„ä»£ç éœ€è¦ç”¨åˆ°ä¸€å®šçš„ç»„ä»¶åœ¨å¤šä¸ªç‰©ä½“ä¸Šï¼Œä½ å°±å¯ä»¥è¿ç”¨è¿™ç§æ–¹å¼æ¥ç¡®ä¿ä½ çš„ç‰©ä½“åŒ…å«äº†è¿™äº›ç»„ä»¶ï¼Œä»¥è‡´äºä½ çš„ä»£ç èƒ½å¤Ÿæ­£å¸¸è¿è¡Œ</p><p>â€‹    åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨<code>Awake()</code>å‡½æ•°é‡Œé¢è·å–æˆ‘ä»¬çš„ç»„ä»¶äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>AI</span><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">RequireComponent</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">NavMeshAgent</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">NavMeshAgent</span> agent<span class="token punctuation">;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        agent <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    </p><h2 id="è®¾ç½®æ•ŒäººåŸºæœ¬å±æ€§"><a href="#è®¾ç½®æ•ŒäººåŸºæœ¬å±æ€§" class="headerlink" title="è®¾ç½®æ•ŒäººåŸºæœ¬å±æ€§"></a>è®¾ç½®æ•ŒäººåŸºæœ¬å±æ€§</h2><p>â€‹    æ¥ä¸‹æ¥æˆ‘ä»¬è®¾ç½®ä¸€ä¸‹æ•Œäººçš„åŸºæœ¬å±æ€§ï¼Œå…ˆæ¥çœ‹çœ‹<code>NavMeshAgent</code>çš„ä¿¡æ¯</p><img src="https://p9.toutiaoimg.com/origin/pgc-image/8c5a62e350ad41d689b6fd0a38cfd104.png" alt="6.png" style="zoom:80%;" /><p>â€‹    è¿™é‡Œæˆ‘ä¿®æ”¹äº†ä¸€ä¸‹è¿™ä¸ªæ•Œäººçš„é€Ÿåº¦<code>Speed</code>ï¼Œå› ä¸ºé€Ÿåº¦å¤ªå¿«ä¼šå¯¼è‡´æˆ‘ä»¬çš„ä¸»è§’æ— æ³•æ‘†è„±æˆ˜æ–—ï¼›åŒæ ·ä¿®æ”¹äº†çš„è¿˜æœ‰è½¬è§’é€Ÿåº¦<code>Angular Speed</code>å’Œé«˜åº¦<code>Height</code>ï¼Œè¿™äº›éƒ½å¯ä»¥è‡ªå·±å°è¯•æ¥è°ƒæ•´åˆ°è‡ªå·±å–œæ¬¢çš„æ•°å€¼</p><p>â€‹    å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜è¦æ¥æ·»åŠ ä¸€ä¸ªç¢°æ’ä½“ç»„ä»¶<code>Collider</code>ï¼Œæˆ‘ä»¬è¦å€Ÿç”¨è¿™ä¸ªç¢°æ’ä½“æ¥åˆ¤æ–­æˆ‘ä»¬é¼ æ ‡çš„å°„çº¿æ˜¯å¦ç‚¹å‡»åˆ°äº†æˆ‘ä»¬çš„æ•Œäººï¼Œå¦‚æœæ²¡æœ‰ç¢°æ’ä½“æˆ‘ä»¬æ˜¯æ²¡æœ‰åŠæ³•æ¥åˆ¤æ–­æ˜¯å¦å‡»ä¸­çš„ã€‚</p><p>â€‹    æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±å–œå¥½å’Œéœ€æ±‚æ¥æ·»åŠ ä¸åŒçš„ç¢°æ’ä½“ç»„ä»¶ï¼Œæˆ‘è¿™é‡Œä¸ºäº†ç®€å•å°±ä½¿ç”¨<code>BoxCollider</code></p><img src="https://p3.toutiaoimg.com/origin/pgc-image/11640e3d6b6048f282feb4622684ece2.png" alt="7.png" style="zoom:80%;" /><p>â€‹    æ·»åŠ å¥½è°ƒæ•´ä¸€ä¸‹æ–¹ä½“çš„ä½ç½®ï¼Œä½¿æ–¹æ¡†åˆšå¥½åŒ…å«æ•Œäºº</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/3f63124e04c9414a94edbdfc62310fb5.png" alt="8.png" style="zoom:80%;" /><p>â€‹    å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜è¦è°ƒæ•´ä¸€ä¸‹æˆ‘ä»¬æ•Œäººçš„å›¾å±‚ï¼Œä»¥é˜²è¢«å…¶å®ƒä¸œè¥¿æŒ¡ä½äº†çœ‹ä¸è§ã€‚</p><p>â€‹    å’Œä¹‹å‰å‰”é™¤äººç‰©é®æŒ¡ä¸€æ ·æ­¥éª¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªå›¾å±‚å¹¶åœ¨<code>URP</code>æ–‡ä»¶ä¸­çš„<code>Layer Mask</code>ä¸‹æ‹‰åˆ—è¡¨ï¼ˆå¯ä»¥å¤šé€‰ï¼‰å‹¾é€‰æˆ‘ä»¬çš„æ–°å›¾å±‚å°±è¡Œäº†</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/eb0776b3a1324e76919f62b6201061ca.png" alt="10.png" style="zoom:80%;" /><img src="https://p5.toutiaoimg.com/origin/pgc-image/c1efe22bdbce4eeb839e358479ad7702.png" alt="11.png" style="zoom:80%;" /><p>â€‹    å›¾å±‚åŠ äº†ä¹‹åä¹Ÿåˆ«å¿˜äº†ä¹Ÿè¦æ–°å»ºä¸€ä¸ª<code>Enemy</code>çš„æ ‡ç­¾</p><h2 id="ç¼–å†™æ•Œäººçš„çŠ¶æ€"><a href="#ç¼–å†™æ•Œäººçš„çŠ¶æ€" class="headerlink" title="ç¼–å†™æ•Œäººçš„çŠ¶æ€"></a>ç¼–å†™æ•Œäººçš„çŠ¶æ€</h2><p>â€‹    é¦–å…ˆæˆ‘ä»¬è¦æ€è€ƒä¸€ä¸‹æ•Œäººä¼šæœ‰å¤šå°‘ç§çŠ¶æ€å‘¢ï¼Ÿè¿™é‡Œæˆ‘å¯ä»¥å…ˆæƒ³åˆ°æœ‰ï¼šè­¦æˆ’ã€å·¡é€»ã€è¿½å‡»ä¸»è§’ã€æ­»äº¡ è¿™å››ç§çŠ¶æ€ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ®ä½ æ‰€å–œå¥½çš„çŠ¶æ€å»è®¾è®¡</p><p>â€‹    æˆ‘ä»¬åœ¨<code>EnemyController.cs</code>ä»£ç æ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢è¿™ä¸€è¡Œæšä¸¾ä»£ç ï¼Œ<u>æ³¨æ„æ˜¯æ‰“åœ¨ç±»çš„å¤–è¾¹ä½œä¸ºå…¨å±€å½¢å¼</u></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">EnemyStates</span><span class="token punctuation">&#123;</span>GUARD<span class="token punctuation">,</span>PATROL<span class="token punctuation">,</span>CHASE<span class="token punctuation">,</span>DEAD<span class="token punctuation">&#125;</span><span class="token comment">//æ•Œäººçš„å››ç§çŠ¶æ€ï¼Œè­¦æˆ’ã€å·¡é€»ã€è¿½å‡»ã€æ­»äº¡</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â€‹    ç„¶åæˆ‘ä»¬å†åœ¨ç±»ä¸­å£°æ˜å˜é‡</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token class-name">EnemyStates</span> enemyStates<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â€‹    è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿”å›Unityä¸­å°±å¯ä»¥åœ¨æ•Œäººå¯¹è±¡ä¸­ä»£ç ç»„ä»¶éƒ¨åˆ†çœ‹åˆ°å¤šäº†ä¸ª<code>Enemy States</code>çš„ä¸‹æ‹‰èœå•äº†</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/09d6536220f44ff2919ed22b29442031.png" alt="9.png" style="zoom:80%;" /><p>â€‹    è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¾ƒä¸ºç®€å•çš„çŠ¶æ€åˆ‡æ¢æ–¹å¼â€”Switchåˆ‡æ¢ï¼Œå½“ç„¶è¿˜å¯ä»¥é€‰æ‹©å¤æ‚ç‚¹çš„çŠ¶æ€æœºåˆ‡æ¢æ–¹å¼ï¼Œè¿™é‡Œæš‚æ—¶ä¸ä½¿ç”¨å…ˆï¼Œæ‰“å¼€æˆ‘ä»¬çš„<code>EnemyController.cs</code>ä»£ç æ–‡ä»¶ï¼Œå†™ä¸€ä¸ªåŸºæœ¬çš„Switchåˆ¤æ–­æ¡†æ¶</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ä»¥ä¸Šçš„æ¡†æ¶ç¼–å†™å¥½åæˆ‘ä»¬å…ˆæ”¾ä¸€è¾¹åˆ°æ—¶å€™å†æ¥è¡¥å……</p><h1 id="æ·»åŠ äººç‰©ç§»åŠ¨åˆ°æ•Œäººçš„æ–¹æ³•"><a href="#æ·»åŠ äººç‰©ç§»åŠ¨åˆ°æ•Œäººçš„æ–¹æ³•" class="headerlink" title="æ·»åŠ äººç‰©ç§»åŠ¨åˆ°æ•Œäººçš„æ–¹æ³•"></a>æ·»åŠ äººç‰©ç§»åŠ¨åˆ°æ•Œäººçš„æ–¹æ³•</h1><h2 id="æ·»åŠ äº‹ä»¶"><a href="#æ·»åŠ äº‹ä»¶" class="headerlink" title="æ·»åŠ äº‹ä»¶"></a>æ·»åŠ äº‹ä»¶</h2><p>â€‹    æ¥ä¸‹æ¥åˆè¦å›åˆ°æˆ‘ä»¬çš„<code>MouseManager.cs</code>ä»£ç æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬è¦æ·»åŠ ä¸€ä¸ªæ–°çš„äº‹ä»¶ï¼Œæ¥ä»£è¡¨å½“æˆ‘ä»¬é¼ æ ‡ç‚¹å‡»æ•Œäººæ—¶çš„äº‹ä»¶</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">event</span> <span class="token class-name">Action<span class="token punctuation">&lt;</span>GameObject<span class="token punctuation">></span></span> OnEnemyClicked<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>â€‹    è¿™æ ·æˆ‘ä»¬äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ä¼ é€’çš„å°±æ˜¯<code>GameObject</code>ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é¼ æ ‡ç‚¹å‡»çš„æ•Œäººäº†ï¼Œè¿™æ ·åšæˆ‘ä»¬å°±å¯ä»¥è·å¾—æ›´å¤šçš„æ•Œäººç›¸å…³ä¿¡æ¯ï¼Œæ¯”å¦‚åæ ‡ã€åå­—ç­‰</p><p>â€‹    ç„¶åæˆ‘ä»¬å†æŠŠå½“å‰ä»£ç æ–‡ä»¶ä¸‹çš„<code>MouseControl</code>å‡½æ•°ä¿®æ”¹ä¸€ä¸‹ï¼Œæ·»åŠ ä¸€äº›ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> hitInfo<span class="token punctuation">.</span>collider <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Ground"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è¿™é‡Œä¼ é€’çš„æ˜¯å°„çº¿ç¢°æ’åˆ°çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æ•Œäººäº†</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    æ¥ä¸‹æ¥è½¬åˆ°<code>PlayerController.cs</code>ä»£ç æ–‡ä»¶æ¥é…ç½®ä¸€ä¸‹è§’è‰²ç‚¹å‡»åˆ°æ•Œäººçš„ååº”</p><p>â€‹    æˆ‘ä»¬åœ¨ä»£ç æ–‡ä»¶çš„ç±»ä¸‹æ·»åŠ ä¸‹é¢çš„ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">GameObject</span> attactTarget<span class="token punctuation">;</span><span class="token comment">//ä¸ºäº†ç¼–å†™ç‚¹å‡»æ•Œäººå‡½æ•°æ–¹ä¾¿è€Œå£°æ˜çš„å˜é‡</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> lastAttactTime<span class="token punctuation">;</span><span class="token comment">//ä¸€ä¸ªå…³äºä¸Šä¸€æ¬¡æ”»å‡»æ—¶é—´çš„å˜é‡ï¼Œç®€å•çš„è®¡æ—¶å™¨ï¼Œä¸€æ—¦è¶…è¿‡æ‰€ç»™çš„CDæ—¶é—´å°±å¯ä»¥å†æ”»å‡»ä¸€æ¬¡</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnMouseClicked<span class="token operator">+=</span>MoveToTarget<span class="token punctuation">;</span><span class="token comment">//æ™®é€šç§»åŠ¨</span>        MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnEnemyClicked<span class="token operator">+=</span>EventAttact<span class="token punctuation">;</span><span class="token comment">//æˆ‘ä»¬ç‚¹å‡»äº†æ”»å‡»ç›®æ ‡ï¼Œå³æ•Œäºº</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EventAttact</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> obj<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿™é‡Œå°±å¯ä»¥å¡«å†™ç‚¹å‡»æ•Œäººåéœ€è¦çš„æ“ä½œäº†</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    </p><h2 id="åˆ©ç”¨åç¨‹çš„æ–¹å¼æ¥å†™äººç‰©ç§»å‘æ•Œäºº"><a href="#åˆ©ç”¨åç¨‹çš„æ–¹å¼æ¥å†™äººç‰©ç§»å‘æ•Œäºº" class="headerlink" title="åˆ©ç”¨åç¨‹çš„æ–¹å¼æ¥å†™äººç‰©ç§»å‘æ•Œäºº"></a>åˆ©ç”¨åç¨‹çš„æ–¹å¼æ¥å†™äººç‰©ç§»å‘æ•Œäºº</h2><p>â€‹    é‚£ä¹ˆæˆ‘ä»¬å°±è¦æ¥æ€è€ƒ<code>EventAttact</code>åœ¨å‡½æ•°é‡Œè¦å®ç°ä»€ä¹ˆäº†</p><p>â€‹    é¦–å…ˆæˆ‘ä»¬æ¥å®ç°å°äººè·‘åˆ°æ•Œäººçš„é¢å‰ï¼Œè¿™é‡Œå°±è¦åˆ¤æ–­å°äººæ˜¯å¦åˆ°äº†å¯ä»¥æ”»å‡»æ•Œäººçš„å°„ç¨‹ï¼Œå¦‚æœæ²¡æœ‰åˆ°çš„è¯å°±è¦ç»§ç»­ç§»åŠ¨ï¼Œè€Œè¿™å°±è¦ç”¨åˆ°<code>åç¨‹</code>çš„æ–¹å¼æ¥å®ç°ï¼Œå…·ä½“å…³äºä»€ä¹ˆæ˜¯åç¨‹å¤§å®¶å¯ä»¥è‡ªè¡Œæœå¯»èµ„æ–™</p><p>â€‹    æˆ‘ä»¬åœ¨ä¸Šé¢ä»£ç çš„åŸºç¡€ä¸‹ï¼Œå†å†™ä¸€ä¸ªå…³äºåç¨‹çš„å‡½æ•°</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è¿™é‡Œç”¨åˆ°çš„IEnumeratorå°±æ˜¯ä¸€ä¸ªåç¨‹</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    åŒæ—¶å› ä¸ºæˆ‘ä»¬å³å°†è¦ç”¨åˆ°ä¸Šé¢å£°æ˜è¿‡çš„<code>attactTargetï¼ˆGameObjectç±»å‹ï¼‰</code>æˆ‘ä»¬è¿˜è¦å¯¹åŸå…ˆçš„å‡½æ•°è¿›è¡Œä¸€äº›ä¿®æ”¹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EventAttact</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœé¼ æ ‡ç‚¹å‡»çš„ç›®æ ‡ä¸ä¸ºç©ºï¼Œæˆ–è€…ç‚¹å‡»çš„æ•Œäººä¸æ˜¯å±äºæ­»äº¡çŠ¶æ€</span>        attact <span class="token operator">=</span> target<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥æ­£å¼æ¥ç¼–å†™<code>MoveToAttackTarget</code>å‡½æ•°äº†</p><p>â€‹    å› ä¸ºè¦å®ç°å°äººè·‘åˆ°æ•Œäººé¢å‰ï¼Œé‚£ä¹ˆå°±å…ˆè¦å®ç°å°äººä¼šè½¬å‘æˆ‘ä»¬çš„ç›®æ ‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸‹é¢è¿™è¡Œä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å› ä¸ºè¿™ä¸ªä»£ç æ–‡ä»¶æ˜¯ä½œä¸ºç»„ä»¶å®‰åœ¨å°äººå¯¹è±¡ä¸Šçš„ï¼Œå› æ­¤å‰é¢this.transformè·å–çš„æ˜¯å°äººçš„transform</span>    <span class="token comment">//transformè‡ªå¸¦çš„LookAt()å‡½æ•°å°±å¯ä»¥å®ç°å°äººçš„è½¬å‘</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    æ¥ç€ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªå¾ªç¯ï¼Œå½“å°äººä¸æ•Œäººçš„è·ç¦»å¤§äºæ‰€ç»™å®šçš„<code>æ”»å‡»è·ç¦»</code>ï¼ˆè¿™é‡Œæš‚æ—¶å®šä¸º1ï¼Œåˆ°æ—¶å€™å¯ä»¥æ›´æ”¹ï¼Œç”šè‡³å¯ä»¥æ ¹æ®æ­¦å™¨ç§ç±»ä¸åŒè€Œç»™å®šä¸åŒçš„å€¼ï¼‰æ—¶ï¼Œå°äººå°±ä¸æ–­åœ°å‘æ•Œäººé è¿‘ï¼ˆä¹‹æ‰€ä»¥è¦ä¸æ–­å¾ªç¯åˆ¤æ–­ï¼Œæ˜¯å› ä¸ºæ•Œäººå¯èƒ½å¤„åœ¨å·¡é€»çš„çŠ¶æ€ï¼Œæ¯ä¸€å¸§çš„ä½ç½®éƒ½ä¸ä¸€æ ·ï¼Œå› æ­¤è¦ä¸æ–­æ›´æ–°ç›®çš„åœ°ï¼‰</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//å–æ¶ˆäººç‰©çš„åœæ­¢çŠ¶æ€</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ¯”è¾ƒäººç‰©å’Œæ•Œäººçš„è·ç¦»æ˜¯å¦å¤§äº0æ”»å‡»è·ç¦»ï¼ŒDistance()å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªVector3è·ç¦»</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//å°äººçš„ç›®çš„åœ°æ˜¯æ•Œäºº</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//ä¸‹ä¸€å¸§å†æ‰§è¡Œå¾ªç¯åˆ¤æ–­</span>    <span class="token punctuation">&#125;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//äººç‰©åˆ°è¾¾æ•Œäººé¢å‰åœä¸‹æ¥</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™ä¸ªæ–¹æ³•åœ¨whileå¾ªç¯å‰åéƒ½ç”¨åˆ°äº†<code>agent.isStopped</code>ï¼Œå½“å®ƒä¸º<code>true</code>èƒ½å¤Ÿè®©äººç‰©åœæ­¢ï¼Œè€Œ<code>false</code>æ—¶ä»£è¡¨æ²¡åœæ­¢</p><p>â€‹    æ‰“å®Œä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬è¿˜è¦å›åˆ°<code>EventAttact</code>æ·»åŠ ä¸€å¥ä»£ç ä»è€Œè°ƒç”¨åç¨‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EventAttact</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœé¼ æ ‡ç‚¹å‡»çš„ç›®æ ‡ä¸ä¸ºç©ºï¼Œæˆ–è€…ç‚¹å‡»çš„æ•Œäººä¸æ˜¯å±äºæ­»äº¡çŠ¶æ€</span>        attactTarget <span class="token operator">=</span> target<span class="token punctuation">;</span>        <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆæ­¥å®ç°å°äººå‘æ•Œäººç§»åŠ¨ï¼Œå¹¶åœ¨ç§»åŠ¨çš„æ—¶å€™ä¸åœåœ°æ¥åˆ¤æ–­æ˜¯å¦åˆ°è¾¾æ”»å‡»è·ç¦»äº†</p><h2 id="æœ€åçš„ä¿®æ”¹"><a href="#æœ€åçš„ä¿®æ”¹" class="headerlink" title="æœ€åçš„ä¿®æ”¹"></a>æœ€åçš„ä¿®æ”¹</h2><p>â€‹    ä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªBugï¼Œå°±æ˜¯åœ¨å¾€æ•Œäººæ–¹å‘ç§»åŠ¨çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬æ˜¯æ— æ³•å–æ¶ˆç§»åŠ¨æˆ–ç§»å‘æ–°çš„ç›®æ ‡åœ°ç‚¹çš„ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨åç¨‹ä»£ç çš„å¾ªç¯å¹¶æ²¡æœ‰åˆ¤æ–­åˆ°åœæ­¢æŒ‡ä»¤ï¼Œå› æ­¤æˆ‘ä»¬æ¥å®Œå–„ä¸€ä¸‹</p><p>â€‹    æˆ‘ä»¬å¯ä»¥åœ¨ç§»åŠ¨æ–¹æ³•<code>MoveToTarget</code>ä¸­æ·»åŠ ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveToTarget</span><span class="token punctuation">(</span><span class="token class-name">Vector3</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è§£å†³æ”»å‡»å®Œåæ— æ³•ç§»åŠ¨</span>        <span class="token function">StopAllCoroutines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœæ­¢æ‰€æœ‰çš„åç¨‹</span>        agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> target<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™ä¸ª<code>StopAllCoroutines()</code>æ–¹æ³•å¯ä»¥å°†æ‰€æœ‰è¿›è¡Œä¸­çš„åç¨‹åœæ­¢ï¼Œå°±å¯ä»¥å®ç°å½“æˆ‘ä»¬åœ¨ç§»å‘æ•Œäººçš„è¿‡ç¨‹ä¸­ï¼Œç‚¹å‡»äº†å…¶å®ƒä½ç½®å°±èƒ½ä¸­æ–­ç§»å‘æ•Œäººå¹¶ç§»åŠ¨åˆ°æ–°çš„ç›®çš„åœ°äº†</p><p>â€‹    åŒæ—¶ä¸Šé¢è¿˜æœ‰ä¸€è¡Œ<code>agent.isStopped = false</code>ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢æˆ‘ä»¬æ”»å‡»å®Œæ•Œäººåå¤„äºäººç‰©åœæ­¢çŠ¶æ€è€Œå¯¼è‡´æ— æ³•ç§»åŠ¨</p><h1 id="æ·»åŠ ä¸€ä¸‹æ”»å‡»åŠ¨ç”»å’Œæ”»å‡»å†·å´æ—¶é—´"><a href="#æ·»åŠ ä¸€ä¸‹æ”»å‡»åŠ¨ç”»å’Œæ”»å‡»å†·å´æ—¶é—´" class="headerlink" title="æ·»åŠ ä¸€ä¸‹æ”»å‡»åŠ¨ç”»å’Œæ”»å‡»å†·å´æ—¶é—´"></a>æ·»åŠ ä¸€ä¸‹æ”»å‡»åŠ¨ç”»å’Œæ”»å‡»å†·å´æ—¶é—´</h1><h2 id="æ·»åŠ æ”»å‡»æ•Œäººçš„åŠ¨ç”»"><a href="#æ·»åŠ æ”»å‡»æ•Œäººçš„åŠ¨ç”»" class="headerlink" title="æ·»åŠ æ”»å‡»æ•Œäººçš„åŠ¨ç”»"></a>æ·»åŠ æ”»å‡»æ•Œäººçš„åŠ¨ç”»</h2><p>â€‹    æˆ‘ä»¬æ¥æ·»åŠ ä¸€ä¸‹äººç‰©æ”»å‡»æ•Œäººçš„åŠ¨ç”»å§ï¼Œæ‰“å¼€æˆ‘ä»¬äººç‰©<code>Player</code>çš„åŠ¨ç”»<code>Animation</code>ä¿®æ”¹åŠ¨ç”»</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/895243b835bf4d71a0f6c9eb1e871794.png" alt="12.png" style="zoom:80%;" /><p>â€‹    å…ˆæ–°å»ºä¸€ä¸ª<code>Trigger</code>ç±»å‹çš„å˜é‡ï¼Œå‘½åä¸º<code>Attack</code></p><img src="https://p9.toutiaoimg.com/origin/pgc-image/c3199d9921284b15b414308b04f3e837.png" alt="13.png" style="zoom:80%;" /><p>â€‹    ç„¶åæˆ‘ä»¬ä»äººç‰©ç´ æåŒ…ä¸­æ‰¾åˆ°æ”»å‡»åŠ¨ç”»ï¼Œå†æŠŠè¯¥åŠ¨ç”»æ‹–å‡ºæ¥ï¼ˆè¿™é‡Œæˆ‘ç”¨çš„æ˜¯<code>Attack01</code>ï¼‰</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/171d1f9a693d4ce090172252c58f7825.png" alt="14.png" style="zoom:80%;" /><p>â€‹    æ‹–å‡ºæ¥åæˆ‘ä»¬å°†å…¶é‡å‘½åèŠ‚ç‚¹ä¸º<code>Attack Base</code>ï¼Œç„¶åä¸æ™®é€šåŠ¨ä½œèŠ‚ç‚¹å»ºç«‹æ¥å›ä¸¤æ¡åˆ‡æ¢çš„çº¿è·¯</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/4251a0aadfe145dd8e29234f9c0cb7f4.png" alt="15.png" style="zoom:80%;" /><p>â€‹    ç´§æ¥ç€ï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸‹æ™®é€šåŠ¨ç”»åˆ‡æ¢åˆ°æ”»å‡»åŠ¨ç”»çš„è®¾ç½®ï¼Œç”±äºæˆ‘ä»¬æ˜¯å½“<code>Attack</code>å˜é‡è§¦å‘å°±ä¼šè¿›å…¥æ”»å‡»åŠ¨ç”»çš„ï¼Œå› æ­¤ä¸éœ€è¦é€€å‡ºæ—¶é—´</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/d09bbe1e30774774a22d75da1fa8c35d.png" alt="16.png" style="zoom:80%;" /><p>â€‹    åŒæ—¶è¿˜è¦æ³¨æ„åˆ‡æ¢æ¡ä»¶æ˜¯å˜é‡<code>Attack</code>ç»™è§¦å‘å°±è¿›è¡Œåˆ‡æ¢</p><img src="https://p9.toutiaoimg.com/origin/pgc-image/9e975d5f4a0140aaa81400ea62bfd6c6.png" alt="16.5.png" style="zoom:80%;" /><p>â€‹    ç„¶åæ˜¯æ”»å‡»åŠ¨ç”»åˆ‡æ¢å›æ™®é€šåŠ¨ç”»çš„è®¾ç½®ï¼Œè¿™é‡Œæˆ‘ä»¬æƒ³æ”»å‡»åŠ¨ç”»æ’­æ”¾å®Œå†åˆ‡æ¢å›å»ï¼Œå› æ­¤é€€å‡ºåŠ¨ç”»å¯ä»¥è®¾ç½®ä¸º1ï¼ŒåŒæ—¶è¿‡æ¸¡åŠ¨ç”»å¯ä»¥æŒ‰è‡ªå·±å–œå¥½è‡ªè¡Œè®¾ç½®</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/d09bbe1e30774774a22d75da1fa8c35d.png" alt="16.png" style="zoom:80%;" /><p>â€‹    åŠ¨ç”»å»ºç«‹å¥½åï¼Œæˆ‘ä»¬çš„åŠ¨ç”»è§¦å‘è·Ÿç€å†·å´æ—¶é—´ä¸€èµ·è®¾ç½®</p><h2 id="æ·»åŠ æ”»å‡»å†·å´æ—¶é—´"><a href="#æ·»åŠ æ”»å‡»å†·å´æ—¶é—´" class="headerlink" title="æ·»åŠ æ”»å‡»å†·å´æ—¶é—´"></a>æ·»åŠ æ”»å‡»å†·å´æ—¶é—´</h2><p>â€‹    è¿˜è®°å¾—å‰é¢å£°æ˜çš„<code>lastAttactTime</code>å˜é‡å—ï¼Ÿè¿™é‡Œå°±æ˜¯ç”¨åˆ°å®ƒçš„æ—¶å€™ï¼Œå»¶ç»­ç€ä¸Šè¾¹åç¨‹å‡½æ•°ï¼Œæˆ‘ä»¬çš„å†·å´æ—¶é—´ä»£ç å’ŒåŠ¨ç”»è§¦å‘ä»£ç éƒ½åœ¨è¿™é‡Œç¼–å†™</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//å½“äººç‰©åˆ°è¾¾å¯ä»¥æ”»å‡»æ•Œäººçš„è·ç¦»å</span><span class="token keyword">if</span><span class="token punctuation">(</span>lastAttactTime<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    animator<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Attack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘æ”»å‡»åŠ¨ç”»</span>    lastAttactTime <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token punctuation">;</span><span class="token comment">//é‡ç½®å†·å´æ—¶é—´</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    æŠŠè¿™ä¸€æ®µä»£ç æ”¾åœ¨åŸæ¥çš„åç¨‹å‡½æ•°å°±å˜æˆ</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ¯”è¾ƒäººç‰©å’Œæ•Œäººçš„è·ç¦»æ˜¯å¦å¤§äº0æ”»å‡»è·ç¦»ï¼ŒDistance()å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªVector3è·ç¦»</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token comment">//æ”»å‡»åŠ¨ç”»å’ŒCDéƒ½åœ¨ä¸‹é¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>lastAttactTime<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        animator<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Attack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘æ”»å‡»åŠ¨ç”»</span>        lastAttactTime <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token punctuation">;</span><span class="token comment">//é‡ç½®å†·å´æ—¶é—´</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    æˆ‘ä»¬è¿™é‡Œå†™åˆ°äº†é‡ç½®å†·å´æ—¶é—´ï¼Œä½†è¿™ä¸ªæ—¶é—´è‚¯å®šè¦æœ‰ä¸€ä¸ªé€’å‡çš„è¿‡ç¨‹çš„ï¼Œé‚£æˆ‘ä»¬å°±è¦æ‰¾ä¸ªåœ°æ–¹æ¥è®©å®ƒé€’å‡ï¼Œè¿™é‡Œ<code>Update</code>æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">SwitchPlyerAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    lastAttactTime <span class="token operator">-=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span><span class="token comment">//é€’å‡å»æ¯ä¸€å¸§ä¹‹é—´çš„æ—¶é—´</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·ï¼Œä¸€ä¸ªå†·å´æ—¶é—´çš„æ•ˆæœè¿˜æœ‰æ”»å‡»åŠ¨ç”»å°±å®Œæˆå•¦ï¼</p><p>â€‹    </p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°5--å‰”é™¤äººç‰©çš„é®æŒ¡</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B05-%E5%89%94%E9%99%A4%E4%BA%BA%E7%89%A9%E7%9A%84%E9%81%AE%E6%8C%A1/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B05-%E5%89%94%E9%99%A4%E4%BA%BA%E7%89%A9%E7%9A%84%E9%81%AE%E6%8C%A1/</url>
      
        <content type="html"><![CDATA[<p>â€‹    æˆ‘ä»¬å‘ç°åœ¨ç§»åŠ¨åˆ°ä¸€äº›ç‰©ä½“ï¼ˆæ¯”å¦‚è¯´æ ‘ï¼‰åé¢çš„æ—¶å€™ï¼Œäººç‰©å°±ä¼šç»™é®æŒ¡ä½äº†ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥å‰”é™¤æ‰è¿™ä¸ªé®æŒ¡å‘¢ï¼Ÿå¯ä»¥å‚è€ƒä¸€äº›æ¸¸æˆï¼Œå¤§éƒ¨åˆ†æ¸¸æˆåœ¨ç§»åŠ¨åˆ°é®æŒ¡ç‰©åé¢æ—¶ä¼šæŠŠäººç‰©çš„è½®å»“æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿™ä¸ªç« èŠ‚æˆ‘ä»¬å°±æ¥å®ç°è¿™ç§æ•ˆæœã€‚</p><h1 id="åˆ©ç”¨-Shader-Graphï¼ˆç€è‰²å™¨å¯è§†åŒ–ç¼–è¾‘å™¨ï¼‰å‰”é™¤é®æŒ¡"><a href="#åˆ©ç”¨-Shader-Graphï¼ˆç€è‰²å™¨å¯è§†åŒ–ç¼–è¾‘å™¨ï¼‰å‰”é™¤é®æŒ¡" class="headerlink" title="åˆ©ç”¨ Shader Graphï¼ˆç€è‰²å™¨å¯è§†åŒ–ç¼–è¾‘å™¨ï¼‰å‰”é™¤é®æŒ¡"></a>åˆ©ç”¨ Shader Graphï¼ˆç€è‰²å™¨å¯è§†åŒ–ç¼–è¾‘å™¨ï¼‰å‰”é™¤é®æŒ¡</h1><h2 id="åˆ›å»ºä¸€ä¸ªShader"><a href="#åˆ›å»ºä¸€ä¸ªShader" class="headerlink" title="åˆ›å»ºä¸€ä¸ªShader"></a>åˆ›å»ºä¸€ä¸ªShader</h2><p>â€‹    é¦–å…ˆä¸ºäº†ä»¥åçš„æ“ä½œæ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨ Materials æ–‡ä»¶å¤¹ä¸‹å†æ–°å»ºä¸€ä¸ª <strong>Shader Graph æ–‡ä»¶å¤¹</strong>ï¼Œæˆ‘ä»¬å°±åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª Shader Graph ï¼ˆCreate â€”&gt; Shader â€”&gt; Universal Render Pipeline â€”&gt; Unlit Shader Graphï¼‰å¹¶å°†å®ƒå‘½åä¸º <strong>Occlusion Shader</strong> ï¼ˆé®æŒ¡ç€è‰²å™¨ï¼‰ã€‚</p><p>â€‹    åŒæ—¶é€‰ä¸­è¯¥ Shader å³é”®æ–°å»ºä¸€ä¸ª Material æè´¨ï¼Œå‘½åä¸º <strong>Occlusion</strong> ï¼Œå°†å®ƒæ‹–åˆ°ä¸Šçº§ç›®å½• Materials ï¼Œå®Œæˆåå¦‚ä¸‹å›¾æ‰€ç¤º</p><img src="https://p9.toutiaoimg.com/origin/pgc-image/bda871c8cfc34794a0f19650681d08c2.jpg" alt="1.jpg" style="zoom:80%;" /><img src="https://p6.toutiaoimg.com/origin/pgc-image/7e8acbcfdcb349588d889a38ea6b699d.jpg" alt="2.jpg" style="zoom:67%;" /><p>â€‹    </p><p>â€‹    åšå¥½è¿™äº›åˆ†ç±»å·¥ä½œåï¼Œæˆ‘ä»¬åŒå‡»æ‰“å¼€ Occlusion Shader æ‰“å¼€ç€è‰²å™¨ç¼–è¾‘å™¨çª—å£ï¼Œçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåœ¨å³ä¸Šè§’çš„ Graph Settings é€‰é¡¹å¡ä¸­<strong>å‹¾é€‰ Alpha Clip</strong> æ‰“å¼€é€æ˜é€šé“ï¼Œå‹¾é€‰äº†è¿™ä¸ªä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨ Fragment èŠ‚ç‚¹ä¸­ä¿®æ”¹é€æ˜å€¼äº†</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/6d0dd303bf884583b5bf7803d0f5998a.jpg" alt="3.jpg" style="zoom:80%;" /><p>â€‹    ç„¶åæˆ‘ä»¬åœ¨ç©ºç™½çš„åœ°æ–¹å³é”®æ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœç´¢æ·»åŠ   <strong>Fresnel Effect</strong> ï¼ˆè²æ¶…å°”æ•ˆåº”ï¼‰ï¼Œæˆ‘ä»¬åˆ°æ—¶å€™å¯ä»¥å°†äººç‰©åº”ç”¨è¿™ä¸ª Shader æ¥å®ç°é€æ˜åŒ–çš„æ•ˆæœ</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/ef52362a31bb45228a82e169ee052644.jpg" alt="4.jpg" style="zoom:80%;" /><p>â€‹    ä½†æ˜¯æˆ‘ä»¬çœ‹è¿™ä¸ªå…‰åœˆæœ‰ç‚¹å•è°ƒï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®ƒæ¥ä¸Šç‚¹é¢œè‰²</p><h2 id="æ·»åŠ é¢œè‰²"><a href="#æ·»åŠ é¢œè‰²" class="headerlink" title="æ·»åŠ é¢œè‰²"></a>æ·»åŠ é¢œè‰²</h2><p>â€‹    è¦æ·»åŠ é¢œè‰²ï¼Œé¦–å…ˆå°±è¦åœ¨å·¦ä¸Šè§’æ–°å»ºä¸€ä¸ª <strong>Colorç±»å‹</strong> çš„å‚æ•°ï¼ˆè¿™äº›æ–°å»ºå‡ºæ¥çš„å‚æ•°ä¹‹åéƒ½å¯ä»¥ç›´æ¥æè´¨å¯¹è±¡çš„å±æ€§ç•Œé¢æ¿ä¿®æ”¹å®ƒä»¬ï¼‰ï¼Œç„¶åç»™è¿™ä¸ªå‚æ•°è®¾ç½®ä¸€ä¸ªé»˜è®¤é¢œè‰²å€¼</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/afff800563c946299acfd483a3bb2f67.jpg" alt="5.jpg" style="zoom:80%;" /><p>â€‹    æœ‰äº†é¢œè‰²å€¼ï¼Œæˆ‘ä»¬æƒ³åº”ç”¨åˆ°ä¸Šé¢çš„ Fresnel Effect èŠ‚ç‚¹çš„è¯ï¼Œæœ‰ä¸ªæ–¹æ³•å°±æ˜¯å°†å®ƒä»¬ç›¸ä¹˜ï¼Œè¿™æ ·é¢œè‰²å°±å¯ä»¥ä¸ä¹‹æ··åˆï¼šæ‹–æ‹½ Fresnel Effect èŠ‚ç‚¹çª—å£çš„ Out ç„¶åç‚¹å‡»ç©ºç™½å¤„ï¼Œåœ¨å¼¹å‡ºçš„æœç´¢æ¡†ä¸­æœç´¢ Multiplyï¼ˆä¹˜ï¼‰ï¼Œè¿™æ—¶å€™å°±å¤šäº†ä¸€ä¸ªèŠ‚ç‚¹çª—å£ï¼ŒAå€¼ç”±åŸæ¥çš„ Fresnel Effect èŠ‚ç‚¹è¾“å…¥è¿›æ¥ï¼Œè€Œå‰©ä¸‹ä¸€ä¸ªBå€¼å°±æ˜¯ç•™ç»™æˆ‘ä»¬é¢œè‰²çš„</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/ca8248f9b6e046ae959697d41e8da5d8.jpg" alt="6.jpg" style="zoom:80%;" /><p>â€‹    æ­¤æ—¶æˆ‘ä»¬å†å°†å·¦ä¸Šè§’çš„ Color æ‹–æ‹½å‡ºæ¥ï¼Œå¹¶ä¼ ç»™Bå€¼ï¼Œè¿™æ ·é¢œè‰²å°±æ··åˆè¿›å»Fresnel Effect èŠ‚ç‚¹äº†</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/278510f8f57e4f57a093c66168a16cd7.jpg" alt="7.jpg" style="zoom:80%;" /><p>â€‹    å°† Multiply èŠ‚ç‚¹è¾“å‡º Out å€¼æ‹–å…¥åˆ° Fragment èŠ‚ç‚¹çš„ Base Color é¡¹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å³ä¸‹è§’çš„é¢„è§ˆçª—å£å°±æ˜¯æˆ‘ä»¬æè´¨çš„æœ€ç»ˆæ•ˆæœäº†</p><img src="https://p9.toutiaoimg.com/origin/pgc-image/7dc333ce40314957b7ed649b5b9fa013.jpg" alt="8.jpg" style="zoom:80%;" /><p>â€‹    å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥æ›´å®Œå–„ä¸€ä¸‹ï¼Œæ·»åŠ ä¸€äº›é¢å¤–çš„ä¸œè¥¿</p><h2 id="æ·»åŠ å™ªç‚¹"><a href="#æ·»åŠ å™ªç‚¹" class="headerlink" title="æ·»åŠ å™ªç‚¹"></a>æ·»åŠ å™ªç‚¹</h2><p>â€‹    æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€äº›å™ªç‚¹å¡«å……æˆ‘ä»¬çš„æè´¨</p><p>â€‹    å³é”®åˆ›å»ºä¸€ä¸ª <strong>Dither</strong> èŠ‚ç‚¹çª—å£ï¼Œæ”¹å˜Xçš„å€¼å¯ä»¥çœ‹åˆ°å™ªç‚¹æ¸å˜çš„æ•ˆæœ</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/5253d92200c34098b2989374df8573da.jpg" alt="9.jpg" style="zoom:80%;" /><p>â€‹    ç”±äºè¿™ä¸ªXå€¼æ˜¯ä¸€ä¸ª Float ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª<strong>floatç±»å‹å‚æ•°</strong>æ¥ä¾›å¤–ç•Œæ”¹å˜å®ƒï¼Œæˆ‘ä»¬å°±æŠŠè¿™ä¸ªå‚æ•°å‘½åä¸º <strong>DitherCount</strong> ï¼Œé»˜è®¤å€¼å¯ä»¥æš‚æ—¶è®¾ä¸º1</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/3554a59477874c29b9730008f8d6207c.jpg" alt="10.jpg" style="zoom:80%;" /><p>â€‹    æœ€åå°†è¾“å‡º Out å€¼ä¼ ç»™ Fragment èŠ‚ç‚¹ä¸­çš„ Alpha å³å¯</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/52e712db91204e3b869a6f13a4876508.jpg" alt="11.jpg" style="zoom:80%;" /><p>â€‹    </p><h2 id="ä¿å­˜Shaderå¹¶ç”Ÿæˆä¸ºæè´¨"><a href="#ä¿å­˜Shaderå¹¶ç”Ÿæˆä¸ºæè´¨" class="headerlink" title="ä¿å­˜Shaderå¹¶ç”Ÿæˆä¸ºæè´¨"></a>ä¿å­˜Shaderå¹¶ç”Ÿæˆä¸ºæè´¨</h2><p>â€‹    æœ€åçš„æœ€åæˆ‘ä»¬å¯ä»¥å†æ·»åŠ ä¸€ä¸ªæ§åˆ¶ Alpha Clip Threshold ï¼ˆAlphaé˜ˆå€¼ï¼‰çš„å‚æ•°å€¼ï¼Œå½“ç„¶å®ƒä¹Ÿæ˜¯ floatç±»å‹çš„ï¼Œå‘½åä¸º AlphaThreshold</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/891aa0b188d44acc835c192ca99c33de.jpg" alt="12.jpg" style="zoom:80%;" /><p>â€‹    </p><p>â€‹    ç‚¹å‡»ä¿å­˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æœ€å¼€å§‹åˆ›å»ºçš„ Occlusion æè´¨çœ‹åˆ°æ•ˆæœäº†ï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„å±æ€§é¢æ¿ä¸­æœ‰äº†ä¸‰ä¸ªå‚æ•°ï¼Œè¿™ä¸‰ä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬åœ¨ Shader ç¼–è¾‘å™¨ä¸­åˆ›å»ºçš„ä¸‰ä¸ªå˜é‡å€¼</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/a2f1c9f63ad443778b5f1cc23c69996a.jpg" alt="13.jpg" style="zoom:80%;" /><h1 id="å°†æè´¨åº”ç”¨åˆ°äººç‰©ä¸­"><a href="#å°†æè´¨åº”ç”¨åˆ°äººç‰©ä¸­" class="headerlink" title="å°†æè´¨åº”ç”¨åˆ°äººç‰©ä¸­"></a>å°†æè´¨åº”ç”¨åˆ°äººç‰©ä¸­</h1><h2 id="åˆ›å»ºä¸€ä¸ªRender-Objects"><a href="#åˆ›å»ºä¸€ä¸ªRender-Objects" class="headerlink" title="åˆ›å»ºä¸€ä¸ªRender Objects"></a>åˆ›å»ºä¸€ä¸ªRender Objects</h2><p>â€‹    åœ¨ä¸Šé¢åˆ›å»ºå¥½äº†æè´¨åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•æŠŠå®ƒåº”ç”¨åˆ°æˆ‘ä»¬çš„äººç‰©é‡Œäº†ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯å½“äººç‰©ç§»åŠ¨åˆ°æ ‘ç­‰ç‰©ä½“åé¢ç»™é®æŒ¡æ—¶åº”ç”¨è¿™ä¸ªæè´¨ï¼Œè¿™æ ·å°±ç­‰åŒäºæ˜¾ç¤ºäººç‰©çš„è½®å»“äº†ï¼Œé‚£å°±è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><p>â€‹    æˆ‘ä»¬æ‰¾åˆ°æˆ‘ä»¬çš„ Pipeline Setting æ–‡ä»¶å¤¹ï¼Œé€‰ä¸­ <strong>UniversalRenderPipelineAsset_Renderer</strong> ï¼Œåœ¨å³è¾¹çš„å±æ€§é¢æ¿ä¸­ç‚¹å‡» <strong>Add Renderer Feature</strong> æŒ‰é’®ï¼Œæ–°å»ºä¸€ä¸ª <strong>Render Objects</strong></p><p>â€‹    å› ä¸ºæˆ‘ä»¬è¦åŒºåˆ†äººç‰©åœ¨é®æŒ¡ç‰©å‰é¢å’Œåœ¨é®æŒ¡ç‰©åé¢çš„æƒ…å†µï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°†è¿™ä¸ª Render Object å‘½åä¸º <strong>CharcterBehind</strong> ï¼Œè€Œåˆ¤æ–­æ˜¯å¦åœ¨é®æŒ¡ç‰©åé¢çš„æ¡ä»¶å°±æ˜¯æ ¹æ® æ·±åº¦ï¼ˆDepthï¼‰æ¥åˆ¤æ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å‹¾é€‰ <strong>Depth</strong> é€‰é¡¹ï¼Œå¹¶æŒ‰ä¸‹å›¾æ¥è®¾ç½®</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/3a0b69da1498450b9896af76a181e118.jpg" alt="14.jpg" style="zoom:80%;" /><p>â€‹    å›¾ä¸­çš„ Material é€‰é¡¹åˆ™æ˜¯é€‰æ‹©æˆ‘ä»¬å‰é¢åˆ›å»ºçš„æè´¨ Occlusionï¼Œè¿™æ ·å½“äººç‰©åœ¨åˆ¤æ–­æˆåŠŸçš„æ¡ä»¶ä¸‹å°±ä¼šç»™æ¸²æŸ“å‡ºè¿™ä¸ªæè´¨æ•ˆæœäº†</p><h2 id="è®¾ç½®è¿‡æ»¤å›¾å±‚"><a href="#è®¾ç½®è¿‡æ»¤å›¾å±‚" class="headerlink" title="è®¾ç½®è¿‡æ»¤å›¾å±‚"></a>è®¾ç½®è¿‡æ»¤å›¾å±‚</h2><p>â€‹    åšå®Œäº†ä¸Šé¢è¿™äº›è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬è¿˜è¦è€ƒè™‘ <strong>Filtersï¼ˆè¿‡æ»¤ï¼‰</strong>å“ªä¸€äº›ä¸œè¥¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šæ–¹çš„ <strong>Layer Mask</strong> ä¸­é€‰æ‹©æˆ‘ä»¬è¦è¿‡æ»¤çš„å›¾å±‚ï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œé®æŒ¡åªæ¶‰åŠåˆ°äººç‰©ï¼Œå› æ­¤æˆ‘ä»¬åªç”¨è¿‡æ»¤äººç‰©å›¾å±‚å°±è¡Œäº†</p><p>â€‹    ä½†æ˜¯é—®é¢˜åœ¨äº Layer Mask é»˜è®¤è‡ªå¸¦çš„é€‰é¡¹å¹¶æ²¡æœ‰æˆ‘ä»¬çš„äººç‰©å›¾å±‚ï¼Œé‚£æˆ‘ä»¬å°±è‡ªåˆ›ä¸€ä¸ªï¼šæ‰¾åˆ°æˆ‘ä»¬çš„äººç‰©å¯¹è±¡ï¼ˆæˆ‘è¿™é‡Œçš„åå­—æ˜¯Playerï¼‰ï¼Œç„¶åç‚¹å‡»å±æ€§é¢æ¿ä¸­çš„ <strong>Layer â€”&gt; Add Layerâ€¦</strong></p><img src="https://p6.toutiaoimg.com/origin/pgc-image/88e43d5e10e6489eaaf3de4128e87533.jpg" alt="15.jpg" style="zoom:80%;" /><p>â€‹    ç„¶åä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œå¯ä»¥å°†è¿™ä¸ªæ–°å›¾å±‚å‘½åä¸º Player</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/e0c625c03a9d422681ba030f982dbe7f.jpg" alt="16.jpg" style="zoom:80%;" /><p>â€‹    æ–°å»ºå¥½åä¸è¦å¿˜äº†å›åˆ°äººç‰©å±æ€§ä¸­é€‰æ‹©æˆ‘ä»¬çš„æ–°å›¾å±‚ï¼Œè¿™æ—¶å€™å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸‹å›¾ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼Œå°†å­ç‰©ä½“ä¹Ÿä¸€èµ·æ›´æ”¹ä¸ºæ–°å›¾å±‚</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/b156a4461b024c348d80d8b760201cde.jpg" alt="17.jpg" style="zoom:80%;" /><h2 id="æœ€åçš„è°ƒæ•´"><a href="#æœ€åçš„è°ƒæ•´" class="headerlink" title="æœ€åçš„è°ƒæ•´"></a>æœ€åçš„è°ƒæ•´</h2><p>â€‹    è¿™ä¸ªæ—¶å€™æˆ‘ä»¬äººç‰©å·²ç»æœ‰äº†ä¸€äº›å˜åŒ–äº†ï¼ŒæŠŠå®ƒæ”¾åœ¨æ ‘åé¢å¯ä»¥çœ‹åˆ°æ¸²æŸ“å‡ºæ¥çš„æ˜¯è½®å»“äº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›é—®é¢˜éœ€è¦è°ƒæ•´ï¼šå½“æˆ‘ä»¬ä¸æ˜¯åœ¨é®æŒ¡ç‰©åé¢æ—¶ï¼Œäººç‰©çš„ä¸€äº›éƒ¨ä»¶ä¹Ÿä¼šæœ‰é®æŒ¡æ•ˆæœï¼Œæˆ‘ä»¬å°±è¦æ¥è§£å†³å®ƒ</p><img src="https://p9.toutiaoimg.com/origin/pgc-image/0130ed394a4c479b8b5d210748ed8dd8.jpg" alt="18.jpg" style="zoom:80%;" /><p>â€‹    æˆ‘ä»¬åªéœ€è¦å†æ–°å»ºä¸€ä¸ª <strong>Render Objects</strong> ï¼Œå¹¶å‘½åä¸º <strong>CharcterInFront</strong> ä»£è¡¨æ˜¯äººç‰©åœ¨é®æŒ¡ç‰©å‰é¢çš„æ—¶å€™ï¼ˆä¸ä¸Šä¸€ä¸ª Render Object ç›¸åæƒ…å†µï¼‰ï¼Œç„¶ååªéœ€è¦æ”¹å˜ Layer Mask ä¸ºæˆ‘ä»¬æ–°å»ºçš„ Player å›¾å±‚ï¼Œäººç‰©å°±æ¢å¤æ­£å¸¸äº†</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/43099fd6b674481abab6aebe7a902607.jpg" alt="19.jpg" style="zoom:80%;" /><img src="https://p9.toutiaoimg.com/origin/pgc-image/cd173ce71bc44957a77546101663df92.jpg" alt="20.jpg" style="zoom:80%;" /><p>â€‹    å› ä¸ºè¿™æ ·è®¾ç½®å°±ä»£è¡¨ç€äººç‰©åœ¨è¢«å…¶å®ƒç‰©ä½“é®æŒ¡äº†ä¼šåº”ç”¨é€æ˜åŒ–çš„æè´¨ï¼ˆç¬¬ä¸€ä¸ª CharcterBehind Render Objectï¼‰ï¼Œåœ¨æ²¡æœ‰è¢«é®æŒ¡çš„æƒ…å†µä¸‹å°±ä»€ä¹ˆéƒ½ä¸å˜ï¼ˆç¬¬äºŒä¸ª CharcterInFront Render Objectï¼‰</p><p>â€‹    åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å‰”é™¤äººç‰©é®æŒ¡æ•ˆæœå•¦ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°4--è®¾ç½®äººç‰©çš„åŠ¨ç”»</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B04-%E8%AE%BE%E7%BD%AE%E4%BA%BA%E7%89%A9%E7%9A%84%E5%8A%A8%E7%94%BB/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B04-%E8%AE%BE%E7%BD%AE%E4%BA%BA%E7%89%A9%E7%9A%84%E5%8A%A8%E7%94%BB/</url>
      
        <content type="html"><![CDATA[<p>â€‹    åœ¨å‰é¢ä¸¤ä¸ªç« èŠ‚æˆ‘ä»¬æˆåŠŸåœ°è®©æˆ‘ä»¬çš„äººç‰©åœ¨åœ°å›¾ä¸Šèµ°äº†èµ·æ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å°äººçš„åŠ¨ä½œæ˜¯ç´ æä¸‹è½½ä¸‹æ¥æ—¶é»˜è®¤çš„çŠ¶æ€ï¼Œéœ€è¦æˆ‘ä»¬æ¥è¿›è¡Œè°ƒæ•´ï¼Œé‚£ä¹ˆè¿™ä¸€ç« èŠ‚å°±æ¥ä¿®æ”¹ä¸€ä¸‹å°äººçš„åŠ¨ä½œå§ï¼</p><h1 id="æŸ¥çœ‹ç´ æå°äººè‡ªå¸¦çš„åŠ¨ä½œåŠ¨ç”»"><a href="#æŸ¥çœ‹ç´ æå°äººè‡ªå¸¦çš„åŠ¨ä½œåŠ¨ç”»" class="headerlink" title="æŸ¥çœ‹ç´ æå°äººè‡ªå¸¦çš„åŠ¨ä½œåŠ¨ç”»"></a>æŸ¥çœ‹ç´ æå°äººè‡ªå¸¦çš„åŠ¨ä½œåŠ¨ç”»</h1><p>â€‹    æˆ‘ä»¬ä¹‹å‰ä¸‹è½½ä¸‹æ¥çš„äººç‰©æ˜¯æœ‰è‡ªå¸¦çš„åŠ¨ä½œçš„ï¼Œæˆ‘ä»¬å…ˆæ¥æŸ¥çœ‹ä¸€ä¸‹å®ƒä»¬æ˜¯æ€æ ·çš„</p><p>â€‹    æ‰“å¼€å¦‚ä¸‹ç›®å½•ï¼ˆ <strong>Assets Packs â€”&gt; DogKnight â€”&gt; Animations</strong> ï¼‰ï¼Œæ‰¾åˆ°å›¾ç‰‡ä¸­çš„è¿™äº›æ–‡ä»¶ï¼Œè¿™ä¸€äº›æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬å°äººè‡ªå¸¦çš„åŠ¨ä½œäº†ï¼Œè€Œåœ¨å³è¾¹æœ‰ä¸ªå°çª—å£å¯ä»¥é¢„è§ˆæ’­æ”¾åŠ¨ä½œåŠ¨ç”»ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°é¢„è§ˆçª—å£ä¸­çš„äººæ˜¯ç´«è‰²çš„ï¼Œæ€æ ·å¯ä»¥è°ƒæˆæˆ‘ä»¬äººç‰©çš„æ ·ä¾‹å‘¢ï¼Ÿ</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/d855bb2c3cb24ba0b1e5b351658616e1.jpg" alt="1.jpg" style="zoom:80%;" /><p>â€‹        æˆ‘ä»¬åªéœ€è¦ç‚¹ä¸€ä¸‹é¢„è§ˆçª—å£ä¸Šæ–¹ä¸€ä¸ªæŒ‰é’®å°±å¯ä»¥å¯¼å…¥ä¸€ä¸ªäººç‰©æ ·ä¾‹ç”¨åœ¨è¿™ä¸ªåŠ¨ç”»ä¸Šäº†</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/994679f9c4704258b10a25ab51ad1273.jpg" alt="2.jpg" style="zoom:80%;" /><p>â€‹    ç‚¹å‡»ç»¿è‰²å°äººæŒ‰é’®ï¼Œç„¶åé€‰æ‹© **Otherâ€¦**ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æ–°å‡ºæ¥çš„çª—å£ <strong>Select GameObject</strong> ä¸­é€‰æ‹©æˆ‘ä»¬è¦ç”¨çš„æ ·ä¾‹äº†ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ DogPBR ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ¸¸æˆä¸­è¦ç”¨åˆ°çš„å°ç‹—</p><p>â€‹    çŸ¥é“äº†åŠ¨ä½œåŠ¨ç”»åœ¨å“ªé‡Œä»¥åŠæ€ä¹ˆé¢„è§ˆåŠ¨ä½œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹æ¥å®ç°æ›´æ”¹è§’è‰²çš„åŠ¨ä½œäº†</p><h1 id="ä½¿ç”¨åŠ¨ä½œæ§åˆ¶å™¨ä¿®æ”¹äººç‰©åŠ¨ä½œ"><a href="#ä½¿ç”¨åŠ¨ä½œæ§åˆ¶å™¨ä¿®æ”¹äººç‰©åŠ¨ä½œ" class="headerlink" title="ä½¿ç”¨åŠ¨ä½œæ§åˆ¶å™¨ä¿®æ”¹äººç‰©åŠ¨ä½œ"></a>ä½¿ç”¨åŠ¨ä½œæ§åˆ¶å™¨ä¿®æ”¹äººç‰©åŠ¨ä½œ</h1><p>â€‹    é¦–å…ˆæˆ‘ä»¬æ–°å»ºä¸€ä¸ªç›®å½•æ¥ä¸“é—¨å­˜æ”¾ä¸€ä¸ªåŠ¨ä½œæ§åˆ¶å™¨æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼Œå¯ä»¥å‚è€ƒä¸‹å›¾ç›®å½•</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/2d3c92a24b084da1825b3632a043a377.jpg" alt="3.jpg" style="zoom:80%;" /><p>â€‹    <strong>Animators</strong> æ–‡ä»¶å¤¹ä¸­æˆ‘ä»¬å³é”® <strong>Create</strong> ä¸€ä¸ª <strong>Animator Controller</strong> æ–‡ä»¶ï¼Œå¹¶å¯ä»¥å°†å®ƒå‘½åä¸º Player ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯ç”¨æ¥æ§åˆ¶æˆ‘ä»¬äººç‰©åŠ¨ä½œçš„æ§åˆ¶å™¨æ–‡ä»¶</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/805493fbe75d4f3db98752c50dde6af4.jpg" alt="4.jpg" style="zoom:80%;" /><p>â€‹    æ–°å»ºå¥½åŠ¨ä½œæ§åˆ¶å™¨æ–‡ä»¶åï¼Œæˆ‘ä»¬åŒå‡»æ‰“å¼€å®ƒï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹å›¾ä¸€ä¸ªé»˜è®¤çš„ç•Œé¢</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/b9f85f9d22ab4bae8e8d5b7eec6983ec.jpg" alt="5.jpg" style="zoom:80%;" /><p>â€‹    æˆ‘ä»¬åœ¨ä¸­é—´è§†å›¾å³é”®ç„¶åæ–°å»ºä¸€ä¸ª <strong>Blend Tree</strong> ï¼ˆå³æ··åˆæ ‘ï¼Œç”¨æ¥è§£å†³å¤šä¸ªåŠ¨ç”»ä¹‹é—´çš„æ··åˆï¼Œç»å¸¸ç”¨äºç§»åŠ¨åŠ¨ç”»ä¹‹é—´çš„æ··åˆï¼‰ï¼Œæ–°å»ºå¥½åå‘½åä¸ºï¼šLocomotionï¼Œå¹¶åŒå‡»æ‰“å¼€è¿™ä¸ª Blend Tree</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/7922cd39288d461b8746c05bd0e315b2.jpg" alt="6.jpg" style="zoom:80%;" /><p>â€‹    æ‰“å¼€åæˆ‘ä»¬é¦–å…ˆè¦åšçš„äº‹å°±æ˜¯æŠŠå·¦ä¸Šæ–¹ <strong>Parametersï¼ˆå‚æ•°ï¼‰</strong> é€‰é¡¹å¡ä¸­é»˜è®¤çš„ Blend å‚æ•°åˆ é™¤ï¼Œå¹¶è‡ªå·±æ–°å»ºä¸€ä¸ª **Float ç±»å‹ **çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ç”¨æ¥å‚è€ƒè¦å“ªä¸€ä¸ªæ•°å€¼æ¥åˆ‡æ¢æˆ‘ä»¬çš„åŠ¨ä½œï¼Œè¿™é‡Œç†æ‰€åº”å½“æ˜¯çœ‹ç§»åŠ¨æ—¶äººç‰©çš„é€Ÿåº¦æ˜¯å¤šå°‘ä»è€Œæ¥åˆ‡æ¢ä¸åŒçš„åŠ¨ä½œï¼Œå› æ­¤æˆ‘ä»¬è¿™ä¸ª Float ç±»å‹çš„å‚æ•°å°±å‘½åä¸º <strong>â€œ Speed â€</strong>ï¼Œåˆ°æ—¶å€™æˆ‘ä»¬åœ¨ä»£ç ä¸­å°±è¦ç”¨åˆ°è¿™ä¸ªå€¼</p><p>â€‹    äº†è§£å‚æ•°ä¹‹åï¼Œæˆ‘ä»¬å³é”®ä¸­é—´çš„ Blend Tree ï¼Œé€‰æ‹© <strong>Add Motion</strong> æ·»åŠ åŠ¨ä½œï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ä¸‹æ€»å…±è¦å¤šå°‘ä¸ªåŠ¨ä½œï¼šä¸€ä¸ªæ˜¯äººç‰©æ²¡æœ‰ç§»åŠ¨çš„æ—¶å€™æ˜¯ <strong>ç«™ç«‹ä¸åŠ¨</strong>ï¼Œä¸€ä¸ªæ˜¯ç§»åŠ¨é€Ÿåº¦è¾ƒæ…¢ï¼Œå±äº <strong>æ…¢èµ°çŠ¶æ€</strong>ï¼Œè¿˜æœ‰ä¸€ä¸ªé€Ÿåº¦è¾ƒå¿«ï¼Œå˜ä¸ºäº† <strong>å¿«è·‘</strong>ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸‰ä¸ªåŠ¨ä½œã€‚å› æ­¤åœ¨è¿™é‡Œå°±è¦æ·»åŠ ä¸‰æ¬¡ Motion äº†</p><p>â€‹    <img src="https://p6.toutiaoimg.com/origin/pgc-image/f5ad228bf45040e393dd2e88d27c040a.jpg" alt="7.jpg" style="zoom:80%;" /></p><p>â€‹    æ·»åŠ å¥½ Motion åæˆ‘ä»¬åœ¨å³è¾¹çš„ Inspector è§†å›¾ä¸­ä¾¿å¯ä»¥çœ‹åˆ°å¤šäº†ä¸‰ä¸ªç©ºçš„ Motion ï¼Œè¿™ä¸ªæ—¶å€™è¦æ³¨æ„<u>å…ˆæŠŠ Parameterï¼ˆå‚æ•°ï¼‰é€‰æ‹©ä¸ºåˆšåˆšåˆ›å»ºçš„ Speed</u> å…ˆï¼Œç„¶åå°±åˆ†åˆ«æŠŠ ç«™ç«‹ã€è¡Œèµ°ã€å¥”è·‘ ä¸‰ä¸ªåŠ¨ä½œæ‹–å…¥åˆ°ä¸‰ä¸ªç©º Motion æ¡†ä¸­ï¼ˆåŠ¨ä½œåœ¨æ–‡ç« å‰é¢å¯ä»¥æ‰¾åˆ°è·¯å¾„ï¼‰ï¼Œå®Œæˆåå¦‚ä¸‹å›¾æ‰€ç¤º</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/58ff789af1ab4b3eb11464c2de7469df.jpg" alt="8.jpg" style="zoom:80%;" /><p>â€‹    å¼„å¥½ä¸Šé¢è¿™äº›ä¸œè¥¿åï¼Œå‰©ä¸‹çš„å°±è¦äº¤ç»™ä»£ç æ¥è§£å†³äº†ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åº”ç”¨ Speed å‚æ•°çš„æ—¶å€™äº†ï¼Œè¿™æ¬¡çš„ä»£ç æ‰“åœ¨äº†ä¹‹å‰åˆ›å»ºè¿‡çš„ <strong>PlayerController</strong> ä»£ç æ–‡ä»¶ä¸­ï¼Œä¸‹é¢è´´å‡ºè¿™æ¬¡è¦ç”¨åˆ°çš„ä»£ç ğŸ‘‡ğŸ‘‡ğŸ‘‡</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">NavMeshAgent</span> agent<span class="token punctuation">;</span><span class="token comment">//å¯¼èˆªæ§åˆ¶ï¼Œä¹‹å‰ç”¨åˆ°çš„</span>    <span class="token keyword">private</span> <span class="token class-name">Animator</span> animator<span class="token punctuation">;</span><span class="token comment">//åŠ¨ä½œæ§åˆ¶</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è·å–å½“å‰ç»„ä»¶å¹¶èµ‹å€¼ç»™ä¸Šé¢å£°æ˜çš„å˜é‡</span>         agent <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>animator<span class="token operator">=</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å®æ—¶æ›´æ–°åŠ¨ä½œåŠ¨ç”»</span><span class="token function">SwitchPlyerAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchPlyerAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//åˆ‡æ¢äººç‰©è§’è‰²çš„åŠ¨ä½œåŠ¨ç”»</span><span class="token comment">//å¼„å¥½åæ•´ä¸ªå‡½æ•°æ”¾è¿›Updateé‡Œ</span>        animator<span class="token punctuation">.</span><span class="token function">SetFloat</span><span class="token punctuation">(</span><span class="token string">"Speed"</span><span class="token punctuation">,</span>agent<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>sqrMagnitude<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®ä¸€ä¸ªFloatå€¼ï¼Œå‚æ•°2ä¸ºè¦è®¾ç½®çš„å€¼</span>        <span class="token comment">//APIè§£é‡Š</span>                <span class="token comment">//velocity -- è·å– NavMeshAgent ç»„ä»¶çš„å½“å‰é€Ÿåº¦ï¼Œæˆ–è€…è®¾ç½®ä¸€ä¸ªé€Ÿåº¦æ¥æ‰‹åŠ¨æ§åˆ¶ä»£ç†ã€‚</span>        <span class="token comment">//APIç½‘å€ï¼šhttps://docs.unity.cn/cn/2020.3/ScriptReference/AI.NavMeshAgent-velocity.html</span>                <span class="token comment">//sqrMagnitude -- å±äº Vector3 çš„æ–¹æ³•ï¼Œè¿”å›è¿™ä¸ªå‘é‡çš„é•¿åº¦çš„å¹³æ–¹ï¼ˆåªè¯»ï¼‰ï¼Œè®¡ç®—é•¿åº¦çš„å¹³æ–¹è€Œä¸æ˜¯magnitudeæ˜¯éå¸¸å¿«çš„</span>        <span class="token comment">//APIç½‘å€ï¼šhttp://docs.manew.com/Script/Vector3.sqrMagnitude.html</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    æ‰“å®Œä»£ç åï¼Œå†æŠŠ Animator Controller æ–‡ä»¶ <strong>Player</strong> æ‹–åˆ°äººç‰©å±æ€§é¢æ¿ä¸­çš„ <strong>Animator â€” Controller</strong> æ¡†æ¡†ä¸­å°±å¤§åŠŸå‘Šæˆå•¦ï¼è¿›å…¥æ¸¸æˆçœ‹çœ‹ä½ çš„äººç‰©æ˜¯å¦åœ¨ç§»åŠ¨æ—¶ä¼šå˜æ¢æŒ‡å®šçš„åŠ¨ä½œå§ï¼</p><img src="https://p9.toutiaoimg.com/origin/pgc-image/5b9d38d06a01422394b2959ab214244c.jpg" alt="9.jpg" style="zoom:80%;" />]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°3--æ‘„åƒæœºè·Ÿè¸ªå¤„ç†</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B03-%E6%91%84%E5%83%8F%E6%9C%BA%E8%B7%9F%E8%B8%AA%E5%A4%84%E7%90%86/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B03-%E6%91%84%E5%83%8F%E6%9C%BA%E8%B7%9F%E8%B8%AA%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>â€‹    åœ¨ä¸Šä¸€ç« èŠ‚ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡åœ¨Unityä¸Šä½¿ç”¨ä»£ç æ¥å®ç°äº†æˆ‘ä»¬äººç‰©çš„ç§»åŠ¨ã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°é•œå¤´å¹¶ä¸ä¼šè·Ÿç€äººç‰©ç§»åŠ¨ï¼Œå› æ­¤åœ¨è¿™ä¸€ç« èŠ‚æˆ‘ä»¬å°±æ¥å®ç°å¦‚ä½•è®©æ‘„åƒæœºè·Ÿç€æˆ‘ä»¬å°äººèµ°ã€‚</p><p>â€‹    åŒæ ·æˆ‘ä»¬ä¹Ÿè¦å®‰è£…ä¸€ä¸ªæ’ä»¶ï¼Œå«åš <strong>Cinemachine</strong> ï¼Œå®‰è£…å®Œåæˆ‘ä»¬å¯ä»¥åœ¨Unityç•Œé¢ä¸Šæ–¹çš„èœå•æ çœ‹è§å®ƒçš„åŠŸèƒ½æ¡</p><img src="https://p6.toutiaoimg.com/origin/pgc-image/2edd56f142984d5ca500ad9372783225.jpg" alt="1.jpg" style="zoom: 67%;" /><img src="https://p6.toutiaoimg.com/origin/pgc-image/a9788d8d88904631b6965ad7b0f5b286.jpg" alt="2.jpg" style="zoom:80%;" /><center>é¦–å…ˆå®‰è£…å¥½Cinemachine</center><p>â€‹    åœ¨è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°çš„é€‰é¡¹æ˜¯ç¬¬ä¸€ä¸ªï¼Œå…ˆé€‰ä¸­æˆ‘ä»¬çš„ä¸»æ‘„åƒæœº Main Cameraï¼ˆæˆ‘è¿™é‡Œå¯¹ä¸»æ‘„åƒæœºçš„å‘½åï¼‰ï¼Œåœ¨èœå•æ ä¸­æ‰¾åˆ° <strong>GameObjectâ€”&gt;Align View to Selected</strong>ï¼ˆè¿™ä¸€æ­¥æ“ä½œæ˜¯æŠŠæˆ‘ä»¬çš„è§†è§’è°ƒåˆ°å’Œæ‘„åƒæœºçš„è§†è§’ä¸€æ ·çš„è§’åº¦ï¼‰ï¼Œç„¶åå†åœ¨åˆšåˆšçš„ <strong>Cinemachine</strong> èœå•æ ä¸­ç‚¹å‡»<strong>åˆ›å»ºä¸€ä¸ª Virtual Camera</strong> </p><img src="https://p9.toutiaoimg.com/origin/pgc-image/a2106f307e6d4818b7bfa9ade25435ad.jpg" alt="3.jpg" style="zoom: 75%;" /><p>â€‹    åˆ›å»ºå¥½åï¼Œæˆ‘ä»¬çš„ Virtual Cameraï¼ˆè™šæ‹Ÿæ‘„åƒæœºï¼‰ å°±ä¼šé¡¶æ›¿äº†æˆ‘ä»¬çš„ä¸»æ‘„åƒæœºï¼Œæˆ‘ä»¬æ‰¾åˆ°åˆšåˆšåˆ›å»ºå¥½çš„è™šæ‹Ÿæ‘„åƒæœºå¯¹è±¡ï¼Œåœ¨å±æ€§æ ä¸­è¿›è¡Œä¸€äº›è°ƒæ•´ï¼š</p><p>â€‹    1ï¼‰é¦–å…ˆåœ¨ Body é€‰æ‹©ä¸º <strong>Framing Transposer</strong> ï¼Œè¿™æ ·ç›¸æœºå°±ä¼šè·Ÿéšç€æˆ‘ä»¬äººç‰©äº†ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€äº›å…¶ä»–å‡ ä¸ªé€‰é¡¹çš„ä½œç”¨</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/f9ab6d9da189491187c26eb6b7f47249.jpg" alt="4.jpg" style="zoom:80%;" /><ul><li><p>Do Nothingï¼šä¸ç§»åŠ¨è™šæ‹Ÿç›¸æœº </p></li><li><p>Framing Transposerï¼šè·Ÿéšç›®æ ‡ç§»åŠ¨ï¼Œå¹¶åœ¨å±å¹•ç©ºé—´ä¿æŒç›¸æœºå’Œè·Ÿéšç›®æ ‡çš„ç›¸å¯¹ä½ç½®ã€‚ </p></li><li><p>Hard Lock to Targetï¼šè™šæ‹Ÿç›¸æœºå’Œè·Ÿéšç›®æ ‡ä½¿ç”¨ç›¸åŒä½ç½®ã€‚</p></li><li><p> Orbital Transposerï¼šç›¸æœºå’Œè·Ÿéšç›®æ ‡çš„ç›¸å¯¹ä½ç½®æ˜¯å¯å˜çš„ï¼Œè¿˜èƒ½æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥ã€‚å¸¸è§äºç©å®¶æ§åˆ¶çš„ç›¸æœºã€‚</p></li><li><p> Tracked Dollyï¼šç›¸æœºæ²¿ç€é¢„å…ˆè®¾ç½®çš„è½¨é“ç§»åŠ¨ã€‚ </p></li><li><p>Transposerï¼šè·Ÿéšç›®æ ‡ç§»åŠ¨ï¼Œå¹¶åœ¨ä¸–ç•Œç©ºé—´ä¿æŒç›¸æœºå’Œè·Ÿéšç›®æ ‡çš„ç›¸å¯¹ä½ç½®å›ºå®šã€‚</p><p>2ï¼‰åœ¨ Aim é€‰é¡¹ä¸­é€‰æ‹© <strong>Do Nothing</strong> ï¼ˆè¿™é‡Œå¯¹å…¶å®ƒå‡ ä¸ªé€‰é¡¹æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»è¯•ä¸€ä¸‹ï¼Œé€‰æ‹©POVçš„æ—¶å€™è§†é‡ä¼šè·Ÿç€é¼ æ ‡è½¬åŠ¨ï¼Œä¸€èˆ¬å¯ç”¨äºç¬¬ä¸€äººç§°çš„æ¸¸æˆï¼‰</p><img src="https://p26.toutiaoimg.com/origin/pgc-image/2d597d7729c044f4a771b53cde8b0077.jpg" alt="5.jpg" style="zoom:80%;" /><p>3ï¼‰å°†ä½ çš„äººç‰©å¯¹è±¡æ‹–å…¥ Follow çš„æ¡†æ¡†ä¸­ï¼ˆè¿™é‡Œå…¶å®æœ¬è´¨æ˜¯ç›¸æœºè·Ÿéšä¸€ä¸ªåƒç´ ç‚¹ï¼Œå¦‚æœæƒ³è°ƒæ•´è·Ÿéšçš„ç‚¹å¯ä»¥è‡ªå·±è°ƒæ•´ï¼Œä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªäººç‰©å­ç±»Emptyå¯¹è±¡ï¼Œç„¶åè°ƒæ•´è¿™ä¸ªç©ºå¯¹è±¡çš„ä½ç½®ï¼Œå†è®©ç›¸æœºè·Ÿéšè¿™ä¸ªå¯¹è±¡ï¼‰</p><img src="https://p5.toutiaoimg.com/origin/pgc-image/edb5d7890a4441ff965a759adb6de889.jpg" alt="6.jpg" style="zoom:80%;" /></li></ul><p>â€‹    åˆ°è¿™é‡Œï¼Œä½ çš„æ‘„åƒæœºå°±ä¼šè·Ÿéšç€äººç‰©ç§»åŠ¨è€Œè½¬å˜è§†è§’äº†ï¼Œå½“ç„¶è¿˜å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œè°ƒæ•´ä¸€ä¸‹ç¼“å†²åŒºåŸŸï¼ˆå°±æ˜¯è®©ç›¸æœºä¸è¦è·Ÿéšç€å¤ªç´§ï¼Œè®©äººç‰©èµ°é‚£ä¹ˆä¸€ç‚¹ç‚¹è·ç¦»å†ç›¸æœºè·Ÿéšï¼‰ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´ä¸‹å›¾å‡ ä¸ªå‚æ•°è€Œè°ƒæ•´ï¼Œé¢„è§ˆå±å¹•çš„æ¡†æ¡†å¯ä»¥çœ‹åˆ°ä½ çš„ç¼“å†²åŒºå¤§å°</p><img src="https://p3.toutiaoimg.com/origin/pgc-image/b17d8f6eca6e4c1494f6b28ede1ecec3.jpg" alt="7.jpg" style="zoom:80%;" /><img src="https://p5.toutiaoimg.com/origin/pgc-image/4242f83084d54044bdb5ecedf8ad588a.jpg" alt="8.jpg" style="zoom:80%;" /><p>â€‹    å½“ç„¶æ„Ÿå…´è¶£çš„è¯è¿˜å¯ä»¥å»æŸ¥æ‰¾æ›´å¤šçš„è®¾ç½®æ–¹æ³•å»è°ƒæ•´ä½ çš„æ‘„åƒæœºï¼Œä»è€Œè®©ä½ çš„è§†é‡ç§»åŠ¨æ›´å®Œç¾ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°2--æ™ºèƒ½å¯¼èˆªçš„çƒ˜ç„™å’Œé¼ æ ‡æ§åˆ¶äººç‰©ç§»åŠ¨</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B02-%E6%99%BA%E8%83%BD%E5%AF%BC%E8%88%AA%E7%9A%84%E7%83%98%E7%84%99%E5%92%8C%E9%BC%A0%E6%A0%87%E6%8E%A7%E5%88%B6%E4%BA%BA%E7%89%A9%E7%A7%BB%E5%8A%A8/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B02-%E6%99%BA%E8%83%BD%E5%AF%BC%E8%88%AA%E7%9A%84%E7%83%98%E7%84%99%E5%92%8C%E9%BC%A0%E6%A0%87%E6%8E%A7%E5%88%B6%E4%BA%BA%E7%89%A9%E7%A7%BB%E5%8A%A8/</url>
      
        <content type="html"><![CDATA[<p>â€‹    è¿™ä¸€æ¬¡æˆ‘ä»¬æ¥å®ç°äººç‰©åœ¨åœ°å›¾ä¸Šèµ°åŠ¨ï¼Œåœ¨å®ç°ä¹‹å‰æˆ‘ä»¬æœ‰ä¸€äº›å‡†å¤‡å·¥ä½œè¦åšï¼Œé¦–å…ˆå°±æ˜¯æˆ‘ä»¬çš„åœ°å›¾çƒ˜ç„™äº†ã€‚</p><h1 id="æ™ºèƒ½å¯¼èˆªåœ°å›¾çš„çƒ˜ç„™"><a href="#æ™ºèƒ½å¯¼èˆªåœ°å›¾çš„çƒ˜ç„™" class="headerlink" title="æ™ºèƒ½å¯¼èˆªåœ°å›¾çš„çƒ˜ç„™"></a>æ™ºèƒ½å¯¼èˆªåœ°å›¾çš„çƒ˜ç„™</h1><p>â€‹    åœ°å›¾çš„çƒ˜ç„™å°±æ˜¯æ ‡è®°æˆ‘ä»¬åœºæ™¯å“ªäº›åŒºåŸŸæ˜¯å¯ä»¥ä¾›äººç‰©ç§»åŠ¨çš„ï¼Œè€Œå“ªä¸€äº›æ˜¯éšœç¢ç‰©æˆ–ä¸å¯èµ°åŒºåŸŸï¼Œåªæœ‰è§„åˆ’å¥½äº†ä¹‹åæˆ‘ä»¬æ‰å¯ä»¥æ›´å¥½çš„å»å®ç°äººç‰©ç§»åŠ¨ï¼Œä¸ç„¶å¯ä»¥æƒ³ä¸€ä¸‹å› ä¸ºä¸€äº›ç²—å¿ƒå¤±è¯¯ä½¿å¾—ä¸€äº›éšœç¢ç‰©æ²¡æœ‰è®¾ç½®æˆåŠŸï¼Œä»è€Œå¯¼è‡´äººç‰©ç§»åŠ¨ç©¿æ¨¡äº†å°±ä¸å¦™äº†ã€‚</p><p>â€‹    é‚£ä¹ˆæˆ‘ä»¬æ¥å¼€å§‹å§ï¼</p><p>â€‹    é¦–å…ˆè¿˜æ˜¯è¦å®‰è£…ä¸€ä¸ªæ’ä»¶å«åš â€” <strong>Navigation</strong> ï¼Œå®‰è£…æ­¥éª¤å°±ä¸å†è¿‡å¤šä»‹ç»äº†</p><p>â€‹    å®‰è£…å¥½äº†ä¹‹åæˆ‘ä»¬æ‰“å¼€ç•Œé¢å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ€ä¹ˆçƒ˜ç„™å§</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/148f5c914e914e808596ffa68e51d87d.jpg" alt="1.jpg" style="zoom: 80%;" /><p>â€‹    </p><p>â€‹    é¦–å…ˆæˆ‘ä»¬åœ¨åœºæ™¯ä¸­<strong>é€‰æ‹©ä¸€ä¸ªåœ°é¢</strong>ï¼Œç„¶åå†åœ¨ Navigation æ’ä»¶é‡Œç‚¹å‡» <strong>Objecté€‰é¡¹å¡</strong>ï¼Œå¯ä»¥æœ‰ä¸ª <strong>Navigation Static</strong> çš„é€‰é¡¹ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªé€‰é¡¹ âœ… å‹¾ä¸Šï¼Œå› ä¸ºåªæœ‰è®¾ä¸º static ä¹‹åæ‰å¯ä»¥è¿›è¡Œçƒ˜ç„™ã€‚</p><p>â€‹    âš æœ‰æ—¶å€™é€‰æ‹©äº† static ä¹‹åä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œè¯¢é—®æ˜¯å¦å°†è¯¥å¯¹è±¡æ‰€åŒ…å«çš„å­å¯¹è±¡ï¼ˆä¾‹å¦‚åœ¨åœ°æ¿å¯¹è±¡ä¸­è¿˜åŒ…å«äº†æ ‘æœ¨å’ŒçŸ³å¤´ç­‰å¯¹è±¡ï¼‰éƒ½è®¾ä¸º static ï¼Œè¿™ä¸ªæˆ‘ä»¬çœ‹è‡ªå·±æƒ…å†µé€‰æ‹©ã€‚</p><p>â€‹    é€‰æ‹© static åï¼Œä¸‹é¢çš„ <strong>Navigation Area</strong> å°±å¯ä»¥é€‰æ‹©å½“å‰åŒºåŸŸä¸ºå¯ç§»åŠ¨è¿˜æ˜¯ä¸å¯ç§»åŠ¨åŒºåŸŸäº†</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/4074b3afad1f40a1b0fc3ea55c186842.jpg" alt="2.jpg" style="zoom:80%;" /><p>â€‹    å›åˆ° Bake é€‰é¡¹å¡ï¼Œæˆ‘ä»¬çœ‹åˆ°å¯ä»¥è®¾ç½®åœ°é¢åœ¨å“ªäº›æƒ…å†µä¸‹å¯ä»¥èµ°ï¼Œå¦‚ <strong>Max Slope</strong> ä»£è¡¨ç€å¯è¡Œå¡åº¦ï¼Œå°±å¥½åƒæˆ‘æ‰€è°ƒçš„35Â°ï¼Œè¿™ä»£è¡¨ç€æˆ‘ä»¬å°äººæœ€å¤šå¯ä»¥èµ°35è§’åº¦çš„å¡ï¼Œå¦‚æœå¤§äº35Â°çš„è¯æˆ‘ä»¬å°äººæ˜¯æ— æ³•åˆ°è¾¾çš„</p><p>â€‹    è€Œå›¾ä¸­çš„è“è‰²åœ†æŸ±ä½“ä»¥ä»£è¡¨ç€ä½ çš„äººç‰©èº«é«˜å’ŒåŠå¾„ï¼Œæˆ‘ä»¬ä¿®æ”¹è¿™äº›å±æ€§ä¹Ÿä¼šå½±å“åˆ°æˆ‘ä»¬åœ°å›¾ä¸Šå¯è¡ŒåŒºåŸŸ</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/1400e1a2f3784cb2ac84e3f87c22a959.jpg" alt="3.jpg" style="zoom:80%;" /><p>â€‹    è®¾ç½®å®Œè¿™ä¸€åˆ‡ä¹‹åæˆ‘ä»¬å°±å¯ä»¥ç‚¹å‡»ä¸‹æ–¹çš„ <strong>Bake</strong> æŒ‰é’®æ¥çƒ˜ç„™å•¦ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨åœ°å›¾ä¸Šçœ‹åˆ°é¢œè‰²çš„å˜åŒ–ï¼Œæœ‰é¢œè‰²æ ‡è®°çš„åŒºåŸŸæ˜¯å¯ä»¥èµ°çš„ï¼Œè€Œæ²¡æœ‰é¢œè‰²åˆ™ä»£è¡¨æ˜¯æ— æ³•åˆ°è¾¾çš„åŒºåŸŸ</p><p>â€‹    </p><p>â€‹    é™¤äº†åƒä¸Šé¢é‚£æ ·ç›´æ¥ä½¿ç”¨ Navigation æ’ä»¶è¿›è¡Œéšœç¢ç‰©ç­‰è®¾ç½®æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥åœ¨ç‰©ä»¶çš„ <strong>Inspector</strong> è§†å›¾ä¸­æ·»åŠ ä¸€ä¸ª <strong>Navigation</strong> çš„ <strong>Component</strong></p><p>â€‹                             <img src="https://p6-tt.byteimg.com/origin/pgc-image/290b93d207ca4b5386932a8dcbef0407.jpg" alt="4.jpg" style="zoom:80%;" />                    <img src="https://p26-tt.byteimg.com/origin/pgc-image/e250b8ffcaf84d4f9eb2ef4e009069be.jpg" alt="5.jpg" style="zoom:80%;" /></p><p>â€‹    æ·»åŠ å®Œä¹‹åæˆ‘ä»¬å¯ä»¥è®¾ç½®æ˜¯å¯ç§»åŠ¨åŒºåŸŸè¿˜æ˜¯éšœç¢åŒºåŸŸï¼Œæœ€åå†è¿›è¡Œ <strong>Bake</strong> ï¼Œç”¨è¿™ç§æ–¹å¼å®ç°çš„åœ°å›¾çƒ˜ç„™æœ‰ä¸€ä¸ªä¼˜ç‚¹å°±æ˜¯åœ¨ä½ ç§»åŠ¨ç‰©ä½“æ—¶ï¼Œæ‰€è®¾ç½®çš„å¯è¡Œæˆ–ä¸å¯è¡ŒåŒºåŸŸä¹Ÿä¼šè·Ÿéšç‰©ä½“ç§»åŠ¨ï¼Œä¾‹å¦‚ï¼šæˆ‘è®¾ç½®äº†ä¸€ä¸ªçŸ³å¤´ä¸ºéšœç¢ç‰©ï¼Œåœ¨æˆ‘ç§»åŠ¨çŸ³å¤´æ—¶ï¼Œè¯¥éšœç¢ç‰©åŒºåŸŸä¹Ÿä¼šè·Ÿéšç€ç§»åŠ¨ã€‚</p><p>â€‹    ä¸æ­¢åœ°é¢å¯ä»¥çƒ˜ç„™ï¼Œæˆ‘ä»¬åœ°é¢ä¸Šçš„æ ‘æœ¨çŸ³å¤´éƒ½å¯ä»¥çƒ˜ç„™ï¼Œå…·ä½“æ“ä½œä¹Ÿæ˜¯å…ˆé€‰ä¸­è¿™äº›å¯¹è±¡ï¼ˆé‰´äºå¯èƒ½ç‰©ä½“è¾ƒå¤šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Hierarchyè§†å›¾ä¸Šå¤šé€‰ï¼‰ï¼Œç„¶åè®¾ä¸º static ï¼Œå†æ¥ç€è®¾ç½®åœ†æŸ±ä½“èŒƒå›´ç­‰å¯è¡ŒåŒºåŸŸæœ€åå†çƒ˜ç„™å°±å¤§åŠŸå‘Šæˆå•¦</p><h1 id="å®ç°é¼ æ ‡æ§åˆ¶äººç‰©ç§»åŠ¨"><a href="#å®ç°é¼ æ ‡æ§åˆ¶äººç‰©ç§»åŠ¨" class="headerlink" title="å®ç°é¼ æ ‡æ§åˆ¶äººç‰©ç§»åŠ¨"></a>å®ç°é¼ æ ‡æ§åˆ¶äººç‰©ç§»åŠ¨</h1><p>â€‹    åœ¨çƒ˜ç„™å¥½åœ°å›¾åŒºåŸŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹æ¥å®ç°é¼ æ ‡æ§åˆ¶äººç‰©ç§»åŠ¨å•¦</p><p>â€‹    å› ä¸ºè¿™éƒ¨åˆ†éœ€è¦æ¶‰åŠåˆ°æ‰“ä»£ç ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª <strong>Scripts</strong> æ–‡ä»¶å¤¹ä¸“é—¨å­˜æ”¾æˆ‘ä»¬çš„ä»£ç </p><p>â€‹    æ–°å»ºä¸€ä¸ª <strong>C#</strong> ä»£ç æ–‡ä»¶ï¼Œä¸€ä¸ª <strong>Unity Emptyå¯¹è±¡</strong>ï¼ŒæŠŠå®ƒä»¬éƒ½å‘½åä¸º <strong>MouseManager</strong> ï¼Œå¹¶æŠŠä»£ç æ–‡ä»¶æ‹–æ‹½åˆ° Unity Emptyå¯¹è±¡ä¸­</p><p>â€‹               <img src="https://p3-tt.byteimg.com/origin/pgc-image/21776254d90d48bca1cf31c28f6c402e.jpg" alt="6.jpg" style="zoom:80%;" />                                        <img src="https://p5-tt.byteimg.com/origin/pgc-image/b54f60e1cb4146ff84a3922d31e64f57.jpg" alt="7.jpg" style="zoom:80%;" /></p><p>â€‹    æ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™ä»£ç äº†ï¼Œç”±äºè¿™é‡Œå±•ç¤ºçš„æ˜¯å•ä¾‹æ¨¡å¼ï¼Œæˆ‘ä»¬è¿˜è¦æ–°å»ºä¸€ä¸ªåä¸ºï¼š <strong>PlayerController</strong> çš„C#æ–‡ä»¶æ‹–æ‹½åˆ°è¦æ§åˆ¶çš„äººç‰©ä¸Šï¼Œä¸‹é¢åˆ†åˆ«æ˜¯ä¸¤ä¸ªC#æ–‡ä»¶çš„ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//MouseManager.cs</span><span class="token comment">//è¿™é‡Œåªå±•ç¤ºé‡è¦çš„éƒ¨åˆ†å¹¶é™„ä¸Šæ³¨é‡Š</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token comment">//for Vector3,RaycastHit,Ray</span><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span><span class="token comment">//for Action</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MouseManager</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">event</span> <span class="token class-name">Action<span class="token punctuation">&lt;</span>Vector3<span class="token punctuation">></span></span> OnMouseClicked<span class="token punctuation">;</span><span class="token comment">//å£°æ˜ä¸€ä¸ªäº‹ä»¶ï¼Œç”¨äºå½“é¼ æ ‡ç‚¹å‡»æ—¶è¿›è¡Œæ“ä½œ</span>    <span class="token class-name">RaycastHit</span> hitInfo<span class="token punctuation">;</span><span class="token comment">//ç”¨æ¥å­˜å‚¨å°„çº¿Rayè¿”å›çš„åæ ‡ç‚¹æ¶ˆæ¯</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">MouseManager</span> Instance<span class="token punctuation">;</span><span class="token comment">//MouseManagerç±»çš„å”¯ä¸€å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ç”¨ï¼‰</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetCursorTexture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å‘å°„ä¸€æ¡å°„çº¿ï¼Œèµ·ç‚¹æ˜¯ä¸»ç›¸æœºï¼ˆMainCameraï¼‰</span>        <span class="token comment">//å°„çº¿å¦ä¸€ç«¯ç‚¹åˆ™æ˜¯é¼ æ ‡ç‚¹å‡»çš„åæ ‡ï¼ˆInput.mousePositionï¼‰</span>        <span class="token class-name">Ray</span> ray <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">ScreenPointToRay</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span>mousePosition<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>Physics<span class="token punctuation">.</span><span class="token function">Raycast</span><span class="token punctuation">(</span>ray<span class="token punctuation">,</span><span class="token keyword">out</span> hitInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ä¸Šé¢çš„Raycastå‡½æ•°é‡Œå°†å°„çº¿ç‚¹ä¿¡æ¯è¿”å›åˆ°äº†outå±æ€§çš„hitInfoå˜é‡é‡Œ</span>            <span class="token comment">//TODO</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>             <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token comment">//å¦‚æœé¼ æ ‡ç‚¹å‡»äº†ä¸€ä¸ªåœ°æ–¹å¹¶ä¸”hitInfoåæ ‡ç‚¹ä¸ä¸ºç©ºçš„è¯</span><span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> hitInfo<span class="token punctuation">.</span>collider <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//æ‰€ç‚¹å‡»çš„ç‰©ä½“æ ‡ç­¾æ˜¯â€œGroundâ€ï¼ˆåœ°é¢ï¼‰çš„è¯ï¼Œï¼ˆæ³¨æ„è¦æŠŠä½ çš„åœ°é¢æ·»åŠ ä¸ºGroundæ ‡ç­¾ï¼‰</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Ground"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//åˆ¤æ–­OnMouseClickedäº‹ä»¶æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºçš„è¯åˆ™ä¼ é€’åæ ‡ç‚¹</span>OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//DeBug Info</span><span class="token class-name">Vector3</span> point <span class="token operator">=</span> hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">;</span>Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"é¼ æ ‡å·¦é”®å•å‡»äº†&#123;0&#125;! X:&#123;1&#125;,Y:&#123;2&#125;,Z:&#123;3&#125;"</span><span class="token punctuation">,</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>name<span class="token punctuation">,</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span>point<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Debugæ˜¾ç¤ºé¼ æ ‡ç‚¹å‡»çš„åæ ‡</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">//åœ¨Unityçš„è„šæœ¬C#ä»£ç æ–‡ä»¶ä¸­ï¼ŒAwake()æ˜¯åœ¨è„šæœ¬å¯¹è±¡å®ä¾‹åŒ–æ—¶è¢«è°ƒç”¨çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªç±»è¢«åˆ›å»ºçš„æ—¶å€™å°±è¿›è¡Œæ“ä½œ</span><span class="token keyword">if</span><span class="token punctuation">(</span>Instance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">Destroy</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Instance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å°†ä¸Šé¢ä¸¤ä¸ªä¸»è¦çš„å‡½æ•°æ”¾è¿›Updateé‡Œ</span><span class="token function">SetCursorTexture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">MouseControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//class MouseManager</span><span class="token comment">//PlayerController.cs</span><span class="token comment">//æŠŠè¿™ä¸ªæ–‡ä»¶æ‹–å…¥åˆ°ä½ è¦æ§åˆ¶çš„äººç‰©ä¸­</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token comment">//for Component.GetComponent&lt;></span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>AI</span><span class="token punctuation">;</span><span class="token comment">//for CLASS NavMeshAgent;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">NavMeshAgent</span> agent<span class="token punctuation">;</span><span class="token comment">//å¯¼èˆªæ§åˆ¶</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//GetComponentä¸ºè·å–ç»„ä»¶</span>        <span class="token comment">//æˆ‘ä»¬åœ¨äººç‰©æ·»åŠ è¿‡ä¸€ä¸ªNavMeshAgentçš„Componentï¼Œè¿™é‡Œè·å–çš„å°±æ˜¯å®ƒ</span>        agent <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveToTarget</span><span class="token punctuation">(</span><span class="token class-name">Vector3</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ä»äº‹ä»¶ä¸­è·å¾—çš„åæ ‡ç‚¹èµ‹å€¼ç»™äººç‰©ç§»åŠ¨çš„ç›®æ ‡ç‚¹</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> target<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å°†å‡½æ•°æ–¹æ³•æ³¨å†Œåˆ°äº‹ä»¶ä¸­</span>MouseManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>OnMouseClicked<span class="token operator">+=</span>MoveToTarget<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    åˆ°æ­¤ï¼Œäººç‰©ç§»åŠ¨çš„æ ¸å¿ƒéƒ¨åˆ†å°±å®ç°äº†ï¼Œå¿«å»å®éªŒä¸€ä¸‹ä½ çš„å°äººèƒ½ä¸èƒ½ç§»åŠ¨å§ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Unityç¬”è®°1--ç†Ÿæ‚‰Unityç•Œé¢ä»¥åŠæ„å»ºåœºæ™¯</title>
      <link href="UnityNotes/Unity%E7%AC%94%E8%AE%B01-%E7%86%9F%E6%82%89Unity%E7%95%8C%E9%9D%A2%E4%BB%A5%E5%8F%8A%E6%9E%84%E5%BB%BA%E5%9C%BA%E6%99%AF/"/>
      <url>UnityNotes/Unity%E7%AC%94%E8%AE%B01-%E7%86%9F%E6%82%89Unity%E7%95%8C%E9%9D%A2%E4%BB%A5%E5%8F%8A%E6%9E%84%E5%BB%BA%E5%9C%BA%E6%99%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="ç†Ÿæ‚‰Unityç•Œé¢"><a href="#ç†Ÿæ‚‰Unityç•Œé¢" class="headerlink" title="ç†Ÿæ‚‰Unityç•Œé¢"></a>ç†Ÿæ‚‰Unityç•Œé¢</h1><p>â€‹    é¦–å…ˆåœ¨å¼€å§‹ä¹‹å‰è¯´ä¸€ä¸‹æˆ‘æ‰€ä½¿ç”¨çš„Unityç‰ˆæœ¬ï¼Œæˆ‘ç›®å‰æ‰€å®‰è£…çš„Unityæ˜¯2020.3ç‰ˆæœ¬ï¼Œå…·ä½“ç‰ˆæœ¬å·å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://p6-tt.byteimg.com/origin/pgc-image/39050d7c97954612bc110e85d4b0d84e.jpg" alt="1.jpg"></p><p>â€‹    åŒæ—¶è¿™ä¸ªç‰ˆæœ¬ä¹Ÿæ˜¯ç¨³å®šç‰ˆæœ¬ï¼ˆLTSï¼‰</p><p>â€‹    å®‰è£…å®ŒUnityï¼Œæˆ‘ä»¬å°±è¦å¼€å§‹åˆ›å»ºé¡¹ç›®ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åˆ›å»ºä¸€ä¸ªæ™®é€š3Dé¡¹ç›®ï¼Œé¡¹ç›®åä¸ºï¼š3DRPG ï¼Œè¿›å»ä¹‹åæˆ‘ä»¬æŒ‰è‡ªå·±å–œå¥½è°ƒæ•´ä¸€ä¸‹ç•Œé¢å¸ƒå±€ï¼Œå…·ä½“æ¯ä¸ªç•Œé¢çš„ä½œç”¨è¿™é‡Œä½œç®€å•çš„ä»‹ç»ï¼Œéšç€æˆ‘ä»¬ä¸æ–­æ¨è¿›é¡¹ç›®æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¯”è¾ƒå¿«åœ°ç†Ÿæ‚‰å„ä¸ªçª—å£çš„ä½œç”¨ã€‚</p><p><img src="https://p5-tt.byteimg.com/origin/pgc-image/aa00a709e4fe479aa99a5b3040a5a298.jpg" alt="2.jpg"></p><p>â€‹    ğŸ‘†æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸Šé¢çš„å›¾ï¼Œè¿™ä¸ªç•Œé¢æ˜¯æˆ‘åœ¨è¿›è¡Œäº†å‡ ä¸ªç« èŠ‚ä¹‹åæˆªçš„å›¾ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½æœ‰å‡ ä¸ªä¸»è¦çš„çª—å£ç•Œé¢ï¼š</p><ul><li><p><strong>Scene</strong>  è¿™ä¸ªæ˜¯æˆ‘ä»¬Unityçš„å¯è§†åŒ–åœºæ™¯ç®¡ç†çª—å£ï¼Œç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥å°†æˆ‘ä»¬çš„äººç‰©ã€å°ç‰©ä»¶ç­‰ä¸œè¥¿åœ¨Sceneçª—å£ä¸Šè¿›è¡Œæ“ä½œï¼Œè¿™å¯ä»¥æå¤§çš„æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œåœºæ™¯çš„å¸ƒç½®å·¥ä½œã€‚</p></li><li><p><strong>Hierarchy</strong> ä¹Ÿå°±æ˜¯ä¸Šå›¾é ä¸­é—´ä¸Šè¾¹çš„è§†å›¾ï¼Œåœ¨è¿™ä¸ªè§†å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨Sceneè§†å›¾ä¸­æ‘†æ”¾äº†å“ªäº›ç‰©ä»¶å¯¹è±¡ï¼ŒåŒ…æ‹¬ä½ çš„å°äººï¼ŒèŠ±è‰æ ‘æœ¨ç”šè‡³ä½ çš„Camera(æ‘„åƒæœºğŸ¥)å’Œå…‰ç…§å¯¹è±¡éƒ½ä¼šåœ¨Hierarchyè§†å›¾ä¸Šæ˜¾ç¤ºå‡ºæ¥ã€‚</p></li><li><p><strong>Project</strong> è¿™ä¸ªè§†å›¾é‡Œæˆ‘ä»¬å¯ä»¥ç®¡ç†å½“å‰é¡¹ç›®çš„æ–‡æ¡£æ–‡ä»¶ï¼Œæ¯”å¦‚C#ä»£ç æ–‡ä»¶æˆ–å…¶å®ƒé…ç½®æ–‡ä»¶ç­‰éƒ½å¯ä»¥åœ¨è¿™é‡Œç›´æ¥è®¿é—®ã€‚</p></li><li><p><strong>Inspector</strong> åœ¨è¿™ä¸ªè§†å›¾é‡Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å¹¶ä¿®æ”¹å½“å‰é€‰ä¸­å¯¹è±¡çš„å±æ€§å€¼ï¼Œä¾‹å¦‚æˆ‘å¯ä»¥åœ¨Sceneè§†å›¾æˆ–Hierarchyè§†å›¾é€‰ä¸­æˆ‘çš„å°äººï¼Œç„¶åä¿®æ”¹å®ƒçš„é«˜åº¦ã€ä½ç½®ç­‰ç­‰è®¸å¤šå±æ€§ã€‚</p></li><li><p><strong>Console</strong> è¿˜æœ‰ä¸€ä¸ªè§†å›¾å°±æ˜¯æˆ‘ä»¬çš„è¾“å‡ºæ§åˆ¶å°å•¦ï¼Œåœ¨è¿™ä¸ªæ§åˆ¶å°é‡Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä»£ç é”™è¯¯æˆ–è€…ä»£ç è¾“å‡ºç­‰ä¿¡æ¯ï¼Œåœ¨å¾€åæˆ‘ä»¬çš„C#ä»£ç æ–‡ä»¶ä¸­å¯ä»¥åˆ©ç”¨Debugæ¥è¾“å‡ºç‰¹å®šçš„ä¿¡æ¯ğŸ‘‰ğŸ‘‰ğŸ‘‰<code>Debug.LogFormat(&quot;è°ƒè¯•ä¿¡æ¯&#123;0&#125;&quot;,xxxx);</code></p><h1 id="å®‰è£…URPæ¸²æŸ“ç®¡çº¿"><a href="#å®‰è£…URPæ¸²æŸ“ç®¡çº¿" class="headerlink" title="å®‰è£…URPæ¸²æŸ“ç®¡çº¿"></a>å®‰è£…URPæ¸²æŸ“ç®¡çº¿</h1><p>â€‹    ç†Ÿæ‚‰å®Œç•Œé¢åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®‰è£…<strong>URP(Universal Render Pipeline)æ¸²æŸ“ç®¡çº¿</strong>äº†ï¼Œé¦–å…ˆæˆ‘ä»¬åœ¨ä¸Šè¾¹çš„èœå•æ æ‰¾åˆ°Windowâ€“Package Manager </p><img src="https://p6-tt.byteimg.com/origin/pgc-image/63fdcf0caf734225823ae387e05ea777.jpg" alt="3.jpg" style="zoom: 67%;" /><p>â€‹    åœ¨ Package Manager ä¸­æˆ‘ä»¬å¯ä»¥ç®¡ç†å½“å‰é¡¹ç›®ä½¿ç”¨çš„Unityæ’ä»¶ï¼Œä»¥åä¹Ÿä¼šç»å¸¸ç”¨åˆ°ï¼Œä¹‹ååœ¨Package Manager çª—å£ä¸­å·¦ä¸Šè§’æˆ‘ä»¬é€‰æ‹© Pcakages ä¸º<strong>Unity Registry</strong>ï¼Œéšååœ¨å³ä¸Šè§’æœç´¢<em>Universal RP</em>æ‰¾åˆ°æˆ‘ä»¬è¦çš„URPæ¸²æŸ“ç®¡çº¿å¹¶ç‚¹å‡»å®‰è£…</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/0c5d7ad152214e88b346851f86c86726.jpg" alt="4.jpg" style="zoom:67%;" /><p>â€‹    æˆ‘è¿™é‡Œå®‰è£…çš„URPç‰ˆæœ¬å·ä¸º 10.4.0 ï¼Œè¯¥ç‰ˆæœ¬å·²ç»åœ¨Unity 2020.3 ä¸­å¾—åˆ°äº†è®¤è¯ã€‚</p><p>â€‹    å®‰è£…å®Œåæˆ‘ä»¬å°±è¦å¼€å§‹é…ç½®å·¥ä½œäº†ï¼Œé¦–å…ˆæˆ‘ä»¬åœ¨Projectè§†å›¾ç‚¹é‚£ä¸ª+å·ï¼Œç„¶åæ‰¾åˆ° Rendering -&gt; Universal Render Pipeline -&gt; Pipeline Asset (Forward Renderer) ï¼Œå¦‚ä¸‹å›¾ğŸ‘‡</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/d659c489af584a5ca3c337957af35a19.jpg" alt="5.jpg" style="zoom:67%;" /><p>â€‹    ç‚¹å‡»ä¹‹åæˆ‘ä»¬çœ‹åˆ°Unityä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªæ–‡ä»¶ï¼ˆä¸‹å›¾çš„ç¬¬äºŒç¬¬ä¸‰ä¸ªï¼‰ï¼Œå½“ç„¶ä¸ºäº†ä»¥åæ›´å¥½çš„ç®¡ç†å„ç§æ‚ä¸ƒæ‚å…«çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬è¦å…»æˆåˆ†ç±»çš„å¥½ä¹ æƒ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼„ä¸ªæ–‡ä»¶å¤¹æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œè¿™é‡Œæˆ‘æ–‡ä»¶å¤¹èµ·å Pipeline Setting</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/fd12dcde3ace40bf9a60e5db6307675a.jpg" alt="6.jpg" style="zoom: 67%;" /><p>â€‹    ä¸‹ä¸€æ­¥æˆ‘ä»¬æ‰“å¼€èœå•æ ä¸­çš„ Editâ€”ProjectSettingsâ€¦</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/35de350f60d04bf7a21461765e3c9f11.jpg" alt="7.jpg" style="zoom: 60%;" /><p>â€‹    åœ¨æ–°æ‰“å¼€çš„çª—å£ä¸­æˆ‘ä»¬å¯ä»¥å¯¹æˆ‘ä»¬å½“å‰çš„é¡¹ç›®è¿›è¡Œä¸€äº›è®¾ç½®æ“ä½œï¼Œè¿™é‡Œæˆ‘ä»¬è¦è®¾ç½®é»˜è®¤çš„æ¸²æŸ“ç®¡çº¿ä¸ºåˆšåˆšåˆ›å»ºçš„URPæ¸²æŸ“ç®¡çº¿ï¼Œæˆ‘ä»¬åˆ†åˆ«åœ¨å·¦ä¾§æ ä¸­é€‰æ‹© Graphics å’Œ Quality ï¼Œå†æŒ‰ç…§ä¸‹å›¾æ ‡è“è‰²æ¡†ä½ç½®é€‰æ‹©æˆ‘ä»¬çš„URPæ¸²æŸ“ç®¡çº¿</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/5dac041ae0e14100a36c7ed5e7fa1991.jpg" alt="8.jpg" style="zoom:70%;" /><center>Graphicsç•Œé¢è®¾ç½®URP</center><img src="https://p6-tt.byteimg.com/origin/pgc-image/78eb8e07811a40a08c3f1e084e204cbc.jpg" alt="9.jpg" style="zoom:70%;" /></li></ul><center>Qualityç•Œé¢è®¾ç½®URP</center><p>â€‹    è‡³æ­¤ï¼Œæˆ‘ä»¬çš„URPæ¸²æŸ“ç®¡çº¿å®‰è£…é…ç½®å°±æš‚æ—¶åˆ°è¿™äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¾¿å¯ä»¥å¼€å§‹å¯¼å…¥ç´ ææµ‹è¯•æ¸²æŸ“æ•ˆæœäº†ã€‚</p><h1 id="å¯¼å…¥ç´ æå¹¶æ„å»ºåœºæ™¯"><a href="#å¯¼å…¥ç´ æå¹¶æ„å»ºåœºæ™¯" class="headerlink" title="å¯¼å…¥ç´ æå¹¶æ„å»ºåœºæ™¯"></a>å¯¼å…¥ç´ æå¹¶æ„å»ºåœºæ™¯</h1><h2 id="ä½¿ç”¨Unityç´ æå•†åº—å¯¼å…¥ç´ æ"><a href="#ä½¿ç”¨Unityç´ æå•†åº—å¯¼å…¥ç´ æ" class="headerlink" title="ä½¿ç”¨Unityç´ æå•†åº—å¯¼å…¥ç´ æ"></a>ä½¿ç”¨Unityç´ æå•†åº—å¯¼å…¥ç´ æ</h2><p>â€‹    æˆ‘ä»¬å¯ä»¥é€šè¿‡Unityè‡ªå¸¦çš„å®˜æ–¹å•†åº—é‡Œé¢å¯»æ‰¾æˆ‘ä»¬å–œæ¬¢çš„ç´ æï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹å‡»è¿™ä¸ª<a href="https://assetstore.unity.com/">é“¾æ¥</a>è¿›å…¥ç´ æå•†åº—ï¼Œä¹Ÿå¯ä»¥åœ¨Unityå†…çš„ Windowâ€”Asset Store å†…æ‰“å¼€</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/150853385a5e42e282a36d8e1e651371.jpg" alt="10.jpg" style="zoom:60%;" /><p>â€‹    å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»Unity2020ç‰ˆå¼€å§‹å–æ¶ˆäº†å†…ç½®å•†åº—çš„çª—å£ï¼Œå¦‚æœä½ æ˜¯2020ç‰ˆæˆ–ä¹‹åçš„ç‰ˆæœ¬çš„è¯ï¼Œæ‰“å¼€Asset Storeä¼šå¾—åˆ°ä¸€ä¸ªæ— æ³•è®¿é—®çš„ç•Œé¢ï¼Œæˆ‘ä»¬éœ€è¦å†ç‚¹å‡» Search Online æŒ‰é’®æŒ‰é’®æ¥æ‰“å¼€ç½‘é¡µç‰ˆå•†åº—</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/da99be76548c4ff18c4954eb06ad1d62.jpg" alt="11.jpg" style="zoom:65%;" /><p>â€‹    </p><p>â€‹    æˆ‘ä»¬ç›®å‰å¯ä»¥å…ˆæ‰¾ä¸¤ä¸ªå…è´¹ç´ æï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸€ä¸ªæ˜¯åœºæ™¯ç´ æï¼Œä¸€ä¸ªæ˜¯äººç‰©ç´ æï¼Œå¯ä»¥ä¾›æˆ‘ä»¬å‰æœŸæš‚æ—¶å­¦ä¹ ä½¿ç”¨äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç‚¹å‡»è“è‰²çš„æŒ‰é’®å¹¶æ ¹æ®æ“ä½œæ·»åŠ åˆ°ä½ çš„Unityè´¦æˆ·é‡Œï¼Œå°±å¯ä»¥åœ¨Unityé‡Œé¢ä¸‹è½½ä¸‹æ¥äº†</p><p><img src="https://p5-tt.byteimg.com/origin/pgc-image/63fc0f40f92a4af181788740c7f975bc.jpg" alt="12.jpg"></p><p>â€‹    åœ¨æŒ‘é€‰ç´ ææ—¶è¦æ³¨æ„ä¸€ç‚¹å°±æ˜¯è¦çœ‹å¥½ç´ ææ˜¯å¦æ”¯æŒæˆ‘ä»¬æ‰€é€‰æ‹©çš„æ¸²æŸ“ç®¡çº¿ï¼Œä¸€èˆ¬åœ¨ç´ æå•†åº—ç•Œé¢éƒ½ä¼šæœ‰è¯´æ˜</p><p>â€‹    ç´ ææ·»åŠ åˆ°è´¦æˆ·ä¹‹åï¼Œæˆ‘ä»¬æ‰“å¼€ Package Managerï¼Œå¹¶åœ¨å·¦ä¸Šè§’çš„ Packages é€‰æ‹©ä¸º My Assetsï¼Œå°±å¯ä»¥çœ‹åˆ°åœ¨Unityå•†åº—æ·»åŠ çš„ç´ æäº†ï¼Œé€‰ä¸­ç´ æç‚¹å‡»ä¸‹è½½å¹¶Importå°±å¯ä»¥æ·»åŠ åˆ°é¡¹ç›®ä¸­å•¦</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/20d6062a1db34a62a9182d0aa5943889.jpg" alt="13.jpg" style="zoom:70%;" /><p>â€‹    å°†æˆ‘ä»¬å°äººæ‹–åˆ°Sceneè§†å›¾ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°å°äººä¸€èº«ç²‰è‰²è¿˜æ²¡æ¸²æŸ“å¤–è§‚å‡ºæ¥ï¼Œè¿™æ—¶æˆ‘ä»¬å°±è¦å°†ç´ æå‡çº§åˆ°æˆ‘ä»¬çš„æ¸²æŸ“ç®¡çº¿ï¼Œå…·ä½“æ“ä½œæ˜¯ Edit -&gt; Render Pipeline -&gt; Universal Render Pipeline -&gt; æ­¤æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å‡ºæ¥ä¸¤ä¸ªé€‰é¡¹ï¼Œç¬¬â˜ä¸ªé€‰é¡¹æ˜¯å°†æˆ‘ä»¬é¡¹ç›®é‡Œçš„æ‰€ä»¥ç´ æéƒ½å‡çº§ä¸ºURPï¼›ç¬¬âœŒä¸ªé€‰é¡¹æ˜¯å°†å½“å‰é€‰ä¸­çš„æè´¨å‡çº§ä¸ºURPï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç¬¬ä¸€ä¸ªã€‚ç‚¹å‡»å‡çº§URPåå°äººå°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/29036628920f45c09b47e29ad9a2eaf0.jpg" alt="14.jpg" style="zoom:80%;" /><p>â€‹    </p><h2 id="æ„å»ºåœºæ™¯"><a href="#æ„å»ºåœºæ™¯" class="headerlink" title="æ„å»ºåœºæ™¯"></a>æ„å»ºåœºæ™¯</h2><p>â€‹    æ­å»ºåœºæ™¯éƒ¨åˆ†æˆ‘ä»¬å¯ä»¥å…ˆä»è°ƒæ•´å¤©ç©ºæ ·å¼å¼€å§‹ï¼Œå› ä¸ºé»˜è®¤çš„å¤©ç©ºæ ·å¼ç°æºœæºœçš„å¹¶ä¸å¥½çœ‹ğŸ˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹å§ï¼</p><h3 id="å¤©ç©º"><a href="#å¤©ç©º" class="headerlink" title="å¤©ç©º"></a>å¤©ç©º</h3><p>â€‹    é¦–å…ˆè°ƒæ•´å¤©ç©ºå¯ä»¥å…ˆå»ä¸‹ä¸ªå¤©ç©ºç›’å­ï¼ˆSkyboxï¼‰ç´ æï¼Œè¿™é‡Œæˆ‘ä¸‹è½½çš„æ˜¯ä¸‹å›¾æ‰€ç¤ºçš„Skyboxï¼š<a href="https://assetstore.unity.com/packages/vfx/shaders/free-skybox-extended-shader-107400">FREE Skybox Extended Shader</a></p><p><img src="https://p9-tt.byteimg.com/origin/pgc-image/e72308b7966b47368c2cc814dcf5dca4.jpg" alt="15.jpg"></p><p>â€‹    æ·»åŠ å¥½èµ„æºåå›åˆ°Unityå†…ä¸‹è½½å¹¶ Importï¼ˆæ³¨æ„å°†æ–‡ä»¶å¤¹åˆ†å¥½ç±»ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç´ æç›®å½•ä¸‹çœ‹åˆ°æœ‰Demoæ ·ä¾‹</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/0b812466543d478b9211e068a949438f.jpg" alt="16.jpg" style="zoom:80%;" /><p>â€‹    é‚£ä¹ˆå¦‚ä½•æ¥ä½¿ç”¨è¿™ä¸ªSkyboxå‘¢ï¼Ÿ</p><p>â€‹    é¦–å…ˆæˆ‘ä»¬è¦åœ¨èœå•æ æ‰“å¼€ Window -&gt; Rendering -&gt; Lighting çª—å£</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/448dfc0867b14cea8a884b1da2cd1cc8.jpg" alt="17.jpg" style="zoom:70%;" /><p>â€‹    ç„¶åæˆ‘ä»¬åœ¨æ–°æ‰“å¼€çš„ Lighting çª—å£ç‚¹å‡» Environment é€‰é¡¹å¡ï¼Œåœ¨Skybox Material é‚£ä¸€æ ä¸­å°±å¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢çš„Skyboxç´ æäº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/e489644b78364fab8c4b97e49a5f69d3.jpg" alt="18.jpg" style="zoom:80%;" /><p>â€‹    å¦å¤–ï¼Œæˆ‘ä»¬åœ¨Sceneé€‰é¡¹å¡ä¸­å¯ä»¥å…ˆç‚¹å‡»ä¸€ä¸‹New Lighting SettingsæŒ‰é’®æ¥æ–°å»ºä¸€ä¸ªå…‰ç…§é…ç½®æ–‡ä»¶å¹¶å°†å®ƒåˆ†ç±»æ‘†å¥½ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶æˆ‘ä»¬åé¢å¯ä»¥ç”¨æ¥é…ç½®åœºæ™¯ç¯å¢ƒå…‰</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/07234fec87af42b8a7db9fbd227478b5.jpg" alt="19.jpg" style="zoom:80%;" /><p><img src="https://p9-tt.byteimg.com/origin/pgc-image/042dbd7860774728a5a7a00969f383e9.jpg" alt="20.jpg"></p><center>å°†è¿™ä¸ªé…ç½®æ–‡ä»¶åˆ†ç±»æ‘†åœ¨Pipeline Settingæ–‡ä»¶å¤¹ä¸‹</center><p>â€‹    </p><p>â€‹    ç°åœ¨æˆ‘ä»¬å°±æŠŠåˆšåˆšä¸‹è½½ä¸‹æ¥çš„Skyboxé€‚ç”¨åˆ°åœºæ™¯ä¸­äº†ï¼Œå¦‚æœæƒ³è¦è°ƒæ•´å‚æ•°çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ°ç´ æç›®å½•ä¸‹æ‰¾åˆ°åˆšåˆšé€‰æ‹©çš„Skyboxç´ æå¯¹è±¡ï¼Œå¹¶åœ¨ Inspector è§†å›¾çª—å£ä¸­è°ƒæ•´è¿™äº›å‚æ•°</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/e3033b1ee0d947b4b315b4a1c17afbf2.jpg" alt="21.jpg" style="zoom:80%;" /><center>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å³è¾¹çš„Inspectorè§†å›¾å†…å¯ä»¥ä¿®æ”¹Skyboxçš„å±æ€§</center><p>â€‹    </p><p>â€‹    è‡³æ­¤ï¼Œå¤©ç©ºåœºæ™¯å°±è¿™æ ·æ­å»ºå¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ­å»ºåœ°é¢çš„å…ƒç´ å§ï¼</p><h3 id="åœ°é¢"><a href="#åœ°é¢" class="headerlink" title="åœ°é¢"></a>åœ°é¢</h3><p>â€‹    å¦‚æœæƒ³åœ¨Unityä¸­è‡ªå·±æ¥ç»˜åˆ¶åœºæ™¯åœ°é¢çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸¤ä¸ªæ’ä»¶ â€” <strong>Poly Brush</strong> å’Œ <strong>ProBuilder</strong> æ¥è‡ªå·±å»ºæ¨¡ã€‚</p><h4 id="Poly-Brush"><a href="#Poly-Brush" class="headerlink" title="Poly Brush"></a>Poly Brush</h4><p>â€‹    æˆ‘ä»¬è¿˜æ˜¯æ‰“å¼€ Package Managerï¼Œå·¦ä¸Šè§’çš„ Packages é€‰æ‹©ä¸º <strong>Unity Registry</strong> ç„¶åæˆ‘ä»¬åœ¨æœç´¢æ¡†æŸ¥æ‰¾ <strong>Poly Brush</strong> ç„¶åä¸‹è½½ä¸‹æ¥å®‰è£…ã€‚å®‰è£…å¥½ Poly Brush ä¸è¦ç€æ€¥å…³é—­ Package Manager çª—å£ï¼Œæˆ‘ä»¬è¿˜è¦ç‚¹å¼€ Samples å¯¼å…¥å±äºæˆ‘ä»¬URPçš„ Shader Examples ï¼Œå³ä¸‹å›¾ä¸­çš„<strong>ç¬¬äºŒä¸ªé€‰é¡¹</strong></p><img src="https://p6-tt.byteimg.com/origin/pgc-image/0a1867154c2045d2ada819d40e319961.jpg" alt="22.jpg" style="zoom:80%;" /><center>å¦‚æœæˆ‘ä»¬ä½¿ç”¨URPçš„è¯é€‰æ‹©çš„æ˜¯ç¬¬äºŒä¸ªé€‰é¡¹</center><p>â€‹    å½“ç„¶å¦‚æœä½ æ˜¯ä½¿ç”¨æ™®é€šçš„Unityé¡¹ç›®è€Œæ²¡æœ‰ä½¿ç”¨URPæ¸²æŸ“ç®¡çº¿çš„è¯å°±é€‰æ‹©<strong>ç¬¬ä¸€ä¸ªé€‰é¡¹</strong></p><p>â€‹    å®‰è£…å¥½åæˆ‘ä»¬çš„ Project è§†å›¾é‡Œå°±ä¼šå¤šå‡ºäº†ä¸€ä¸ª Polybrush æ’ä»¶çš„æ–‡ä»¶å¤¹ï¼Œç”±äºä¹‹åæˆ‘ä»¬è¿˜è¦å®‰è£…ä¸€äº›æ’ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å‘½åä¸º <strong>Addons</strong> æ¥ä¸“é—¨å­˜æ”¾è¿™äº›æ’ä»¶çš„æ–‡ä»¶ï¼ˆè¦å…»æˆåˆ†ç±»çš„å¥½ä¹ æƒ¯ï¼‰</p><p>â€‹    å¼„å¥½è¿™äº›ä¸œè¥¿åï¼Œæˆ‘ä»¬å›åˆ°Unityä¸»ç•Œé¢ï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šæ–¹èœå•æ çš„ <strong>Tools-&gt;Polybrush-&gt;Polybrush Window</strong> æ¥æ‰“å¼€Polybrushçª—å£</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/c58b3d98cab54de79fac9e3d9a0eaac6.jpg" alt="23.jpg" style="zoom:80%;" /><center>æ‰“å¼€ Polybrush çª—å£</center><p>â€‹    æ‰“å¼€ Polybrush çª—å£åæˆ‘ä»¬äº†è§£ä¸€ä¸‹è¿™äº›æŒ‰é’®çš„åŠŸèƒ½</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/d8e4a421ebcb42719f15c86813a7e131.jpg" alt="24.jpg" style="zoom:80%;" /><ul><li><p>ç¬¬ä¸€ä¸ªæŒ‰é’®æ˜¯è°ƒæ•´åœ°é¢çš„é«˜åº¦ï¼Œé€‰ä¸­è¯¥æŒ‰é’®ç„¶ååœ¨åœ°é¢ä¸Šæ‹–æ‹½é¼ æ ‡å³å¯å°†åœ°é¢å‡é«˜ï¼ŒæŒ‰ä½ Ctrl å¹¶æ‹–æ‹½é¼ æ ‡ä¾¿æ˜¯ä¸‹é™ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸‹é¢é¢æ¿ä¸­è¿˜æœ‰ä¸€äº›å‚æ•°ä¾›æˆ‘ä»¬è°ƒæ•´ï¼š</p><p><strong>OuterRadius</strong> å¯ä»¥é€‰æ‹©å¤–è§’å¤§å°</p><p><strong>InnerRadius</strong> åˆ™ä¿®æ”¹å†…è§’å¤§å°ã€‚æŒ‰ä½ shift é”®æ»‘åŠ¨é¼ æ ‡æ»šè½®å¯ä»¥è°ƒæ•´å†…åœˆå¤§å°ï¼ŒæŒ‰ä½ Ctrl é”®æ»‘åŠ¨æ»šè½®è°ƒæ•´å¤–åœˆã€‚</p><p><strong>Strength</strong>å¯ä»¥ä¿®æ”¹å¼ºåº¦</p><p><strong>Direction</strong> å¯ä»¥é€‰æ‹©åœ°å½¢æ”¹å˜çš„æ–¹å‘ï¼Œé»˜è®¤ä¸ºnormalï¼Œä¸‹æ‹‰å¯ä»¥è¿›è¡Œä¿®æ”¹ã€‚</p><p><strong>BrushMirroring</strong>å¯ä»¥å¤åˆ¶ç¬”åˆ·ï¼Œæ²¿ç€é€‰ä¸­çš„çš„x,y,zé•œåƒåŒæ—¶ä¿®æ”¹åœ°å½¢</p></li><li><p>ç¬¬äºŒä¸ªæŒ‰é’®æ˜¯æŸ”åŒ–æŒ‰é’®ï¼Œç¾½åŒ–åŠŸèƒ½å¯ä»¥å°†åœ°å›¾è¾ƒä¸ºåƒµç¡¬çš„é¡¶ç‚¹è¿›è¡ŒæŸ”åŒ–</p></li><li><p>ç¬¬ä¸‰ä¸ªæŒ‰é’®æ˜¯é¢œè‰²åˆ·ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬å¾ˆæ–¹ä¾¿åœ°å°†æˆ‘ä»¬çš„åœ°æ¿æ¶‚ä¸Šæˆ‘ä»¬æƒ³è¦çš„é¢œè‰²</p></li><li><p>ç¬¬å››ä¸ªæŒ‰é’®æ˜¯å°†é¢„è®¾çš„ç‰©ä½“æ¶‚åˆ°åœ°æ¿ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¢æ¿ä¸­å‹¾é€‰è¦åˆ·çš„ç‰©ä½“ä»¥åŠå¯†åº¦ï¼ˆå³æ¦‚ç‡ï¼‰</p></li><li><p>ç¬¬äº”ä¸ªæ˜¯è´´å›¾åˆ·ï¼Œå’Œé¢„åˆ¶ä½“åˆ·å­çš„åŠŸèƒ½ä¸€æ ·ï¼Œå®ƒæ˜¯å°†ä¸€äº›textureåˆ·åˆ°åœºæ™¯ä¸­ï¼Œå¯ä»¥æŠŠå›¾ç‰‡ç´ æå¯ä»¥å¼•ç”¨åœ¨åœºæ™¯ä¸­é€‰ä¸­çš„ç‰©ä½“ä¸Šã€‚</p></li></ul><h4 id="ProBuilder"><a href="#ProBuilder" class="headerlink" title="ProBuilder"></a>ProBuilder</h4><p>â€‹    ä¸Šé¢çš„Poly Brushæ’ä»¶æ˜¯ç”¨æ¥ç»˜åˆ¶ä¿®æ”¹åœ°é¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ¥åˆ›å»ºè‡ªå·±çš„åœ°é¢å‘¢ï¼Ÿè¿™ä¸‹å°±è¦ç”¨åˆ°æˆ‘ä»¬çš„å¦ä¸€ä¸ªæ’ä»¶ â€” <strong>ProBuilder</strong> äº†</p><p>â€‹    åŒæ ·åœ°ï¼Œæˆ‘ä»¬é€šè¿‡ Package Manager æ¥å®‰è£…æ­¤æ’ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ååŒæ ·æŠŠæ’ä»¶æ–‡ä»¶å¤¹åˆ†å¥½ç±»ï¼Œç„¶åæ‰“å¼€çª—å£</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/9e16aa320d6e461a9fc6a22752440486.jpg" alt="25.jpg" style="zoom:80%;" /><center>ProBuilderç•Œé¢</center><p>â€‹    æˆ‘ä»¬å¯ä»¥æŒ‰ä½ <strong>å·¦Shift</strong> å¹¶é¼ æ ‡æŒ‡åˆ°å›¾å½¢æŒ‰é’®æ¥æŸ¥çœ‹è¿™äº›æŒ‰é’®çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰äº›æŒ‰é’®å³ä¸Šè§’æœ‰ä¸ªå°é½¿è½®ï¼Œè¿™ä»£è¡¨ç€æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ¥è®¾ç½®ï¼Œåªç”¨æŒ‰ä½ Alt å¹¶ç‚¹å‡»ä»–ä»¬å°±å¯ä»¥è¿›ä¸€æ­¥åœ°æ¥è®¾ç½®ï¼Œæ‹¿ç¬¬ä¸€ä¸ªæŒ‰é’®ï¼ˆåŠŸèƒ½æ˜¯<strong>åˆ›å»ºå‡ ä½•ä½“</strong>ï¼‰æ¥è¯´</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/bacf417b80d14ac18301bb95e8fb9034.jpg" alt="26.jpg" style="zoom:80%;" /><p>â€‹    æŒ‰ä½ Alt å¹¶ç‚¹å‡»ç¬¬ä¸€ä¸ªæŒ‰é’®æˆ‘ä»¬æ‰“å¼€å¦‚ä¸Šå›¾æ‰€ç¤ºçš„çª—å£ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è¦åˆ›å»ºçš„ç‰©ä½“æ˜¯ä»€ä¹ˆï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ Plane ï¼ˆå¹³é¢ï¼‰ï¼Œä¸‹é¢å¯ä»¥è®¾ç½®è¯¥å‡ ä½•ä½“çš„çš„è½´çš„æœå‘ã€å®½åº¦ã€é•¿åº¦ä»¥åŠé¡¶ç‚¹æ•°ï¼ˆå¦‚ä¸Šå›¾é¡¶ç‚¹æ•°æ˜¯30x30ï¼‰</p><p>â€‹    å…·ä½“çš„åŠŸèƒ½æˆ‘ä»¬å¯ä»¥è‡ªå·±å»å°è¯•ï¼Œé…åˆ Polybrush æˆ‘ä»¬å°±å¯ä»¥è½»æ¾åœ°æ¥åˆ›å»ºæˆ‘ä»¬çš„åœºæ™¯å¹¶ç»˜åˆ¶ä»–ä»¬å•¦ï¼</p><p>â€‹    è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬å¦‚æœè¦ä½¿ç”¨ <em>Low Poly</em> é£æ ¼çš„åœºæ™¯çš„è¯ï¼Œæˆ‘ä»¬è¦è®¾ç½®åœ°å›¾ç½‘æ ¼å‘ˆä¸‰è§’å½¢ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ä¸Šé¢ ProBuilder å›¾ä¸­çš„ <strong>ç¬¬äºŒæ’ç¬¬äº”ä¸ª</strong> æŒ‰é’®æ¥å®ç°ï¼Œé€‰ä¸­æˆ‘ä»¬çš„åœ°é¢å‡ ä½•ä½“ï¼Œç„¶åç‚¹å‡»è¯¥æŒ‰é’®ä¾¿å¯ä»¥è®¾ç½®æˆåŠŸã€‚</p><p>â€‹    </p><p>â€‹    åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå·±å»å°è¯•ä¸€ä¸‹æ„å»ºå±äºè‡ªå·±çš„åœºæ™¯äº†ã€‚</p><h1 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h1><p>â€‹    åœ¨è¿™ä¸€ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å¼€å§‹ç¬¬ä¸€æ¬¡æ¥è§¦Unityå¹¶å°è¯•äº†è§£å®ƒï¼Œäº†è§£å¦‚ä½•å¯¼å…¥ç´ æå¹¶æ„å»ºã€ç»˜åˆ¶æˆ‘ä»¬çš„åœºæ™¯ï¼Œæˆ‘ä»¬åªæœ‰å¤šå»å°è¯•ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œæ‰å¯ä»¥å˜å¾—ç†Ÿæ‚‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆå¯ä»¥å‘æŒ¥è‡ªå·±åˆ›æ„æ¥æ„å»ºä¸€ä¸ªåœºæ™¯ï¼Œä»¥ä¾¿åé¢æ¥æ“ä½œå§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Unityå­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Unity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºæˆ‘</title>
      <link href="%E8%AE%B0%E4%BA%8B/%E5%85%B3%E4%BA%8E%E6%88%91/"/>
      <url>%E8%AE%B0%E4%BA%8B/%E5%85%B3%E4%BA%8E%E6%88%91/</url>
      
        <content type="html"><![CDATA[<h1 id="å…³äºè¿™ä¸ªåšå®¢çš„ä¸€äº›äº‹ğŸ¥"><a href="#å…³äºè¿™ä¸ªåšå®¢çš„ä¸€äº›äº‹ğŸ¥" class="headerlink" title="å…³äºè¿™ä¸ªåšå®¢çš„ä¸€äº›äº‹ğŸ¥"></a>å…³äºè¿™ä¸ªåšå®¢çš„ä¸€äº›äº‹ğŸ¥</h1><p>â€‹    å½“åˆåˆ›å»ºè¿™ä¸ªåšå®¢çš„ç›®çš„æ˜¯æƒ³ç€è®°å½•è‡ªå·±åœ¨å¤§å­¦ç”Ÿæ´»ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜æˆ–è€…å­¦ä¹ ç¬”è®°ç­‰ï¼Œå¹³æ—¶ä¹Ÿçœ‹äº†ä¸å°‘åˆ«äººçš„ä¸ªäººåšå®¢ï¼Œäºæ˜¯å¿ƒè¡€æ¥æ½®å°±æƒ³è‡ªå·±ä¹Ÿåˆ›ä¸€ä¸ªå±äºè‡ªå·±çš„ä¸ªäººåšå®¢ã€‚</p><p>â€‹    åˆšå¼€å§‹æˆ‘ä¾¿å»æŸ¥æ‰¾æœ‰ä»€ä¹ˆåšå®¢å¹³å°ï¼Œå› ä¸ºæˆ‘å–œæ¬¢è‡ªå·±è‡ªå®šä¹‰ç•Œé¢çš„æ–¹å¼ï¼Œä¾¿æ‰¾åˆ°äº†å¯ä»¥åˆ©ç”¨GitHubæ¥åšä¸€ä¸ªåšå®¢æ–¹å¼ï¼Œå³ï¼š<a href="https://hexo.io/zh-cn/">hexo</a> ã€‚ä¹‹åæˆ‘ä¾¿è·Ÿç€æ•™ç¨‹å¼€å§‹æ­å»ºï¼Œä¹Ÿå‘ç°äº†ä¸€äº›å¾ˆå¥½çœ‹çš„ä¸»é¢˜ï¼Œæˆ‘ç°åœ¨ç”¨çš„è¿™ä¸ªä¸»é¢˜æ˜¯<a href="https://butterfly.js.org/">butterfly</a>ï¼ˆ<a href="https://github.com/jerryc127/hexo-theme-butterfly/tree/dev">GitHubåœ°å€</a>ï¼‰ã€‚ä¹‹åç ”ç©¶ç¾åŒ–ç•Œé¢åˆèŠ±äº†å¥½ä¸€äº›æ—¶é—´ï¼Œä¸è¿‡åœ¨å¼„è¿™äº›ä¸œè¥¿çš„æ—¶å€™æˆ‘éƒ½è§‰å¾—å¾ˆæ»¡è¶³ï¼Œçœ‹ç€å±äºè‡ªå·±çš„åšå®¢æ…¢æ…¢å¼€å§‹æ­å»ºèµ·æ¥ï¼Œä¸€è‚¡æˆå°±æ„Ÿå°±ä¸Šæ¥äº†ï¼Œè€Œä¸”åœ¨å…¶ä¸­ä¹Ÿæ¥è§¦åˆ°äº†è®¸å¤šä¹‹å‰æ²¡æœ‰é‡åˆ°è¿‡çš„çŸ¥è¯†ã€‚</p><p>â€‹    å¼„å¥½åšå®¢çš„åŸºæœ¬æ¡†æ¶åï¼Œæ‰æ˜¯çœŸæ­£çš„å¼€å§‹ï¼Œå¸Œæœ›æœ‰ä¸€ä¸ªåšå®¢ä¹‹åï¼Œèƒ½å¤Ÿå¯¹æˆ‘è‡ªå·±æœ‰æ›´å¥½çš„å¸®åŠ©ï¼Œå¯ä»¥æ›´å¥½åœ°å»æ€»ç»“çŸ¥è¯†ç‚¹ï¼Œä¹Ÿå¸Œæœ›å¯ä»¥åˆ†äº«ä¸€äº›çŸ¥è¯†ç»™è§‚çœ‹åšå®¢çš„ä½ ğŸ˜€ã€‚</p><h1 id="å…³äºæˆ‘çš„ä¸€äº›äº‹"><a href="#å…³äºæˆ‘çš„ä¸€äº›äº‹" class="headerlink" title="å…³äºæˆ‘çš„ä¸€äº›äº‹"></a>å…³äºæˆ‘çš„ä¸€äº›äº‹</h1><p>â€‹    å¾…æ›´æ–°â€¦â€¦.ğŸ’¨</p>]]></content>
      
      
      <categories>
          
          <category> è®°äº‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®°äº‹ </tag>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
