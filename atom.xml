<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ğŸŒ¸æ¨±èŠ±é…’å§ğŸ»</title>
  
  <subtitle>ğŸŒ¸Sakura-PubğŸ»</subtitle>
  <link href="http://sakura-pub.ltd/atom.xml" rel="self"/>
  
  <link href="http://sakura-pub.ltd/"/>
  <updated>2021-08-02T04:18:18.335Z</updated>
  <id>http://sakura-pub.ltd/</id>
  
  <author>
    <name>Sakura.</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Unityç¬”è®°26-å®ç°åŒåœºæ™¯çš„ä¼ é€</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B026-%E5%AE%9E%E7%8E%B0%E5%90%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E4%BC%A0%E9%80%81/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B026-%E5%AE%9E%E7%8E%B0%E5%90%8C%E5%9C%BA%E6%99%AF%E7%9A%84%E4%BC%A0%E9%80%81/</id>
    <published>2021-08-02T01:49:40.000Z</published>
    <updated>2021-08-02T04:18:18.335Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œæˆ‘ä»¬å®ç°åŒåœºæ™¯çš„ä¼ é€æ•ˆæœ</p><h1 id="è°ƒæ•´ä¼ é€é—¨"><a href="#è°ƒæ•´ä¼ é€é—¨" class="headerlink" title="è°ƒæ•´ä¼ é€é—¨"></a>è°ƒæ•´ä¼ é€é—¨</h1><p>åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¦æŠŠä¸åŒçš„ä¼ é€é—¨æ‘†æ”¾å¥½å…ˆ</p><p>å¦å¤–æˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ç‚¹å‡»ä¸äº†ä¼ é€é—¨ï¼Œè¿™æ˜¯å› ä¸ºä¼ é€é—¨çš„box collideræŒ¡ä½äº†æˆ‘ä»¬é¼ æ ‡çš„å°„çº¿ï¼Œè¿™é‡ŒæŠŠå®ƒçš„å¤§å°æ”¹ä¸€ä¸‹å°±è¡Œäº†</p><img src="https://i.loli.net/2021/08/02/LHvS6JN4idPbQOA.png" style="zoom:80%;" /><p>ç»™ä¼ é€é—¨åŠ ä¸Š<code>Portal</code>çš„æ ‡ç­¾ï¼Œç„¶åå†å»<code>MouseManager.cs</code>ä¿®æ”¹ä¸€ä¸‹é¼ æ ‡çš„å›¾æ ·</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SetCursorTexture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">Ray</span> ray <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span><span class="token function">ScreenPointToRay</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span>mousePosition<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>Physics<span class="token punctuation">.</span><span class="token function">Raycast</span><span class="token punctuation">(</span>ray<span class="token punctuation">,</span><span class="token keyword">out</span> hitInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//TODO:åˆ‡æ¢é¼ æ ‡è´´å›¾</span><span class="token keyword">switch</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">case</span> <span class="token string">"Ground"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>åœ°é¢è¡Œèµ°çš„å›¾æ ‡Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>arrow<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">"Enemy"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>ç‚¹å‡»æ•Œäººçš„å›¾æ ‡Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>attack<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">"Portal"</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>ç‚¹å‡»ä¼ é€é—¨å›¾æ ‡Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>doorway<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">default</span><span class="token punctuation">:</span>Cursor<span class="token punctuation">.</span><span class="token function">SetCursor</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector2</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>CursorMode<span class="token punctuation">.</span>Auto<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//if</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> hitInfo<span class="token punctuation">.</span>collider <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Ground"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Portal"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ç‚¹å‡»ä¼ é€é—¨</span>OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç‚¹å‡»æ•Œäººä¼ é€’æ•Œäººçš„gameObject</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Attackable"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç¼–å†™ä¼ é€ç®¡ç†ä»£ç "><a href="#ç¼–å†™ä¼ é€ç®¡ç†ä»£ç " class="headerlink" title="ç¼–å†™ä¼ é€ç®¡ç†ä»£ç "></a>ç¼–å†™ä¼ é€ç®¡ç†ä»£ç </h1><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>SceneController.cs</code>ï¼Œä¹‹æ‰€ä»¥ä¸æ˜¯ç”¨Manageræ˜¯å› ä¸ºåœ¨Unityæœ‰ä¸ª<code>SceneManager</code>åŒåçš„æ–‡ä»¶å­˜åœ¨</p><img src="https://i.loli.net/2021/08/02/FLvOK3csbIP45Xz.png" style="zoom:80%;" /><p>æ³¨æ„æ­¤æ–‡ä»¶ç»§æ‰¿çš„æ˜¯<strong>å•ä¾‹æ¨¡å¼</strong>ç±»</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>SceneManagement</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>AI</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SceneController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Singleton<span class="token punctuation">&lt;</span>SceneController<span class="token punctuation">></span></span></span><span class="token punctuation">&#123;</span>    <span class="token class-name">GameObject</span> player<span class="token punctuation">;</span><span class="token comment">//ç©å®¶</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TransitiToDestination</span><span class="token punctuation">(</span><span class="token class-name">TransitionPoint</span> transitionPoint<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è€ƒè™‘æ˜¯åŒåœºæ™¯è¿˜æ˜¯ä¸åŒåœºæ™¯çš„ä¼ é€</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>transitionPoint<span class="token punctuation">.</span>transitionType<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> TransitionPoint<span class="token punctuation">.</span>TransitionType<span class="token punctuation">.</span>SameScene<span class="token punctuation">:</span>            <span class="token comment">//åŒåœºæ™¯å¯ä»¥ä¸ç”¨å¼‚æ­¥ï¼Œç›´æ¥ä¼ é€</span>            <span class="token comment">//è¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·å¾—å½“å‰æ´»åŠ¨çª—å£çš„åå­—</span>            <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">Transition</span><span class="token punctuation">(</span>SceneManager<span class="token punctuation">.</span><span class="token function">GetActiveScene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>transitionPoint<span class="token punctuation">.</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> TransitionPoint<span class="token punctuation">.</span>TransitionType<span class="token punctuation">.</span>DifferentScene<span class="token punctuation">:</span>            <span class="token comment">//ä¸åŒåœºæ™¯ï¼Œç”¨å¼‚æ­¥åŠ è½½çš„æ–¹å¼</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name">IEnumerator</span> <span class="token function">Transition</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sceneName<span class="token punctuation">,</span><span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å…ˆè·å¾—ç©å®¶çš„å¯¹è±¡</span>        player <span class="token operator">=</span> GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>        <span class="token comment">//è·å¾—ç›®çš„åœ°ä¼ é€é—¨å¯¹è±¡</span>        <span class="token class-name"><span class="token keyword">var</span></span> td <span class="token operator">=</span> <span class="token function">GetDestination</span><span class="token punctuation">(</span>destinationTag<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å…³é—­å¯¼èˆªç§»åŠ¨</span>        player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment">//è®¾ç½®å¯¹è±¡çš„åæ ‡å’Œæ—‹è½¬è§’åº¦</span>        player<span class="token punctuation">.</span>transform<span class="token punctuation">.</span><span class="token function">SetPositionAndRotation</span><span class="token punctuation">(</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>td<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ¢å¤å¯¼èˆªç§»åŠ¨</span>        player<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token return-type class-name">TransitionDestination</span> <span class="token function">GetDestination</span><span class="token punctuation">(</span><span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//é€šè¿‡ä¼ é€é—¨ç›®çš„åœ°çš„æ ‡ç­¾å¯»æ‰¾ç›®çš„åœ°ä¼ é€é—¨æ‰€åœ¨ä½ç½®</span>        <span class="token class-name"><span class="token keyword">var</span></span> entrances <span class="token operator">=</span> <span class="token generic-method"><span class="token function">FindObjectsOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TransitionDestination<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>entrances<span class="token punctuation">.</span>Length<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>entrances<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>destinationTag <span class="token operator">==</span> destinationTag<span class="token punctuation">)</span><span class="token comment">//ç›®çš„åœ°ä¼ é€é—¨æ ‡ç­¾åŒ¹é…çš„è¯</span>                <span class="token keyword">return</span> entrances<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦å¤–å½“æˆ‘ä»¬ç©å®¶åˆ°è¾¾ä¼ é€é—¨ï¼Œæˆ‘å¸Œæœ›å®ƒå¯ä»¥æŒ‰é”®è§¦å‘ä¼ é€çš„ï¼Œæ‰€ä»¥è¿™é‡Œå»åˆ°<code>TransitionPoint.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//è§¦å‘å™¨è®¾ç½®</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> canTrans<span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦è§¦å‘ä¼ é€</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKeyDown</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span>E<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> canTrans<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æŒ‰é”®è§¦å‘ä¼ é€</span>        SceneController<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">TransitiToDestination</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜æœ‰ä¸€ä¸ªå·¥ä½œå°±æ˜¯è¦æŠŠæˆ‘ä»¬çš„<code>TransitionDestination.cs</code>ä½œä¸ºç»„ä»¶æ·»åŠ åœ¨ä¼ é€é—¨å­å¯¹è±¡çš„ç‚¹ä¸Š</p><img src="https://i.loli.net/2021/08/02/3Jm9QXySOEiqdRF.png" style="zoom:80%;" /><img src="https://i.loli.net/2021/08/02/Hen9PBroRJYcFjp.png" style="zoom:80%;" /><p>è¿™ä¸ªç‚¹æ˜¯ç”¨æ¥è®¾ç½®å½“å‰çš„ç‚¹æ˜¯å±äºå“ªä¸€ä¸ªæ ‡ç­¾çš„ï¼Œæˆ‘ä»¬å°±æŠŠä¸€ä¸ªä¼ é€é—¨å½“åšå…¥å£è®¾ä¸º<code>ENTER</code>ï¼Œå¦ä¸€ä¸ªä¼ é€é—¨å½“åšç›®çš„åœ°è®¾ä¸º<code>A</code></p><p>å¦å¤–å»åˆ°ä¼ é€é—¨ä¸­ï¼Œç›®çš„åœ°ä¹Ÿè¦è¿›è¡Œå¯¹åº”çš„è®¾ç½®ï¼Œå…¥å£ä¼ é€é—¨çš„ç›®çš„åœ°æ˜¯<code>A</code>ï¼Œåè¿‡æ¥å¦å¤–ä¸€ä¸ªä¼ é€é—¨æƒ³è¿‡æ¥å°±è¦è®¾ç½®ç›®çš„åœ°ä¸º<code>ENTER</code></p><p><strong>æ³¨æ„</strong>ï¼šæˆ‘ä»¬æœ€å¥½ä¸è¦è®¾ç½®å¤šä¸ªåŒä¸€æ ‡ç­¾çš„ä¼ é€é—¨ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜</p><p>æœ€åï¼Œå»ºç«‹ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶æŠŠ<code>SceneController.cs</code>ä½œä¸ºç»„ä»¶é™„ä¸Šå»</p><img src="https://i.loli.net/2021/08/02/caN1CyLrJU76bnI.png" style="zoom:80%;" /><h1 id="Triggeræ— æ³•è§¦å‘é—®é¢˜"><a href="#Triggeræ— æ³•è§¦å‘é—®é¢˜" class="headerlink" title="Triggeræ— æ³•è§¦å‘é—®é¢˜"></a>Triggeræ— æ³•è§¦å‘é—®é¢˜</h1><p>å¦‚æœå‡½æ•°å†…çš„Triggeräº‹ä»¶æ²¡æœ‰è§¦å‘çš„è¯ï¼Œå¯èƒ½æ˜¯ç©å®¶ä¸Šæ²¡æœ‰æ·»åŠ é’¢ä½“çš„åŸå› ï¼ŒæŠŠé’¢ä½“æ·»åŠ åœ¨ä¸»åŠ¨ç¢°æ’çš„ç‰©ä½“ä¸Šï¼ˆè¿™é‡Œæ˜¯ç©å®¶ï¼‰ï¼Œç„¶åæŠŠä¼ é€é—¨å’Œç©å®¶çš„ç¢°æ’ä½“ç»„ä»¶ä¸­<code>IsTrigger</code>å‹¾é€‰ä¸Šå°±å¯ä»¥äº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™é‡Œæˆ‘ä»¬å®ç°åŒåœºæ™¯çš„ä¼ é€æ•ˆæœ&lt;/p&gt;
&lt;h1 id=&quot;è°ƒæ•´ä¼ é€é—¨&quot;&gt;&lt;a href=&quot;#è°ƒæ•´ä¼ é€é—¨&quot; class=&quot;headerlink&quot; title=&quot;è°ƒæ•´ä¼ é€é—¨&quot;&gt;&lt;/a&gt;è°ƒæ•´ä¼ é€é—¨&lt;/h1&gt;&lt;p&gt;åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¦æŠŠä¸åŒçš„ä¼ é€é—¨æ‘†æ”¾å¥½å…ˆ&lt;/p&gt;
&lt;p&gt;å¦å¤–æˆ‘ä»¬å¯èƒ½ä¼šå‘ç°</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°25-åˆ¶ä½œä¼ é€é—¨</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B025-%E5%88%B6%E4%BD%9C%E4%BC%A0%E9%80%81%E9%97%A8/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B025-%E5%88%B6%E4%BD%9C%E4%BC%A0%E9%80%81%E9%97%A8/</id>
    <published>2021-08-01T01:53:22.000Z</published>
    <updated>2021-08-01T03:53:51.612Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬è¿™ä¸€ç« æ¥åˆ¶ä½œä¸€ä¸ªä¼ é€é—¨ä»¥ä¾›åé¢ç©å®¶åˆ‡æ¢ä¸åŒåœºæ™¯æ—¶ä½¿ç”¨</p><h1 id="åˆ¶ä½œä¼ é€é—¨Shader"><a href="#åˆ¶ä½œä¼ é€é—¨Shader" class="headerlink" title="åˆ¶ä½œä¼ é€é—¨Shader"></a>åˆ¶ä½œä¼ é€é—¨Shader</h1><p>é¦–å…ˆå°±æ˜¯è¦æ¥åˆ¶ä½œä¼ é€é—¨çš„Shaderï¼Œæ–°å»ºä¸€ä¸ª<code>Lit Shader Graph</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰å…‰å½±å“çš„shaderï¼Œèœå•ä¸­è¿˜æœ‰ä¸€ä¸ªå«åšUnlit Shader Graphå°±æ˜¯æ²¡æœ‰å…‰å½±å“çš„</p><p>è¿™é‡Œå»ºå¥½åèµ·åä¸º<code>Portal Shader</code></p><img src="https://i.loli.net/2021/08/01/pd7nMhKZHVBm4ar.png" style="zoom:80%;" /><p>æ³¨æ„é‡Œè¾¹çš„è®¾ç½®ï¼ŒSurfaceé€‰æ‹©<code>Transparent</code>å°±æ˜¯æœ‰é€æ˜é€šé“çš„æ„æ€ï¼Œç„¶åå‹¾é€‰<code>Two Sided</code>æ˜¾ç¤ºä¸¤é¢</p><img src="https://i.loli.net/2021/08/01/k7eZSNDKwTt2Y43.png" style="zoom:80%;" /><p>è¿™é‡Œç›´æ¥ä¸Šåšå¥½çš„å›¾ï¼Œé¢œè‰²çš„å±æ€§é¢æ¿ä¸­æ³¨æ„è¦é€‰æ‹©<code>HDR</code></p><img src="https://i.loli.net/2021/08/01/nwoQLuWKhYSR8lp.png" style="zoom:80%;" /><p>åšå¥½åç‚¹å‡»å·¦ä¸Šè§’<code>Save Asset</code>ä¿å­˜ï¼Œç„¶åå³é”®<code>Shder Graph</code>åˆ›å»ºä¸ºä¸€ä¸ª<code>Materials</code></p><img src="https://i.loli.net/2021/08/01/ecxz9EY5KfGgMOq.png" style="zoom:80%;" /><p>è¿™æ ·ä¸€ä¸ªä¼ é€é—¨çš„Shaderå°±åˆ›å»ºå¥½äº†</p><h1 id="åˆ¶ä½œä¼ é€é—¨"><a href="#åˆ¶ä½œä¼ é€é—¨" class="headerlink" title="åˆ¶ä½œä¼ é€é—¨"></a>åˆ¶ä½œä¼ é€é—¨</h1><p>å›åˆ°åœ°å›¾ä¸Šï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>Quad</code></p><img src="https://i.loli.net/2021/08/01/1ULfhYbuIgzD529.png" style="zoom:80%;" /><p>ç„¶åæŠŠåˆšåˆšçš„ä¼ é€é—¨æè´¨é™„ä¸Šå»ï¼Œç„¶åå°±å¯ä»¥çœ‹åˆ°ä¼ é€é—¨çš„é›å½¢äº†</p><img src="https://i.loli.net/2021/08/01/oGMurVFip1O8sjA.png" style="zoom:80%;" /><p>ä¹‹åå¯ä»¥åˆ›å»ºä¸€ä¸ªå­å¯¹è±¡ï¼Œè¡¨ç¤ºä¼ é€ç‚¹ï¼Œä»¥åå½“ç©å®¶è§¦ç¢°è¿™ä¸ªç‚¹ä¾¿å¯ä»¥è§¦å‘ä¼ é€äº‹ä»¶</p><img src="https://i.loli.net/2021/08/01/z65KBjWylxAvGIo.png" style="zoom:80%;" /><p>å¦‚å›¾æˆ‘è¿˜å°†è¿™ä¸ªç‚¹é™„ä¸Šäº†ä¸€ä¸ªè“è‰²å›¾æ ‡ï¼Œä»£è¡¨è¿™ä¸¤ä¸ªä¼ é€é—¨æ˜¯äº’é€šçš„ï¼Œä¸€å¯¹çš„ï¼Œå¯ä»¥èµ·åˆ°ä¸€ä¸ªæ ‡è®°ä½œç”¨</p><h1 id="ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç "><a href="#ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç " class="headerlink" title="ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç "></a>ç¼–å†™ä¼ é€é—¨åŸºæœ¬ä»£ç </h1><p>è¿™é‡Œç¼–å†™ä¸€ä¸‹åŸºæœ¬çš„ä¼ é€é—¨ä»£ç ï¼Œè¯¦ç»†çš„ä»£ç å®Œå–„ç•™åœ¨ä¸‹ä¸€ç« èŠ‚</p><img src="https://i.loli.net/2021/08/01/aVGXZyRzq36d8pt.png" style="zoom:80%;" /><p>è¿™é‡Œçš„<code>TransitionPoint</code>æŒ‚è½½åœ¨ä¼ é€é—¨ä¸Šï¼Œè€Œ<code>TransitionDestination</code>æŒ‚è½½åœ¨è“è‰²çš„ç‚¹ä¸Š</p><p>æˆ‘ä»¬å…ˆæ¥ç¼–è¾‘TransitionPoint.cs</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//TransitionPoint.cs</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransitionPoint</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">TransitionType</span><span class="token punctuation">&#123;</span><span class="token comment">//ä¼ é€çŠ¶æ€</span>        SameScene<span class="token punctuation">,</span>DifferentScene    <span class="token punctuation">&#125;</span>        <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Transition Infoï¼ˆä¼ é€é—¨è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> sceneName<span class="token punctuation">;</span><span class="token comment">//è®°å½•åœºæ™¯åç§°</span>    <span class="token keyword">public</span> <span class="token class-name">TransitionType</span> transitionType<span class="token punctuation">;</span><span class="token comment">//è®°å½•ä¼ é€çŠ¶æ€ï¼ŒåŒåœºæ™¯ä¼ é€å°±å¤–è¾¹é€‰æ‹©ç¬¬ä¸€ä¸ªï¼Œä¸åŒåœºæ™¯å°±é€‰æ‹©ç¬¬äºŒä¸ª</span>    <span class="token keyword">public</span> <span class="token class-name">TransitionDestination<span class="token punctuation">.</span>DestinationTag</span> destinationTag<span class="token punctuation">;</span><span class="token comment">//ä¼ é€ç‚¹ç›®çš„åœ°</span>    <span class="token comment">//è§¦å‘å™¨è®¾ç½®</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> canTrans<span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦è§¦å‘ä¼ é€</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerStay</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ç©å®¶åœ¨ä¼ é€é—¨åŒºåŸŸå†…</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            canTrans <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnTriggerExit</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//ç©å®¶ç¦»å¼€äº†ä¼ é€é—¨åŒºåŸŸ</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            canTrans <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ä¼ é€ç‚¹ç›®çš„åœ°å¯¹åº”çš„åœ¨TransitionDestination.csä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//TransitionDestination.cs</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransitionDestination</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">DestinationTag</span><span class="token punctuation">&#123;</span><span class="token comment">//ä¼ é€ç‚¹æ ‡ç­¾</span>        ENTER<span class="token punctuation">,</span>A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">DestinationTag</span> destinationTag<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œçš„A,B,Cå¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼Œè¡¨ç¤ºçš„æ˜¯ä¸åŒä¼ é€é—¨ä¸­çš„ä¸åŒåœ°æ–¹ï¼Œç±»ä¼¼äºä¸€ä¸ªç«™ç‰Œ</p><p>æˆ‘ä»¬è¿˜æ³¨æ„åˆ°åœ¨å‰é¢<code>TransitionPoint.cs</code>ä¸­æœ‰è§¦å‘çš„ä»£ç ï¼Œè¿™é‡Œè¦åˆ°Unityå±æ€§é¢æ¿ä¸­æŠŠè§¦å‘<code>isTrigger</code>é€‰é¡¹å‹¾ä¸Šï¼Œå¦åˆ™ä¸èƒ½è§¦å‘<code>OnTriggerStay()</code>å’Œ<code>OnTriggerExit()</code>æ–¹æ³•</p><img src="https://i.loli.net/2021/08/01/G7DPlvBtNd5Lw9Y.png" style="zoom:80%;" /><p>å½“ç„¶ï¼Œç°åœ¨ç”¨åˆ°çš„æ˜¯<code>Mesh Collider</code>ï¼Œè¿™é‡Œè§¦å‘é¢ç§¯åªæ˜¯ä¸€ä¸ªå¹³é¢ï¼Œæˆ‘ä»¬å¯ä»¥æ¢æˆ<code>Box Collider</code>ï¼Œè®©å®ƒçš„è§¦å‘é¢ç§¯æ›´å¤§ä¸€äº›</p><img src="https://i.loli.net/2021/08/01/mPRClNHWdA6jufi.png" style="zoom:80%;" /><p>å¼„å¥½è¿™äº›åï¼Œè®°å¾—æŠŠä¼ é€é—¨ä¿å­˜ä¸ºä¸€ä¸ªç´ æ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æˆ‘ä»¬è¿™ä¸€ç« æ¥åˆ¶ä½œä¸€ä¸ªä¼ é€é—¨ä»¥ä¾›åé¢ç©å®¶åˆ‡æ¢ä¸åŒåœºæ™¯æ—¶ä½¿ç”¨&lt;/p&gt;
&lt;h1 id=&quot;åˆ¶ä½œä¼ é€é—¨Shader&quot;&gt;&lt;a href=&quot;#åˆ¶ä½œä¼ é€é—¨Shader&quot; class=&quot;headerlink&quot; title=&quot;åˆ¶ä½œä¼ é€é—¨Shader&quot;&gt;&lt;/a&gt;åˆ¶ä½œä¼ é€é—¨Shader&lt;/h1&gt;&lt;</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°24-åˆ¶ä½œç©å®¶çŠ¶æ€æ¡</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B024-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%8A%B6%E6%80%81%E6%9D%A1/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B024-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%8A%B6%E6%80%81%E6%9D%A1/</id>
    <published>2021-07-31T02:35:09.000Z</published>
    <updated>2021-07-31T03:56:36.736Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬ç« æ¥åˆ¶ä½œç©å®¶çš„çŠ¶æ€æ¡ï¼Œå¦‚è¡€é‡æ¡ï¼Œç»éªŒæ¡ç­‰</p><h1 id="ç¼–è¾‘UIå¸ƒå±€"><a href="#ç¼–è¾‘UIå¸ƒå±€" class="headerlink" title="ç¼–è¾‘UIå¸ƒå±€"></a>ç¼–è¾‘UIå¸ƒå±€</h1><p>ç¬¬ä¸€æ­¥ä¹Ÿæ˜¯å»ºç«‹ä¸€ä¸ªç”»å¸ƒï¼Œæ¨¡å¼ä½¿ç”¨é»˜è®¤çš„<code>Screen Space</code>è¦†ç›–å±å¹•</p><p>å€¼å¾—æ³¨æ„æ˜¯ä¸ºäº†ä½¿çŠ¶æ€æ¡å¯ä»¥éšç€å±å¹•çš„åˆ†è¾¨ç‡å¤§å°è€Œåˆ‡æ¢ï¼Œæˆ‘ä»¬çš„<code>UI Scale Mode</code>è¦è®¾ç½®æˆ<code>Scale With Scree</code></p><img src="https://www.hualigs.cn/image/6104bb2a28b1d.jpg" style="zoom:80%;" /><p>ä¹‹ååˆ›å»ºå¥½UIï¼Œå¯ä»¥åœ¨<code>Scene</code>è§†å›¾çš„2Dæ¨¡å¼ä¸‹è°ƒæ•´åˆ°åˆé€‚çš„ä½ç½®ï¼Œç„¶ååœ¨<code>Game</code>è§†å›¾ä¸‹é¢„è§ˆæ•ˆæœï¼Œå¯ä»¥è‡ªè¡Œå¤šå¤šå°è¯•</p><p>æœ€åçš„æ•ˆæœå¦‚ä¸‹</p><img src="https://i.loli.net/2021/07/31/xh2a6d1GFWIAQB3.png" style="zoom:80%;" /><p>æ³¨æ„è¿™é‡Œçš„æ–‡å­—æˆ‘ç”¨äº†è‡ªå®šä¹‰çš„å­—ä½“ï¼Œåœ¨Unityä¸­åªç”¨æŠŠä½ æƒ³è¦ç”¨çš„ç‰©ä½“æ‹–æ‹½è¿›æ¥åˆ†ç±»å¥½ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨æ–‡å­—UIè®¾ç½®é¢æ¿ä¸Šé€‰æ‹©ä½¿ç”¨äº†</p><h1 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h1><p>æ¥ä¸‹æ¥å°±æ˜¯ç¼–å†™ä»£ç æ¥ç®¡ç†æˆ‘ä»¬çš„UIäº†</p><img src="https://i.loli.net/2021/07/31/WEluxrQkRazFKf5.png" style="zoom:80%;" /><p>ç„¶åæŠŠä»£ç ä½œä¸ºç»„ä»¶æ·»åŠ åˆ°ä¸Šé¢åˆ›å»ºçš„ç”»å¸ƒå½“ä¸­ï¼Œæ¥ç€å°±æ˜¯ç¼–å†™ä»£ç äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span><span class="token keyword">using</span> <span class="token namespace">UnityEngine<span class="token punctuation">.</span>UI</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlayerHealthUI</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç”±äºæˆ‘ä»¬çš„äººç‰©ä¿¡æ¯æ æœ€ç»ˆä¼šä¿å­˜ä¸ºä¸€ä¸ªprefab</span>    <span class="token comment">//å› æ­¤æˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨æ‹–æ‹½gameobjectæ–¹å¼æ¥è·å¾—å¯¹è±¡</span>    <span class="token comment">//å¯ä»¥ç›´æ¥ä½¿ç”¨è·å¾—å¯¹è±¡çš„å­å¯¹è±¡æ–¹å¼</span>    <span class="token class-name">Text</span> levelText<span class="token punctuation">;</span><span class="token comment">//è·å¾—textæ–‡æœ¬</span>    <span class="token class-name">Image</span> healthSlider<span class="token punctuation">;</span><span class="token comment">//ç”Ÿå‘½å€¼æ‹–æ‹½æ¡</span>    <span class="token class-name">Image</span> expSlider<span class="token punctuation">;</span><span class="token comment">//ç»éªŒæ‹–æ‹½æ¡</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ³¨æ„GetChildå¡«å†™çš„å‚æ•°ç±»ä¼¼äºæ•°ç»„ä¸‹æ ‡ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡çš„ç´¢å¼•æ˜¯0</span>        levelText <span class="token operator">=</span> transform<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Text<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å¾—æ–‡å­—å¯¹è±¡</span>        healthSlider <span class="token operator">=</span> transform<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Image<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å¾—ç”Ÿå‘½æ‹–æ‹½æ¡</span>        expSlider <span class="token operator">=</span> transform<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Image<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å¾—ç»éªŒå€¼æ‹–æ‹½æ¡</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">UpdateExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">UpdateHealth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        levelText<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"Level  "</span> <span class="token operator">+</span>             GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>currentLevel<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//00æ˜¯è§„å®šç»™å®ƒçš„ä¸€ä¸ªæ ¼å¼ï¼Œæ¯”å¦‚01 02....</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateHealth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¯ä»¥é€šè¿‡GameManagerç±»æ¥è·å¾—playerçš„states</span>        <span class="token class-name"><span class="token keyword">float</span></span> sliderPercent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>currentHealth<span class="token operator">/</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>MaxHealth<span class="token punctuation">;</span>        <span class="token comment">//æ›´æ–°å›¾ç‰‡å¡«å……</span>        healthSlider<span class="token punctuation">.</span>fillAmount <span class="token operator">=</span> sliderPercent<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">float</span></span> sliderPercent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>currentExp<span class="token operator">/</span>            GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>baseExp<span class="token punctuation">;</span>        <span class="token comment">//æ›´æ–°å›¾ç‰‡å¡«å……</span>        expSlider<span class="token punctuation">.</span>fillAmount <span class="token operator">=</span> sliderPercent<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ˜¯å€ŸåŠ©äº†<code>GameManager.cs</code>ä¸­çš„å•ä¾‹æ¨¡å¼å®ä¾‹åŒ–çš„æ–¹å¼æ¥è·å¾—playerçš„çŠ¶æ€ä¿¡æ¯ï¼Œå› ä¸ºå…ˆå‰æˆ‘ç”¨äº†å¤–ç•Œæ³¨å†Œçš„æ–¹å¼æŠŠç©å®¶çš„ä¿¡æ¯èµ‹äºˆäº†GameManageré‡Œé¢çš„æˆå‘˜å˜é‡</p><p>åˆ°è¿™æˆ‘ä»¬å°±å¤§åŠŸå‘Šæˆäº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ¬ç« æ¥åˆ¶ä½œç©å®¶çš„çŠ¶æ€æ¡ï¼Œå¦‚è¡€é‡æ¡ï¼Œç»éªŒæ¡ç­‰&lt;/p&gt;
&lt;h1 id=&quot;ç¼–è¾‘UIå¸ƒå±€&quot;&gt;&lt;a href=&quot;#ç¼–è¾‘UIå¸ƒå±€&quot; class=&quot;headerlink&quot; title=&quot;ç¼–è¾‘UIå¸ƒå±€&quot;&gt;&lt;/a&gt;ç¼–è¾‘UIå¸ƒå±€&lt;/h1&gt;&lt;p&gt;ç¬¬ä¸€æ­¥ä¹Ÿæ˜¯å»ºç«‹ä¸€ä¸ªç”»å¸ƒï¼Œæ¨¡å¼ä½¿ç”¨é»˜è®¤çš„&lt;code&gt;</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°23-åˆ¶ä½œç©å®¶çš„å‡çº§</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B023-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%9A%84%E5%8D%87%E7%BA%A7/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B023-%E5%88%B6%E4%BD%9C%E7%8E%A9%E5%AE%B6%E7%9A%84%E5%8D%87%E7%BA%A7/</id>
    <published>2021-07-30T02:05:51.000Z</published>
    <updated>2021-07-31T04:10:05.890Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æœ¬ç« ä¸­æˆ‘ä»¬æ¥åˆ¶ä½œç©å®¶çš„ç»éªŒç³»ç»Ÿï¼Œå¹¶é™„æœ‰å‡çº§åŠŸèƒ½</p><h1 id="æ‰©å±•CharacterData-SO"><a href="#æ‰©å±•CharacterData-SO" class="headerlink" title="æ‰©å±•CharacterData_SO"></a>æ‰©å±•CharacterData_SO</h1><p>æˆ‘ä»¬é¦–å…ˆæ‰“å¼€<code>CharacterData_SO.cs</code>æ·»åŠ ä¸€äº›é¢å¤–çš„å±æ€§è¿›å»ï¼ŒåŒæ—¶å†™ä¸€ä¸ªå‡çº§æ—¶å¤„ç†çš„æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CreateAssetMenu</span><span class="token attribute-arguments"><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Character States/Data"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharacterData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"States Infoï¼ˆå±æ€§ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> maxHealth<span class="token punctuation">;</span><span class="token comment">//æœ€å¤§ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentHealth<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> baseDefence<span class="token punctuation">;</span><span class="token comment">//åŸºç¡€é˜²å¾¡å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentDefence<span class="token punctuation">;</span><span class="token comment">//å½“å‰é˜²å¾¡å€¼</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Killï¼ˆå‡»æ€ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> killPoint<span class="token punctuation">;</span><span class="token comment">//å‡»æ€åæ‰è½çš„ç»éªŒå€¼</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Levelï¼ˆç­‰çº§ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentLevel<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç­‰çº§</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> maxLevel<span class="token punctuation">;</span><span class="token comment">//æœ€å¤§ç­‰çº§æ•°</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> baseExp<span class="token punctuation">;</span><span class="token comment">//åŸºç¡€ç»éªŒå€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentExp<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç»éªŒå€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> levelBuff<span class="token punctuation">;</span><span class="token comment">//æ¯æ¬¡å‡çº§æ•´ä½“å±æ€§æå‡çš„ç™¾åˆ†æ¯”</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">float</span></span> LevelMultiplier<span class="token punctuation">&#123;</span>        <span class="token comment">//å‡çº§æå‡å±æ€§åŠ çš„å€ç‡</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>currentLevel<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> levelBuff<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateExp</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> point<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        currentExp <span class="token operator">+=</span> point<span class="token punctuation">;</span><span class="token comment">//æŠŠå¤–ç•Œçš„ç»éªŒåŠ è¿›æ¥</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>currentExp <span class="token operator">>=</span> baseExp<span class="token punctuation">)</span>            <span class="token function">LevelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LevelUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿™ä¸ªæ–¹æ³•ä¸­æ·»åŠ å‡çº§æ—¶æƒ³æå‡çš„æ•°æ®</span>        <span class="token comment">//å°†current+1é™åˆ¶åœ¨[0,maxLevel]é—­åŒºé—´ä¸­</span>        currentLevel <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Clamp</span><span class="token punctuation">(</span>currentLevel<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>maxLevel<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†ç»éªŒå’Œç”Ÿå‘½å€¼æŒ‰ç…§æ¯ä¸€ç­‰çº§ä¸åŒå€ç‡å¢é•¿ï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨å›ºå®šå€¼level buffï¼‰</span>        baseExp <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>baseExp<span class="token operator">*</span>LevelMultiplier<span class="token punctuation">)</span><span class="token punctuation">;</span>        maxHealth <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>maxHealth <span class="token operator">*</span> LevelMultiplier<span class="token punctuation">)</span><span class="token punctuation">;</span>        currentHealth <span class="token operator">=</span> maxHealth<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€å†å»åˆ°<code>CharacterStates.cs</code>åšæœ€åçš„ä¿®æ”¹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharacterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³æ•°å€¼</span>    <span class="token comment">//å½“å‰æ”»å‡»åŠ›å‡å»ç›®æ ‡çš„é˜²å¾¡åŠ›ï¼Œå¦‚æœé˜²å¾¡åŠ›è¿‡é«˜å°±æ˜¯0ä¼¤å®³</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡ä¹Ÿæ˜¯æœ€å°å€¼é”åœ¨0</span>    Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"&#123;0&#125;æ”»å‡»äº†&#123;1&#125;ï¼Œé€ æˆäº†&#123;2&#125;ç‚¹ä¼¤å®³"</span><span class="token punctuation">,</span>attacker<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>defener<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>damage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­è¢«æ‰“è€…æ˜¯å¦å—åˆ°æš´å‡»å¹¶ä¸”æ’­æ”¾å—ä¼¤åŠ¨ç”»</span>        defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å°†æ¥è¦åšçš„äº‹æƒ…</span>    <span class="token comment">//è¡€é‡æ¡UI</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span>    <span class="token comment">//æ‰“æ­»æ€ªååŠ ç»éªŒ</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>        attacker<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span><span class="token function">UpdateExp</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>killPoint<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//çŸ³å¤´åå‡»çŸ³å¤´äººçš„æ”»å‡»æ–¹å¼</span>    <span class="token class-name"><span class="token keyword">int</span></span> dam <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>damage <span class="token operator">-</span> defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    defener<span class="token punctuation">.</span>currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">-</span> dam<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¡€æ¡äº‹ä»¶</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span>    <span class="token comment">//TODO:åŠ ç»éªŒ</span>    <span class="token comment">//å¯ä»¥é€šè¿‡GameManageræ¥è®¿é—®ç©å®¶çš„å±æ€§</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>    GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span>playerStates<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span><span class="token function">UpdateExp</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>characterData<span class="token punctuation">.</span>killPoint<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åæˆ‘ä»¬å»åˆ°äººç‰©çš„<code>PlayerData</code>è¿˜æœ‰æ¯ä¸ªæ•Œäººçš„<code>Data</code>æ·»åŠ å±æ€§å°±å¯ä»¥äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/bc33680758884eb88e5bfed71402eaa5.png" alt="1.png" style="zoom:80%;" />]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åœ¨æœ¬ç« ä¸­æˆ‘ä»¬æ¥åˆ¶ä½œç©å®¶çš„ç»éªŒç³»ç»Ÿï¼Œå¹¶é™„æœ‰å‡çº§åŠŸèƒ½&lt;/p&gt;
&lt;h1 id=&quot;æ‰©å±•CharacterData-SO&quot;&gt;&lt;a href=&quot;#æ‰©å±•CharacterData-SO&quot; class=&quot;headerlink&quot; title=&quot;æ‰©å±•CharacterData_SO&quot;&gt;&lt;/a&gt;</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°22-åˆ¶ä½œè¡€é‡æ¡UI</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B022-%E5%88%B6%E4%BD%9C%E8%A1%80%E9%87%8F%E6%9D%A1UI/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B022-%E5%88%B6%E4%BD%9C%E8%A1%80%E9%87%8F%E6%9D%A1UI/</id>
    <published>2021-07-29T01:28:59.000Z</published>
    <updated>2021-07-29T10:01:08.942Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬æ¥åˆ¶ä½œä¸€ä¸‹æ•Œäººçš„è¡€é‡æ¡</p><h1 id="åˆ›å»ºè¡€æ¡UI"><a href="#åˆ›å»ºè¡€æ¡UI" class="headerlink" title="åˆ›å»ºè¡€æ¡UI"></a>åˆ›å»ºè¡€æ¡UI</h1><h2 id="åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰"><a href="#åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰" class="headerlink" title="åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰"></a>åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰</h2><p>é¦–å…ˆåœ¨<code>Hierachy</code>çª—å£ä¸­åˆ›å»ºä¸€ä¸ª<code>Canvas</code>ï¼ˆç”»å¸ƒï¼‰ï¼Œå¹¶å°†å®ƒå‘½åä¸º<code>HealthBarCanvas</code></p><img src="https://p26-tt.byteimg.com/origin/pgc-image/a4bddbb255de4c87825a7866dd064269.png" alt="1.png" style="zoom:80%;" /><p>ä¹‹åæˆ‘ä»¬æ”¹ä¸€ä¸‹<code>HealthBarCanvas</code>è®¾ç½®ï¼Œå¹¶æŠŠåæ ‡é‡ç½®</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/7c8fa921e76f4decb29167a49ad882f1.png" alt="2.png" style="zoom:80%;" /><p>éšåæˆ‘ä»¬åœ¨è¿™ä¸ªç”»å¸ƒçš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ª<code>Image</code>ï¼Œå¹¶å°†å®ƒå‘½åä¸º<code>Bar Holder</code>ï¼Œç„¶ååœ¨æŠŠå®ƒçš„åæ ‡æ”¹ä¸€ä¸‹ï¼Œæ”¹æˆåƒä¸€ä¸ªè¡€æ¡çš„å¤§å°</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/48339de2f8e6417f94b09466da3b7428.png" alt="3.png" style="zoom:80%;" /><p>æˆ‘ä»¬å°±å¯ä»¥åœ¨Sceneçª—å£ä¸Šçœ‹åˆ°è¡€æ¡çš„åˆå§‹æ ·å­äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/ccf344e88ab44a2e92fc6563d1339523.png" alt="4.png" style="zoom:80%;" /><h2 id="åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource-Imageï¼‰"><a href="#åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource-Imageï¼‰" class="headerlink" title="åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource Imageï¼‰"></a>åˆ›å»ºè¡€æ¡åº•å±‚å›¾åƒï¼ˆSource Imageï¼‰</h2><p>æ¥ç€æˆ‘ä»¬è¦ä¸º<code>Bar Holder</code>å¯¼å…¥ä¸€ä¸ª<code>Source Image</code>ä½œä¸ºè¡€æ¡çš„åº•å±‚ï¼Œè¿™é‡Œå°±é€‰æ‹©è‡ªå·±åˆ›å»ºä¸€ä¸ªå›¾åƒä½œä¸ºå®ƒçš„åº•å±‚</p><p>é¦–å…ˆè¦æ‰“å¼€<code>Package Manager</code>å®‰è£…ä¸€ä¸‹<code>2D Sprite</code></p><img src="https://p26-tt.byteimg.com/origin/pgc-image/7c103cd1256d4e5cb07ed10165846528.png" alt="5.png" style="zoom:80%;" /><p>æ¥ç€æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè·¯å¾„ä¸“é—¨å­˜æ”¾UIç›¸å…³çš„å¯¹è±¡ï¼Œè¿™é‡Œåˆ›å»ºä¸€ä¸ª<code>Square</code>æ–¹å½¢å›¾åƒ</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/73d842b512f940698760bf2547bbf82c.png" alt="6.png" style="zoom:80%;" /><p>å†æŠŠè¿™ä¸ªæ–¹å½¢å›¾åƒåº”ç”¨åœ¨åˆšåˆšçš„<code>Source Image</code>ä¸­å°±è¡Œäº†</p><p>ç”±äºç°åœ¨æˆ‘ä»¬åˆ›å»ºå‡ºæ¥çš„æ˜¯ä¸€ä¸ªè¡€æ¡çš„åº•å±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠå®ƒçš„é¢œè‰²è®¾ç½®ä¸ºçº¢è‰²åº•ï¼Œå¾…ä¼šæœ‰ä¸ªä¸Šå±‚å›¾åƒè®¾ç½®æˆç»¿è‰²ï¼Œè¿™æ ·å¼„å‡ºæ¥å°±æœ‰è¡€æ¡çš„æ ·å­äº†</p><p>å› æ­¤æˆ‘ä»¬è¿™é‡ŒæŠŠé¢œè‰²æ”¹ä¸ºçº¢è‰²ï¼ˆè¿™é‡Œæˆ‘æŠŠé¢œè‰²çš„é€æ˜åº¦æ”¹æˆäº† 150 ï¼‰</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/9d082235f7dc478ca60891914aaa2de1.png" alt="7.png" style="zoom:80%;" /><h2 id="åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ"><a href="#åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ" class="headerlink" title="åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ"></a>åˆ›å»ºè¡€æ¡ä¸Šå±‚å›¾åƒ</h2><p>æˆ‘ä»¬åœ¨<code>Bar Holder</code>çš„åŸºç¡€ä¸Šå†åˆ›å»ºä¸€ä¸ªå›¾åƒ<code>Image</code>ï¼Œå‘½åä¸º<code>Current Health</code>ï¼Œå¹¶å°†å®½åº¦å’Œé«˜åº¦è®¾ç½®æˆå’Œåº•å±‚ä¸€æ ·ï¼ˆ2.5å’Œ0.25ï¼‰</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/13abb2c92ea14215973e66d999182fa4.png" alt="8.png" style="zoom:80%;" /><p>åŒæ—¶<code>Source Image</code>è¿˜æ˜¯å’Œåˆšåˆšä¸€æ ·ï¼Œé¢œè‰²è°ƒä¸ºç»¿è‰²</p><p>å”¯ä¸€ä¸åŒçš„æ˜¯å›¾ç‰‡çš„ç±»å‹<code>Image Type</code>è¦è°ƒä¸º<strong>å¡«å……</strong><code>Filled</code>ï¼Œå¡«å……çš„æ–¹å¼ä¸º<strong>æ°´å¹³å¡«å……</strong><code>Horizontal</code>ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è°ƒèŠ‚å¡«å……æ•°é‡<code>Fill Amount</code>æ¥æ§åˆ¶ç»¿è‰²æ¡çš„é•¿åº¦ï¼Œä»è€Œä»£è¡¨è¡€é‡çš„å¤šå°‘äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/f5d505bfb9e74b98a2e2ffdaa4b81b15.png" alt="9.png" style="zoom:80%;" /><p>æ•ˆæœå›¾å¦‚ä¸‹</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/72681600544d4713a09b34e971078333.png" alt="10.png" style="zoom:80%;" /><p>è¿™æ ·ä¸€ä¸ªç®€é™‹çš„è¡€æ¡å°±å¼„å¥½äº†ï¼Œæˆ‘ä»¬å°†å®ƒä¿å­˜ä¸ºä¸€ä¸ªç´ æ</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/7d681c103df74db1921f9235c27f02e1.png" alt="11.png" style="zoom:80%;" /><h2 id="è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®"><a href="#è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®" class="headerlink" title="è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®"></a>è®¾ç½®è¡€æ¡åœ¨æ•Œäººä¸Šæ–¹çš„ä½ç½®</h2><p>ç”±äºæˆ‘ä»¬æ¯ä¸ªæ•Œäººé«˜çŸ®ä¸åŒï¼Œå°±å¯¼è‡´äº†è¡€æ¡åœ¨ä¸åŒæ•Œäººçš„ä½ç½®ä¹Ÿä¸ä¸€æ ·ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬åé¢çš„ä»£ç ï¼Œè¿™é‡Œæˆ‘ä»¬è¦ä¸ºæ¯ä¸ªæ•Œäººè®¾ç½®ä¸€ä¸‹è¡€æ¡åº”è¯¥å‡ºç°çš„ä½ç½®</p><p>æœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯ä¸ºæ¯ä¸ªæ•Œäººå¯¹è±¡å†åˆ›å»ºä¸€ä¸ªå­å¯¹è±¡æ¥è®°å½•è¡€æ¡ä½ç½®</p><p>æˆ‘ä»¬æ‰“å¼€<code>Prefabs ---&gt; Characters</code>ç›®å½•ç¼–è¾‘æ•Œäººç´ æï¼Œè¿™é‡Œæ‹¿å²è±å§†ä¸ºä¾‹å­</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/a4ed16108baa4e62a2c591cb1d263eb6.png" alt="13.png" style="zoom:80%;" /><p>åƒä¸Šé¢å›¾ç‰‡è¿™æ ·ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>HealthBar Point</code>çš„ç©ºå¯¹è±¡æ¥è®°å½•è¡€æ¡çš„ä½ç½®ï¼Œè¿™æ ·å°±å¾ˆæ–¹ä¾¿æˆ‘ä»¬ä»£ç çš„ç¼–å†™äº†</p><p>æœ€åæŒ‰ç…§åŒæ ·çš„æ–¹å¼ç»™æ¯ä¸ªæ•Œäººéƒ½å®‰æ”¾<code>HealthBar Point</code></p><h1 id="ç¼–å†™è¡€æ¡ä»£ç "><a href="#ç¼–å†™è¡€æ¡ä»£ç " class="headerlink" title="ç¼–å†™è¡€æ¡ä»£ç "></a>ç¼–å†™è¡€æ¡ä»£ç </h1><h2 id="åˆ›å»ºäº‹ä»¶"><a href="#åˆ›å»ºäº‹ä»¶" class="headerlink" title="åˆ›å»ºäº‹ä»¶"></a>åˆ›å»ºäº‹ä»¶</h2><p>åœ¨åˆ›å»ºè¡€æ¡ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆåœ¨<code>CharacterStates.cs</code>ä¸­åˆ›å»ºä¸€ä¸ªäº‹ä»¶ï¼Œå³åœ¨é€ æˆä¼¤å®³æ—¶è¦è§¦å‘çš„è¡€æ¡å˜åŠ¨äº‹ä»¶</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//é€ æˆä¼¤å®³æ—¶è¡€æ¡æ”¹å˜çš„äº‹ä»¶</span><span class="token keyword">public</span> <span class="token keyword">event</span> <span class="token class-name">Action<span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token punctuation">></span></span> UpdateHealthBarOnAttack<span class="token punctuation">;</span><span class="token comment">//åœ¨é€ æˆä¼¤å®³æ—¶è°ƒç”¨</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharacterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"&#123;0&#125;æ”»å‡»äº†&#123;1&#125;ï¼Œé€ æˆäº†&#123;2&#125;ç‚¹ä¼¤å®³"</span><span class="token punctuation">,</span>attacker<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>defener<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">,</span>damage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span>        defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//TODO:è¡€é‡æ¡UI</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">int</span></span> dam <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>damage <span class="token operator">-</span> defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    defener<span class="token punctuation">.</span>currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">-</span> dam<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¡€æ¡äº‹ä»¶</span>    UpdateHealthBarOnAttack<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>currentHealth<span class="token punctuation">,</span>MaxHealth<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœäº‹ä»¶ä¸ä¸ºç©ºåˆ™è°ƒç”¨</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åˆ›å»ºè¡€æ¡ä»£ç "><a href="#åˆ›å»ºè¡€æ¡ä»£ç " class="headerlink" title="åˆ›å»ºè¡€æ¡ä»£ç "></a>åˆ›å»ºè¡€æ¡ä»£ç </h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å†™æ§åˆ¶è¡€æ¡çš„è„šæœ¬ä»£ç </p><p>åœ¨ä¸‹å›¾ç›®å½•åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œèµ·åä¸º<code>HealthBarUI.cs</code></p><img src="https://p6-tt.byteimg.com/origin/pgc-image/19ea0718eaf34586b42b44476b56da6c.png" alt="12.png" style="zoom:80%;" /><p>ç„¶åæ‰“å¼€ç¼–å†™ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HealthBarUI</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> healthUIPrefab<span class="token punctuation">;</span><span class="token comment">//ä¾›å¤–ç•Œæä¾›ä¸€ä¸ªè¡€æ¡ç´ æ</span>    <span class="token keyword">public</span> <span class="token class-name">Transform</span> barPoint<span class="token punctuation">;</span><span class="token comment">//è®°å½•è¡€é‡æ¡è¯¥æ˜¾ç¤ºåœ¨æ•Œäººçš„å“ªä¸ªä½ç½®</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"è¡€æ¡æ˜¾ç¤ºè®¾ç½®"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> alwaysVisible<span class="token punctuation">;</span><span class="token comment">//è¡€æ¡æ˜¯å¦ä¸€ç›´å¯è§</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> visibleTime<span class="token punctuation">;</span><span class="token comment">//è¡€æ¡æ˜¾ç¤ºæ—¶é—´ï¼ˆå¦‚æœä¸æ˜¯ä¸€ç›´å¯è§çš„æƒ…å†µä¸‹ï¼‰</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> timeLeft<span class="token punctuation">;</span><span class="token comment">//å‰©ä½™çš„æ˜¾ç¤ºæ—¶é—´</span>    <span class="token class-name">Image</span> healthSlider<span class="token punctuation">;</span><span class="token comment">//æ‹¿åˆ°è¡€æ¡ä¸Šå±‚å›¾åƒ</span>    <span class="token class-name">Transform</span> UIbar<span class="token punctuation">;</span><span class="token comment">//è®°å½•ç”Ÿæˆçš„è¡€æ¡åœ¨çš„ä½ç½®</span>    <span class="token class-name">Transform</span> cam<span class="token punctuation">;</span><span class="token comment">//æ‹¿åˆ°æ‘„åƒæœºä½ç½®ä»¥å¤„ç†è¡€æ¡ä¸€ç›´é¢å‘æˆ‘ä»¬æ‘„åƒæœº</span>    <span class="token class-name">CharacterStates</span> currentStates<span class="token punctuation">;</span><span class="token comment">//è·å–å½“å‰äººç‰©çš„states</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        currentStates <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        currentStates<span class="token punctuation">.</span>UpdateHealthBarOnAttack <span class="token operator">+=</span> UpdateHealthBar<span class="token punctuation">;</span><span class="token comment">//æ³¨å†Œäº‹ä»¶</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//OnEnableåœ¨æ¯æ¬¡åˆ‡æ¢åœ°å›¾æ—¶éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡</span>        cam <span class="token operator">=</span> Camera<span class="token punctuation">.</span>main<span class="token punctuation">.</span>transform<span class="token punctuation">;</span><span class="token comment">//è·å–ä¸»ç›¸æœºä½ç½®</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">Canvas</span> canvas <span class="token keyword">in</span> <span class="token generic-method"><span class="token function">FindObjectsOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Canvas<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//éå†æ¯ä¸€ä¸ªç”»å¸ƒ</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>renderMode <span class="token operator">==</span> RenderMode<span class="token punctuation">.</span>WorldSpace<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//æ‰¾åˆ°è¡€æ¡æ‰€åœ¨çš„ç”»å¸ƒï¼Œæœ‰å¤šç§æ–¹æ³•æ¥è·å¾—</span>                <span class="token comment">//ä¹Ÿå¯ä»¥ä¾›å¤–ç•Œæä¾›æ­¤ç”»å¸ƒï¼Œæ›´ä¸¥è°¨ä¸€ç‚¹</span>                UIbar <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>healthUIPrefab<span class="token punctuation">,</span>canvas<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">.</span>transform<span class="token punctuation">;</span>                <span class="token comment">//è·å¾—ä¸Šå±‚å›¾åƒï¼ˆç»¿è‰²æ¡ï¼‰çš„å¯¹è±¡ï¼Œä¸‹æ ‡ä¸º0</span>                healthSlider <span class="token operator">=</span> UIbar<span class="token punctuation">.</span><span class="token function">GetChild</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Image<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//æ˜¯å¦ä¸€ç›´å¯è§</span>                UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span>alwaysVisible<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateHealthBar</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> currentHealth<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">int</span></span> maxHealth<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ›´æ–°è¡€é‡</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>currentHealth <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¦‚æœå½“å‰è¡€é‡å°äºç­‰äº0ï¼Œå°±é”€æ¯UIbar</span>            <span class="token function">Destroy</span><span class="token punctuation">(</span>UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//æ¯æ¬¡æ›´æ–°æ—¶å¿…ç„¶å¯è§</span>        UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å¾—åˆ°è¡€é‡ç™¾åˆ†æ¯”</span>        <span class="token class-name"><span class="token keyword">float</span></span> sliderPercent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>currentHealth <span class="token operator">/</span> maxHealth<span class="token punctuation">;</span>        <span class="token comment">//æ›´æ–°è¡€æ¡é•¿åº¦</span>        healthSlider<span class="token punctuation">.</span>fillAmount <span class="token operator">=</span> sliderPercent<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">LateUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åœ¨Updateåä¸€å¸§æ‰§è¡Œ</span>        <span class="token comment">//æ›´æ–°è¡€æ¡è·Ÿéšæ•Œäººä½ç½®</span>        <span class="token comment">//è¿™é‡Œå…ˆæ£€æµ‹UIbaræœ‰æ²¡æœ‰ç»™é”€æ¯</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>UIbar <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            UIbar<span class="token punctuation">.</span>position <span class="token operator">=</span> barPoint<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//æ›´æ–°åˆ°æ•Œäººä½ç½®</span>            UIbar<span class="token punctuation">.</span>forward <span class="token operator">=</span> cam<span class="token punctuation">.</span>forward<span class="token punctuation">;</span><span class="token comment">//é¢æœæ‘„åƒæœºï¼ˆå³æ‘„åƒæœºçš„æ–¹å‘ï¼‰</span>            <span class="token comment">//è¡€æ¡å‰©ä½™æ˜¾ç¤ºæ—¶é—´</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>timeLeft <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>alwaysVisible<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                timeLeft <span class="token operator">=</span> visibleTime<span class="token punctuation">;</span>                UIbar<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">SetActive</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span>                timeLeft <span class="token operator">-=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åæŠŠä»£ç è„šæœ¬æŒ‚è½½åˆ°æ¯ä¸ªæ•Œäººèº«ä¸Šï¼Œå†è°ƒæ•´æ•°æ®å°±å¯ä»¥è¿è¡Œè¯•è¯•çœ‹æ•ˆæœäº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€ç« æˆ‘ä»¬æ¥åˆ¶ä½œä¸€ä¸‹æ•Œäººçš„è¡€é‡æ¡&lt;/p&gt;
&lt;h1 id=&quot;åˆ›å»ºè¡€æ¡UI&quot;&gt;&lt;a href=&quot;#åˆ›å»ºè¡€æ¡UI&quot; class=&quot;headerlink&quot; title=&quot;åˆ›å»ºè¡€æ¡UI&quot;&gt;&lt;/a&gt;åˆ›å»ºè¡€æ¡UI&lt;/h1&gt;&lt;h2 id=&quot;åˆ›å»ºè¡€æ¡åŸºç¡€å½¢çŠ¶ï¼ˆCanvasä¸Imageï¼‰&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°21-åå‡»çŸ³å¤´äºº</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B021-%E5%8F%8D%E5%87%BB%E7%9F%B3%E5%A4%B4%E4%BA%BA/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B021-%E5%8F%8D%E5%87%BB%E7%9F%B3%E5%A4%B4%E4%BA%BA/</id>
    <published>2021-07-27T13:54:34.000Z</published>
    <updated>2021-07-28T01:59:34.199Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™ä¸€ç« ä¸­æˆ‘ä»¬æ¥å®ç°çŸ³å¤´äººä¸¢å‡ºçŸ³å¤´æ¥å‡»é£ç©å®¶å¹¶ä¸”é€ æˆä¼¤å®³çš„æ•ˆæœï¼ŒåŒæ—¶ç©å®¶è¿˜å¯ä»¥åˆ©ç”¨çŸ³å¤´åå‡»çŸ³å¤´äºº</p><h1 id="å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³"><a href="#å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³" class="headerlink" title="å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³"></a>å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³</h1><p>æˆ‘ä»¬æ‰“å¼€<code>Rock.cs</code>ï¼Œæˆ‘ä»¬è¦æœ‰åŒºåˆ†æ€§çš„è§¦å‘ä¼¤å®³ï¼Œå¯¹äºç©å®¶å’Œæ•Œäººå¯ä»¥é€ æˆä¼¤å®³ï¼Œä½†æ˜¯å¯¹äºä¸¢åˆ°åœ°é¢çš„æƒ…å†µæ˜¯ä¸èƒ½é€ æˆä¼¤å®³çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥åˆ©ç”¨ä¸€ä¸ªæšä¸¾æ¥åŒºåˆ†å¼€æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">RockStates</span><span class="token punctuation">&#123;</span>HitPlayer<span class="token punctuation">,</span>HitEnemy<span class="token punctuation">,</span>HitNothing<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">public</span>  <span class="token class-name">RockStates</span> rockStates<span class="token punctuation">;</span><span class="token comment">//æšä¸¾å®ä¾‹</span><span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">;</span><span class="token comment">//é€ æˆçš„ä¼¤å®³æ˜¯å¤šå°‘</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnCollisionEnter</span><span class="token punctuation">(</span><span class="token class-name">Collision</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//otheræŒ‡è¢«çŸ³å¤´æ‰“åˆ°çš„å¯¹è±¡</span>    <span class="token comment">//å½“å‘ç”Ÿç¢°æ’æ—¶ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>rockStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> RockStates<span class="token punctuation">.</span>HitPlayer<span class="token punctuation">:</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> direction <span class="token operator">*</span> force<span class="token punctuation">;</span><span class="token comment">//å‡»é€€ç©å®¶</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Dizzy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//çœ©æ™•</span>                <span class="token comment">//è¿™é‡Œçš„TakeDamageæ˜¯é‡è½½çš„å…¶ä¸­ä¸€ä¸ªæ–¹æ³•</span>                <span class="token comment">//é€ æˆä¼¤å®³</span>                other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>damage<span class="token punctuation">,</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                rockStates <span class="token operator">=</span> RockStates<span class="token punctuation">.</span>HitNothing<span class="token punctuation">;</span><span class="token comment">//å¤åŸçŠ¶æ€ä»¥é˜²ä¸€ç›´æ‰§è¡Œ</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//end switch</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬çœ‹åˆ°å…¶ä¸­çš„<code>TakeDamage()</code>æ˜¯ä¸€ä¸ªé‡è½½æ–¹æ³•ï¼Œæ‰“å¼€<code>CharacterStates.cs</code>æˆ‘ä»¬è¿™é‡Œè¡¥å……ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//å‡½æ•°é‡è½½</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> damage<span class="token punctuation">,</span><span class="token class-name">CharacterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">int</span></span> dam <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>damage <span class="token operator">-</span> defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    defener<span class="token punctuation">.</span>currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>defener<span class="token punctuation">.</span>currentHealth <span class="token operator">-</span> dam<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åä¿å­˜å…³é—­ï¼Œåˆ«å¿˜äº†è¦åœ¨å¤–è¾¹çŸ³å¤´å¯¹è±¡ä¸Šèµ‹äºˆä¸€ä¸ªåˆå§‹ä¼¤å®³å€¼</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/87f552555d2d4f60b4fe62d0d9c10da6.png" alt="1.png" style="zoom:80%;" /><p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†çŸ³å¤´çš„ç¬¬ä¸€ä¸ªçŠ¶æ€</p><h1 id="å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº"><a href="#å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº" class="headerlink" title="å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº"></a>å®ç°çŸ³å¤´æ”»å‡»çŸ³å¤´äºº</h1><p>å…ˆæŠŠä»£ç å®Œå–„å¥½</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">case</span> RockStates<span class="token punctuation">.</span>HitEnemy<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Golem<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è·å¾—äº†çŸ³å¤´äººä»£ç ç»„ä»¶çš„å°±æ˜¯çŸ³å¤´äººçš„ï¼Œå¦åˆ™è¿”å›çš„æ˜¯ç©º</span>    <span class="token class-name"><span class="token keyword">var</span></span> otherStates <span class="token operator">=</span> other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    otherStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>damage<span class="token punctuation">,</span>otherStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">Destroy</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæˆ‘ä»¬è¿™é‡Œæ˜¯åå‡»çŸ³å¤´äººï¼Œæ‰€ä»¥è¦æœ‰ä¸ªåˆ¤æ–­é¼ æ ‡ç‚¹å‡»åˆ°äº†çŸ³å¤´ï¼Œä¸€ä¸ªæœ€ç›´æ¥çš„åŠæ³•å°±æ˜¯ç»™æˆ‘ä»¬çš„çŸ³å¤´æ·»åŠ ä¸€ä¸ªæ ‡ç­¾ï¼Œç„¶åå†ä¿®æ”¹ä¸€ä¸‹é¼ æ ‡ç‚¹å‡»æ—¶çš„æ–¹æ³•</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/e18b4dde9c5b4129bba36dd1c9f553b2.png" alt="2.png" style="zoom:80%;" /><p>å›åˆ°<code>PlayerController.cs</code>ä¿®æ”¹ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Attackable"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¦‚æœç‚¹å‡»çš„å¯¹è±¡ä¸æ˜¯æ•Œäººè€Œæ˜¯å…¶å®ƒå¦ç±»å¯æ”»å‡»å¯¹è±¡ï¼Œå¦‚çŸ³å¤´</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rockStates            <span class="token operator">==</span> Rock<span class="token punctuation">.</span>RockStates<span class="token punctuation">.</span>HitNothing<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¦‚æœæ˜¯çŸ³å¤´å¹¶ä¸”çŸ³å¤´ä¸åœ¨ç©ºä¸­è€Œæ˜¯è½åœ°ä¹‹å</span>            attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rockStates <span class="token operator">=</span> Rock<span class="token punctuation">.</span>RockStates<span class="token punctuation">.</span>HitEnemy<span class="token punctuation">;</span>            <span class="token comment">//é˜²æ­¢æ”»å‡»é‚£ä¸€åˆ¹é‚£é€Ÿåº¦å°äº1å¯¼è‡´çŸ³å¤´çŠ¶æ€å‘ç”Ÿæ”¹å˜</span>            attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>one<span class="token punctuation">;</span>                        <span class="token comment">//æ·»åŠ ä¸€ä¸ªç©å®¶æœå‘çš„åŠ›ï¼ŒåŠ›çš„å¤§å°æš‚æ—¶å®š 40</span>            attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">AddForce</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>forward <span class="token operator">*</span> <span class="token number">40</span><span class="token punctuation">,</span>ForceMode<span class="token punctuation">.</span>Impulse<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//è®¡ç®—ä¼¤å®³</span>        targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¡ä»¶ä¸­æœ‰ä¸€ä¸ªæ˜¯åˆ¤æ–­æ˜¯å¦ä¸º<code>HitNothing</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨åˆ¤æ–­çŸ³å¤´æ˜¯å¦ä¸ºæ¥è¿‘äºé™æ­¢æ—¶ä¸ºæ¡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å°±è¦å›å»<code>Rock.cs</code>åšä¸€äº›ä¿®æ”¹äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    rb <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    rb<span class="token punctuation">.</span>velocity <span class="token operator">=</span> Vector3<span class="token punctuation">.</span>one<span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢çŸ³å¤´ä¸€ç”Ÿæˆæ—¶é€Ÿåº¦ä¸º0å¯¼è‡´çŠ¶æ€å‘ç”Ÿæ”¹å˜</span>    <span class="token function">FlyToTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">FixedUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å›ºå®šå¸§æ›´æ–°</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>rb<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>sqrMagnitude <span class="token operator">&lt;</span> <span class="token number">1f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å‘é‡çš„å¹³æ–¹</span>        rockStates <span class="token operator">=</span> RockStates<span class="token punctuation">.</span>HitNothing<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ååˆ«å¿˜äº†åœ¨<code>MouseManager.cs</code>åŠ ä¸Šä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MouseControl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetMouseButtonDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> hitInfo<span class="token punctuation">.</span>collider <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Ground"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            OnMouseClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name"><span class="token keyword">var</span></span> point <span class="token operator">=</span> hitInfo<span class="token punctuation">.</span>point<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Enemy"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç‚¹å‡»æ•Œäººä¼ é€’æ•Œäººçš„gameObject</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Attackable"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//ç‚¹å‡»çŸ³å¤´ç­‰å¯¹è±¡ç”¨</span>            OnEnemyClicked<span class="token punctuation">?.</span><span class="token function">Invoke</span><span class="token punctuation">(</span>hitInfo<span class="token punctuation">.</span>collider<span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ"><a href="#ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ" class="headerlink" title="ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ"></a>ä¸ºçŸ³å¤´åŠ ä¸Šçˆ†è£‚ç‰¹æ•ˆ</h1><p>æœ€åæˆ‘ä»¬æƒ³åœ¨çŸ³å¤´æ‰“åˆ°çŸ³å¤´äººæ—¶æœ‰ä¸€ä¸ªçˆ†è£‚ç¢çŸ³ç‰¹æ•ˆï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°<code>Particle System</code>äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/efcac51c11a3459cb6e1cfad55ff677a.png" alt="3.png" style="zoom:80%;" /><p>åˆ›å»ºå¥½ä¹‹åæˆ‘ä»¬æŒ‰ç…§ä¸‹å›¾å‚è€ƒè®¾ç½®</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/2a5fef602fe948eab2649b98a3f07f83.png" alt="5.png" style="zoom:80%;" /><img src="https://p5-tt.byteimg.com/origin/pgc-image/529e6ea5fe1141afb30b34135e7b8018.png" alt="6.png" style="zoom:80%;" /><img src="https://p6-tt.byteimg.com/origin/pgc-image/e34343a1983440909f77ce88719261e3.png" alt="7.png" style="zoom:80%;" /><img src="https://p5-tt.byteimg.com/origin/pgc-image/973530a9742240a7bc989b50a5ce86fb.png" alt="8.png" style="zoom:80%;" /><p>è‡ªå·±å¤šå¤šæµ‹è¯•ä¸€ä¸‹æ•ˆæœï¼Œæ»¡æ„ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ”¹ä¸ªåå°†å®ƒä¿å­˜ä¸ºä¸€ä¸ªç´ ææ”¾å¥½å…ˆï¼Œç„¶åä¸è¦å¿˜äº†æŠŠåœ°å›¾ä¸Šåˆšåˆšè°ƒè¯•çš„åˆ é™¤</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/4b40b473872f4223a4aafecdb889c930.png" alt="9.png" style="zoom:80%;" /><p>æœ€åå†åœ¨<code>Rock.cs</code>ä¸Šä¿®æ”¹ä¸€ä¸‹ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token class-name">GameObject</span> RockBreakParticle<span class="token punctuation">;</span><span class="token comment">//çŸ³å¤´çˆ†è£‚ç‰¹æ•ˆï¼Œä¾›å¤–ç•Œæ‹–æ‹½è¿›æ¥</span><span class="token keyword">case</span> RockStates<span class="token punctuation">.</span>HitEnemy<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Golem<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è·å¾—äº†çŸ³å¤´äººä»£ç ç»„ä»¶çš„å°±æ˜¯çŸ³å¤´äººçš„ï¼Œå¦åˆ™è¿”å›çš„æ˜¯ç©º</span>    <span class="token class-name"><span class="token keyword">var</span></span> otherStates <span class="token operator">=</span> other<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    otherStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>damage<span class="token punctuation">,</span>otherStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    Instantiate        <span class="token punctuation">(</span>RockBreakParticle<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>Quaternion<span class="token punctuation">.</span>identity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‡»ä¸­æ•Œäººæ—¶äº§ç”Ÿçˆ†è£‚ç‰¹æ•ˆ</span>    <span class="token function">Destroy</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">break</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åä¸è¦å¿˜äº†æŠŠçŸ³å¤´çˆ†è£‚çš„ç‰¹æ•ˆæ‹–è¿›å»è®¾ç½®é¢æ¿é‡Œ</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/272290cea6af4b3a8f67fbe952186662.png" alt="10.png" style="zoom:80%;" />]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™ä¸€ç« ä¸­æˆ‘ä»¬æ¥å®ç°çŸ³å¤´äººä¸¢å‡ºçŸ³å¤´æ¥å‡»é£ç©å®¶å¹¶ä¸”é€ æˆä¼¤å®³çš„æ•ˆæœï¼ŒåŒæ—¶ç©å®¶è¿˜å¯ä»¥åˆ©ç”¨çŸ³å¤´åå‡»çŸ³å¤´äºº&lt;/p&gt;
&lt;h1 id=&quot;å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³&quot;&gt;&lt;a href=&quot;#å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ æˆä¼¤å®³&quot; class=&quot;headerlink&quot; title=&quot;å®ç°çŸ³å¤´å‡»é£ç©å®¶å¹¶é€ </summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°20-å®ç°çŸ³å¤´äººä¸¢å‡ºçŸ³å¤´</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B020-%E5%AE%9E%E7%8E%B0%E7%9F%B3%E5%A4%B4%E4%BA%BA%E4%B8%A2%E5%87%BA%E7%9F%B3%E5%A4%B4/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B020-%E5%AE%9E%E7%8E%B0%E7%9F%B3%E5%A4%B4%E4%BA%BA%E4%B8%A2%E5%87%BA%E7%9F%B3%E5%A4%B4/</id>
    <published>2021-07-26T01:12:34.000Z</published>
    <updated>2021-07-26T03:00:21.294Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬å®ç°ä¸€ä¸‹çŸ³å¤´äººçš„ç‰¹æ®Šæ”»å‡»ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆä¸€ä¸ªçŸ³å¤´ç„¶åä¸¢å‘æˆ‘ä»¬ç©å®¶</p><h1 id="ç¼–è¾‘çŸ³å¤´"><a href="#ç¼–è¾‘çŸ³å¤´" class="headerlink" title="ç¼–è¾‘çŸ³å¤´"></a>ç¼–è¾‘çŸ³å¤´</h1><p>é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°çŸ³å¤´ç´ ææ‹–å‡ºæ¥ï¼Œç”±äºæˆ‘ä»¬è¦ç»™å®ƒæ–½åŠ ä¸€ä¸ªåŠ›ï¼Œå› æ­¤è¿™é‡Œå°±è¦ç”¨åˆ°<code>Rigidbody(é’¢ä½“)</code>ç»„ä»¶äº†</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/63ea4e8d49e540acb69a7ded75d37782.png" alt="2.png" style="zoom:80%;" /><p>åŒæ—¶çŸ³å¤´è¿˜è¦ä¸åœ°é¢å‘ç”Ÿç¢°æ’ï¼Œå› æ­¤è¿˜è¦æ·»åŠ ä¸€ä¸ªç¢°æ’ä½“ï¼Œè¿™é‡Œé€‰æ‹©çš„æ˜¯<code>MeshCollider</code>ï¼Œå‹¾é€‰<code>Convex</code>å¯ä»¥çœ‹åˆ°ç¢°æ’ä½“ç§¯åˆšå¥½é€‚é…æˆ‘ä»¬çš„çŸ³å¤´å½¢çŠ¶</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/ddc484a234c94603b2b16b9dd5ea0a42.png" alt="3.png" style="zoom:80%;" /><p>ç„¶åæˆ‘ä»¬å°±è¦æ¥è¿›è¡Œå†™ä»£ç äº†</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/0a42c8f078f8441ea47b3ef4af3302f8.png" alt="1.png" style="zoom:80%;" /><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Rock</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Rigidbody</span> rb<span class="token punctuation">;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Basic Settings(æ‰”å‡ºçŸ³å¤´å‚æ•°è®¾ç½®)"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> force<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‡ºå»çš„å†²å‡»åŠ›å¤§å°</span>    <span class="token keyword">public</span> <span class="token class-name">GameObject</span> target<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‘çš„ç›®æ ‡</span>    <span class="token keyword">private</span> <span class="token class-name">Vector3</span> direction<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‡ºå»çš„æ–¹å‘</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        rb <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rigidbody<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">FlyToTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">FlyToTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//é˜²æ­¢ä¸¢å‡ºå»é‚£ä¸€åˆ¹é‚£ç©å®¶è„±ç¦»ä¸¢å¤±ç›®æ ‡å¯¼è‡´çŸ³å¤´ç”Ÿæˆä¸å‡ºæ¥</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>target <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            target <span class="token operator">=</span> <span class="token generic-method"><span class="token function">FindObjectOfType</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>PlayerController<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>                <span class="token comment">//Vector3.upæ˜¯æƒ³åœ¨çŸ³å¤´ä¸¢å‡ºå»çš„æ—¶å€™ä¸Šå‡ä¸€ä¸ªé«˜åº¦</span>        direction <span class="token operator">=</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">-</span> transform<span class="token punctuation">.</span>position <span class="token operator">+</span> Vector3<span class="token punctuation">.</span>up<span class="token punctuation">)</span><span class="token punctuation">.</span>normalized<span class="token punctuation">;</span>        <span class="token comment">//Impulseæ˜¯å†²å‡»åŠ›çš„æ¨¡å¼</span>        rb<span class="token punctuation">.</span><span class="token function">AddForce</span><span class="token punctuation">(</span>direction <span class="token operator">*</span> force<span class="token punctuation">,</span>ForceMode<span class="token punctuation">.</span>Impulse<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬å°†çŸ³å¤´ç´ æä¿å­˜ä¸€ä¸ªæ¨¡æ¿å¯¹è±¡</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/735c192da1924614a7f5e0f0ee01b428.png" alt="4.png" style="zoom:80%;" /><h1 id="è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº"><a href="#è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº" class="headerlink" title="è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº"></a>è¿›ä¸€æ­¥å®Œå–„çŸ³å¤´äºº</h1><p>éšåæˆ‘ä»¬å†æ¬¡ç¼–è¾‘çŸ³å¤´äººï¼Œå› ä¸ºæˆ‘ä»¬çš„çŸ³å¤´æ˜¯ä»çŸ³å¤´äººçš„æ‰‹ä¸Šä¸¢å‡ºå»çš„ï¼Œå› æ­¤æˆ‘ä»¬å°±è¦è·å¾—æ‰‹çš„åæ ‡ï¼Œå³ä¸‹é¢çš„å¯¹è±¡åæ ‡</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/0cdbbddf408c42e6a443e151c343ce6b.png" alt="5.png" style="zoom:80%;" /><p>çŸ¥é“è¿™ä¸ªåæˆ‘ä»¬æš‚æ—¶æ”¾åœ¨ä¸€è¾¹ï¼Œæ¥ç¼–å†™ä¸€ä¸‹çŸ³å¤´äººçš„ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Rock Settingsï¼ˆä¸¢çŸ³å¤´æ”»å‡»çš„ç›¸å…³è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token class-name">GameObject</span> rockPrefab<span class="token punctuation">;</span><span class="token comment">//çŸ³å¤´ç´ æ</span><span class="token keyword">public</span> <span class="token class-name">Transform</span> handPos<span class="token punctuation">;</span><span class="token comment">//ä¸¢å‡ºçŸ³å¤´çš„æ‰‹çš„åæ ‡</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ThrowRock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åˆ›å»ºçŸ³å¤´å¯¹è±¡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ—‹è½¬ï¼Œè¿™é‡Œé€‰æ‹©ç»´æŒåˆå§‹æ—‹è½¬</span>        <span class="token class-name">GameObject</span> rock <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>rockPrefab<span class="token punctuation">,</span>handPos<span class="token punctuation">.</span>position<span class="token punctuation">,</span>Quaternion<span class="token punctuation">.</span>identity<span class="token punctuation">)</span><span class="token punctuation">;</span>        rock<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Rock<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>target <span class="token operator">=</span> attackTarget<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æŠŠçŸ³å¤´äººçš„åŠ¨ç”»äº‹ä»¶æ·»åŠ ä¸Šå»</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/6ec880f34ce24caab5c2270d61e5d04a.png" alt="6.png" style="zoom:80%;" /><p>æœ€ååˆ«å¿˜äº†è¿˜è¦é€‰æ‹©çŸ³å¤´çš„ç´ æï¼ˆå°±æ˜¯æˆ‘ä»¬åˆšåˆšä¿å­˜å¥½çš„ç´ ææ¨¡æ¿ï¼‰ï¼Œä»¥åŠæ‰‹çš„åæ ‡</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/29b7a5e0ae72481a933c5728c35ca1b9.png" alt="7.png" style="zoom:80%;" />]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€ç« æˆ‘ä»¬å®ç°ä¸€ä¸‹çŸ³å¤´äººçš„ç‰¹æ®Šæ”»å‡»ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆä¸€ä¸ªçŸ³å¤´ç„¶åä¸¢å‘æˆ‘ä»¬ç©å®¶&lt;/p&gt;
&lt;h1 id=&quot;ç¼–è¾‘çŸ³å¤´&quot;&gt;&lt;a href=&quot;#ç¼–è¾‘çŸ³å¤´&quot; class=&quot;headerlink&quot; title=&quot;ç¼–è¾‘çŸ³å¤´&quot;&gt;&lt;/a&gt;ç¼–è¾‘çŸ³å¤´&lt;/h1&gt;&lt;p&gt;é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°çŸ³å¤´ç´ ææ‹–å‡ºæ¥ï¼Œç”±äºæˆ‘ä»¬è¦</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°19-è®¾ç½®çŸ³å¤´äºº</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B019-%E8%AE%BE%E7%BD%AE%E7%9F%B3%E5%A4%B4%E4%BA%BA/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B019-%E8%AE%BE%E7%BD%AE%E7%9F%B3%E5%A4%B4%E4%BA%BA/</id>
    <published>2021-07-25T04:09:19.000Z</published>
    <updated>2021-07-25T06:52:30.857Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥è®¾ç½®çŸ³å¤´äººï¼Œç”±äºå’Œè®¾ç½®å…½äººç›¸å·®ä¸å¤§ï¼Œç¯‡å¹…æ¯”è¾ƒå°‘</p><h1 id="è®¾ç½®åŠ¨ç”»"><a href="#è®¾ç½®åŠ¨ç”»" class="headerlink" title="è®¾ç½®åŠ¨ç”»"></a>è®¾ç½®åŠ¨ç”»</h1><p>æˆ‘ä»¬å»æµè§ˆçŸ³å¤´äººçš„åŠ¨ç”»å¯ä»¥å‘ç°ï¼Œ<code>Attack01</code>æ˜¯ç±»ä¼¼æ‹¿èµ·çŸ³å¤´ä¸¢æˆ‘ä»¬ï¼Œå®ƒæ‰æ˜¯æŠ€èƒ½æ”»å‡»ï¼Œè€Œ<code>Attack02</code>æ˜¯å‡»æ™•ç©å®¶çš„æ”»å‡»åŠ¨ç”»ï¼Œå¯ä»¥ä½œä¸ºæ™®é€šæ”»å‡»æ¥ä½¿ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è°ƒæ•´æ”»å‡»åŠ¨ç”»æ—¶è¦æ³¨æ„åˆ†æ¸…</p><p>æˆ‘ä»¬çš„åŠ¨ç”»æ§åˆ¶å™¨æ–‡ä»¶å°±é€‰æ‹©æ˜¯åŸºäº<code>å…½äºº</code>çš„åŠ¨ç”»æ¥å®Œæˆï¼Œåˆ›å»ºä¸€ä¸ª<code>New Animator Override Controller</code>ï¼Œæ¨¡æ¿é€‰æ‹©ä¸ºå…½äººï¼Œç„¶åå†ä¸€ä¸ªä¸ªåŠ¨ç”»æ›¿æ¢ä¸Šå»</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/cbf3634f05844a5f98fed856698b1a5a.png" alt="1.png" style="zoom:80%;" /><p>å…¶ä¸­<code>Run</code>å¹¶æ²¡æœ‰è‡ªå¸¦åŠ¨ç”»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>Walk</code>ä»£æ›¿</p><h1 id="ç¼–å†™ä»£ç æ–‡ä»¶"><a href="#ç¼–å†™ä»£ç æ–‡ä»¶" class="headerlink" title="ç¼–å†™ä»£ç æ–‡ä»¶"></a>ç¼–å†™ä»£ç æ–‡ä»¶</h1><p>æˆ‘ä»¬åƒå…½äººä»£ç æ–‡ä»¶é‚£æ ·å•ç‹¬åˆ›ä¸€ä¸ªä»£ç æ–‡ä»¶ç»™çŸ³å¤´äººç”¨ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯è¦ç»§æ‰¿<code>EnemyController</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Golem</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EnemyController</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Skillï¼ˆçŸ³å¤´äººç‰¹æ®Šæ”»å‡»è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> kickForce <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token comment">//æ¨å¼€æ•Œäººè·ç¦»</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">kickOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//çŸ³å¤´äººå‡»é£ç©å®¶</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> transform<span class="token punctuation">.</span><span class="token function">IsFacingTarget</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name"><span class="token keyword">var</span></span> targetState <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Vector3</span> direction <span class="token operator">=</span> <span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token punctuation">.</span>normalized<span class="token punctuation">;</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> direction<span class="token operator">*</span>kickForce<span class="token punctuation">;</span>            targetState<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>characterStates<span class="token punctuation">,</span>targetState<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åå†æ·»åŠ åŠ¨ç”»äº‹ä»¶å°±è¡Œäº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥è®¾ç½®çŸ³å¤´äººï¼Œç”±äºå’Œè®¾ç½®å…½äººç›¸å·®ä¸å¤§ï¼Œç¯‡å¹…æ¯”è¾ƒå°‘&lt;/p&gt;
&lt;h1 id=&quot;è®¾ç½®åŠ¨ç”»&quot;&gt;&lt;a href=&quot;#è®¾ç½®åŠ¨ç”»&quot; class=&quot;headerlink&quot; title=&quot;è®¾ç½®åŠ¨ç”»&quot;&gt;&lt;/a&gt;è®¾ç½®åŠ¨ç”»&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬å»æµè§ˆçŸ³å¤´äººçš„åŠ¨ç”»å¯ä»¥å‘ç°ï¼Œ&lt;code&gt;At</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°18-æ‰©å±•æ–¹æ³•</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B018-%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B018-%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95/</id>
    <published>2021-07-24T04:55:12.000Z</published>
    <updated>2021-07-24T06:02:15.450Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬æ¥ç†Ÿæ‚‰ä¸€ä¸‹æ‰©å±•æ–¹æ³•ï¼Œæ‰€è°“æ‰©å±•æ–¹æ³•å°±æ˜¯åœ¨ä¸ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä½†æ˜¯å¯ä»¥é¢å¤–ç¼–å†™ä¸€ä¸ªç±»æ¥æ‰©å±•è¿™ä¸ªç±»çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¿™ä¸€ç« æˆ‘ä»¬æƒ³è®©æˆ‘ä»¬æ§åˆ¶ä¸»è§’åœ¨å…½äººåé¢æ—¶å…½äººæ”»å‡»ä¸ä¼šé€ æˆä¼¤å®³ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°<code>transfrom</code>ç±»ï¼Œä½†æ˜¯<code>transfrom</code>é‡Œè¾¹æ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±è¦æ¥æ‰©å±•å®ƒ</p><h1 id="æ‰©å±•æ–¹æ³•"><a href="#æ‰©å±•æ–¹æ³•" class="headerlink" title="æ‰©å±•æ–¹æ³•"></a>æ‰©å±•æ–¹æ³•</h1><p>è¦æƒ³æˆ‘ä»¬çš„å…½äººæ•Œäººå¯¹èº«åç©å®¶é€ æˆä¸äº†ä¼¤å®³ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥å†™ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸“é—¨æ¥åˆ¤æ–­ç©å®¶æ˜¯å¦åœ¨å…½äººæ­£å‰æ–¹æ‰‡å½¢åŒºåŸŸï¼Œå¦‚æœåœ¨åˆ™è¿”å›<code>true</code>å¦åˆ™è¿”å›<code>false</code>ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ–¹æ³•åŠ åˆ°è®¡ç®—ä¼¤å®³çš„<code>Hit()</code>å‡½æ•°é‡Œè¾¹è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œç©å®¶åœ¨å…½äººè§†é‡èŒƒå›´å†…å°±é€ æˆä¼¤å®³ï¼Œåä¹‹ä¸é€ æˆ</p><p>è¿™ä¸ªæ‰©å±•æ–¹æ³•æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ä»£ç æ–‡ä»¶</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/1d4a90fb719d4281b68a709f01232cd2.png" alt="1.png" style="zoom:80%;" /><p>æ‰“å¼€ç¼–å†™å®ƒ</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ExtensionMethod</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ‰©å±•æ–¹æ³•ç±»</span>    <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">float</span></span> dotThreshold <span class="token operator">=</span> <span class="token number">0.5f</span><span class="token punctuation">;</span> <span class="token comment">//è§†é‡èŒƒå›´å¤§å°</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">IsFacingTarget</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">Transform</span> transform <span class="token punctuation">,</span> <span class="token class-name">Transform</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åˆ¤æ–­ç›®æ ‡æ˜¯å¦åœ¨è§†é‡èŒƒå›´å†…</span>        <span class="token class-name"><span class="token keyword">var</span></span> vectorToTarget <span class="token operator">=</span> target<span class="token punctuation">.</span>position <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//è·å¾—æ•Œäººå’Œç©å®¶çš„ç›¸å¯¹ä½ç½®</span>        vectorToTarget<span class="token punctuation">.</span><span class="token function">Normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘é‡åŒ–</span>        <span class="token comment">//Dot:ä¸¤ä¸ªçŸ¢é‡çš„ç‚¹ç§¯ã€‚ ç‚¹ç§¯æ˜¯ä¸€ä¸ªæµ®ç‚¹å€¼ï¼Œç­‰äºä¸¤ä¸ªçŸ¢é‡çš„å¤§å°ç›¸ä¹˜ï¼Œç„¶åä¹˜ä»¥å®ƒä»¬ä¹‹é—´çš„è§’åº¦çš„ä½™å¼¦ã€‚</span>        <span class="token class-name"><span class="token keyword">float</span></span> dot <span class="token operator">=</span> Vector3<span class="token punctuation">.</span><span class="token function">Dot</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>forward<span class="token punctuation">,</span>vectorToTarget<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> dot <span class="token operator">></span> dotThreshold<span class="token punctuation">;</span><span class="token comment">//å¦‚æœç©å®¶åœ¨æ•Œäººå¤¹è§’120Â°(cos120 = 0.5)è§†é‡èŒƒå›´å†…åˆ™è¿”å›true</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>Vector3.Dot()</code>æ–¹æ³•ï¼Œå®˜æ–¹APIåœ¨<a href="http://docs.unity3d.com/ScriptReference/Vector3.Dot.html">è¿™é‡Œ</a>ï¼ŒåŒæ—¶ä¹Ÿç”¨äº†<code>transform.forward</code>æ¥è¡¨ç¤ºæ•Œäººé¢å¯¹çš„æ–¹å‘</p><p>åŒæ—¶è¿˜è¦æ³¨æ„åˆ°å‚æ•°æœ‰ä¸ª<code>this</code>ï¼Œè¿™æ ·å¯ä»¥è®©æ–¹æ³•åŠ å…¥åˆ°<code>Transform</code>ç±»é‡Œé¢ï¼Œå˜æˆå®ƒçš„ä¸€ä¸ªæ–¹æ³•</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/f180df5587214500b2f7e3cb8e63072a.png" alt="2.png" style="zoom:80%;" /><p>æœ€åæˆ‘ä»¬å›åˆ°<code>Hit()</code>å‡½æ•°ä¸­ï¼ŒæŠŠåˆ¤æ–­æ¡ä»¶åŠ ä¸Šå°±å®Œæˆäº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç”±äºåœ¨æ•Œäººè¿½ä¸»è§’çš„è¿‡ç¨‹ä¸­ä¸»è§’å¯èƒ½ä¼šè·‘å¼€ï¼Œè¿™æ—¶å€™å¦‚æœæ”»å‡»çš„è¯ç›®æ ‡å°±ä¸¢å¤±äº†</span>    <span class="token comment">//æ‰€ä»¥æˆ‘ä»¬åœ¨æ”»å‡»å‰åˆ¤æ–­ç›®æ ‡æ˜¯å¦ä¸ºç©ºï¼Œä»¥é˜²æŠ¥é”™</span>    <span class="token comment">//åŒæ—¶è¿˜åˆ¤æ–­äº†ç©å®¶æ˜¯å¦åœ¨æ•Œäººçš„è§†é‡èŒƒå›´å†…ï¼Œåœ¨çš„è¯æ‰é€ æˆä¼¤å®³</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> transform<span class="token punctuation">.</span><span class="token function">IsFacingTarget</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharacterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>characterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ï¼Œå½“æˆ‘ä»¬çš„ç©å®¶èµ°åˆ°æ•Œäººåè¾¹çš„æ—¶å€™å°±ä¸ä¼šå—åˆ°ä¼¤å®³</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€ç« æˆ‘ä»¬æ¥ç†Ÿæ‚‰ä¸€ä¸‹æ‰©å±•æ–¹æ³•ï¼Œæ‰€è°“æ‰©å±•æ–¹æ³•å°±æ˜¯åœ¨ä¸ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä½†æ˜¯å¯ä»¥é¢å¤–ç¼–å†™ä¸€ä¸ªç±»æ¥æ‰©å±•è¿™ä¸ªç±»çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¿™ä¸€ç« æˆ‘ä»¬æƒ³è®©æˆ‘ä»¬æ§åˆ¶ä¸»è§’åœ¨å…½äººåé¢æ—¶å…½äººæ”»å‡»ä¸ä¼šé€ æˆä¼¤å®³ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°&lt;code&gt;transfrom&lt;/code&gt;ç±»ï¼Œä½†æ˜¯&lt;code&gt;transfrom&lt;/code</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°17-è®¾ç½®å…½äººæ•Œäºº</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B017-%E8%AE%BE%E7%BD%AE%E5%85%BD%E4%BA%BA%E6%95%8C%E4%BA%BA/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B017-%E8%AE%BE%E7%BD%AE%E5%85%BD%E4%BA%BA%E6%95%8C%E4%BA%BA/</id>
    <published>2021-07-23T02:01:51.000Z</published>
    <updated>2021-07-23T03:47:43.441Z</updated>
    
    <content type="html"><![CDATA[<p> åœ¨è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥è®¾ç½®ä¸€ä¸‹å…½äººæ•Œäººï¼Œç”±äºå®ƒçš„<code>Attack02</code>åŠ¨ç”»åŒ…å«ä¸€ä¸ªæ¨äººçš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œå•ç‹¬çš„æµ‹è¯•ï¼Œè€Œä¸æ˜¯ç»§ç»­æ²¿ç”¨ä¹‹å‰çš„<code>EnemyController</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å®ƒåŸºç¡€ä¸Šè¿›è¡Œæ·»åŠ ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©ç»§æ‰¿ç±»æ–¹å¼æ”¹å†™</p><h1 id="ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•"><a href="#ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•" class="headerlink" title="ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•"></a>ç»§æ‰¿EnemyControllerå¹¶æ·»åŠ æ¨å¼€äººç‰©æ–¹æ³•</h1><p>å› ä¸ºå…½äººæ˜¯ç”¨ç»§æ‰¿çš„ä»£ç ï¼Œæˆ‘ä»¬è¦ä¸“é—¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ”¾ç‰¹å®šæ•Œäººçš„<code>EnemyController</code>å­ç±»ä»£ç </p><img src="https://p5-tt.byteimg.com/origin/pgc-image/2a7f1d824413463f8bbb1701fb464525.png" alt="1.png" style="zoom:80%;" /><p>åŒæ—¶ä¹ŸæŠŠè¿™ä¸ªä»£ç æŒ‚è½½åˆ°å…½äººèº«ä¸Š</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Grunt</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">EnemyController</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Skillï¼ˆå…½äººç‰¹æ®Šæ”»å‡»è®¾ç½®ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> kickForce <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span><span class="token comment">//æ¨å¼€æ•Œäººè·ç¦»</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">kickOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å¦‚æœè®¿é—®ä¸äº†attackTargetè¦è¿”å›çˆ¶ç±»ä¿®æ”¹ä¸ºprotectå±æ€§</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Vector3</span> direction <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token operator">-</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>            direction<span class="token punctuation">.</span><span class="token function">Normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é‡åŒ–æ¨å¼€çš„æ–¹å‘</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token comment">//velocityè¡¨ç¤ºé€Ÿåº¦ï¼Œè¿™é‡Œç»™äº†ä¸»è§’ä¸€ä¸ªåå‘é€Ÿåº¦ï¼Œè¾¾åˆ°ç»™æ¨å¼€çš„æ•ˆæœ</span>            attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>velocity <span class="token operator">=</span> direction<span class="token operator">*</span>kickForce<span class="token punctuation">;</span>                        attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Dizzy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//äººç‰©è¿›å…¥çœ©æ™•çŠ¶æ€</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æŠŠåŠ¨ç”»äº‹ä»¶æ·»åŠ ä¸Šï¼Œ<code>Attack02</code>ç”¨çš„äº‹ä»¶æ˜¯æˆ‘ä»¬ä¸Šé¢å†™çš„<code>kickOff()</code></p><p>åŒæ—¶è¿™é‡Œæœ‰ä¸ªçœ©æ™•çŠ¶æ€ï¼Œæˆ‘ä»¬æŠŠçœ©æ™•åŠ¨ç”»å¦‚ä¸‹æ·»åŠ å¥½ï¼ŒåŒæ—¶çœ©æ™•åŠ¨ç”»é€Ÿåº¦æˆ‘æ”¹ä¸ºäº†2ï¼Œè®©å®ƒæ’­æ”¾å¿«ä¸€ç‚¹</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/e375df607aa64f32b0779527e3494c29.png" alt="2.png" style="zoom:80%;" /><h1 id="æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º"><a href="#æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º" class="headerlink" title="æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º"></a>æ›¿æ¢åŠ¨ç”»å¹¶ä¸”æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸º</h1><p>æˆ‘ä»¬æŠŠå²è±å§†çš„åŠ¨ç”»å¤åˆ¶ä¸€ä»½ç»™å…½äººï¼Œç„¶åä¸ºäº†ä¿æŒå…½äººåœ¨æ¨å¼€äººç‰©æ—¶äººç‰©è¿›å…¥çœ©æ™•çŠ¶æ€å¹¶ä¸”ä¸èƒ½ç§»åŠ¨ï¼Œæˆ‘ä»¬è¿˜è¦æ·»åŠ ä¸€ä¸ªåŠ¨ç”»è¡Œä¸ºï¼ˆ<code>Behaviour</code>ï¼‰</p><p>æ›¿æ¢åŠ¨ç”»è¿‡ç¨‹ä¸å†æè¿°ï¼Œä½†æ˜¯æ³¨æ„è¿™é‡Œ<strong>ä¸èƒ½</strong>é‡‡ç”¨åŠ¨ç”»æ§åˆ¶å™¨ç»§æ‰¿çš„æ–¹å¼</p><p>è¿™é‡Œå°±è¯´ä¸€ä¸‹åŠ¨ç”»è¡Œä¸ºï¼Œæ‰¾åˆ°äººç‰©çš„<code>Dizzy</code>åŠ¨ç”»ï¼Œç‚¹å‡»<code>Add Behaviour</code>ï¼Œåˆ›å»ºä¸€ä¸ªå«åš<code>Stop Agent</code>çš„è¡Œä¸ºï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªä»£ç æ–‡ä»¶ï¼Œåˆ›å»ºå¥½åæˆ‘ä»¬æŠŠè¿™ä¸ªä»£ç æ–‡ä»¶å½’ç±»æ”¾å¥½</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/3b6e539cae684b47ae1971d9d95485de.png" alt="3.png" style="zoom:80%;" /><img src="https://p9-tt.byteimg.com/origin/pgc-image/752bc9fca53d4a6a80c77a7381d9a0f0.png" alt="4.png" style="zoom:80%;" /><p>è¿™ä¸ªä»£ç æ–‡ä»¶æ‰“å¼€å°±å·²ç»æœ‰ä¸€äº›æ³¨é‡Šåœ¨é‚£äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å–æ¶ˆæˆ‘ä»¬è¦ç”¨æ–¹æ³•çš„æ³¨é‡Šï¼Œè¿™é‡Œç”¨åˆ°çš„å°±æ˜¯è¿›å…¥åŠ¨ç”»ã€åŠ¨ç”»æ’­æ”¾æ—¶ä»¥åŠåŠ¨ç”»ç»“æŸæ—¶åˆ»çš„ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StopAgent</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">StateMachineBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token comment">// OnStateEnter is called when a transition starts and the state machine starts to evaluate this state</span>    <span class="token keyword">override</span> <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnStateEnter</span><span class="token punctuation">(</span><span class="token class-name">Animator</span> animator<span class="token punctuation">,</span> <span class="token class-name">AnimatorStateInfo</span> stateInfo<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> layerIndex<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        animator<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// OnStateUpdate is called on each Update frame between OnStateEnter and OnStateExit callbacks</span>    <span class="token keyword">override</span> <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnStateUpdate</span><span class="token punctuation">(</span><span class="token class-name">Animator</span> animator<span class="token punctuation">,</span> <span class="token class-name">AnimatorStateInfo</span> stateInfo<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> layerIndex<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        animator<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// OnStateExit is called when a transition ends and the state machine finishes evaluating this state</span>    <span class="token keyword">override</span> <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnStateExit</span><span class="token punctuation">(</span><span class="token class-name">Animator</span> animator<span class="token punctuation">,</span> <span class="token class-name">AnimatorStateInfo</span> stateInfo<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> layerIndex<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>       animator<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// OnStateMove is called right after Animator.OnAnimatorMove()</span>    <span class="token comment">//override public void OnStateMove(Animator animator, AnimatorStateInfo stateInfo, int layerIndex)</span>    <span class="token comment">//&#123;</span>    <span class="token comment">//    // Implement code that processes and affects root motion</span>    <span class="token comment">//&#125;</span>    <span class="token comment">// OnStateIK is called right after Animator.OnAnimatorIK()</span>    <span class="token comment">//override public void OnStateIK(Animator animator, AnimatorStateInfo stateInfo, int layerIndex)</span>    <span class="token comment">//&#123;</span>    <span class="token comment">//    // Implement code that sets up animation IK (inverse kinematics)</span>    <span class="token comment">//&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹‹åæˆ‘ä»¬å¯ä»¥æŠŠè¡Œä¸ºæ”¾è¿›äººç‰©çš„çœ©æ™•ã€å—ä¼¤ç­‰åŠ¨ç”»ï¼Œç”šè‡³æ˜¯æ•Œäººçš„æ”»å‡»åŠ¨ç”»</p><p>æ³¨æ„çš„æ˜¯æ·»åŠ åˆ°æ•Œäººæ”»å‡»åŠ¨ç”»æ—¶å¯èƒ½ä¼šæœ‰ä¸€ä¸ªæŠ¥é”™ï¼ŒåŸå› æ˜¯æˆ‘ä»¬å¯èƒ½æŠŠæ•Œäººæ‰“æ­»äº†ï¼Œå¯¼è‡´è¡Œä¸ºæ— æ³•è·å¾—agentï¼Œè§£å†³åŠæ³•å¦‚ä¸‹ï¼Œæˆ‘ä»¬å»åˆ°<code>EnemyController.cs</code>ä¿®æ”¹æ•Œäººæ­»äº†ä¹‹åçš„çŠ¶æ€</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>collider<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢æ—¶å€™å¼€ä¸šå†æ¬¡æ”»å‡»</span><span class="token comment">//agent.enabled = false;//ç›´æ¥å…³é—­å¯¼èˆªç»„ä»¶</span>agent<span class="token punctuation">.</span>radius <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//æŠŠagentçš„èŒƒå›´ç¼©å°</span><span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">,</span><span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é”€æ¯æ¸¸æˆå¯¹è±¡ï¼Œå»¶è¿Ÿä¸º2ç§’</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬åŸæœ¬æƒ³å…³é—­agentä»¥è¾¾åˆ°agentæ²¡æœ‰ä½“ç§¯æ•ˆæœï¼Œæ‰€ä»¥å¯ä»¥æŠŠagent.enabled = false;è¯­å¥æ”¹ä¸ºäº†ç›´æ¥æŠŠagentèŒƒå›´ç¼©å°åˆ°0ï¼Œä¹Ÿæ˜¯åŒæ ·çš„æ•ˆæœ</p><p>åˆ°è¿™æˆ‘ä»¬å°±åˆæ­¥è®¾ç½®å¥½äº†å…½äººäº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; åœ¨è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥è®¾ç½®ä¸€ä¸‹å…½äººæ•Œäººï¼Œç”±äºå®ƒçš„&lt;code&gt;Attack02&lt;/code&gt;åŠ¨ç”»åŒ…å«ä¸€ä¸ªæ¨äººçš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œå•ç‹¬çš„æµ‹è¯•ï¼Œè€Œä¸æ˜¯ç»§ç»­æ²¿ç”¨ä¹‹å‰çš„&lt;code&gt;EnemyController&lt;/code&gt;ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨å®ƒåŸºç¡€ä¸Šè¿›è¡Œæ·»åŠ ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©ç»§æ‰¿ç±»æ–¹å¼æ”¹</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°16-åˆ¶ä½œæ›´å¤šçš„æ•Œäºº</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B016-%E5%88%B6%E4%BD%9C%E6%9B%B4%E5%A4%9A%E7%9A%84%E6%95%8C%E4%BA%BA/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B016-%E5%88%B6%E4%BD%9C%E6%9B%B4%E5%A4%9A%E7%9A%84%E6%95%8C%E4%BA%BA/</id>
    <published>2021-07-22T01:53:09.000Z</published>
    <updated>2021-07-22T15:31:27.489Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™ä¸€ç« æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„æ•Œäººæ•°é‡åˆ¶ä½œåœ°å¤šä¸€äº›ï¼Œæ›´åŠ åœ°å»å®Œå–„æ¸¸æˆ</p><h1 id="åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†"><a href="#åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†" class="headerlink" title="åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†"></a>åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†</h1><p>åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†å¾ˆç®€å•ï¼Œåªç”¨å¯¹ç€ä¹‹å‰çš„å²è±å§†<code>Ctrl + D</code>å¤åˆ¶ä¸€ä¸‹å°±å¯ä»¥</p><p>ä½†æ˜¯è¿™ä¹‹ä¸­ä¹Ÿæœ‰å­˜åœ¨é—®é¢˜ï¼Œå°±æ˜¯å²è±å§†ä¼šå…±ç”¨ä¸€ä¸ª<code>Character Data</code>ï¼Œè¿™å¯ä»¥åœ¨æ¯æ¬¡å¼€å§‹æ¸¸æˆæ—¶åˆ›å»ºä¸€ä¸ªä¸´æ—¶<code>Data</code>ç»™ä»–ä»¬æ¥è§£å†³</p><p>æ‰“å¼€<code>Character States.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token class-name">CharacterData_SO</span> characterData<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">CharacterData_SO</span> templateData<span class="token punctuation">;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>templateData <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token comment">//å¤åˆ¶ä¸€ä¸ªä¸´æ—¶æ¨¡æ¿Data</span>        characterData <span class="token operator">=</span> <span class="token function">Instantiate</span><span class="token punctuation">(</span>templateData<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”Ÿæˆå¤šä¸€ä¸ªdata</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå²è±å§†èº«ä¸Šçš„<code>Data</code>å¦‚ä¸‹è®¾ç½®</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/e780aba5845e41caa4a1b38673b38708.png" alt="2.png" style="zoom:80%;" /><h1 id="æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ"><a href="#æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ" class="headerlink" title="æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ"></a>æ”¾ç½®ä¸€ä¸ªåˆºåˆºé¾Ÿ</h1><p>æˆ‘ä»¬çš„å²è±å§†ç´ ææ–‡ä»¶å¤¹ä¸‹æœ‰å¦å¤–ä¸€ä¸ªæ•Œäººåˆºåˆºé¾Ÿï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒæ”¾ç½®ä¸Šæ¥</p><p>ç”±äºå®ƒä¹Ÿæ˜¯ä¾èµ–<code>EnemyController.cs</code>çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä¹‹å‰è¿˜è¦æ·»åŠ ä¸€è¡Œå¼ºåˆ¶é™„å¸¦ç»„ä»¶ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">RequireComponent</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">CharacterStates</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±å¯ä»¥å¼ºåˆ¶é™„å¸¦<code>CharacterStates</code>ä»£ç ç»„ä»¶äº†</p><p>åœ¨ç´ æä¸­æ‰¾åˆ°åˆºåˆºé¾ŸæŠŠå®ƒæ”¾ç½®åœ¨åœ°å›¾ä¸Š</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/c0a6ab51762547b5855e2d4d808bb14c.png" alt="3.png" style="zoom:80%;" /><p>ç„¶åä¸ºå®ƒæ·»åŠ <code>EnemyController.cs</code>ï¼Œä»¥åŠè®¾ç½®å¥½åŸºæœ¬ä¿¡æ¯</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/82f0fc3573f7434aa1a235f4fbe931c3.png" alt="4.png" style="zoom:80%;" /><p>è¿˜æœ‰ä¸€ä¸ªå…³é”®çš„åœ°æ–¹åœ¨äºåŠ¨ç”»çš„åˆ‡æ¢ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€ä¸ªæŠ€å·§ï¼ŒæŠŠå²è±å§†åŸæ¥çš„<code>Animations</code>å¤åˆ¶ä¸€ä¸ªå‡ºæ¥ç›´æ¥è¦†ç›–æ›¿æ¢åŠ¨ç”»</p><p>æˆ‘ä»¬åœ¨å³é”®åˆ›å»ºæ—¶é€‰æ‹©<code>Animator Override Controller</code>å°±å¯ä»¥äº†</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/61c8eb67c769464eb07f58ab37b2c59d.png" alt="5.png" style="zoom:80%;" /><p>ç„¶åå±æ€§é¢æ¿ä¸­ç¬¬ä¸€ä¸ªé€‰é¡¹å°±ä¼šé—®æˆ‘ä»¬è¦ä¾é å“ªä¸ª<code>Animation</code>ä¸ºæ¨¡æ¿ï¼Œæˆ‘ä»¬é€‰æ‹©å²è±å§†åŸæ¥çš„åŠ¨ç”»</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/60d1f5873d4b440ba04764b3bdfd5cda.png" alt="6.png" style="zoom:80%;" /><p>ä¹‹åå†å°†å®ƒä»¬æ›¿æ¢å°±å¯ä»¥äº†ï¼Œåˆ«å¿˜äº†<code>Attack01</code>å’Œ<code>Attack02</code>è¦å•ç‹¬å¤åˆ¶å‡ºæ¥ä»¥åŠæ·»åŠ å¸§äº‹ä»¶</p><h1 id="å…½äººå’ŒçŸ³å¤´äºº"><a href="#å…½äººå’ŒçŸ³å¤´äºº" class="headerlink" title="å…½äººå’ŒçŸ³å¤´äºº"></a>å…½äººå’ŒçŸ³å¤´äºº</h1><p>è¿˜æœ‰éœ€è¦æ·»åŠ çš„å°±æ˜¯å…½äººå’ŒçŸ³å¤´äººï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶æ·»åŠ å¥½ç´ æå†æŠŠå®ƒä»¬ç§»åˆ°åœ°å›¾ä¸Šå°±å¥½äº†ï¼Œä¹‹åçš„äº‹æƒ…ä¸‹ä¸€ç« èŠ‚å†å¤„ç†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/712fe6fd05d24f17a782e3bbd8937ab7.png" alt="7.png" style="zoom:80%;" /><img src="https://p5-tt.byteimg.com/origin/pgc-image/c884e6e35d714f3988fb0a5b4109a5cc.png" alt="8.png" style="zoom:80%;" />]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™ä¸€ç« æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„æ•Œäººæ•°é‡åˆ¶ä½œåœ°å¤šä¸€äº›ï¼Œæ›´åŠ åœ°å»å®Œå–„æ¸¸æˆ&lt;/p&gt;
&lt;h1 id=&quot;åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†&quot;&gt;&lt;a href=&quot;#åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†&quot; class=&quot;headerlink&quot; title=&quot;åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†&quot;&gt;&lt;/a&gt;åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†&lt;/h1&gt;&lt;p&gt;åˆ¶ä½œå¤šä¸€ä¸ªå²è±å§†å¾ˆ</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°15-ä½¿ç”¨æ¥å£å®ç°è§‚å¯Ÿè€…æ¨¡å¼çš„è®¢é˜…å’Œå¹¿æ’­</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B015-%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%AE%A2%E9%98%85%E5%92%8C%E5%B9%BF%E6%92%AD/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B015-%E4%BD%BF%E7%94%A8%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%AE%A2%E9%98%85%E5%92%8C%E5%B9%BF%E6%92%AD/</id>
    <published>2021-07-21T01:30:13.000Z</published>
    <updated>2021-07-22T04:22:22.553Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™ä¸€ç« æˆ‘ä»¬ä½¿ç”¨æ¥å£æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼çš„è®¢é˜…å’Œå¹¿æ’­ï¼ŒåŒæ—¶ä¹Ÿæ¥å®ç°ç©å®¶æ­»äº†æ¸¸æˆç»“æŸä¹‹åæ•Œäººçš„è·èƒœåŠ¨ç”»</p><h1 id="ç¼–å†™æ¥å£"><a href="#ç¼–å†™æ¥å£" class="headerlink" title="ç¼–å†™æ¥å£"></a>ç¼–å†™æ¥å£</h1><p>åœ¨<code>Tools</code>æ–‡ä»¶å¤¹ä¸‹æˆ‘ä»¬æ–°å»ºä¸€ä¸ªä»£ç æ–‡ä»¶<code>IEndGameObserver.cs</code>è¡¨ç¤ºæ¸¸æˆç»“æŸä¹‹åçš„æ¥å£</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IEndGameObserver</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ³¨æ„æ¥å£åªå†™å£°æ˜ä¸å†™å®šä¹‰</span>    <span class="token comment">//æ¸¸æˆç»“æŸè¦æ“ä½œçš„éƒ½åœ¨è¿™ä¸ªæ¥å£å®ç°</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æ¥åˆ°<code>EnemyController.cs</code>ç¼–å†™ä¸€ä¸ªå¹¿æ’­æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span><span class="token punctuation">,</span><span class="token class-name">IEndGameObserver</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è·èƒœåŠ¨ç”»</span>        <span class="token comment">//åœæ­¢æ‰€æœ‰ç§»åŠ¨</span>        <span class="token comment">//åœæ­¢Agent</span>        isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        attackTarget <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶å®ƒè¦åœ¨æ¸¸æˆç»“æŸæ—¶è¦æœ‰æ“ä½œçš„ä»£ç ä¹Ÿå¯ä»¥åƒè¿™ç§æ–¹å¼æ¥ç»§æ‰¿æ¥å£å¹¶å®ç°æ“ä½œ</p><h1 id="è®¢é˜…æ¥å£"><a href="#è®¢é˜…æ¥å£" class="headerlink" title="è®¢é˜…æ¥å£"></a>è®¢é˜…æ¥å£</h1><p>å› ä¸ºæˆ‘ä»¬ä¼šæœ‰å¾ˆå¤šä¸åŒçš„ä»£ç æ–‡ä»¶éƒ½ä¼šç»§æ‰¿è¿™ä¸ªæ¥å£ï¼Œæ€æ ·æ¥ç®¡ç†è®¢é˜…ä¹Ÿæ˜¯å€¼å¾—è€ƒè™‘çš„äº‹æƒ…</p><p>æ‰“å¼€ä¸Šä¸€ç« åˆ›å»ºçš„<code>GameManager.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GameManager</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Sigltion<span class="token punctuation">&lt;</span>GameManager<span class="token punctuation">></span></span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">CharacterStates</span> playerStates<span class="token punctuation">;</span>    <span class="token comment">//æ¸¸æˆç»“æŸæ—¶è°ƒç”¨çš„æ–¹æ³•çš„æ•°ç»„</span>    List<span class="token operator">&lt;</span>IEndGameObserver<span class="token operator">></span>endGameObservers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>IEndGameObserver<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RigisterPlayer</span><span class="token punctuation">(</span><span class="token class-name">CharacterStates</span> player<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//é€šè¿‡å¤–ç•Œæ³¨å†Œçš„æ–¹å¼æ¥è·å¾—å¯¹è±¡çš„playerStates</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>playerStates <span class="token operator">=</span> player<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">AddObserve</span><span class="token punctuation">(</span><span class="token class-name">IEndGameObserver</span> gameObserver<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åŠ å…¥å¾…æ“ä½œæ•°ç»„</span>        endGameObservers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>gameObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">RemoveObserve</span><span class="token punctuation">(</span><span class="token class-name">IEndGameObserver</span> gameObserver<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//å°†ç‰¹å®šçš„è§‚å¯Ÿè€…åœ¨å¾…æ“ä½œæ•°ç»„ä¸­åˆ é™¤</span>        endGameObservers<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>gameObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">NotifyObserves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è°ƒç”¨å¾…æ“ä½œæ•°ç»„ä¸­æ¯ä¸€ä¸ªè§‚å¯Ÿè€…</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">IEndGameObserver</span> gameObserver <span class="token keyword">in</span> endGameObservers<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            gameObserver<span class="token punctuation">.</span><span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæˆ‘ä»¬æ˜¯è¦åœ¨ä¸»è§’æ­»äº†ä¹‹åå¼€å§‹æ¸¸æˆç»“æŸçš„æ“ä½œï¼Œæ‰€ä»¥å›åˆ°<code>PlayerController.cs</code>åœ¨åˆ¤æ–­ä¸»è§’æ­»äº†ä¹‹åè°ƒç”¨å¹¿æ’­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">.</span>currentHealth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//åˆ¤æ–­æ­»äº¡</span>        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">NotifyObserves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ—¶æˆ‘ä»¬åœ¨<code>EnemyController.cs</code>ä¸­è¿˜è¦è¡¥å……ä¸€ä¸ªåŠ å…¥å¾…æ“ä½œæ•°ç»„æ–¹æ³•å’Œç§»é™¤æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//void OnEnable()&#123;//Unityçš„ä¸€ä¸ªå¯åŠ¨æ¸¸æˆæ—¶è‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°</span><span class="token comment">//  GameManager.Instance.AddObserve(this);</span><span class="token comment">// &#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å¼€å§‹æ¸¸æˆæ—¶å…ˆæ£€æµ‹æ˜¯å¦å‹¾é€‰äº†å®ˆå«çŠ¶æ€</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isGuard<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">;</span>        <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//FIXME:åœºæ™¯åˆ‡æ¢åšå¥½åä¿®æ”¹æ‰</span>    GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">AddObserve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDisable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>GameManager<span class="token punctuation">.</span>IsInitialized<span class="token punctuation">)</span>         <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœGameManageræ²¡æœ‰ç»™æ„å»ºçš„è¯å°±ç›´æ¥return</span>        GameManager<span class="token punctuation">.</span>Instance<span class="token punctuation">.</span><span class="token function">RemoveObserve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äº<code>OnEnable()</code>æ˜¯åœ¨æ¸¸æˆå¼€å§‹æ—¶æ—©æœŸå°±è°ƒç”¨çš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¿™æ ·å†™ä¼šå‘ç”ŸæŠ¥é”™ï¼Œæˆ‘ä»¬è¦ç­‰åˆ°åé¢å†™åœºæ™¯åŠ è½½æ—¶æ‰ç”¨è¿™ç§æ–¹æ³•ï¼Œè¿™é‡Œæš‚æ—¶æŠŠåŠ å…¥å¾…æ“ä½œæ•°ç»„ä»£ç å•ç‹¬å†™åˆ°<code>Start()</code>é‡Œ</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/5e902802764e44b099915b6323377dfb.png" alt="1.png" style="zoom:80%;" /><h1 id="é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»"><a href="#é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»" class="headerlink" title="é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»"></a>é…ç½®æ•Œäººèƒœåˆ©åŠ¨ç”»</h1><p>æˆ‘ä»¬æ‰“å¼€åŠ¨ç”»ç®¡ç†å™¨ï¼Œé…ç½®æ•Œäººåœ¨æ‰“æ­»ä¸»è§’åçš„åŠ¨ç”»</p><p>æ–°å»ºä¸€ä¸ª<code>Victory Layer</code>ï¼ˆæ³¨æ„æƒé‡å€¼ä¸º1ï¼‰ï¼Œä»¥åŠä¸€ä¸ª<code>Win</code>å¸ƒå°”å€¼æ§åˆ¶åŠ¨ç”»è§¦å‘</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/85512e9ac113448c808c81d1b29dc079.png" alt="1.png" style="zoom:80%;" /><p>è¿”å›<code>EnemyController.cs</code>ä»£ç æˆ‘ä»¬è¦é…ç½®åŠ¨ç”»å˜é‡ä»€ä¹ˆæ—¶å€™è§¦å‘</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">.</span>currentHealth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡å˜0åˆ™æ­»äº¡çŠ¶æ€ä¸ºçœŸ</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//åŠ äº†ä¸ªelseæ˜¯é˜²æ­¢æ­»åæ•Œäººåœ¨èƒœåˆ©åŠ¨ç”»ä¸‹ä¸€å¸§åˆç»™åˆ‡æ¢å›æ™®é€šåŠ¨ç”»</span>        <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        lastAttackTime<span class="token operator">-=</span>Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span><span class="token comment">//æ¯ä¸€å¸§éƒ½å‡å†·å´</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è·èƒœåŠ¨ç”»</span>    <span class="token comment">//åœæ­¢æ‰€æœ‰ç§»åŠ¨</span>    <span class="token comment">//åœæ­¢Agent</span>    anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Win"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    attackTarget <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åæˆ‘ä»¬å‘ç°ä¸»è§’æ­»äº†ä¹‹åè¿˜æ˜¯å¯ä»¥æ§åˆ¶ç§»åŠ¨ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨<code>PlyaerController.cs</code>ä¿®å¤ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">MoveToTarget</span><span class="token punctuation">(</span><span class="token class-name">Vector3</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isDead<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœæ­»äº†å°±ä¸èƒ½ç§»åŠ¨</span><span class="token function">StopAllCoroutines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»ˆæ­¢å…¶å®ƒç§»åŠ¨å‘½ä»¤</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> target<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EventAttact</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>isDead<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token comment">//å¦‚æœæ­»äº†å°±ä¸èƒ½ç§»åŠ¨</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœé¼ æ ‡ç‚¹å‡»çš„ç›®æ ‡ä¸ä¸ºç©ºï¼Œæˆ–è€…ç‚¹å‡»çš„æ•Œäººä¸æ˜¯å±äºæ­»äº¡çŠ¶æ€</span>attactTarget <span class="token operator">=</span> target<span class="token punctuation">;</span><span class="token comment">//åˆ¤æ–­æ˜¯å¦æš´å‡»</span>charcterStates<span class="token punctuation">.</span>isCritical <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">&lt;</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>criticalChance<span class="token punctuation">;</span><span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™ä¸€ç« æˆ‘ä»¬ä½¿ç”¨æ¥å£æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼çš„è®¢é˜…å’Œå¹¿æ’­ï¼ŒåŒæ—¶ä¹Ÿæ¥å®ç°ç©å®¶æ­»äº†æ¸¸æˆç»“æŸä¹‹åæ•Œäººçš„è·èƒœåŠ¨ç”»&lt;/p&gt;
&lt;h1 id=&quot;ç¼–å†™æ¥å£&quot;&gt;&lt;a href=&quot;#ç¼–å†™æ¥å£&quot; class=&quot;headerlink&quot; title=&quot;ç¼–å†™æ¥å£&quot;&gt;&lt;/a&gt;ç¼–å†™æ¥å£&lt;/h1&gt;&lt;p&gt;åœ¨&lt;code</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°14-æ³›å‹å•ä¾‹æ¨¡å¼</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B014-%E6%B3%9B%E5%9E%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B014-%E6%B3%9B%E5%9E%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-07-20T01:52:36.000Z</published>
    <updated>2021-07-21T01:34:24.792Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ä¸€ç« æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªæ³›å‹å•ä¾‹æ¨¡å¼çš„ä»£ç ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„é¡¹ç›®ä¸­ä¼šæœ‰å¾ˆå¤šçš„<code>Manager</code>ï¼Œå¦‚æœæ¯ä¸ªéƒ½ä½¿ç”¨å•ä¾‹æ¨¡å¼ä¼šæ›´å¥½åœ°å»ç®¡ç†å’Œä½¿ç”¨</p><p>ä¾‹å¦‚å…¶ä¸­æ§åˆ¶æˆ‘ä»¬æ¸¸æˆçš„å¼€å§‹æš‚åœç­‰ä¸€èˆ¬æ˜¯ç”¨<code>Game Manager</code>æ¥å‘½åï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªä»£ç æ–‡ä»¶ä»¥åŠä¸€ä¸ªç©ºå¯¹è±¡ä½¿å¾—ä»£ç å¯ä»¥ä¾é™„åœ¨å®ƒä¸Šé¢</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/d8bf83d3ad554952a66a0b00aafc1b96.png" alt="1.png" style="zoom:80%;" /><p>è¿™ä¸ªä»£ç æˆ‘ä»¬å…ˆæ”¾åœ¨ä¸€è¾¹ä¹‹åå†è¡¥å……ï¼Œå…ˆæŠŠæ³›å‹å•ä¾‹æ¨¡å¼ä»£ç å†™äº†å…ˆ</p><h1 id="æ³›å‹å•ä¾‹æ¨¡å¼"><a href="#æ³›å‹å•ä¾‹æ¨¡å¼" class="headerlink" title="æ³›å‹å•ä¾‹æ¨¡å¼"></a>æ³›å‹å•ä¾‹æ¨¡å¼</h1><p>åˆ›å»ºç›®å½•æ–‡ä»¶å¦‚ä¸‹</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/86a804f3de9a4c9b960af8c63dd89626.png" alt="2.png" style="zoom:80%;" /><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sigltion<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span> <span class="token keyword">where</span> <span class="token class-name">T</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Sigltion<span class="token punctuation">&lt;</span>T<span class="token punctuation">></span></span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">T</span> instance<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">T</span> Instance<span class="token punctuation">&#123;</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> instance<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å…è®¸å­ç±»å¯¹Awakeè¿›è¡Œé‡å†™</span>    <span class="token keyword">protected</span> <span class="token keyword">virtual</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>instance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            instance <span class="token operator">=</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token keyword">this</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ£€æµ‹å•ä¾‹æ˜¯å¦ç”Ÿæˆ</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> IsInitialized<span class="token punctuation">&#123;</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> instance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//å…è®¸å­ç±»ä¿®æ”¹é”€æ¯æ—¶çš„æ“ä½œ</span>    <span class="token keyword">protected</span> <span class="token keyword">virtual</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span>            instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ä¸€æ—¦ä¸€ä¸ªAç±»ç»§æ‰¿äº†<code>Sigltion&lt;A&gt;</code>ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å…¶å®ƒç±»ä¸­è°ƒç”¨Aç±»çš„å•ä¾‹ï¼Œå¦‚ï¼š<code>A.Instance</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ä¸€ç« æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªæ³›å‹å•ä¾‹æ¨¡å¼çš„ä»£ç ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„é¡¹ç›®ä¸­ä¼šæœ‰å¾ˆå¤šçš„&lt;code&gt;Manager&lt;/code&gt;ï¼Œå¦‚æœæ¯ä¸ªéƒ½ä½¿ç”¨å•ä¾‹æ¨¡å¼ä¼šæ›´å¥½åœ°å»ç®¡ç†å’Œä½¿ç”¨&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚å…¶ä¸­æ§åˆ¶æˆ‘ä»¬æ¸¸æˆçš„å¼€å§‹æš‚åœç­‰ä¸€èˆ¬æ˜¯ç”¨&lt;code&gt;Game Manager&lt;/code&gt;æ¥å‘½åï¼Œæˆ‘ä»¬æ¥</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°13-æ•Œäººçš„å®ˆå«çŠ¶æ€å’Œæ­»äº¡çŠ¶æ€</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B013-%E6%95%8C%E4%BA%BA%E7%9A%84%E5%AE%88%E5%8D%AB%E7%8A%B6%E6%80%81%E5%92%8C%E6%AD%BB%E4%BA%A1%E7%8A%B6%E6%80%81/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B013-%E6%95%8C%E4%BA%BA%E7%9A%84%E5%AE%88%E5%8D%AB%E7%8A%B6%E6%80%81%E5%92%8C%E6%AD%BB%E4%BA%A1%E7%8A%B6%E6%80%81/</id>
    <published>2021-07-19T01:43:57.000Z</published>
    <updated>2021-07-19T04:08:52.903Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥åˆ¶ä½œæ•Œäººçš„å®ˆå«çŠ¶æ€å’Œæ­»äº¡çŠ¶æ€</p><h1 id="æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰"><a href="#æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰" class="headerlink" title="æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰"></a>æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰</h1><p>æ‰“å¼€<code>EnemyController.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token class-name">Quaternion</span> guardRotation<span class="token punctuation">;</span><span class="token comment">//è®°å½•æ•Œäººæœ€åˆçš„æ—‹è½¬è§’åº¦ï¼Œç”¨äºè„±ç¦»è¿½å‡»å›å»å®ˆå«ç‚¹ç –å¤´è½¬å¤´</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    guardRotation <span class="token operator">=</span> transform<span class="token punctuation">.</span>rotation<span class="token punctuation">;</span><span class="token comment">//è·å¾—æœ€åˆæ—‹è½¬è§’åº¦</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>å®ˆå«çŠ¶æ€            isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è„±ç¦»è¿½å‡»çŠ¶æ€</span>            <span class="token comment">//å¦‚æœåœ¨è¿½å‡»ä¸»è§’æ—¶å›åˆ°å®ˆå«çŠ¶æ€ï¼Œå°±è¦è·‘å›å®ˆå«ç‚¹</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position <span class="token operator">!=</span> guardPos<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                isWalk <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ’­æ”¾èµ°è·¯åŠ¨ç”»</span>                agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token comment">//å¯¼èˆªå›æœ€åˆå®ˆå«ç‚¹</span>                agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> guardPos<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">SqrMagnitude</span><span class="token punctuation">(</span>guardPos <span class="token operator">-</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">&lt;=</span>agent<span class="token punctuation">.</span>stoppingDistance<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//SqrMagnitudeä¹Ÿæ˜¯å¯ä»¥ç”¨äºæ¯”è¾ƒè·ç¦»çš„æ–¹æ³•ï¼Œæ¯”èµ·Distanceç¨å¾®å¿«ä¸€äº›</span>                    <span class="token comment">//è¿™é‡Œæ˜¯åˆ¤æ–­æ˜¯å¦åˆ°è¾¾æœ€åˆå®ˆå«ç‚¹å¯ä»¥åœæ­¢èŒƒå›´</span>                    isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                    <span class="token comment">//æ…¢æ…¢è½¬å¤´ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°è¶Šæ¥è¿‘1è½¬å¾—è¶Šå¿«</span>                    transform<span class="token punctuation">.</span>rotation <span class="token operator">=</span> Quaternion<span class="token punctuation">.</span><span class="token function">Lerp</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>rotation<span class="token punctuation">,</span>guardRotation<span class="token punctuation">,</span><span class="token number">0.01f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬å°±å†™å¥½äº†å®ˆå«çŠ¶æ€çš„ä»£ç ï¼Œå…¶ä¸­<code>SqrMagnitude()</code>ä½œç”¨å’Œ<code>Distance()</code>ä¸€æ ·éƒ½æ˜¯æ¯”è¾ƒä¸¤ä¸ªç‚¹çš„è·ç¦»ï¼Œç„¶åæˆ‘ä»¬è¿˜åŠ äº†æ…¢æ…¢è½¬å¤´çš„æ•ˆæœï¼Œå¦åˆ™æ•Œäººå›åˆ°å®ˆå«ç‚¹æ˜¯ä¸ä¼šè½¬å¤´çš„</p><h1 id="æ­»äº¡çŠ¶æ€"><a href="#æ­»äº¡çŠ¶æ€" class="headerlink" title="æ­»äº¡çŠ¶æ€"></a>æ­»äº¡çŠ¶æ€</h1><p>æˆ‘ä»¬å¸Œæœ›å½“æ•Œäººè¡€é‡ä¸º0æ—¶æ’­æ”¾æ­»äº¡åŠ¨ç”»å¹¶ä¸”å°¸ä½“æ¶ˆå¤±æ‰</p><h2 id="è®¾ç½®æ­»äº¡åŠ¨ç”»"><a href="#è®¾ç½®æ­»äº¡åŠ¨ç”»" class="headerlink" title="è®¾ç½®æ­»äº¡åŠ¨ç”»"></a>è®¾ç½®æ­»äº¡åŠ¨ç”»</h2><p>æ‰“å¼€åŠ¨ç”»æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª<code>Death Layer</code>ï¼Œä¸è¦å¿˜äº†æƒé‡è®¾ä¸º1</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/32be87ac0205413280a7f42a61d7296e.png" alt="1.png" style="zoom:80%;" /><p>è¿™é‡Œæœ‰ä¸ª<code>GetHit</code>æ˜¯ç”¨æ¥åšæš´å‡»ä¼¤å®³å—ä¼¤æ•ˆæœçš„ï¼Œå®ƒæœ‰å·¦è¾¹çš„<code>Hit</code>è§¦å‘ï¼Œè€Œæˆ‘ä»¬çš„æ­»äº¡åŠ¨ç”»<code>Die</code>è¿ç€<code>Any State</code>è¡¨ç¤ºä»»ä½•çŠ¶æ€éƒ½èƒ½è½¬ç§»è¿‡æ¥ï¼Œç”±å¸ƒå°”å€¼<code>Death</code>æ§åˆ¶</p><p><strong>ç‰¹åˆ«è¦æ³¨æ„çš„åœ°æ–¹ï¼š</strong>å…³äºæ­»äº¡åŠ¨ç”»çš„è®¾ç½®<code>Can Transition To</code>ä¸€å®šä¸èƒ½å‹¾é€‰ï¼Œä¸ç„¶ä¼šå‘ç”Ÿé¬¼ç•œ</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/497e554f53c24b17be551acb0694058c.png" alt="2.png" style="zoom:80%;" /><p>æ¥ä¸‹æ¥ä¸»è§’çš„åŠ¨ç”»ä¹Ÿæ˜¯å¦‚æ­¤è®¾ç½®</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/66e702dd2c644d058b5e628fbcf052c6.png" alt="3.png" style="zoom:80%;" /><h2 id="ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç "><a href="#ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç " class="headerlink" title="ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç "></a>ç¼–å†™åŠ¨ç”»çŠ¶æ€è½¬ç§»ä»£ç </h2><p>å›åˆ°æˆ‘ä»¬çš„<code>EnemyController.cs</code>ä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token class-name">Collider</span> collider<span class="token punctuation">;</span><span class="token comment">//ç¢°æ’ä½“ç»„ä»¶</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isDead<span class="token punctuation">;</span><span class="token comment">//æ­»äº¡çŠ¶æ€æ§åˆ¶</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    collider <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Collider<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">.</span>currentHealth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        isDead <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡å˜0åˆ™æ­»äº¡çŠ¶æ€ä¸ºçœŸ</span>    <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Death"</span><span class="token punctuation">,</span>isDead<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦æ’­æ”¾æ­»äº¡åŠ¨ç”»</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç¬¬ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºæ­»äº¡</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isDead<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœå‘ç°player åˆ‡æ¢åˆ°CHASE</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">;</span>        <span class="token comment">//Debug.LogFormat("æ•Œäºº&#123;0&#125;å‘ç°äº†ç©å®¶",this.name);//æµ‹è¯•ä»£ç </span>    <span class="token punctuation">&#125;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>    collider<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢æ—¶å€™å¼€ä¸šå†æ¬¡æ”»å‡»</span>    agent<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ç›´æ¥å…³é—­å¯¼èˆªç»„ä»¶</span>    <span class="token function">Destroy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>gameObject<span class="token punctuation">,</span><span class="token number">2f</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é”€æ¯æ¸¸æˆå¯¹è±¡ï¼Œå»¶è¿Ÿä¸º2ç§’</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬è®¾ç½®äº†<code>Death</code>çš„åŠ¨ç”»çŠ¶æ€ï¼Œæ³¨æ„å¼€å¤´<code>if(isDead)</code>çš„ä¸‹ä¸€ä¸ªæ˜¯<code>else if</code>ï¼Œè€Œ<code>Hit</code>çš„çŠ¶æ€å¯ä»¥å»åˆ°<code>CharcterStates.cs</code>ä¸­è®¾ç½®</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharcterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharcterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³æ•°å€¼</span>    <span class="token comment">//å½“å‰æ”»å‡»åŠ›å‡å»ç›®æ ‡çš„é˜²å¾¡åŠ›ï¼Œå¦‚æœé˜²å¾¡åŠ›è¿‡é«˜å°±æ˜¯0ä¼¤å®³</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡ä¹Ÿæ˜¯æœ€å°å€¼é”åœ¨0</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isCritical<span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­è¢«æ‰“è€…æ˜¯å¦å—åˆ°æš´å‡»å¹¶ä¸”æ’­æ”¾å—ä¼¤åŠ¨ç”»</span>        defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//å°†æ¥è¦åšçš„äº‹æƒ…</span>    <span class="token comment">//TODO:è¡€é‡æ¡UI</span>    <span class="token comment">//TODO:æ‰“æ­»æ€ªååŠ ç»éªŒ</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸­é—´æˆ‘ä»¬æ‰“äº†ä¸€è¡Œä»£ç ï¼Œç”¨æ¥è·å–è¢«æ‰“è€…çš„Animatorå¹¶è®¾ç½®åŠ¨ç”»<code>Hit</code>çŠ¶æ€ï¼Œè¿™æ ·å°±å¯ä»¥é›†ä¸­ç®¡ç†æš´å‡»å—ä¼¤åŠ¨ç”»äº†</p><p>æœ€åå¯¹äºä¸»è§’æˆ‘ä»¬ä¹Ÿç”¨ç›¸åŒçš„åŠæ³•æ¥å†™è¿™äº›ä»£ç å°±å¤§åŠŸå‘Šæˆäº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥åˆ¶ä½œæ•Œäººçš„å®ˆå«çŠ¶æ€å’Œæ­»äº¡çŠ¶æ€&lt;/p&gt;
&lt;h1 id=&quot;æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰&quot;&gt;&lt;a href=&quot;#æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰&quot; class=&quot;headerlink&quot; title=&quot;æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰&quot;&gt;&lt;/a&gt;æ•Œäººçš„å®ˆå«çŠ¶æ€ï¼ˆGuardï¼‰</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°12-å®ç°æ”»å‡»æ•°å€¼è®¡ç®—</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B012-%E5%AE%9E%E7%8E%B0%E6%94%BB%E5%87%BB%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B012-%E5%AE%9E%E7%8E%B0%E6%94%BB%E5%87%BB%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/</id>
    <published>2021-07-18T01:29:45.000Z</published>
    <updated>2021-07-26T01:10:45.401Z</updated>
    
    <content type="html"><![CDATA[<p> è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥å®ç°æ”»å‡»ä¼¤å®³çš„è®¡ç®—ï¼Œç»™äºˆäººç‰©æˆ–æ•ŒäººçœŸå®çš„æ”»å‡»ä¼¤å®³</p><h1 id="è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»"><a href="#è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»" class="headerlink" title="è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»"></a>è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»</h1><p>åœ¨ä¹‹å‰æˆ‘ä»¬è¦ç»™äººç‰©æ·»åŠ ä¸€ä¸‹æš´å‡»åŠ¨ç”»ï¼Œå’Œä¸Šä¸€ç« èŠ‚è®¾ç½®æ•ŒäººåŠ¨ç”»ç±»ä¼¼ï¼Œæ³¨æ„è¦è®¾ç½®åŠ¨ç”»åˆ‡æ¢æ•ˆæœ</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/db2c7f3914614d4ea5ec93211e2b47a7.png" alt="1.png" style="zoom:80%;" /><p>æ‰“å¼€<code>PlayerController.cs</code>ï¼Œä¿®æ”¹ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">></span>          charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>attackRange<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ¯”è¾ƒäººç‰©å’Œæ•Œäººçš„è·ç¦»æ˜¯å¦å¤§äº0æ”»å‡»è·ç¦»ï¼ŒDistance()å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªVector3è·ç¦»</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token comment">//æ”»å‡»åŠ¨ç”»å’ŒCDéƒ½åœ¨ä¸‹é¢</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>lastAttactTime<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//CDå†·å´å®Œæˆå¯æ‰§è¡Œæ”»å‡»</span>        animator<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Critical"</span><span class="token punctuation">,</span>charcterStates<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¢åŠ äº†ä¼ é€’æ˜¯å¦æš´å‡»</span>        animator<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Attack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ™®é€šæ”»å‡»</span>        lastAttactTime <span class="token operator">=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>coolDown<span class="token punctuation">;</span><span class="token comment">//ä¿®æ”¹äº†è¿™é‡Œçš„CDæ—¶é—´</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬ä¿®æ”¹äº†ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯å¢åŠ äº†æš´å‡»åˆ¤æ–­ï¼Œå¦ä¸€ä¸ªæ˜¯ä¿®æ”¹äº†CDæ—¶é—´åˆ¤æ–­</p><h1 id="å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—"><a href="#å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—" class="headerlink" title="å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—"></a>å¢åŠ æ”»å‡»æ•°å€¼è®¡ç®—</h1><p>å‰é¢è¡¥å……å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼æ¥å†™æ”»å‡»ä¼¤å®³çš„æ•°å€¼è®¡ç®—äº†</p><p>æ‰“å¼€<code>CharcterStates.cs</code>ï¼Œæˆ‘ä»¬åœ¨æœ€ä¸‹é¢åŠ ä¸Šæˆ‘ä»¬çš„ä¼¤å®³è®¡ç®—ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">EventAttact</span><span class="token punctuation">(</span><span class="token class-name">GameObject</span> target<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœé¼ æ ‡ç‚¹å‡»çš„ç›®æ ‡ä¸ä¸ºç©ºï¼Œæˆ–è€…ç‚¹å‡»çš„æ•Œäººä¸æ˜¯å±äºæ­»äº¡çŠ¶æ€</span>        attactTarget <span class="token operator">=</span> target<span class="token punctuation">;</span>        <span class="token comment">//éšæœºæš´å‡»ç‡è¯­å¥</span>        charcterStates<span class="token punctuation">.</span>isCritical <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">&lt;</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>criticalChance<span class="token punctuation">;</span>        <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//ä¼¤å®³è®¡ç®—åŒº</span><span class="token preprocessor property">#<span class="token directive keyword">region</span> Charcter Combat</span>    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TakeDamage</span><span class="token punctuation">(</span><span class="token class-name">CharcterStates</span> attacker<span class="token punctuation">,</span><span class="token class-name">CharcterStates</span> defener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³æ•°å€¼</span>    <span class="token comment">//å½“å‰æ”»å‡»åŠ›å‡å»ç›®æ ‡çš„é˜²å¾¡åŠ›ï¼Œå¦‚æœé˜²å¾¡åŠ›è¿‡é«˜å°±æ˜¯0ä¼¤å®³</span>    <span class="token class-name"><span class="token keyword">int</span></span> damage <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span><span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>defener<span class="token punctuation">.</span>currentDefence<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    currentHealth <span class="token operator">=</span> Mathf<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>currentHealth<span class="token operator">-</span>damage<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¡€é‡ä¹Ÿæ˜¯æœ€å°å€¼é”åœ¨0</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attacker<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token comment">//åˆ¤æ–­è¢«æ‰“è€…æ˜¯å¦å—åˆ°æš´å‡»å¹¶ä¸”æ’­æ”¾å—ä¼¤åŠ¨ç”»</span>            defener<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Hit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å°†æ¥è¦åšçš„äº‹æƒ…</span>    <span class="token comment">//TODO:è¡€é‡æ¡UI</span>    <span class="token comment">//TODO:æ‰“æ­»æ€ªååŠ ç»éªŒ</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">CurrentDamage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//åœ¨æ”»å‡»åŠ›èŒƒå›´å†…å–éšæœºæ•°è¿”å›ä¸€ä¸ªéšæœºæ”»å‡»åŠ›</span>    <span class="token class-name"><span class="token keyword">float</span></span> coreDamage <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span>attackData<span class="token punctuation">.</span>minDamage<span class="token punctuation">,</span>attackData<span class="token punctuation">.</span>maxDamage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isCritical<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœæš´å‡»çš„è¯è¿˜è¦è®¡ç®—ä¸Šæš´å‡»ç‡</span>        coreDamage <span class="token operator">*=</span>attackData<span class="token punctuation">.</span>criticalMultiplier<span class="token punctuation">;</span><span class="token comment">//ä¹˜ç­‰äº</span>        Debug<span class="token punctuation">.</span><span class="token function">LogFormat</span><span class="token punctuation">(</span><span class="token string">"æš´å‡»äº†ï¼ä¼¤å®³ä¸ºï¼ˆä¸ç®—ç›®æ ‡é˜²å¾¡åŠ›ï¼‰ï¼š&#123;0&#125;"</span><span class="token punctuation">,</span>coreDamage<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>coreDamage<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•"><a href="#è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•" class="headerlink" title="è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•"></a>è°ƒç”¨ä¼¤å®³è®¡ç®—æ–¹æ³•</h1><p>ä¼¤å®³è®¡ç®—ä»£ç å†™å¥½åï¼Œæˆ‘ä»¬å°±è¦å»æƒ³å¦‚ä½•è°ƒç”¨å®ƒï¼Œåœ¨å“ªé‡Œè°ƒç”¨å®ƒäº†</p><p>å‚è€ƒä¸€äº›RPGæ¸¸æˆï¼Œä¸€èˆ¬éƒ½æ˜¯å½“ä½ çš„æ­¦å™¨æŒ¥å‡ºå»åæ¥è§¦åˆ°æ•Œäººé‚£ä¸€ç¬é—´è®¡ç®—ä¼¤å®³ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰ç…§è¿™æ ·æ¥åš</p><h2 id="åœ¨äººç‰©èº«ä¸Šè°ƒç”¨"><a href="#åœ¨äººç‰©èº«ä¸Šè°ƒç”¨" class="headerlink" title="åœ¨äººç‰©èº«ä¸Šè°ƒç”¨"></a>åœ¨äººç‰©èº«ä¸Šè°ƒç”¨</h2><p>é¦–å…ˆè¦è°ƒå‡º<code>Animation</code>çª—å£</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/42623310028b4fbcafc6c49ce9fbc6a6.png" alt="2.png" style="zoom:80%;" /><p>ç„¶åçª—å£å·¦ä¸Šè§’é€‰æ‹©ä¸Šæˆ‘ä»¬çš„æ”»å‡»åŠ¨ç”»<code>Attack01</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æ”»å‡»åŠ¨ç”»é‡Œé¢çš„æŸä¸ªç‰¹å®šå¸§æ·»åŠ äº‹ä»¶äº†</p><p>æˆ‘ä»¬å†æ¬¡ç¼–è¾‘ä¸€ä¸‹<code>PlayerController.cs</code>ä»£ç åŠ ä¸€ä¸ªç”¨æ¥è°ƒç”¨çš„æ–¹æ³•</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//Animation Event</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è®¡ç®—ä¼¤å®³</span>    targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å›åˆ°<code>Animation</code>çª—å£ï¼Œå°†å®ƒæ·»åŠ ä¸ºäº‹ä»¶</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/3ebdba5a85864a339407b9a8d21a740f.png" alt="4.png" style="zoom:80%;" /><p><strong>æ³¨æ„ï¼šåŒæ ·çš„æš´å‡»åŠ¨ç”»ä¹Ÿè¦åŠ ä¸Š</strong></p><h2 id="åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨"><a href="#åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨" class="headerlink" title="åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨"></a>åœ¨æ•Œäººèº«ä¸Šè°ƒç”¨</h2><p>ç„¶ååœ¨æ•Œäººèº«ä¸Šæˆ‘ä»¬ä¹Ÿè¦è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œæ‰“å¼€<code>EnemyController.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//EnemyController.cs</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Hit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//ç”±äºåœ¨æ•Œäººè¿½ä¸»è§’çš„è¿‡ç¨‹ä¸­ä¸»è§’å¯èƒ½ä¼šè·‘å¼€ï¼Œè¿™æ—¶å€™å¦‚æœæ”»å‡»çš„è¯ç›®æ ‡å°±ä¸¢å¤±äº†</span>    <span class="token comment">//æ‰€ä»¥æˆ‘ä»¬åœ¨æ”»å‡»å‰åˆ¤æ–­ç›®æ ‡æ˜¯å¦ä¸ºç©ºï¼Œä»¥é˜²æŠ¥é”™</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">var</span></span> targetStates <span class="token operator">=</span> attackTarget<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        targetStates<span class="token punctuation">.</span><span class="token function">TakeDamage</span><span class="token punctuation">(</span>charcterStates<span class="token punctuation">,</span>targetStates<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååœ¨ä¸º<code>Animation</code>æ·»åŠ åŠ¨ç”»æ—¶æˆ‘ä»¬å‘ç°å½“å‰å²è±å§†çš„åŠ¨ç”»æ˜¯<code>åªè¯»</code>å±æ€§çš„ï¼Œå¯¹äºè¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥æŠŠåŠ¨ç”»å•ç‹¬å¤åˆ¶åˆ°å…¶å®ƒåœ°æ–¹ï¼Œå†å°†å¤åˆ¶å‡ºæ¥çš„åŠ¨ç”»æ›¿æ¢åŸæ¥çš„ï¼Œå°±å¯ä»¥è¿›è¡Œäº‹ä»¶æ·»åŠ äº†</p><p>å¦‚å›¾å¯¹ç€åŠ¨ç”»æ–‡ä»¶æŒ‰<code>Ctrl+D</code>å¯ä»¥å¿«é€Ÿå¤åˆ¶</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/3831ed71b8dc46cc8d7ce464438e15b3.png" alt="5.png" style="zoom:80%;" /><p>ç„¶åæˆ‘ä»¬å°†å¤åˆ¶å‡ºæ¥çš„åŠ¨ç”»ï¼ˆè¿™é‡Œæœ‰ä¸¤ä¸ªï¼‰åˆ†ç±»æ”¾å¥½</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/cded851a377744a2a2c53f78e2573698.png" alt="6.png" style="zoom:80%;" /><p>ç„¶åè¿›è¡ŒåŠ¨ç”»æ›¿æ¢</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/99667e3e7b754c4f8b286410045bac15.png" alt="7.png" style="zoom:80%;" /><p>æœ€åå†è¿›è¡ŒåŠ¨ç”»å¸§äº‹ä»¶æ·»åŠ æ“ä½œå°±è¡Œäº†</p><p>åˆ°è¿™æˆ‘ä»¬å°±æŠŠä¼¤å®³è®¡ç®—ä»£ç å’Œæ•ˆæœéƒ½å†™å‡ºæ¥äº†ï¼Œä¸‹ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬è¿˜ä¼šå»è¡¥å……å¦‚æœæ•Œäººæˆ–äººç‰©è¡€é‡åˆ°0äº†æ—¶å€™çš„çŠ¶æ€</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt; è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥å®ç°æ”»å‡»ä¼¤å®³çš„è®¡ç®—ï¼Œç»™äºˆäººç‰©æˆ–æ•ŒäººçœŸå®çš„æ”»å‡»ä¼¤å®³&lt;/p&gt;
&lt;h1 id=&quot;è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»&quot;&gt;&lt;a href=&quot;#è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»&quot; class=&quot;headerlink&quot; title=&quot;è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»&quot;&gt;&lt;/a&gt;è¡¥å……äººç‰©æ”»å‡»åŠ¨ç”»&lt;/h1&gt;&lt;p&gt;åœ¨ä¹‹å‰æˆ‘ä»¬</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ</title>
    <link href="http://sakura-pub.ltd/LeetCode/LeetCode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%9C%9F/"/>
    <id>http://sakura-pub.ltd/LeetCode/LeetCode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0%E7%AC%AC%E4%B8%80%E6%9C%9F/</id>
    <published>2021-07-17T15:54:05.000Z</published>
    <updated>2021-08-01T15:36:41.720Z</updated>
    
    <content type="html"><![CDATA[<h1 id="LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ"><a href="#LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ" class="headerlink" title="LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ"></a>LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰ä¸€ç›´æƒ³åœ¨åˆ·é¢˜çš„æ—¶å€™æŠŠæƒ³è¦è®°ä¸‹çš„ç¬”è®°è®°ä¸‹æ¥ï¼Œä½†æ˜¯æ²¡æœ‰æ‰¾åˆ°å¾ˆå¥½çš„åœ°æ–¹ï¼Œä½†æ˜¯ç°åœ¨æœ‰äº†åšå®¢ä¹‹åå°±å¯ä»¥å†™åœ¨è¿™çš„</p><p>å†™è¿™ä¸ªåˆ·é¢˜ç¬”è®°ä¸€ä¸ªæ˜¯æƒ³æ—¶ä¸æ—¶å›æ¥å·©å›ºä¸€ä¸‹ç®—æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯æƒ³è®°å½•ä¸‹è‡ªå·±çš„ç®—æ³•èƒ½åŠ›æˆé•¿çš„è¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æƒ³ä¸ºå®ä¹ åšå‡†å¤‡</p><p>å†™è¿™ä¸ªç¬”è®°æ˜¯å¤§äºŒæš‘å‡æ—¶æœŸï¼Œä¹‹å‰ä¹Ÿæœ‰ä¸€äº›ç®—æ³•åŸºç¡€ï¼Œå‚åŠ è¿‡çš„ç®—æ³•ç›¸å…³ç«èµ›åªæœ‰ä¸€æ¬¡è“æ¡¥æ¯ï¼Œåªæ‹¿åˆ°çœèµ›äºŒç­‰å¥–ï¼Œä¹Ÿå¸Œæœ›èƒ½å¤Ÿé€šè¿‡åˆ·é¢˜å’Œåšç¬”è®°èƒ½å¤Ÿæœ‰æ‰€é•¿è¿›</p><p>æœ¬äººç®—æ³•èƒ½åŠ›ä¸æ˜¯å¾ˆå¼ºï¼Œä¸€èˆ¬éƒ½è¦æƒ³å¥½ä¸€é˜µå­ï¼Œæ‰€ä»¥ä¸€èˆ¬å†™å‡ºæ¥çš„ç­”æ¡ˆä¸æ˜¯å¾ˆå¥½ï¼Œæœ›å¤§ä½¬ä»¬è½»å–·</p><p>âœ¨æ³¨ï¼šæˆ‘å†™ç®—æ³•çš„è¯­è¨€ä¸»æ‰“C++</p><p>é‚£ä¹ˆï¼Œå°±å¼€å§‹å§ï¼</p><hr><h1 id="è´ªå¿ƒ"><a href="#è´ªå¿ƒ" class="headerlink" title="è´ªå¿ƒ"></a>è´ªå¿ƒ</h1><h2 id="452-ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"><a href="#452-ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ" class="headerlink" title="452.ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"></a>452.<a href="https://leetcode-cn.com/problems/minimum-number-of-arrows-to-burst-balloons/">ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ</a></h2><p>åœ¨äºŒç»´ç©ºé—´ä¸­æœ‰è®¸å¤šçƒå½¢çš„æ°”çƒã€‚å¯¹äºæ¯ä¸ªæ°”çƒï¼Œæä¾›çš„è¾“å…¥æ˜¯æ°´å¹³æ–¹å‘ä¸Šï¼Œæ°”çƒç›´å¾„çš„å¼€å§‹å’Œç»“æŸåæ ‡ã€‚ç”±äºå®ƒæ˜¯æ°´å¹³çš„ï¼Œæ‰€ä»¥çºµåæ ‡å¹¶ä¸é‡è¦ï¼Œå› æ­¤åªè¦çŸ¥é“å¼€å§‹å’Œç»“æŸçš„æ¨ªåæ ‡å°±è¶³å¤Ÿäº†ã€‚å¼€å§‹åæ ‡æ€»æ˜¯å°äºç»“æŸåæ ‡ã€‚</p><p>ä¸€æ”¯å¼“ç®­å¯ä»¥æ²¿ç€ x è½´ä»ä¸åŒç‚¹å®Œå…¨å‚ç›´åœ°å°„å‡ºã€‚åœ¨åæ ‡ x å¤„å°„å‡ºä¸€æ”¯ç®­ï¼Œè‹¥æœ‰ä¸€ä¸ªæ°”çƒçš„ç›´å¾„çš„å¼€å§‹å’Œç»“æŸåæ ‡ä¸º <code>xstart</code>ï¼Œ<code>xend</code>ï¼Œ ä¸”æ»¡è¶³  <code>xstart</code> â‰¤ x â‰¤ <code>xend</code>ï¼Œåˆ™è¯¥æ°”çƒä¼šè¢«å¼•çˆ†ã€‚å¯ä»¥å°„å‡ºçš„å¼“ç®­çš„æ•°é‡æ²¡æœ‰é™åˆ¶ã€‚ å¼“ç®­ä¸€æ—¦è¢«å°„å‡ºä¹‹åï¼Œå¯ä»¥æ— é™åœ°å‰è¿›ã€‚æˆ‘ä»¬æƒ³æ‰¾åˆ°ä½¿å¾—æ‰€æœ‰æ°”çƒå…¨éƒ¨è¢«å¼•çˆ†ï¼Œæ‰€éœ€çš„å¼“ç®­çš„æœ€å°æ•°é‡ã€‚</p><p>ç»™ä½ ä¸€ä¸ªæ•°ç»„ points ï¼Œå…¶ä¸­ points [i] = [xstart,xend] ï¼Œè¿”å›å¼•çˆ†æ‰€æœ‰æ°”çƒæ‰€å¿…é¡»å°„å‡ºçš„æœ€å°å¼“ç®­æ•°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼špoints = [[10,16],[2,8],[1,6],[7,12]]<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼šå¯¹äºè¯¥æ ·ä¾‹ï¼Œx = 6 å¯ä»¥å°„çˆ† [2,8],[1,6] ä¸¤ä¸ªæ°”çƒï¼Œä»¥åŠ x = 11 å°„çˆ†å¦å¤–ä¸¤ä¸ªæ°”çƒ</p></blockquote><p>è¿™ä¸€é¢˜æ‹¿åˆ°é¢˜ç›®æ—¶çœ‹äº†å¥½å‡ æ¬¡éƒ½çœ‹ä¸æ‡‚é¢˜ç›®ï¼Œçœ‹äº†ä¸€ä¸‹åˆ«äººç”»çš„å›¾æ‰æ˜ç™½é¢˜çš„æ„æ€ï¼Œå’Œå¦å¤–é¢˜ <code>435. æ— é‡å åŒºé—´</code>æœ‰ç‚¹ç›¸ä¼¼</p><p>æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸€æ¬¡å°„å‡»ç®­çš„æ—¶å€™å°½é‡å¾€ç”¨å°‘ä¸€ç‚¹çš„æ–¹å‘å»æƒ³ï¼Œå½“æ°”çƒé‡å æ—¶ä¾¿ä¸€èµ·å°„ï¼Œè¿™æ˜¯å±€éƒ¨æœ€ä¼˜ï¼Œç„¶åæ¯æ¬¡å±€éƒ¨æœ€ä¼˜æ‰€é€ æˆçš„å°±æ˜¯å…¨å±€æœ€ä¼˜ï¼Œå°„å®Œå…¨éƒ¨æ°”çƒæ‰€ç”¨çš„å¼“ç®­æ˜¯æœ€å°‘ï¼Œè¿™ä¾¿å¯ä»¥ç”¨è´ªå¿ƒç®—æ³•æ¥æ±‚è§£</p><p>å€Ÿç”¨å®˜æ–¹è§£ç­”æ‰€ç»™çš„å›¾æ¥è§£é‡Š</p><p><img src="https://p9-tt.byteimg.com/origin/pgc-image/f83bd4a2e87746078b4cac68d1f4d1d5.png"></p><p>å½“æŠŠå¼“ç®­æŒªåˆ°å³åŒºé—´æœ€å°çš„æ—¶å€™ï¼ˆå¦‚ç¬¬ä¸‰ä¸ªå›¾çš„è“è‰²ï¼‰å°±å¯ä»¥ä¸€ç®­å››é›•ï¼Œå› ä¸ºé¢˜ç›®æ‰€ç»™çš„æ¡ä»¶<code>xstart</code> â‰¤ x â‰¤ <code>xend</code>æ—¶æ°”çƒå°±ä¼šç»™å°„çˆ†ï¼Œè¿™é‡ŒåŒ…å«äº†è¾¹ç•Œå€¼æ¡ä»¶ï¼Œæ‰€ä»¥åœ¨é—­åŒºé—´ä½ç½®ä¹Ÿæ»¡è¶³</p><p>å› æ­¤æˆ‘å°±æœ‰äº†åŸºæœ¬æ€è·¯ï¼Œå…ˆæŠŠè¿™äº›æ°”çƒæ’åˆ—ï¼Œç„¶åä»ç¬¬äºŒä¸ªæ°”çƒéå†ï¼Œæ¯æ¬¡ä¸å‰ä¸€ä¸ªæ°”çƒä½œæ¯”è¾ƒï¼Œå¦‚æœä¸¤ä¸ªæ°”çƒåŒºé—´ç›¸äº¤ï¼Œé‚£å°±å¯ä»¥ç•¥è¿‡å½“å‰æ°”çƒè¿›å…¥ä¸‹ä¸€æ¬¡æ¯”è¾ƒï¼ˆåšä¸ªæ ‡è®°ï¼Œä»£è¡¨å¯ä»¥åœ¨è¿™ä¸€ä¸ªå¼“ç®­å°„å®Œï¼‰ï¼Œå…·ä½“å¦‚ä½•ç•¥è¿‡çœ‹ä»£ç ï¼›å¦‚æœæ°”çƒä¸ç›¸äº¤äº†ï¼Œé‚£å°±è¯æ˜è¦ç”¨å¤šä¸€å‘å¼“ç®­äº†ï¼Œæ­¤æ—¶å¼“ç®­æ•°è¦åŠ ä¸€ï¼Œç„¶åç»§ç»­å¾€ä¸‹æ¯”è¾ƒ</p><p>ä¸‹é¢æ˜¯è‡ªå·±å‚è€ƒåˆ«äººè§£ç­”åå†™å‡ºæ¥çš„ä»£ç ï¼š</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token keyword">bool</span> <span class="token function">VecSort</span><span class="token punctuation">(</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span><span class="token keyword">const</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">findMinArrowShots</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> points<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> size <span class="token operator">=</span> points<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>size<span class="token punctuation">)</span><span class="token comment">//æ•°ç»„ä¸ºç©º</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token function">sort</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>points<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>VecSort<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æŒ‰æ°”çƒèµ·ç‚¹è¿›è¡Œä»å°åˆ°å¤§æ’åº</span>        <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›ç»“æœï¼Œä¸ä¸ºç©ºè‡³å°‘éœ€è¦ä¸€åªç®­</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ä»å‰å¾€åéå†æ°”çƒ</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">></span>points<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å½“å‰æ°”çƒä¸å‰ä¸€ä¸ªæ°”çƒä¸é‡å </span>                res<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//é‡å åˆ™è·³è¿‡å½“å‰æ°”çƒ</span>                <span class="token comment">//ï¼ˆåˆ©ç”¨é—­åŒºé—´æœ€å³ä½ç½®å¯ä»¥å°„åˆ°çš„è§„åˆ™è®©å…¶é•¿åº¦å˜çŸ­ï¼Œä»¥è¾¾åˆ°å¯è·³è¿‡çš„å½“å‰æ°”çƒç›®çš„ï¼‰</span>                points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>std<span class="token operator">::</span><span class="token function">min</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>points<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·åšå‡ºæ¥ä¹‹åæ—¶é—´å¤æ‚åº¦ä¸º<em>O(nlogn)<em>å› ä¸ºç”¨äº†ä¸ªå¿«æ’ï¼Œç©ºé—´å¤æ‚åº¦ä¸º</em>O(1)</em></p><img src="https://p6-tt.byteimg.com/origin/pgc-image/3af7d43845b04870bda4754ca1805c0e.jpg" alt="452.jpg" style="zoom:80%;" /><hr><h2 id="763-åˆ’åˆ†å­—æ¯åŒºé—´"><a href="#763-åˆ’åˆ†å­—æ¯åŒºé—´" class="headerlink" title="763. åˆ’åˆ†å­—æ¯åŒºé—´"></a><a href="https://leetcode-cn.com/problems/partition-labels/">763. åˆ’åˆ†å­—æ¯åŒºé—´</a></h2><p>å­—ç¬¦ä¸² <code>S</code> ç”±å°å†™å­—æ¯ç»„æˆã€‚æˆ‘ä»¬è¦æŠŠè¿™ä¸ªå­—ç¬¦ä¸²åˆ’åˆ†ä¸ºå°½å¯èƒ½å¤šçš„ç‰‡æ®µï¼ŒåŒä¸€å­—æ¯æœ€å¤šå‡ºç°åœ¨ä¸€ä¸ªç‰‡æ®µä¸­ã€‚è¿”å›ä¸€ä¸ªè¡¨ç¤ºæ¯ä¸ªå­—ç¬¦ä¸²ç‰‡æ®µçš„é•¿åº¦çš„åˆ—è¡¨ã€‚</p><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼šS = â€œababcbacadefegdehijhklijâ€<br>è¾“å‡ºï¼š[9,7,8]<br>è§£é‡Šï¼š<br>åˆ’åˆ†ç»“æœä¸º â€œababcbacaâ€, â€œdefegdeâ€, â€œhijhklijâ€ã€‚<br>æ¯ä¸ªå­—æ¯æœ€å¤šå‡ºç°åœ¨ä¸€ä¸ªç‰‡æ®µä¸­ã€‚<br>åƒ â€œababcbacadefegdeâ€, â€œhijhklijâ€ çš„åˆ’åˆ†æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºåˆ’åˆ†çš„ç‰‡æ®µæ•°è¾ƒå°‘ã€‚</p></blockquote><p>è¿™ç§é¢˜å‹ç¬¬ä¸€æ¬¡è§ï¼Œä¸æ€ä¹ˆä¼šï¼Œå› ä¸ºå°½å¯èƒ½åœ°è¦åˆ’åˆ†å¤šä¸ªåŒºåŸŸï¼Œä»è€Œè¾¾åˆ°æŸä¸ªæˆ–å¤šä¸ªå­—æ¯åªå‡ºç°åœ¨è¿™ç‰‡åŒºåŸŸä¸­ï¼Œé‚£ä¹ˆå°±å¯ä»¥å…ˆè®°å½•ä¸‹æ¯ä¸ªå­—æ¯æœ€åå‡ºç°çš„ä½ç½®</p><p>ç„¶åå†æ¬¡éå†å­—ç¬¦ä¸²ï¼Œä¸æ–­æ›´æ–°æ ‡è¯†ç¬¦<code>end</code>ï¼Œè¯¥æ ‡è¯†ç¬¦æŒ‡å‘çš„æ˜¯å½“å‰éå†è¿‡çš„å­—æ¯ä¸­ï¼Œæœ€æŒä¹…çš„å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®ï¼Œä¹Ÿç›¸å½“äºæ˜¯è¿™ç‰‡åŒºåŸŸæœ€åçš„ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬åªç”¨æ‰¾å‡ºè¿™ä¸ªæ ‡è¯†ç¬¦æœ€ç»ˆçš„ä½ç½®å°±èƒ½å¤Ÿåˆ’åˆ†ä¸€ä¸ªåŒºåŸŸå‡ºæ¥äº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">partitionLabels</span><span class="token punctuation">(</span>string s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> str_size <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>str_size<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str_size <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span>res<span class="token punctuation">;</span>        <span class="token keyword">int</span> map<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ¯ä¸ªå­—æ¯æœ€åå‡ºç°çš„ä½ç½®</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str_size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            map<span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token operator">=</span>i<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> end<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•åˆ†å‰²æ•°æ®çš„å¼€å¤´å’Œç»“å°¾ä½ç½®</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>str_size<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            end <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">max</span><span class="token punctuation">(</span>end<span class="token punctuation">,</span>map<span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è´ªå¿ƒç­–ç•¥åœ°æ–¹ï¼Œå°½å¯èƒ½æ‰¾åˆ°å­—æ¯æœ€åå‡ºç°çš„ä½ç½®ä»è€Œåˆ’åˆ†åŒºåŸŸ</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">==</span> end<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å¦‚æœæ‰¾åˆ°ä¹‹å‰éå†è¿‡çš„æ‰€æœ‰å­—æ¯çš„æœ€è¿œè¾¹ç•Œï¼Œè¯´æ˜è¿™ä¸ªè¾¹ç•Œå°±æ˜¯åˆ†å‰²ç‚¹äº†</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>end<span class="token operator">-</span>start<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                start <span class="token operator">=</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦<em>O(n)<em>ï¼Œç©ºé—´å¤æ‚åº¦</em>O(1)</em></p><img src="https://p5-tt.byteimg.com/origin/pgc-image/c6d28e63caa845aba5e8479b6f016d58.jpg" alt="763.jpg" style="zoom:80%;" /><hr><h1 id="åŒæŒ‡é’ˆ"><a href="#åŒæŒ‡é’ˆ" class="headerlink" title="åŒæŒ‡é’ˆ"></a>åŒæŒ‡é’ˆ</h1><h2 id="88-åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„â€”ï¼ˆç®€å•ï¼‰"><a href="#88-åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„â€”ï¼ˆç®€å•ï¼‰" class="headerlink" title="88. åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„â€”ï¼ˆç®€å•ï¼‰"></a><a href="https://leetcode-cn.com/problems/merge-sorted-array/">88. åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„</a>â€”ï¼ˆç®€å•ï¼‰</h2><p>ç»™ä½ ä¸¤ä¸ªæœ‰åºæ•´æ•°æ•°ç»„ nums1 å’Œ nums2ï¼Œè¯·ä½ å°† nums2 åˆå¹¶åˆ° nums1 ä¸­ï¼Œä½¿ nums1 æˆä¸ºä¸€ä¸ªæœ‰åºæ•°ç»„ã€‚</p><p>åˆå§‹åŒ– nums1 å’Œ nums2 çš„å…ƒç´ æ•°é‡åˆ†åˆ«ä¸º m å’Œ n ã€‚ä½ å¯ä»¥å‡è®¾ nums1 çš„ç©ºé—´å¤§å°ç­‰äº m + nï¼Œè¿™æ ·å®ƒå°±æœ‰è¶³å¤Ÿçš„ç©ºé—´ä¿å­˜æ¥è‡ª nums2 çš„å…ƒç´ ã€‚</p><p>ç¤ºä¾‹1ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [1,2,3,0,0,0], m = 3, nums2 = [2,5,6], n = 3<br>è¾“å‡ºï¼š[1,2,2,3,5,6]</p></blockquote><p>ç¤ºä¾‹2ï¼š</p><blockquote><p>è¾“å…¥ï¼šnums1 = [1], m = 1, nums2 = [], n = 0<br>è¾“å‡ºï¼š[1]</p></blockquote><p>è¿™é“é¢˜æ˜¯å¤šæŒ‡é’ˆä¸­çš„ä¸€ç§é¢˜å‹ï¼Œä½†æ˜¯å®ƒéœ€è¦çš„æ˜¯é€†å‘æŒ‡é’ˆï¼ŒçŸ¥é“åŸç†åæ¯”è¾ƒç®€å•</p><p>å› ä¸ºè¿™ä¸¤ä¸ªæ•°ç»„å·²ç»æ’å¥½åºï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æ”¾åœ¨ä¸¤ä¸ªæ•°ç»„çš„æœ«å°¾ï¼Œå³ nums1 çš„m - 1 ä½å’Œ nums2 çš„ n - 1 ä½æ¯æ¬¡å°†è¾ƒå¤§çš„é‚£ä¸ªæ•°å­—å¤åˆ¶åˆ° nums1 çš„åè¾¹ï¼Œç„¶åå‘å‰ç§»åŠ¨ä¸€ä½ã€‚å› ä¸ºæˆ‘ä»¬ä¹Ÿè¦å®šä½ nums1 çš„æœ«å°¾ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç¬¬ä¸‰ä¸ªæŒ‡é’ˆï¼Œä»¥ä¾¿å¤åˆ¶ã€‚<br>åœ¨ä»¥ä¸‹çš„ä»£ç é‡Œï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨ m å’Œ n å½“ä½œä¸¤ä¸ªæ•°ç»„çš„æŒ‡é’ˆï¼Œå†é¢å¤–åˆ›ç«‹ä¸€ä¸ª pos æŒ‡é’ˆï¼Œèµ·å§‹ä½ç½®ä¸º m + n - 1ã€‚æ¯æ¬¡å‘å‰ç§»åŠ¨ m æˆ– n çš„æ—¶å€™ï¼Œä¹Ÿè¦å‘å‰ç§»åŠ¨ posã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœ nums1çš„æ•°å­—å·²ç»å¤åˆ¶å®Œï¼Œä¸è¦å¿˜è®°æŠŠ nums2 çš„æ•°å­—ç»§ç»­å¤åˆ¶ï¼›å¦‚æœ nums2 çš„æ•°å­—å·²ç»å¤åˆ¶å®Œï¼Œå‰©ä½™nums1 çš„æ•°å­—ä¸éœ€è¦æ”¹å˜ï¼Œå› ä¸ºå®ƒä»¬å·²ç»è¢«æ’å¥½åºã€‚  </p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">void</span> <span class="token function">merge</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums2<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> size1 <span class="token operator">=</span> nums1<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> size2 <span class="token operator">=</span> nums2<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>size2<span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token comment">//éœ€è¦ä¸‰ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«æ˜¯m-1,n-1å’Œm+n-1ï¼Œå‰ä¸¤ä¸ªå¯ä»¥ç”¨m n ä»£æ›¿</span>        <span class="token keyword">int</span> pos <span class="token operator">=</span> m<span class="token operator">+</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        n<span class="token operator">--</span><span class="token punctuation">;</span>m<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">>=</span><span class="token number">0</span> <span class="token operator">&amp;&amp;</span> m<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            nums1<span class="token punctuation">[</span>pos<span class="token operator">--</span><span class="token punctuation">]</span><span class="token operator">=</span>nums1<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token operator">></span>nums2<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">?</span>nums1<span class="token punctuation">[</span>m<span class="token operator">--</span><span class="token punctuation">]</span><span class="token operator">:</span>nums2<span class="token punctuation">[</span>n<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            nums1<span class="token punctuation">[</span>pos<span class="token operator">--</span><span class="token punctuation">]</span><span class="token operator">=</span>nums2<span class="token punctuation">[</span>n<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦<em>O(m+n)<em>ï¼Œå› ä¸ºæŒ‡é’ˆæœ€å¤šéå†m+nä¸ªæ•°ï¼Œç©ºé—´å¤æ‚åº¦</em>O(1)</em></p><hr><h2 id="142-ç¯å½¢é“¾è¡¨-IIâ€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#142-ç¯å½¢é“¾è¡¨-IIâ€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="142. ç¯å½¢é“¾è¡¨ IIâ€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/linked-list-cycle-ii/">142. ç¯å½¢é“¾è¡¨ II</a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¿”å›é“¾è¡¨å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœé“¾è¡¨æ— ç¯ï¼Œåˆ™è¿”å› nullã€‚</p><p>ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼Œpos ä»…ä»…æ˜¯ç”¨äºæ ‡è¯†ç¯çš„æƒ…å†µï¼Œå¹¶ä¸ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°å‡½æ•°ä¸­ã€‚</p><p>è¯´æ˜ï¼šä¸å…è®¸ä¿®æ”¹ç»™å®šçš„é“¾è¡¨ã€‚</p><p><em>è¿›é˜¶ï¼š</em></p><p><em>ä½ æ˜¯å¦å¯ä»¥ä½¿ç”¨ O(1) ç©ºé—´è§£å†³æ­¤é¢˜ï¼Ÿ</em></p><blockquote><p>ç¤ºä¾‹ï¼š</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/aeba8d5b296441c6a8d25a7bc3e7eb31.png" alt="1" style="zoom:80%;" /><p>è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1<br>è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 1 çš„é“¾è¡¨èŠ‚ç‚¹<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</p></blockquote><p>æœ¬é¢˜ç¬¬ä¸€æ¬¡åšç¨å¾®æœ‰éš¾åº¦ï¼Œæ¶‰åŠåˆ°ä¸€äº›æ•°å­¦çŸ¥è¯†</p><p>æ‰€ä½¿ç”¨çš„æ˜¯å¿«æ…¢æŒ‡é’ˆï¼Œä¸¤ä¸ªæŒ‡é’ˆéƒ½æ˜¯ä»å¤´ç»“ç‚¹å¼€å§‹ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ ¼ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ ¼ï¼Œå¦‚æœä»–ä»¬å¯ä»¥ç›¸é‡ï¼Œå°±ä»£è¡¨é“¾è¡¨æ˜¯æœ‰ç¯çš„ï¼Œå› ä¸ºå¿«æŒ‡é’ˆæ¯æ¬¡èµ°çš„æ¯”æ…¢æŒ‡é’ˆå¤š<code>1</code>æ ¼ï¼Œåªè¦æ˜¯æœ‰ç¯è·¯è‚¯å®šèƒ½ç›¸é‡</p><p>å…¶æ¬¡ï¼Œåœ¨ç¬¬ä¸€æ¬¡ç›¸é‡åï¼Œæˆ‘ä»¬å°†å¿«æŒ‡é’ˆé‡ç½®ä¸ºå¤´ç»“ç‚¹ä½ç½®ï¼Œä¹‹åå¿«æ…¢æŒ‡é’ˆ<code>åŒæ—¶èµ°</code>ï¼Œæ¯æ¬¡éƒ½æ˜¯èµ°<code>1</code>æ­¥ï¼Œç›´åˆ°ä¸¤æŒ‡é’ˆå†ä¸€æ¬¡ç›¸é‡å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç¯å…¥å£äº†ï¼Œå…·ä½“æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸‹é¢çš„å›¾</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/c1f26d9f0524448ebd0245449d12eb45.png" alt="code" style="zoom:80%;" /><p>æˆ‘ä»¬è®¾<code>x</code>æ˜¯å¤´ç»“ç‚¹åˆ°ç¯å½¢å…¥å£èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°ï¼Œ<code>y</code>æ˜¯ä»å…¥å£èŠ‚ç‚¹åˆ°ä¸¤ä¸ªæŒ‡é’ˆç¬¬ä¸€æ¬¡ç›¸é‡çš„èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°ï¼Œå½“ç¬¬ä¸€æ¬¡ä¸¤æŒ‡é’ˆåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ç›¸é‡æ—¶ï¼Œæ…¢æŒ‡é’ˆèµ°äº†<code>x+y</code>ï¼Œå¿«æŒ‡é’ˆèµ°äº†<code>x+y+n(z+y)</code>å…¶ä¸­<code>n(z+y)</code>æ˜¯åœ¨ç¯å†…å¤šèµ°äº†<code>n</code>åœˆ</p><p>åˆå› ä¸ºå¿«æŒ‡é’ˆèµ°çš„èŠ‚ç‚¹æ•°æ˜¯æ…¢æŒ‡é’ˆçš„ä¸¤å€åˆ™æœ‰æ–¹ç¨‹ï¼š<code>2(x+y)=x+y+n(z+y)</code>ï¼ŒåŒ–ç®€çš„å‡º<code>x=n(y+z)-y</code>ï¼Œä»n(y+z)æå‡ºä¸€ä¸ªy+zå¾—å‡ºå…¬å¼ï¼š<code>x=(n-1)(y+z)+z</code>ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‡è®¾<code>n=1</code>ï¼Œå³å¿«æŒ‡é’ˆåªç”¨åœ¨ç¯å†…å¤šèµ°ä¸€åœˆå°±ï¼Œå°±å¯ä»¥å¾—å‡º<code>x=z</code></p><p>è¿™æ ·å°±å¾—å‡ºäº†æœ€ç»ˆçš„ç»“è®ºï¼šå½“ä¸¤ä¸ªæŒ‡é’ˆåœ¨ç¬¬ä¸€æ¬¡ç›¸é‡åï¼Œæ­¤æ—¶ç›¸é‡èŠ‚ç‚¹åˆ°ç¯å½¢å…¥å£èŠ‚ç‚¹é•¿åº¦<code>ç­‰äº</code>å¤´ç»“ç‚¹åˆ°ç¯å½¢å…¥å£é•¿åº¦ï¼Œé‚£ä¹ˆé—®é¢˜å°±å¾ˆå®¹æ˜“äº†ï¼Œæˆ‘ä»¬éšä¾¿å°†ä¸€ä¸ªæŒ‡é’ˆ<code>é‡ç½®</code>å›å¤´ç»“ç‚¹ï¼Œå†è®©ä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶å‡ºå‘ï¼Œå¹¶ä¸”æ¯ä¸€æ­¥åªèµ°<code>ä¸€æ ¼</code>é•¿åº¦ï¼Œå½“å†æ¬¡ç›¸é‡æ—¶ï¼Œä½ç½®å°±æ˜¯ç¯å½¢å…¥å£èŠ‚ç‚¹äº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/** * Definition for singly-linked list. * struct ListNode &#123; *     int val; *     ListNode *next; *     ListNode(int x) : val(x), next(NULL) &#123;&#125; * &#125;; */</span><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    ListNode <span class="token operator">*</span><span class="token function">detectCycle</span><span class="token punctuation">(</span>ListNode <span class="token operator">*</span>head<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token operator">||</span>head<span class="token operator">-></span>next<span class="token operator">==</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>        ListNode<span class="token operator">*</span> slow <span class="token operator">=</span> head<span class="token punctuation">;</span><span class="token comment">//å¿«æŒ‡é’ˆ</span>        ListNode<span class="token operator">*</span> fast <span class="token operator">=</span> head<span class="token punctuation">;</span><span class="token comment">//æ…¢æŒ‡é’ˆ</span>        <span class="token comment">//ç¬¬ä¸€æ¬¡ç›¸é‡ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ç¯è·¯</span>        <span class="token keyword">do</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fast<span class="token operator">||</span><span class="token operator">!</span>fast<span class="token operator">-></span>next<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>            fast<span class="token operator">=</span>fast<span class="token operator">-></span>next<span class="token operator">-></span>next<span class="token punctuation">;</span>            slow<span class="token operator">=</span>slow<span class="token operator">-></span>next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>slow<span class="token operator">!=</span>fast<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//é‡ç½®å¿«æŒ‡é’ˆ</span>        fast <span class="token operator">=</span> head<span class="token punctuation">;</span>        <span class="token comment">//ç¬¬äºŒæ¬¡ç›¸é‡åˆ™æ˜¯å…¥å£</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>fast<span class="token operator">!=</span>slow<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            fast <span class="token operator">=</span> fast<span class="token operator">-></span>next<span class="token punctuation">;</span>            slow <span class="token operator">=</span> slow<span class="token operator">-></span>next<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> slow<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸ºï¼š<em>O(n)<em>ï¼Œç©ºé—´å¤æ‚åº¦ä¸º</em>O(1)</em></p><hr><h2 id="76-æœ€å°è¦†ç›–å­ä¸²â€”ï¼ˆå›°éš¾ï¼‰"><a href="#76-æœ€å°è¦†ç›–å­ä¸²â€”ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="76. æœ€å°è¦†ç›–å­ä¸²â€”ï¼ˆå›°éš¾ï¼‰"></a><a href="https://leetcode-cn.com/problems/minimum-window-substring/">76. æœ€å°è¦†ç›–å­ä¸²</a>â€”ï¼ˆå›°éš¾ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ã€ä¸€ä¸ªå­—ç¬¦ä¸² t ã€‚è¿”å› s ä¸­æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚å¦‚æœ s ä¸­ä¸å­˜åœ¨æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² â€œâ€ ã€‚</p><p>æ³¨æ„ï¼š</p><p>å¯¹äº t ä¸­é‡å¤å­—ç¬¦ï¼Œæˆ‘ä»¬å¯»æ‰¾çš„å­å­—ç¬¦ä¸²ä¸­è¯¥å­—ç¬¦æ•°é‡å¿…é¡»ä¸å°‘äº t ä¸­è¯¥å­—ç¬¦æ•°é‡ã€‚<br>å¦‚æœ s ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œADOBECODEBANCâ€, t = â€œABCâ€<br>è¾“å‡ºï¼šâ€BANCâ€</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œaâ€, t = â€œaâ€<br>è¾“å‡ºï¼šâ€aâ€</p></blockquote><p>ç¤ºä¾‹ 3:</p><blockquote><p>è¾“å…¥: s = â€œaâ€, t = â€œaaâ€<br>è¾“å‡º: â€œâ€<br>è§£é‡Š: t ä¸­ä¸¤ä¸ªå­—ç¬¦ â€˜aâ€™ å‡åº”åŒ…å«åœ¨ s çš„å­ä¸²ä¸­ï¼Œ<br>å› æ­¤æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­å­—ç¬¦ä¸²ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p></blockquote><p>è¿™ä¸ªé¢˜ç›®ä¸­è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²tæ˜¯å¯ä»¥åŒ…å«<em>é‡å¤</em>å­—æ¯çš„</p><p>æ‰€è¿ç”¨çš„æ˜¯æ»‘åŠ¨çª—å£ï¼Œç”±äºä¹‹å‰æ²¡æœ‰åšè¿‡æ»‘åŠ¨çª—å£çš„é¢˜ï¼Œæ‰€ä»¥å…ˆçœ‹äº†è§£é‡Šæ‰å¼€å§‹åšçš„ï¼Œæ›´å¤šç»†èŠ‚åœ¨<a href="https://leetcode-cn.com/problems/minimum-window-substring/solution/zui-xiao-fu-gai-zi-chuan-by-leetcode-solution/">å®˜æ–¹è§£æ</a>å’Œè§†é¢‘ï¼Œæ»‘åŠ¨çª—å£å›¾ç¤ºå¦‚ä¸‹ï¼š</p><img src="https://cube-resources.lenovo.com.cn/cube/86cf648e03a1a5daceab2cfbdb802819.gif" alt="æ»‘åŠ¨çª—å£" style="zoom:80%;" /><p>é¦–å…ˆæ˜¯è¿ç”¨ä¸¤ä¸ªæ•°ç»„ï¼Œä¸€ä¸ªæ˜¯è®°å½•æ»‘åŠ¨çª—å£ä¸­éå†åˆ°çš„tå­—ç¬¦ä¸²å«æœ‰çš„å­—æ¯ä¸ªæ•°ï¼Œè€Œå¦ä¸€ä¸ªåˆ™æ˜¯è®°å½•tå­—ç¬¦ä¸²æ¯ä¸ªå­—æ¯çš„ä¸ªæ•°ã€‚ç„¶åè¿˜æœ‰ä¸ªæ¯”è¾ƒé‡è¦çš„å°±æ˜¯<code>distance</code>ï¼Œè¿™ä¸ªå˜é‡æ˜¯ç”¨æ¥è®°å½•å½“å‰æ»‘åŠ¨çª—å£åŒºåŸŸä¸­æ‹¥æœ‰å¯¹ç…§å­—ç¬¦ä¸²tä¸­æ‰€éœ€è¦çš„å­—ç¬¦ä¸ªæ•°</p><p>æ•´ä¸ªæ»‘åŠ¨çª—å£æµç¨‹å¤§è‡´æ˜¯ï¼š</p><p>å½“å³æŒ‡é’ˆå‰è¿›æ—¶éå†åˆ°ä¸€ä¸ªæ‰€éœ€å­—ç¬¦åˆ™<code>distance+1</code>ï¼Œç›´åˆ°<code>distance == t.size()</code>æ—¶åœæ­¢å‰è¿›ï¼Œ<strong>æ³¨æ„å½“ä¸€ä¸ªå­—ç¬¦å‡ºç°è¶…è¿‡æ‰€éœ€æ•°ä½†æ˜¯distanceè¿˜æ²¡è¾¾æ ‡æ—¶ï¼Œdistanceä¸å¢åŠ </strong>ï¼Œå¦‚ä¸‹é¢ä»£ç ä¸­çš„<code>winFre[s[right]]&gt;=tFre[s[right]]</code>æ—¶distanceä¸ä¼šå†ç»§ç»­åŠ 1ã€‚</p><p>ä¹‹åè½®åˆ°å·¦æŒ‡é’ˆå‰è¿›ï¼Œå®ƒä¼šè·³è¿‡ä¸€äº›å¤šä½™çš„å­—ç¬¦ä»¥å°½å¯èƒ½åœ°ç¼©å°åŒºåŸŸï¼Œå®ƒä¹Ÿè¦å‰”é™¤é‡å¤çš„å­—ç¬¦æ•°ï¼Œå½“<code>winFre[s[right]]&gt;tFre[s[right]]</code>æ—¶distanceä¸ä¼šç›¸å‡ï¼Œå› æ­¤<code>distance</code>çš„ä½œç”¨å¯ä»¥çœ‹åšæ˜¯ä¸¤è¾¹å­—æ¯çš„è¾¹ç•Œå€¼ã€‚åœ¨å·¦æŒ‡é’ˆé‡åˆ°ä¸èƒ½å†ç»§ç»­å‰è¿›æ—¶ä¼šæ¯”è¾ƒå½“å‰æœ€å°çš„è¦†ç›–å­ä¸²åŒºé—´æ˜¯å¦è¦æ›´æ–°ï¼Œæœ€åä¸‹ä¸€æ¬¡å¾ªç¯ä¸­åˆè¦æ¢å¤ä¸ºå³åŒºé—´å‰è¿›ï¼Œç›´åˆ°å³åŒºé—´åˆ°è¾¾tå­—ç¬¦ä¸²çš„é•¿åº¦æ‰ä¼šé€€å‡ºå¾ªç¯ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    string <span class="token function">minWindow</span><span class="token punctuation">(</span>string s<span class="token punctuation">,</span> string t<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> sLen <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> tLen <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>sLen<span class="token operator">&lt;</span>tLen<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">//ç‰¹æ®Šæƒ…å†µ</span>        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> s<span class="token punctuation">;</span>        <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å·¦æŒ‡é’ˆ</span>        <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//å³æŒ‡é’ˆ</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token function">winFre</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ»‘åŠ¨çª—å£ä¸­æ‰€åŒ…å«å¯¹ç…§å­—ç¬¦ä¸²æ¯ä¸ªå­—æ¯çš„ä¸ªæ•°</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token function">tFre</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•å¯¹ç…§å­—ç¬¦ä¸²ä¸­æ‰€å«æœ‰çš„æ¯ä¸ªå­—æ¯çš„ä¸ªæ•°</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">char</span> i<span class="token operator">:</span>t<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//éå†å¯¹ç…§å­—ç¬¦ä¸²t</span>            tFre<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•è¿”å›å­—ç¬¦ä¸²çš„å¼€å§‹ä¸‹æ ‡ä½ç½®</span>        <span class="token keyword">int</span> minLen <span class="token operator">=</span> sLen<span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•å½“å‰éå†å¾—åˆ°çš„æœ€å°è¦†ç›–å­ä¸²é•¿åº¦</span>        <span class="token keyword">int</span> distance <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ»‘åŠ¨çª—å£ä¸­æ‰€åŒ…å«çš„å­—æ¯ä¸ªæ•°å’Œå¯¹ç…§å­—ç¬¦ä¸²æ‰€éœ€è¦çš„å­—æ¯ä¸ªæ•°å·®è·ï¼ˆç›¸åŒæ—¶ä¸åŠ ï¼‰</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>right<span class="token operator">&lt;</span>sLen<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¾ªç¯ç»“æŸæ¡ä»¶æ˜¯å³æŒ‡é’ˆåˆ°è¾¾æœ€åä¸€ä¸ªå­—ç¬¦</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//é¦–å…ˆæ˜¯å³æŒ‡é’ˆå¾€å³èµ°ï¼Œé‡åˆ°ä¸æ˜¯æ‰€éœ€è¦æ‰¾çš„å­—ç¬¦è·³è¿‡</span>                right<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                distance<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//æ»‘åŠ¨çª—å£é‡åˆ°ä¸å¤Ÿå­—æ¯æ€»æ•°æ—¶distanceåŠ ä¸€</span>            winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>            right<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>distance <span class="token operator">==</span> tLen<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//æ»‘åŠ¨çª—å£å·¦æŒ‡é’ˆå‰è¿›</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    left<span class="token operator">++</span><span class="token punctuation">;</span>                    <span class="token keyword">continue</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> tFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                    distance<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//é‡åˆ°åˆšå¥½æ»¡è¶³å­—ç¬¦æ•°æ¡ä»¶æ—¶å‡å»distanceï¼Œä»¥ä½¿æ¢å¤ä¸‹ä¸€æ¬¡å¾ªç¯æ˜¯å³æŒ‡é’ˆå‰è¿›</span>                <span class="token keyword">int</span> tempWinLen <span class="token operator">=</span> right <span class="token operator">-</span> left<span class="token punctuation">;</span><span class="token comment">//å½“å‰æ»‘åŠ¨çª—å£çš„å­—ç¬¦é•¿åº¦</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>minLen<span class="token operator">></span>tempWinLen<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//å¦‚æœå½“å‰è®°å½•åœ¨å†…çš„æœ€å°åŒºé—´æ²¡æœ‰æ–°çš„å°åˆ™æ›¿æ¢å®ƒ</span>                    minLen <span class="token operator">=</span> tempWinLen<span class="token punctuation">;</span>                    begin <span class="token operator">=</span> left<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                                winFre<span class="token punctuation">[</span>s<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">--</span><span class="token punctuation">;</span>                left<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">//cout&lt;&lt;begin&lt;&lt;" "&lt;&lt;minLen;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>minLen <span class="token operator">==</span> sLen <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>begin<span class="token punctuation">,</span>minLen<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦O(n)ï¼Œç©ºé—´å¤æ‚åº¦O(k)ï¼Œkä¸ºä¸¤ä¸ªä¼ è¿›æ¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¹‹å’Œ</p><hr><h2 id="524-é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#524-é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="524. é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/longest-word-in-dictionary-through-deleting/">524. é€šè¿‡åˆ é™¤å­—æ¯åŒ¹é…åˆ°å­—å…¸é‡Œæœ€é•¿å•è¯</a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s å’Œä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ dictionary ä½œä¸ºå­—å…¸ï¼Œæ‰¾å‡ºå¹¶è¿”å›å­—å…¸ä¸­æœ€é•¿çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å¯ä»¥é€šè¿‡åˆ é™¤ s ä¸­çš„æŸäº›å­—ç¬¦å¾—åˆ°ã€‚</p><p>å¦‚æœç­”æ¡ˆä¸æ­¢ä¸€ä¸ªï¼Œè¿”å›é•¿åº¦æœ€é•¿ä¸”å­—å…¸åºæœ€å°çš„å­—ç¬¦ä¸²ã€‚å¦‚æœç­”æ¡ˆä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œabpcpleaâ€, dictionary = [â€œaleâ€,â€appleâ€,â€monkeyâ€,â€pleaâ€]<br>è¾“å‡ºï¼šâ€appleâ€</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šs = â€œabpcpleaâ€, dictionary = [â€œaâ€,â€bâ€,â€câ€]<br>è¾“å‡ºï¼šâ€aâ€</p></blockquote><p>æ³¨æ„è¿™é‡Œçš„<code>å­—å…¸åº</code>æ¦‚å¿µï¼šåŸºäºå­—æ¯é¡º<em>åº</em>æ’åˆ—çš„å•è¯æŒ‰å­—æ¯é¡º<em>åº</em>æ’åˆ—çš„æ–¹æ³•ï¼Œä¾‹ï¼šabc &lt; bbcï¼Œå¯ä»¥ç”¨C++ä¸­<code>string</code>ç±»è‡ªå¸¦çš„æˆå‘˜å‡½æ•°ï¼ˆéstaticï¼‰<code>a.compare(string&amp; b)</code>æ¥æ¯”è¾ƒ</p><p>è¿™é“é¢˜åˆšå¼€å§‹æƒ³å°±æ˜¯æ™®é€šåœ°æŠŠå­—å…¸ä¸­çš„å­—ç¬¦ä¸²æ¯ä¸ªéå†ï¼Œå¹¶ä½œæ¯”è¾ƒæ˜¯å¦ä¸ºså­—ç¬¦ä¸²çš„å­ä¸²ï¼Œæ¯”è¾ƒä¹‹åå†æ¯”è¾ƒå­—å…¸åºã€‚ä»¥ä¸ºè¿™ä¸ªæ–¹æ³•æ•ˆç‡ä¸è¡Œï¼Œæƒ³ä¸åˆ°å®˜æ–¹è§£ç­”ç»™å‡ºæœ€æœ‰æ•ˆç‡çš„å°±æ˜¯è¿™ä¸ªäº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    string <span class="token function">findLongestWord</span><span class="token punctuation">(</span>string s<span class="token punctuation">,</span> vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">&amp;</span> dictionary<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> sLen <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> dSize <span class="token operator">=</span> dictionary<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        string maxStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æœ€åè¦è¿”å›çš„é•¿åº¦æœ€é•¿ä¸”å­—å…¸åºæœ€å°çš„å­—ç¬¦ä¸²</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> str <span class="token operator">:</span> dictionary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsSubStr</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> maxStr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> maxStr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>maxStr<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    maxStr <span class="token operator">=</span> str<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> maxStr<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">bool</span> <span class="token function">IsSubStr</span><span class="token punctuation">(</span>string<span class="token operator">&amp;</span> a<span class="token punctuation">,</span>string<span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ£€æµ‹bæ˜¯ä¸æ˜¯açš„å­ä¸²</span>        <span class="token keyword">int</span> subSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> bLen <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch <span class="token operator">:</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>ch <span class="token operator">==</span> b<span class="token punctuation">[</span>subSize<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token operator">++</span>subSize<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>subSize <span class="token operator">==</span> bLen<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ä¸º<em>O(nÂ·x)<em>å…¶ä¸­næ˜¯å­—å…¸æ•°ç»„é•¿åº¦ï¼Œxæ˜¯æ•°ç»„ä¸­å­—ç¬¦ä¸²å¹³å‡é•¿åº¦ï¼Œ</em>O(x)</em></p><hr><h1 id="äºŒåˆ†æ³•"><a href="#äºŒåˆ†æ³•" class="headerlink" title="äºŒåˆ†æ³•"></a>äºŒåˆ†æ³•</h1><h2 id="154-å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼-IIâ€”ï¼ˆå›°éš¾ï¼‰"><a href="#154-å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼-IIâ€”ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="154. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼ IIâ€”ï¼ˆå›°éš¾ï¼‰"></a><a href="https://leetcode-cn.com/problems/find-minimum-in-rotated-sorted-array-ii/">154. å¯»æ‰¾æ—‹è½¬æ’åºæ•°ç»„ä¸­çš„æœ€å°å€¼ II</a>â€”ï¼ˆå›°éš¾ï¼‰</h2><p>å·²çŸ¥ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ï¼Œé¢„å…ˆæŒ‰ç…§å‡åºæ’åˆ—ï¼Œç»ç”± 1 åˆ° n æ¬¡ æ—‹è½¬ åï¼Œå¾—åˆ°è¾“å…¥æ•°ç»„ã€‚ä¾‹å¦‚ï¼ŒåŸæ•°ç»„ nums = [0,1,4,4,5,6,7] åœ¨å˜åŒ–åå¯èƒ½å¾—åˆ°ï¼š<br>è‹¥æ—‹è½¬ 4 æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° [4,5,6,7,0,1,4]<br>è‹¥æ—‹è½¬ 7 æ¬¡ï¼Œåˆ™å¯ä»¥å¾—åˆ° [0,1,4,4,5,6,7]<br>æ³¨æ„ï¼Œæ•°ç»„ [a[0], a[1], a[2], â€¦, a[n-1]] æ—‹è½¬ä¸€æ¬¡ çš„ç»“æœä¸ºæ•°ç»„ [a[n-1], a[0], a[1], a[2], â€¦, a[n-2]] ã€‚</p><p>ç»™ä½ ä¸€ä¸ªå¯èƒ½å­˜åœ¨ é‡å¤ å…ƒç´ å€¼çš„æ•°ç»„ nums ï¼Œå®ƒåŸæ¥æ˜¯ä¸€ä¸ªå‡åºæ’åˆ—çš„æ•°ç»„ï¼Œå¹¶æŒ‰ä¸Šè¿°æƒ…å½¢è¿›è¡Œäº†å¤šæ¬¡æ—‹è½¬ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›æ•°ç»„ä¸­çš„ æœ€å°å…ƒç´  ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><blockquote><p>è¾“å…¥ï¼šnums = [1,3,5]<br>è¾“å‡ºï¼š1</p></blockquote><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><blockquote><p>è¾“å…¥ï¼šnums = [2,2,2,0,1]<br>è¾“å‡ºï¼š0</p></blockquote><p>è¿™é“é¢˜æ„Ÿè§‰LeetCodeéš¾åº¦åˆ†çš„æŒºè¿·çš„ï¼Œè¯´æ˜¯å›°éš¾å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆéš¾åº¦ï¼Œä¹Ÿæ˜¯ä½¿ç”¨<code>left,mid,right</code>ä¸‰ä¸ªæŒ‡é’ˆï¼Œåªè¦åªè¦è€ƒè™‘å‡ ç‚¹å°±è¡Œäº†</p><p>è¿™é‡Œæœ‰ä¸‰ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯ï¼š</p><p>1ã€<code>nums[mid]</code>å°äº<code>nums[right]</code>ï¼Œè¯æ˜æˆ‘ä»¬è¦æ‰¾çš„æœ€å°å€¼åœ¨å‰åŠæ®µæˆ–è€…æ˜¯<code>nums[mid]</code>æœ¬èº«ï¼Œå› æ­¤æˆ‘ä»¬æŠŠ<code>right = mid</code></p><p>2ã€<code>nums[mid]</code>å¤§äº<code>nums[right]</code>ï¼Œè¯æ˜æœ€å°å€¼é€šè¿‡æ•°ç»„æ—‹è½¬ç»™è°ƒåˆ°æœ‰åŠæ®µå»äº†ï¼Œè€Œä¸”æ­¤æ—¶çš„<code>nums[mid]</code>è‚¯å®šä¸æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†<code>left = mid + 1</code></p><p>3ã€æ’é™¤ä¸Šé¢ä¸¤ç§æƒ…å†µä¹‹åï¼Œå°±è¦è€ƒè™‘æ•°ç»„ä¸­æœ‰é‡å¤çš„æ•°å­—ï¼Œè€Œä¸”å¯èƒ½å°±æ˜¯å½“å‰æŒ‡é’ˆæŒ‡ç€çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å³æŒ‡é’ˆå¾€å‰èµ°å°±è¡Œäº†<code>--right</code>ï¼Œè‡³äºä¸ºä»€ä¹ˆä¸æ˜¯å·¦æŒ‡é’ˆå¾€åèµ°ï¼Œæ˜¯å› ä¸ºï¼š</p><ul><li>æ­¤æ“ä½œä¸ä¼šä½¿æ•°ç»„è¶Šç•Œï¼šå› ä¸ºè¿­ä»£æ¡ä»¶ä¿è¯äº† right &gt; left &gt;= 0ï¼›</li><li>æ­¤æ“ä½œä¸ä¼šä½¿æœ€å°å€¼ä¸¢å¤±ï¼šå‡è®¾<code>nums[right]</code>æ˜¯æœ€å°å€¼ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š</li><li>1ï¼‰è‹¥ <code>nums[right]</code> æ˜¯å”¯ä¸€æœ€å°å€¼ï¼šé‚£å°±ä¸å¯èƒ½æ»¡è¶³åˆ¤æ–­æ¡ä»¶ <code>nums[mid] == nums[right]</code>ï¼Œå› ä¸º <code>mid &lt; right</code>ï¼ˆleft != right  ä¸” mid = (left + right) / 2 å‘ä¸‹å–æ•´ï¼‰ï¼›</li><li>2ï¼‰è‹¥ nums[right] ä¸æ˜¯å”¯ä¸€æœ€å°å€¼ï¼Œç”±äº<code> mid &lt; right</code> è€Œ <code>nums[mid] == nums[right]</code>ï¼Œå³è¿˜æœ‰æœ€å°å€¼å­˜åœ¨äº <code>[left, right - 1]</code>åŒºé—´ï¼Œå› æ­¤ä¸ä¼šä¸¢å¤±æœ€å°å€¼ã€‚</li></ul><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span><span class="token punctuation">:</span>    <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">findMin</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token keyword">int</span></span> nLen <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name"><span class="token keyword">int</span></span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token class-name"><span class="token keyword">int</span></span> right <span class="token operator">=</span> nLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token class-name"><span class="token keyword">int</span></span> mid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å‰åŠéƒ¨åˆ†æ˜¯å¢åºåºåˆ—</span>                right <span class="token operator">=</span> mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ååŠéƒ¨åˆ†ä¸ºé™åºåºåˆ—</span>                left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token operator">--</span>right<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ O(logN)ï¼Œæœ€åæƒ…å†µä¹Ÿåªåˆ° O(N)ï¼Œæ¯”å¦‚ç»™å®šçš„æ•°ç»„æ¯ä¸ªæ•°å­—éƒ½æ˜¯ä¸€æ ·çš„ {1,1,1,1,1}</p><hr><h2 id="540-æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#540-æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="540. æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/single-element-in-a-sorted-array/">540. æœ‰åºæ•°ç»„ä¸­çš„å•ä¸€å…ƒç´ </a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™å®šä¸€ä¸ªåªåŒ…å«æ•´æ•°çš„æœ‰åºæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½ä¼šå‡ºç°ä¸¤æ¬¡ï¼Œå”¯æœ‰ä¸€ä¸ªæ•°åªä¼šå‡ºç°ä¸€æ¬¡ï¼Œæ‰¾å‡ºè¿™ä¸ªæ•°ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: nums = [1,1,2,3,3,4,4,8,8]<br>è¾“å‡º: 2</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: nums =  [3,3,7,7,10,11,11]<br>è¾“å‡º: 10</p></blockquote><p><strong>æç¤º:</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 105</code></li><li><code>0 &lt;= nums[i] &lt;= 105</code></li></ul><p>è¿™é“é¢˜å¯ä»¥è§‚å¯Ÿé¢˜æ„å‘ç°ï¼Œåœ¨å‡ºç°ç‹¬ç«‹æ•°ä¹‹å‰ï¼Œæ•°ç»„çš„ä¸‹æ ‡éƒ½æ˜¯æœ‰è§„å¾‹çš„ï¼Œå¶æ•°ï¼ˆåŒ…å«0ï¼‰å¯¹åº”ä¸€å¯¹é‡å¤æ•°çš„ç¬¬ä¸€ä¸ªï¼Œå¥‡æ•°å¯¹åº”ç¬¬äºŒä¸ªã€‚ä¸€æ—¦ç‹¬ç«‹æ•°å‡ºç°ä¹‹åï¼Œæƒ…å†µå°±åè¿‡æ¥äº†</p><p>æ€»ä½“ä¸Šçœ‹çš„è¯ï¼Œæ•´ä¸ªæ•°ç»„è‚¯å®šæ˜¯å¥‡æ•°ä¸ªçš„ï¼Œå› ä¸ºå…¶ä½™é‡å¤æ•°æ˜¯å¶æ•°ä¸ªå†åŠ ä¸Šä¸€ä¸ªç‹¬ç«‹æ•°å°±æ˜¯å¥‡æ•°ä¸ª</p><p>å› æ­¤å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œå½“æˆ‘ä»¬æŠŠä¸€ä¸ªæ•°ç»„çš„ä¸­ä¸­é—´çš„ä¸€å¯¹å…ƒç´ ç§»é™¤ä¹‹åï¼Œå‰©ä¸‹å·¦è¾¹çš„æ•°ç»„å…¨æ˜¯é‡å¤çš„å…ƒç´ ï¼Œä¸ªæ•°ä¸ºå¶æ•°ï¼›è€Œå³è¾¹å«æœ‰ä¸€ä¸ªç‹¬ç«‹æ•°å…ƒç´ ï¼Œä¸ªæ•°ä¸ºå¥‡æ•°ã€‚</p><p><img src="https://i.loli.net/2021/07/31/njUaBzt62Sv5OIf.png" alt="1.png"></p><p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ¤æ–­å·¦å³å­æ•°ç»„å«æœ‰å…ƒç´ çš„ä¸ªæ•°æ˜¯å¥‡è¿˜æ˜¯å¶æ¥è¿›è¡Œä¸‹ä¸€æ­¥å¾€å“ªè¾¹åˆ¤æ–­</p><p>ä¸‹é¢æœ‰å‡ ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥æ¥åˆ†æä¸€ä¸‹ï¼Œå‡è®¾å·¦æŒ‡é’ˆæ˜¯<code>lo</code>ï¼Œå³æŒ‡é’ˆæ˜¯<code>hi</code></p><p>æƒ…å†µ1ï¼š</p><p>ä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å³è¾¹ï¼Œä¸”è¢« mid åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¶æ•°ã€‚</p><p>æˆ‘ä»¬å°†å³å­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å³å­æ•°ç»„å…ƒç´ ä¸ªæ•°å˜æˆå¥‡æ•°ï¼Œæˆ‘ä»¬åº”å°† <code>lo</code> è®¾ç½®ä¸º <code>mid + 2</code></p><p><img src="https://i.loli.net/2021/07/31/bnv7lY6X3uTIWw9.png" alt="2.jpg"></p><p>æƒ…å†µ2ï¼š</p><p>ä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å³è¾¹ï¼Œä¸”è¢« <code>mid</code> åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¥‡æ•°ã€‚</p><p>æˆ‘ä»¬å°†å³å­æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å³å­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å˜ä¸ºå¶æ•°ï¼Œæˆ‘ä»¬åº”å°† <code>hi</code> è®¾ç½®ä¸º <code>mid - 1</code></p><p><img src="https://i.loli.net/2021/07/31/mfnQIPMUGhT5sED.png" alt="3.png"></p><p>ä¾‹å­ 3ï¼šä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å·¦è¾¹ï¼Œä¸”è¢« mid åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¶æ•°ã€‚</p><p>æˆ‘ä»¬å°†å·¦å­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å·¦å­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å˜ä¸ºå¥‡æ•°ï¼Œæˆ‘ä»¬åº”å°† hi è®¾ç½®ä¸º mid - 2ã€‚</p><p><img src="https://i.loli.net/2021/07/31/25rqAzunOkFvGPU.png" alt="4.png"></p><p>ä¾‹å­ 4ï¼šä¸­é—´å…ƒç´ çš„åŒä¸€å…ƒç´ åœ¨å·¦è¾¹ï¼Œä¸”è¢« mid åˆ†æˆä¸¤åŠçš„æ•°ç»„ä¸ºå¥‡æ•°ã€‚</p><p>æˆ‘ä»¬å°†å·¦å­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ç§»é™¤åï¼Œåˆ™å·¦å­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å˜ä¸ºå¶æ•°ï¼Œæˆ‘ä»¬åº”å°† lo è®¾ç½®ä¸º mid + 1ã€‚</p><p><img src="https://i.loli.net/2021/07/31/xSkLFir6aE1oIPc.png" alt="5.png"></p><p>è¿˜æœ‰æœ€åä¸€ç§æƒ…å†µï¼Œå°±æ˜¯åˆšå¥½æˆ‘ä»¬çš„ä¸­é—´æŒ‡é’ˆæŒ‡å‘çš„æ•°å’Œå‰é¢åé¢çš„æ•°éƒ½ä¸ç›¸ç­‰ï¼Œå°±ä»£è¡¨è¿™ä¸ªæ•°å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç‹¬ç«‹æ•°äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç›´æ¥return</p><p>æ˜ç™½åŸç†ä¹‹åå°±å¯ä»¥å†™ä»£ç äº†</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> <span class="token function">singleNonDuplicate</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//O(log n)æ—¶é—´å¤æ‚åº¦æ–¹æ³•</span>        <span class="token keyword">int</span> nLen <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>nLen <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//åªæœ‰ä¸€ä¸ªæ•°ç›´æ¥è¿”å›</span>        <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> right <span class="token operator">=</span> nLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ä¸­é—´æŒ‡é’ˆçš„æ•°ä¸å‰ä¸€ä¸ªæ•°ç›¸ç­‰</span>                mid<span class="token operator">--</span><span class="token punctuation">;</span><span class="token comment">//ä¸­é—´æŒ‡é’ˆåé€€ä»¥ä¾¿è®¡ç®—å·¦è¾¹å­æ•°ç»„çš„ä¸ªæ•°</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mid<span class="token operator">-</span>left<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//å·¦è¾¹æ˜¯å¶æ•°çš„è¯å”¯ä¸€æ•°åœ¨å³è¾¹</span>                    left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token keyword">else</span><span class="token comment">//å¦åˆ™å”¯ä¸€æ•°åœ¨å·¦è¾¹</span>                    right <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token operator">==</span>nums<span class="token punctuation">[</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ä¸­é—´æŒ‡é’ˆå’Œåé¢ä¸€ä¸ªæ•°ç›¸ç­‰çš„è¯</span>                mid<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//ä¸­é—´æŒ‡é’ˆå‰è¿›ä¸€æ ¼ï¼Œä»¥ä¾¿è®¡ç®—å³è¾¹å­æ•°ç»„çš„ä¸ªæ•°</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">-</span> mid<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                    right <span class="token operator">=</span> mid <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    left <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ä¸­é—´æ•°ä¸å‰åçš„æ•°éƒ½ä¸ç›¸ç­‰ï¼Œä»£è¡¨æˆ‘ä»¬æ‰¾åˆ°äº†è¦çš„é‚£ä¸ªæ•°</span>                <span class="token keyword">return</span> nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)</p><p>åœ¨æ­¤é¢˜ç›®çš„å®˜æ–¹é¢˜è§£ä¸­è¿˜æœ‰ç¬¬ä¸‰ç§è§£æ³•ï¼Œ<a href="https://leetcode-cn.com/problems/single-element-in-a-sorted-array/solution/you-xu-shu-zu-zhong-de-dan-yi-yuan-su-by-leetcode/"><strong>æ–¹æ³•ä¸‰ï¼šä»…å¯¹å¶æ•°ç´¢å¼•è¿›è¡ŒäºŒåˆ†æœç´¢</strong></a>ï¼Œè¿™ä¸ªè§£æ³•æ—¶é—´å¤æ‚åº¦ä¸ºO(n/2) = O(n)ï¼Œæ¯”èµ·ä¸Šé¢çš„ç®—æ³•æ›´ä¼˜é›…ä¸€äº›ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹</p><hr><h1 id="æ’åºç®—æ³•"><a href="#æ’åºç®—æ³•" class="headerlink" title="æ’åºç®—æ³•"></a>æ’åºç®—æ³•</h1><p>æ’åºè¦æ‡‚å¾—å¸¸ç”¨çš„é‚£å‡ ä¸ªæ’åºï¼ŒåŒæ—¶è¿˜è¦æ±‚å¯ä»¥é»˜å†™å‡ºæ¥ï¼Œæ­¤åä¼šæœ‰ä¸“é—¨çš„æ–‡ç« æ¥è®°å½•å„ç§å¸¸ç”¨çš„æ’åºç®—æ³•çš„ä»£ç ï¼Œè¿™é‡Œæš‚æ—¶è·³è¿‡ï¼Œç›´æ¥çœ‹ä¸€ä¸ªåŸºäºå¿«é€Ÿæ’åºçš„<strong>å¿«é€Ÿé€‰æ‹©ç®—æ³•</strong>é¢˜ç›®</p><h2 id="215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/kth-largest-element-in-an-array/">215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ </a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>ç»™å®šæ•´æ•°æ•°ç»„ nums å’Œæ•´æ•° kï¼Œè¯·è¿”å›æ•°ç»„ä¸­ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ ã€‚</p><p>è¯·æ³¨æ„ï¼Œä½ éœ€è¦æ‰¾çš„æ˜¯æ•°ç»„æ’åºåçš„ç¬¬ k ä¸ªæœ€å¤§çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯ç¬¬ k ä¸ªä¸åŒçš„å…ƒç´ ã€‚</p><p>ç¤ºä¾‹ 1:</p><blockquote><p>è¾“å…¥: [3,2,1,5,6,4] å’Œ k = 2<br>è¾“å‡º: 5</p></blockquote><p>ç¤ºä¾‹ 2:</p><blockquote><p>è¾“å…¥: [3,2,3,1,2,4,5,5,6] å’Œ k = 4<br>è¾“å‡º: 4</p></blockquote><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= k &lt;= nums.length &lt;= 104</code></li><li><code>-104 &lt;= nums[i] &lt;= 104</code></li></ul><p>é‡åˆ°è¿™ç§å¯»æ‰¾æ•°ç»„ä¸­ç¬¬xä¸ªæœ€å¤§ï¼ˆå°ï¼‰å…ƒç´ çš„é¢˜ç›®ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨å¿«é€Ÿé€‰æ‹©çš„æ–¹æ³•æ¥è§£å†³</p><p>å› ä¸ºæˆ‘ä»¬åªç”¨æ‰¾æŸä¸ªç¬¬xä¸ªæœ€å¤§ï¼ˆå°ï¼‰çš„æ•°ï¼Œå› æ­¤å¹¶ä¸ç”¨å¯¹æ•´ä¸ªæ•°ç»„æ’åºï¼Œä»è€ŒæŠŠå¿«é€Ÿæ’åºçš„O(n*log n)çš„å¹³å‡æ—¶é—´å¤æ‚åº¦é™åˆ°O(n)ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯æœ€å·®æƒ…å†µä¸‹è¿˜æ˜¯å¯èƒ½O(n^2)</p><p>å¿«é€Ÿæ’åºæ˜¯ä¸€ç§åˆ†æ²»ç®—æ³•ï¼Œè€Œå¿«é€Ÿé€‰æ‹©ä¹Ÿç±»ä¼¼ï¼Œå‡è®¾è¿™é‡Œæœ‰ä¸€ä¸ªæ•°ç»„<strong>a[lâ€¦r]<strong>ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°æ•°ç»„</strong>ç¬¬kå¤§</strong>çš„æ•°ï¼Œå¿«é€Ÿé€‰æ‹©å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li><strong>åˆ†è§£</strong>ï¼šå°†æ•°ç»„åˆ†ä¸ºa[lâ€¦q-1]ï¼Œa[q]ï¼Œa[q+1â€¦r]ï¼Œå…¶ä¸­å·¦åŠè¾¹çš„å­æ•°ç»„a[lâ€¦q-1]æ¯ä¸€ä¸ªå…ƒç´ éƒ½å°äºç­‰äºa[q]ï¼Œè€Œå¯¹äºå³åŠè¾¹çš„å­æ•°ç»„ï¼Œa[q]éƒ½ä¼šå°äºç­‰äºå³åŠè¾¹å­æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ </li><li><strong>è§£å†³</strong>ï¼šä¸åƒå¿«é€Ÿæ’åºï¼Œæˆ‘ä»¬ä¸ç”¨æŠŠå·¦å³ä¸¤è¾¹å­æ•°ç»„è¿›è¡Œæ’åºï¼Œåªç”¨å¤„ç†å¥½a[q]ä¸¤è¾¹å­æ•°ç»„æ»¡è¶³<code>åˆ†è§£</code>æ­¥éª¤çš„è¦æ±‚å°±è¡Œäº†ã€‚å› ä¸ºå½“åˆ†è§£å¥½åï¼Œa[q]åœ¨æ•°ç»„ä¸­çš„ä½ç½®å°±æ˜¯æˆ‘ä»¬å¿«æ’åæœ€ç»ˆå®ƒæ‰€åœ¨çš„ä½ç½®ï¼Œå½“åˆ†è§£åˆ°a[q]çš„ä¸‹æ ‡qæ­£å¥½æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ä¸‹æ ‡æ—¶å°±ç›´æ¥return a[q]</li></ul><p>æ—¶é—´å¤æ‚åº¦ï¼š</p><p>æˆ‘ä»¬çŸ¥é“å¿«é€Ÿæ’åºçš„æ€§èƒ½å’Œã€Œåˆ’åˆ†ã€å‡ºçš„å­æ•°ç»„çš„é•¿åº¦å¯†åˆ‡ç›¸å…³ã€‚ç›´è§‚åœ°ç†è§£å¦‚æœæ¯æ¬¡è§„æ¨¡ä¸º n çš„é—®é¢˜æˆ‘ä»¬éƒ½åˆ’åˆ†æˆ 1å’Œ n - 1ï¼Œæ¯æ¬¡é€’å½’çš„æ—¶å€™åˆå‘ n - 1 çš„é›†åˆä¸­é€’å½’ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€åçš„ï¼Œæ—¶é—´ä»£ä»·æ˜¯ O(n ^ 2)<br> )ã€‚æˆ‘ä»¬å¯ä»¥å¼•å…¥éšæœºåŒ–æ¥åŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œå®ƒçš„æ—¶é—´ä»£ä»·çš„æœŸæœ›æ˜¯ O(n)ï¼Œè¯æ˜è¿‡ç¨‹å¯ä»¥å‚è€ƒã€Œã€Šç®—æ³•å¯¼è®ºã€‹9.2ï¼šæœŸæœ›ä¸ºçº¿æ€§çš„é€‰æ‹©ç®—æ³•ã€ã€‚</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">QuickSelect</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span><span class="token keyword">int</span> left<span class="token punctuation">,</span><span class="token keyword">int</span> right<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> i<span class="token operator">=</span>left<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//nums[l]æ˜¯å“¨å…µæ•°</span>        <span class="token keyword">int</span> j<span class="token operator">=</span>right<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>right<span class="token operator">></span>i<span class="token operator">&amp;&amp;</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token operator">++</span>i<span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>j<span class="token operator">></span>left<span class="token operator">&amp;&amp;</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">>=</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token operator">--</span>j<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">>=</span>j<span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">,</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> j<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> <span class="token function">findKthLargest</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> r <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> traget <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>k<span class="token punctuation">;</span><span class="token comment">//ç›®æ ‡</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token function">QuickSelect</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>l<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>mid<span class="token operator">==</span>traget<span class="token punctuation">)</span>                <span class="token keyword">return</span> nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>mid <span class="token operator">&lt;</span> traget<span class="token punctuation">)</span><span class="token comment">//ç›®æ ‡åœ¨å³è¾¹å­æ•°ç»„</span>                l<span class="token operator">=</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">else</span><span class="token comment">//ç›®æ ‡åœ¨å·¦è¾¹å­æ•°ç»„</span>                r<span class="token operator">=</span>mid<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h1><p>æœç´¢ä¸€èˆ¬åˆ†ä¸º<strong>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</strong>å’Œ<strong>å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰</strong>ï¼Œå®ƒä»¬è¢«å¹¿æ³›è¿ç”¨åœ¨å›¾å’Œæ ‘ç­‰ç»“æ„ä¸­</p><p><strong>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆdepth-first seachï¼Œ DFSï¼‰</strong>ï¼šåœ¨æœç´¢åˆ°ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ—¶ï¼Œç«‹å³å¯¹è¯¥æ–°èŠ‚ç‚¹è¿›è¡Œé<br>å†ï¼›å› æ­¤éå†éœ€è¦ç”¨<strong>å…ˆå…¥åå‡ºçš„æ ˆ</strong>æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸æ ˆç­‰ä»·çš„<strong>é€’å½’</strong>æ¥å®ç°ã€‚å¯¹äºæ ‘ç»“æ„è€Œè¨€ï¼Œ<br>ç”±äºæ€»æ˜¯å¯¹æ–°èŠ‚ç‚¹è°ƒç”¨éå†ï¼Œå› æ­¤çœ‹èµ·æ¥æ˜¯å‘ç€â€œæ·±â€çš„æ–¹å‘å‰è¿›ã€‚  </p><p><strong>æ·±åº¦ä¼˜å…ˆæœç´¢</strong>ä¹Ÿå¯ä»¥ç”¨æ¥<strong>æ£€æµ‹ç¯è·¯</strong>ï¼šè®°å½•æ¯ä¸ªéå†è¿‡çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œè‹¥ä¸€ä¸ªèŠ‚ç‚¹è¢«å†æ¬¡é<br>å†ä¸”çˆ¶èŠ‚ç‚¹ä¸åŒï¼Œåˆ™è¯´æ˜æœ‰ç¯ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¹‹åä¼šè®²åˆ°çš„æ‹“æ‰‘æ’åºåˆ¤æ–­æ˜¯å¦æœ‰ç¯è·¯ï¼Œè‹¥æœ€åå­˜<br>åœ¨å…¥åº¦ä¸ä¸ºé›¶çš„ç‚¹ï¼Œåˆ™è¯´æ˜æœ‰ç¯ã€‚<br>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦å¯¹å·²ç»æœç´¢è¿‡çš„èŠ‚ç‚¹è¿›è¡Œæ ‡è®°ï¼Œä»¥é˜²æ­¢åœ¨éå†æ—¶é‡å¤æœç´¢æŸä¸ªèŠ‚ç‚¹ï¼Œè¿™<br>ç§åšæ³•å«åš<strong>çŠ¶æ€è®°å½•</strong>æˆ–<strong>è®°å¿†åŒ–ï¼ˆmemoizationï¼‰</strong>ã€‚  </p><p><strong>å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆbreadth-first searchï¼Œ BFSï¼‰</strong>ï¼šä¸åŒä¸æ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå®ƒæ˜¯ä¸€å±‚å±‚è¿›è¡Œéå†çš„ï¼Œå› <br>æ­¤éœ€è¦ç”¨<strong>å…ˆå…¥å…ˆå‡ºçš„é˜Ÿåˆ—</strong>è€Œéå…ˆå…¥åå‡ºçš„æ ˆè¿›è¡Œéå†ã€‚ç”±äºæ˜¯æŒ‰å±‚æ¬¡è¿›è¡Œéå†ï¼Œå¹¿åº¦ä¼˜å…ˆæœç´¢æ—¶<br>æŒ‰ç…§â€œå¹¿â€çš„æ–¹å‘è¿›è¡Œéå†çš„ï¼Œä¹Ÿå¸¸å¸¸ç”¨æ¥å¤„ç†æœ€çŸ­è·¯å¾„ç­‰é—®é¢˜ã€‚  </p><p>è¿™é‡Œè¦æ³¨æ„ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢å’Œå¹¿åº¦ä¼˜å…ˆæœç´¢éƒ½å¯ä»¥å¤„ç†<strong>å¯è¾¾æ€§</strong>é—®é¢˜ï¼Œå³ä»ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹æ˜¯å¦<br>èƒ½è¾¾åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å› ä¸ºæ·±åº¦ä¼˜å…ˆæœç´¢å¯ä»¥åˆ©ç”¨é€’å½’å¿«é€Ÿå®ç°ï¼Œå¾ˆå¤šäººä¼šä¹ æƒ¯ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢<br>åˆ·æ­¤ç±»é¢˜ç›®ã€‚å®é™…è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œå¾ˆå°‘è§åˆ°é€’å½’çš„å†™æ³•ï¼Œå› ä¸ºä¸€æ–¹é¢éš¾ä»¥ç†è§£ï¼Œå¦ä¸€æ–¹é¢å¯èƒ½<br>äº§ç”Ÿæ ˆæº¢å‡ºçš„æƒ…å†µï¼›è€Œç”¨æ ˆå®ç°çš„æ·±åº¦ä¼˜å…ˆæœç´¢å’Œç”¨é˜Ÿåˆ—å®ç°çš„å¹¿åº¦ä¼˜å…ˆæœç´¢åœ¨å†™æ³•ä¸Šå¹¶æ²¡æœ‰å¤ª<br>å¤§å·®å¼‚ï¼Œå› æ­¤ä½¿ç”¨å“ªä¸€ç§æœç´¢æ–¹å¼éœ€è¦æ ¹æ®å®é™…çš„åŠŸèƒ½éœ€æ±‚æ¥åˆ¤æ–­ã€‚  </p><h2 id="934-æœ€çŸ­çš„æ¡¥â€”ï¼ˆä¸­ç­‰ï¼‰"><a href="#934-æœ€çŸ­çš„æ¡¥â€”ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="934. æœ€çŸ­çš„æ¡¥â€”ï¼ˆä¸­ç­‰ï¼‰"></a><a href="https://leetcode-cn.com/problems/shortest-bridge/">934. æœ€çŸ­çš„æ¡¥</a>â€”ï¼ˆä¸­ç­‰ï¼‰</h2><p>åœ¨ç»™å®šçš„äºŒç»´äºŒè¿›åˆ¶æ•°ç»„ A ä¸­ï¼Œå­˜åœ¨ä¸¤åº§å²›ã€‚ï¼ˆå²›æ˜¯ç”±å››é¢ç›¸è¿çš„ 1 å½¢æˆçš„ä¸€ä¸ªæœ€å¤§ç»„ã€‚ï¼‰</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† <code>0</code> å˜ä¸º <code>1</code>ï¼Œä»¥ä½¿ä¸¤åº§å²›è¿æ¥èµ·æ¥ï¼Œå˜æˆä¸€åº§å²›ã€‚</p><p>è¿”å›å¿…é¡»ç¿»è½¬çš„ <code>0</code> çš„æœ€å°æ•°ç›®ã€‚ï¼ˆå¯ä»¥ä¿è¯ç­”æ¡ˆè‡³å°‘æ˜¯ <code>1 </code>ï¼‰</p><p>ç¤ºä¾‹ 1ï¼š</p><blockquote><p>è¾“å…¥ï¼šA = [[0,1],[1,0]]<br>è¾“å‡ºï¼š1</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><blockquote><p>è¾“å…¥ï¼šA = [[0,1,0],[0,0,0],[0,0,1]]<br>è¾“å‡ºï¼š2</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šA = [[1,1,1,1,1],[1,0,0,0,1],[1,0,1,0,1],[1,0,0,0,1],[1,1,1,1,1]]<br>è¾“å‡ºï¼š1</p></blockquote><p>ç¤ºä¾‹4ï¼š</p><blockquote><p>è¾“å…¥ï¼š<br>[[1,1,1,1,1],<br>[1,0,0,0,1],<br>[1,0,1,0,1],<br>[1,0,0,0,1],<br>[1,1,1,1,1]]<br>è¾“å‡ºï¼š1  </p></blockquote><p><strong>æç¤ºï¼š</strong></p><ul><li><code>2 &lt;= A.length == A[0].length &lt;= 100</code></li><li><code>A[i][j] == 0</code> æˆ– <code>A[i][j] == 1</code></li></ul><p>å²›å±¿é—®é¢˜ä¸€èˆ¬éƒ½æ˜¯ä¸dfsæœ‰å…³ç³»ï¼Œå¤§å¤šéƒ½æ˜¯å¥—æ¨¡æ¿</p><p>è¿™é‡Œæœ‰é¢˜ç›®å¾—çŸ¥ä¸€å…±æœ‰ä¸¤ä¸ªå²›å±¿ï¼Œå…¶ä½™çš„éƒ½æ˜¯æ°´ï¼Œè¿™é‡Œç”¨ç¤ºä¾‹4æ¥è¯´</p><p>åˆšå¼€å§‹ä¸¤åº§å²›å±¿æ˜¯éš”å¼€çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆéå†å…¶ä¸­ä¸€ä¸ªå²›å±¿ï¼Œå¹¶æŠŠæ•´ä¸ªå²›å±¿éå†å®Œï¼ŒåŒæ—¶è¾¹éå†è¾¹æŠŠè¿™ä¸ªå²›çš„<code>1</code>æ”¹æˆ<code>2</code>ä½œä¸ºæ ‡è®°</p><p>å½“æŠŠè¿™ä¸ªå²›å…¨éƒ¨éå†å®Œæ—¶ï¼Œæ­¤æ—¶åœ°å›¾ä¸Šæœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šå²›å±¿1ã€å²›å±¿2å’Œæ°´</p><p>ç´§æ¥ç€å†é€‰æ‹©ä¸€ä¸ªå²›å±¿ï¼ˆè¿™é‡Œå‡è®¾é€‰æ‹©å²›å±¿1ï¼‰ï¼Œä½¿ç”¨å¹¿åº¦æœç´¢å±‚å±‚éå†ï¼Œå½“ç¬¬ä¸€æ¬¡é‡åˆ°å²›å±¿2æ—¶èµ°è¿‡çš„å±‚æ•°å°±æ˜¯æœ€çŸ­æ¡¥</p><p>ä»£ç æœ‰ç‚¹å¤šï¼Œå¤§è‡´åˆ†ä¸ºå››ä¸ªæ­¥éª¤</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">int</span> direction<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//æ–¹å‘æ•°ç»„</span>    <span class="token keyword">int</span> <span class="token function">shortestBridge</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> map<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//æ­¥éª¤1ï¼šéå†ä¸€ä¸ªå²›ï¼ŒæŠŠ1æ”¹æˆ2ä½œä¸ºæ ‡è®°</span>        <span class="token comment">//dfs</span>        <span class="token keyword">int</span> findFlag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•æ˜¯å¦æ‰¾åˆ°å²›å±¿äº†</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//ç¬¬ä¸€å±‚</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//ç¬¬äºŒå±‚</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//æ‰¾åˆ°äº†å²›å±¿</span>                    map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>                    <span class="token function">dfs</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ­¥éª¤2ï¼šæ·±åº¦æœç´¢åŒæ—¶æŠŠå½“å‰æ•´ä¸ªå¤§é™†æ¶‚ä¸Š2</span>                    findFlag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°å²›å±¿ï¼Œæ ‡è®°ä»¥ä¾¿é€€å‡ºå¾ªç¯ï¼Œå› ä¸ºæ‰¾åˆ°ä¸€å—å…¶å®ƒç›¸è¿çš„éƒ½ä¼šåœ¨dfsä¸­æ¶‚ä¸Š2</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°åå°±é€€å‡ºäº†</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>findFlag<span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ­¤æ—¶ï¼Œè¿é€šå—å·²æ¶‚è‰²ï¼Œåˆ†ä¸ºä¸‰å—ï¼Œ0æ˜¯æ°´ï¼Œ1å’Œ2ä»£è¡¨ä¸¤ä¸ªè¿é€šå—ï¼ˆå²›1å’Œå²›2ï¼‰</span>        <span class="token comment">//æ­¥éª¤3ï¼šå†é€‰æ‹©ä¸€ä¸ªå²›å±¿ï¼ˆè¿™é‡Œé€‰æ‹©å²›å±¿1ï¼‰ï¼Œä¸ºå¹¿åº¦æœç´¢é˜Ÿåˆ—åšå‡†å¤‡è€Œå…¥åˆ—</span>        <span class="token keyword">int</span> step<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è®°å½•å±‚æ•°ï¼Œæœ€ç»ˆè¿”å›çš„ç­”æ¡ˆ</span>        queue<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">>></span> qMap<span class="token punctuation">;</span><span class="token comment">//é€‰æ‹©pairæ˜¯ä¸ºäº†å­˜å‚¨åæ ‡</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">++</span>j<span class="token punctuation">)</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//æŠŠå²›å±¿1çš„ç‚¹åæ ‡å…¨éƒ¨å…¥åˆ—</span>                    qMap<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ­¥éª¤4ï¼šå¹¿åº¦æœç´¢é˜Ÿåˆ—ä¸­çš„å²›å±¿ï¼Œå±‚å±‚æ¨è¿›å‘å¤–æ‰©å¼ </span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>qMap<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//é˜Ÿåˆ—ä¸ä¸ºç©ºå°±åœ¨å¾ªç¯å†…</span>            <span class="token keyword">int</span> size <span class="token operator">=</span> qMap<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å½“å‰å±‚è¦éå†çš„æ¬¡æ•°</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token keyword">int</span><span class="token operator">></span> cur <span class="token operator">=</span> qMap<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> x<span class="token operator">=</span>cur<span class="token punctuation">.</span>first<span class="token punctuation">;</span>                <span class="token keyword">int</span> y<span class="token operator">=</span>cur<span class="token punctuation">.</span>second<span class="token punctuation">;</span>                qMap<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>index<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token operator">++</span>index<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//å‘å››å‘¨æ‰©æ•£</span>                    <span class="token keyword">int</span> x_next<span class="token operator">=</span>x<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">int</span> y_next<span class="token operator">=</span>y<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span>x_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>x_next<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment">//æ‰¾åˆ°å²›å±¿2ï¼Œå¯ä»¥è¿”å›äº†</span>                            <span class="token keyword">return</span> step<span class="token punctuation">;</span>                        <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">//éå†çš„è¿˜æ˜¯å½“å‰å²›å±¿çš„ç‰ˆå—ï¼Œç»§ç»­æœç´¢</span>                            <span class="token keyword">continue</span><span class="token punctuation">;</span>                        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                            <span class="token comment">//éå†çš„æ˜¯æµ·æ´‹</span>                            qMap<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>x_next<span class="token punctuation">,</span>y_next<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å…¥é˜Ÿåˆ—</span>                            map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//æ¶‚è‰²ï¼Œé˜²æ­¢éå†é‡å¤</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            step<span class="token operator">++</span><span class="token punctuation">;</span><span class="token comment">//éå†ä¸€å±‚ç»“æŸï¼Œç­”æ¡ˆåŠ ä¸€</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//æ·±åº¦æœç´¢ï¼Œå°†æ•´å—å¤§é™†çš„1æ”¹æˆ2</span>    <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">>></span><span class="token operator">&amp;</span> map<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>index<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">;</span><span class="token operator">++</span>index<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¾€å››ä¸ªæ–¹å‘æ‰©å¼ </span>            <span class="token keyword">int</span> x_next<span class="token operator">=</span>x<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> y_next<span class="token operator">=</span>y<span class="token operator">+</span>direction<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>x_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">>=</span><span class="token number">0</span><span class="token operator">&amp;&amp;</span>x_next<span class="token operator">&lt;</span>map<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>y_next<span class="token operator">&lt;</span>map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span>map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//é™åˆ¶æ¡ä»¶ï¼Œæ‰€å¯»æ‰¾çš„ä¸‹ä¸€ä¸ªç‚¹æ²¡æœ‰è¶Šç•Œï¼ŒåŒæ—¶ä¸‹ä¸€ä¸ªç‚¹ä¹Ÿæ˜¯å±äºé™†åœ°</span>                map<span class="token punctuation">[</span>x_next<span class="token punctuation">]</span><span class="token punctuation">[</span>y_next<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//æ¶‚è‰²</span>                <span class="token function">dfs</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span>x_next<span class="token punctuation">,</span>y_next<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç»§ç»­æœç´¢</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¶é—´å¤æ‚åº¦ï¼šO(MN)ï¼Œå…¶ä¸­ M å’Œ N åˆ†åˆ«æ˜¯æ•°ç»„è¡Œæ•°å’Œåˆ—æ•°</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(MN)</p><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ&quot;&gt;&lt;a href=&quot;#LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ&quot; class=&quot;headerlink&quot; title=&quot;LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ&quot;&gt;&lt;/a&gt;LeetCodeåˆ·é¢˜ç¬”è®°ç¬¬ä¸€æœŸ&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="LeetCodeåˆ·é¢˜ç¬”è®°" scheme="http://sakura-pub.ltd/categories/LeetCode%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="LeetCode" scheme="http://sakura-pub.ltd/tags/LeetCode/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°11-æ·»åŠ æ”»å‡»å±æ€§</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B011-%E6%B7%BB%E5%8A%A0%E6%94%BB%E5%87%BB%E5%B1%9E%E6%80%A7/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B011-%E6%B7%BB%E5%8A%A0%E6%94%BB%E5%87%BB%E5%B1%9E%E6%80%A7/</id>
    <published>2021-07-17T01:11:59.000Z</published>
    <updated>2021-07-17T06:34:40.384Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥ç»™äººç‰©è¿˜æœ‰å²è±å§†æ·»åŠ æ”»å‡»çš„å±æ€§ï¼ŒåŒæ—¶ä¹Ÿç»™å²è±å§†è¡¥å……ä¸Šæ”»å‡»çš„åŠ¨ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹å§</p><h1 id="åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject"><a href="#åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject" class="headerlink" title="åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject"></a>åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject</h1><p>é¦–å…ˆè¿˜æ˜¯æ–°å»ºæ–‡ä»¶å¤¹å’Œä»£ç æ–‡ä»¶ğŸ‘‡</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/b58fb07a9dd74e99a87414a252bf97d5.png" alt="1.png" style="zoom:80%;" /><p>æ‰“å¼€è¿™ä¸ªä»£ç ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸‹æœ‰å…³æ”»å‡»çš„å±æ€§</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CreateAssetMenu</span><span class="token attribute-arguments"><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Attack/Attack Data"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AttackData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token punctuation">&#123;</span>    <span class="token comment">//è®°å½•æ”»å‡»ç›¸å…³å±æ€§</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> attackRange<span class="token punctuation">;</span><span class="token comment">//è¿‘æˆ˜æ”»å‡»èŒƒå›´</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> skillRange<span class="token punctuation">;</span><span class="token comment">//è¿œç¨‹æ”»å‡»èŒƒå›´</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> coolDown<span class="token punctuation">;</span><span class="token comment">//CDå†·å´</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> minDamage<span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æœ€å°ä¼¤å®³</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> maxDamage<span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æœ€å¤§ä¼¤å®³</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> criticalMultiplier<span class="token punctuation">;</span><span class="token comment">//æš´å‡»åŠ æˆç™¾åˆ†æ¯”</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> criticalChance<span class="token punctuation">;</span><span class="token comment">//æš´å‡»ç‡</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å®Œä»£ç ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªæœ‰å…³æ”»å‡»çš„<code>ScriptableObject</code>äº†</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/ab9faff156ca410f9a77dd7090b983e8.png" alt="2.png" style="zoom:80%;" /><p>ç„¶åæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚è¿›è¡Œå±æ€§å€¼è®¾å®š</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/cc0abf9d1c1f4e6d8accc357cba98c51.png" alt="3.png" style="zoom:80%;" /><p>åŒæ—¶æˆ‘ä»¬è¿˜è¦å°†å®ƒæŒ‚è½½åˆ°äººç‰©å’Œæ•Œäººèº«ä¸Šï¼Œæˆ‘ä»¬æ‰“å¼€<code>Monobehavior</code>æ–‡ä»¶å¤¹ä¸‹çš„<code>CharcterStates.cs</code>ä»£ç æ–‡ä»¶ï¼Œè¿™ä¸ªä»£ç æ–‡ä»¶æ˜¯æŒ‚è¾…åŠ©å°†ScriptableObjectæŒ‚è½½çš„</p><p>ç„¶åæ·»åŠ ä¸€è¡Œä»£ç ï¼Œæ¥å—å¤–ç•Œæä¾›çš„<code>Player BaseAttackData</code>çš„ScriptableObject</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token class-name">AttackData_SO</span> attackData<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å›åˆ°å²è±å§†ä¸ŠæŒ‚è½½äº†</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/ba22aeebd6224df78664695acf1c927f.png" alt="4.png" style="zoom:80%;" /><h1 id="è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç "><a href="#è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç " class="headerlink" title="è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç "></a>è¡¥å……ä¹‹å‰çš„æ”»å‡»ç›¸å…³ä»£ç </h1><p>è¿˜è®°å¾—ä¹‹å‰åœ¨å†™äººç‰©å’Œå²è±å§†æ”»å‡»æ—¶ç•™ä¸‹æ¥çš„ä¸€äº›å¾…è¡¥å……ä»£ç å—ï¼Ÿæˆ‘ä»¬ç°åœ¨å°±å¯ä»¥é€æ­¥æ¥å®Œå–„å®ƒä»¬äº†</p><p>ç¬¬ä¸€ä¸ªè¦ä¿®æ”¹çš„æ˜¯<code>PlayerController.cs</code>é‡Œé¢äººç‰©çš„æ”»å‡»è·ç¦»ï¼Œä¹‹å‰æˆ‘ä»¬ä¸€ç›´æ˜¯é»˜è®¤ä¸º1ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬å¯ä»¥æ¥è¡¥å……å®ƒäº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//ScriptableObjectç›¸å…³å˜é‡</span><span class="token keyword">private</span> <span class="token class-name">CharcterStates</span> charcterStates<span class="token punctuation">;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    charcterStates <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name">IEnumerator</span> <span class="token function">MoveToAttackTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//TODO:æ·»åŠ äººç‰©æ”»å‡»è·ç¦»</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span><span class="token operator">></span>          charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>attackRange<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ¯”è¾ƒäººç‰©å’Œæ•Œäººçš„è·ç¦»æ˜¯å¦å¤§äº0æ”»å‡»è·ç¦»ï¼ŒDistance()å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªVector3è·ç¦»</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> attactTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>        <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å£°æ˜ä¸€ä¸ª<code>CharcterStates</code>åï¼Œæˆ‘ä»¬è¦æŠŠè¿™é‡Œçš„whileåˆ¤æ–­æ¡ä»¶å³è¾¹çš„1æ”¹æˆ<code>charcterStates.attackData.attackRange</code>ä»¥è·å–æ”»å‡»è·ç¦»åˆ¤æ–­</p><p>ç„¶åæ˜¯<code>EnemyController.cs</code>ï¼Œè¿™é‡Œä¿®æ”¹é‡æ¯”è¾ƒå¤§</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//ScriptableObjectç›¸å…³å˜é‡</span><span class="token keyword">private</span> <span class="token class-name">CharcterStates</span> charcterStates<span class="token punctuation">;</span><span class="token comment">//è¿™ä¸ªæ•Œäººæ”»å‡»ç›¸å…³çš„</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> lastAttackTime<span class="token punctuation">;</span><span class="token comment">//ä¸Šä¸€æ¬¡æ”»å‡»çš„æ—¶é—´ï¼ˆç”¨æ¥å®ç°CDå†·å´æ•ˆæœï¼‰</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    charcterStates <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CharcterStates<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    lastAttackTime <span class="token operator">=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>coolDown<span class="token punctuation">;</span><span class="token comment">//å¼€å§‹è·å–å†·å´æ—¶é—´</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>    lastAttackTime<span class="token operator">-=</span>Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span><span class="token comment">//æ¯ä¸€å¸§éƒ½å‡å†·å´</span><span class="token punctuation">&#125;</span><span class="token comment">//åˆ¤æ–­æ”»å‡»è·ç¦»å‡½æ•°</span><span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//äººç‰©åœ¨æ•Œäººçš„æ”»å‡»è·ç¦»å†…</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span>            <span class="token operator">&lt;=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>attackRange<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//äººç‰©åœ¨æ•Œäººçš„è¿œç¨‹æ”»å‡»è·ç¦»å†…</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>attackTarget<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span>            <span class="token operator">&lt;=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>skillRange<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»            <span class="token comment">//...</span>            <span class="token comment">//TODO:åœ¨æ”»å‡»èŒƒå›´æ”»å‡»</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//åœæ­¢è·Ÿéš</span>                agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//åœä¸‹æ¥</span>                <span class="token comment">//æ”»å‡»å†·å´å®Œæˆè¿›è¡Œæ”»å‡»ï¼Œåœ¨å‰é¢å£°æ˜äº†</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>lastAttackTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    lastAttackTime <span class="token operator">=</span> charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>coolDown<span class="token punctuation">;</span>                    <span class="token comment">//æš´å‡»åˆ¤æ–­ï¼Œéšæœºè·å–çš„æ•°å€¼ï¼ˆ0åˆ°1ä¹‹é—´ï¼‰åœ¨æš´å‡»ç‡å†…åˆ™æ˜¯æš´å‡»</span>                    <span class="token comment">//charcterStates.isCriticalä¸‹é¢ä¼šè®²ï¼Œç”¨æ¥è®°å½•æ˜¯å¦æš´å‡»çš„å˜é‡</span>                    charcterStates<span class="token punctuation">.</span>isCritical <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token keyword">value</span> <span class="token operator">&lt;</span>                        charcterStates<span class="token punctuation">.</span>attackData<span class="token punctuation">.</span>criticalChance<span class="token punctuation">;</span>                    <span class="token comment">//æ‰§è¡Œæ”»å‡»</span>                    <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//æ”»å‡»æ§åˆ¶å‡½æ•°</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æ—¶æ•Œäººçœ‹å‘ç›®æ ‡</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿‘èº«æ”»å‡»åŠ¨ç”»</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿œç¨‹æˆ–æŠ€èƒ½æ”»å‡»åŠ¨ç”»</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬çœ‹åˆ°ä¸­é—´æ§åˆ¶æ”»å‡»çš„æ—¶å€™æœ‰ä¸€ä¸ª<code>charcterStates.isCritical</code>çš„æ–°å˜é‡ï¼Œè¿™æ˜¯åœ¨<code>CharcterStates.cs</code>ä¸­æ–°å£°æ˜çš„ï¼Œå¯ä»¥ä¾›å¤–ç•Œè®¿é—®çš„å¸ƒå°”å€¼ï¼Œç”¨æ¥è®°å½•å½“å‰æ˜¯å¦ä¸ºæš´å‡»ï¼ŒåŒæ—¶è™½ç„¶å®ƒæ˜¯publicå±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨<code>[HideInInspector]</code>å°†å…¶éšè—èµ·æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//CharcterStates.cs</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterStates</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HideInInspector</span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> isCritical<span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦æš´å‡»</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç å¼€å§‹å¤æ‚äº†èµ·æ¥ï¼Œéœ€è¦å¥½å¥½ç†è§£å“¦</p><h1 id="æ·»åŠ æ”»å‡»åŠ¨ç”»"><a href="#æ·»åŠ æ”»å‡»åŠ¨ç”»" class="headerlink" title="æ·»åŠ æ”»å‡»åŠ¨ç”»"></a>æ·»åŠ æ”»å‡»åŠ¨ç”»</h1><p>æˆ‘ä»¬çœ‹åˆ°ä¸Šé¢çš„ä»£ç æœ‰ä¸¤ä¸ªåŠ¨ç”»éœ€è¦æˆ‘ä»¬æ¥æ·»åŠ ï¼Œä¸€ä¸ªæ˜¯è¿‘èº«æ”»å‡»åŠ¨ç”»ï¼Œä¸€ä¸ªæ˜¯è¿œç¨‹æˆ–æŠ€èƒ½åŠ¨ç”»</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/3d2834012c04439d824cd2b2bbb56556.png" alt="5.png" style="zoom:80%;" /><p>æˆ‘ä»¬æŒ‰ä¸Šå›¾è¿™æ ·ç¼–è¾‘åŠ¨ç”»æ§åˆ¶å™¨ï¼Œå»ºç«‹ä¸¤ä¸ª<code>Trigger</code>ç±»å‹çš„å˜é‡æ¥åˆ†åˆ«æ§åˆ¶<code>Attack01</code>å’Œ<code>Attack02</code>çš„åŠ¨ç”»è§¦å‘æ¡ä»¶ï¼Œå…¶æ¬¡è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯ç”±å·¡é€»çŠ¶æ€åˆ‡æ¢è¿‡å»æ”»å‡»çŠ¶æ€æ—¶å¹¶ä¸éœ€è¦åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœï¼ŒåŒæ—¶è®°å¾—ä¸è¦å¿˜è®°æŠŠè§¦å‘æ¡ä»¶é€‰æ‹©ä¸Š</p><p>ç„¶åæˆ‘ä»¬å›åˆ°ä»£ç ä¸­ï¼Œæ‰¾åˆ°æ§åˆ¶æ”»å‡»çš„<code>Attack()</code>å‡½æ•°è¡¥å……ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ§åˆ¶æ•Œäººæ”»å‡»çš„å‡½æ•°</span>    transform<span class="token punctuation">.</span><span class="token function">LookAt</span><span class="token punctuation">(</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ”»å‡»æ—¶æ•Œäººçœ‹å‘ç›®æ ‡</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInAttackRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿‘èº«æ”»å‡»åŠ¨ç”»</span>        anim<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Attack"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">TargetInSkillRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¿œç¨‹æˆ–æŠ€èƒ½æ”»å‡»åŠ¨ç”»</span>        anim<span class="token punctuation">.</span><span class="token function">SetTrigger</span><span class="token punctuation">(</span><span class="token string">"Skill"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†åŸºæœ¬çš„æ”»å‡»æ•ˆæœ</p><p>æˆ‘ä»¬è¿˜å¯ä»¥æŠŠæš´å‡»æ•ˆæœåŠ ä¸Šï¼Œå¯ä»¥æŠŠSkillåŠ¨ç”»æ¢æˆæˆ‘ä»¬çš„æš´å‡»æ•ˆæœåŠ¨ç”»</p><p>å†æ¬¡æ‰“å¼€åŠ¨ç”»æ§åˆ¶å™¨ï¼Œæ·»åŠ ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å˜é‡<code>Critical</code></p><p>æˆ‘ä»¬æŠŠ<code>Attack02</code>å½“åšæš´å‡»åŠ¨ç”»ï¼Œç„¶åè°ƒæ•´ä¸€ä¸‹åŠ¨ç”»çš„åˆ‡æ¢è¿‡ç¨‹</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/d665b2ca32e840c8868baf19b0e587cf.png" alt="6.png" style="zoom:80%;" /><p>è¿™é‡Œæ³¨æ„ä¸€ç‚¹å°±æ˜¯è¿˜è¦åŒºåˆ«æ™®é€šæ”»å‡»æ—¶<code>Critical</code>è§¦å‘çŠ¶æ€åº”è¯¥æ˜¯<code>false</code>ï¼Œä»¥é˜²åŠ¨ç”»å†²çª</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/4745d79d02704b0c9ef1bf7903896d5b.png" alt="7.png" style="zoom:80%;" /><p>ç„¶åè¿”å›ä»£ç ï¼Œæˆ‘ä»¬è¦æ—¶åˆ»è·å–æ˜¯å¦ä¸ºæš´å‡»çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥å¦‚ä¸‹æ“ä½œ</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//å®æ—¶æ›´æ–°Animatoré‡Œé¢å²è±å§†çš„çŠ¶æ€å¸ƒå°”å€¼</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Critical"</span><span class="token punctuation">,</span>charcterStates<span class="token punctuation">.</span>isCritical<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ—¶åˆ»è·å–æ˜¯å¦ä¸ºæš´å‡»</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äº<code>SwitchAnimation()</code>æ˜¯æ”¾åœ¨Update()é‡Œé¢è¿è¡Œçš„ï¼Œæ‰€ä»¥å¯ä»¥æŠŠæš´å‡»çŠ¶æ€æ”¾åœ¨è¿™é‡Œè®©å®ƒæ¯ä¸€åˆ»éƒ½è·å–æš´å‡»çŠ¶æ€</p><h1 id="ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜"><a href="#ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜" class="headerlink" title="ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜"></a>ä¿®å¤äººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´åæ•Œäººä¸åŠ¨é—®é¢˜</h1><p>æœ€åï¼Œæˆ‘ä»¬æœ‰ä¸ªå°é—®é¢˜è¦ä¿®å¤ä¸€ä¸‹</p><p>ç”±äºä¹‹å‰æˆ‘ä»¬å†™äº†å‘ç°æ•Œäººæ—¶æ•Œäººå°±è¦åœä¸‹æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰€ä»¥ï¼Œå¦‚æœäººç‰©è„±ç¦»æ•Œäººæ”»å‡»èŒƒå›´æ—¶æˆ‘ä»¬å°±è¦æŠŠåœæ­¢çŠ¶æ€å–æ¶ˆæ‰ï¼Œä¸ç„¶å°±ä¼šå‡ºç°æ•Œäººåœç•™åœ¨åŸåœ°çš„ç°è±¡</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»<span class="token comment">//...</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>        agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//äººç‰©è„±ç¦»è¿½å‡»èŒƒå›´åï¼Œæ•Œäººåœåœ¨å½“å‰ä½ç½®</span>        isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        isFollow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°äººç‰©å°±è·‘ç€è¿½</span>        agent<span class="token punctuation">.</span>isStopped <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//&lt;-----------åœæ­¢çŠ¶æ€å–æ¶ˆ</span>        agent<span class="token punctuation">.</span>speed<span class="token operator">=</span>speed<span class="token punctuation">;</span>        <span class="token comment">//äººç‰©è¿›åˆ°æ•Œäººçš„èŒƒå›´ä¼šç»™è¿½å‡»</span>        agent<span class="token punctuation">.</span>destination<span class="token operator">=</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆåˆ°è¿™ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ç»™äººç‰©å’Œæ•Œäººæ·»åŠ æ”»å‡»å±æ€§ï¼Œå¹¶ä¸”è¿˜ä¸ºæ•ŒäººåŠ äº†æ™®é€šæ”»å‡»å’Œæš´å‡»ç­‰æ”»å‡»åŠ¨ç”»ï¼Œè®©æ¸¸æˆå¼€å§‹å˜å¾—æœ‰æ¨¡æœ‰æ ·èµ·æ¥</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;åœ¨è¿™ä¸€ç« èŠ‚ä¸­æˆ‘ä»¬æ¥ç»™äººç‰©è¿˜æœ‰å²è±å§†æ·»åŠ æ”»å‡»çš„å±æ€§ï¼ŒåŒæ—¶ä¹Ÿç»™å²è±å§†è¡¥å……ä¸Šæ”»å‡»çš„åŠ¨ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¼€å§‹å§&lt;/p&gt;
&lt;h1 id=&quot;åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject&quot;&gt;&lt;a href=&quot;#åˆ›å»ºæœ‰å…³æ”»å‡»çš„ScriptableObject&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°10-ä¸ºäººç‰©æ·»åŠ å±æ€§</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B010-%E4%B8%BA%E4%BA%BA%E7%89%A9%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B010-%E4%B8%BA%E4%BA%BA%E7%89%A9%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7/</id>
    <published>2021-07-16T07:37:04.000Z</published>
    <updated>2021-07-16T09:55:36.320Z</updated>
    
    <content type="html"><![CDATA[<p>ğŸˆ<strong>æ³¨æ„</strong>ï¼šä»è¿™ä¸€ç« å¼€å§‹ï¼Œç¬”è®°å†…å®¹ä¼šåœ¨ä¸€äº›æ¯”è¾ƒç®€å•çš„åœ°æ–¹è¿›è¡Œç®€ç•¥</p><h1 id="è®¤è¯†Scriptable-Object"><a href="#è®¤è¯†Scriptable-Object" class="headerlink" title="è®¤è¯†Scriptable Object"></a>è®¤è¯†Scriptable Object</h1><p>è¿™ä¸€ç« å¼€å§‹æˆ‘ä»¬ä¼šé¢‘ç¹åœ°ä½¿ç”¨ä»£ç ä»¥åŠæ›´å¤šåœ°<code>ScriptableObject</code>èµ·æ¥ï¼Œä»€ä¹ˆæ˜¯Scriptable Objectå‘¢ï¼Ÿå°±åƒä¸‹å›¾æˆ‘ä»¬çš„<code>Pipeline Setting</code>æ–‡ä»¶å¤¹ä¸‹çš„ä¸œè¥¿å°±æ˜¯æˆ‘ä»¬ä¸€ç§Scriptable Objectå®ç°æ–¹å¼</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/158275c63e164f448921282c6cefad4a.png" alt="1.png" style="zoom:80%;" /><p>å…³äºå®ƒçš„æ›´å¤šç‰¹æ€§å¯ä»¥ä¸Šç½‘æœç´¢èµ„æ–™ï¼Œè¿™é‡Œä¸è¿‡å¤šæè¿°</p><p>é‚£ä¹ˆæˆ‘ä»¬è¿™æ¬¡å°±æ‹¿å®ƒæ¥ç»™æˆ‘ä»¬çš„äººç‰©åŒ…æ‹¬æ•Œäººåˆ›å»ºä¸€äº›åŸºæœ¬çš„å±æ€§å€¼ï¼Œå¦‚ï¼šè¡€é‡ã€é˜²å¾¡å€¼ç­‰ç­‰</p><h1 id="ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼"><a href="#ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼" class="headerlink" title="ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼"></a>ä¸ºäººç‰©æ·»åŠ å±æ€§å€¼</h1><p>é¦–å…ˆè¦åœ¨<code>Scripts</code>æ–‡ä»¶å¤¹åˆ›å»ºä¸€äº›æ–‡ä»¶å¤¹ä»¥ä¾¿æ—¥åç®¡ç†</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/5a19a7e92b1e41d1ad6996dbb1a0563a.png" alt="2.png" style="zoom:80%;" /><p>ä¸¤ä¸ªæ–‡ä»¶å¤¹åˆ†åˆ«æ˜¯å­˜æ”¾æŒ‚è½½ï¼ˆMonoBehaviorï¼‰ä¸å»ºç«‹ï¼ˆScriptableObjectï¼‰æˆ‘ä»¬çš„Scriptable Objectçš„ä»£ç æ–‡ä»¶ç”¨çš„</p><p>é™¤äº†ä¸Šé¢çš„ä¸¤ä¸ªæ–‡ä»¶å¤¹å¤–ï¼Œè¿˜æœ‰ä¸“é—¨æœ‰ç”¨æ¥å­˜æ”¾<code>ScriptableObject</code>æ•°æ®çš„æ–‡ä»¶å¤¹</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/dd8e1a4b80a646f5835de7c6834b4f19.png" alt="3.png" style="zoom:80%;" /><h2 id="åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable-Object"><a href="#åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable-Object" class="headerlink" title="åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable Object"></a>åˆ›å»ºä¸“é—¨å­˜æ”¾å±æ€§å€¼çš„Scriptable Object</h2><p>ä¹‹åå†åœ¨<code>Charcter States/ScriptableObject</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸ªä»£ç è„šæœ¬æ–‡ä»¶<code>CharcterData_SO.cs</code></p><p>ä»£ç å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//æ·»åŠ å³é”®èœå•</span><span class="token punctuation">[</span><span class="token function">CreateAssetMenu</span><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Charcter States/Data"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token comment">//æ³¨æ„è¿™ä¸ªç±»ç»§æ‰¿çš„æ˜¯ScriptableObjectç±»</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ®µä»£ç å¯ä»¥åœ¨å³é”®èœå•ä¸­æ·»åŠ ä¸€ä¸ªé€‰é¡¹</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/54d3f5656d33441fa14682fcf33ee71f.png" alt="4.1.png" style="zoom:80%;" /><p>åˆ›å»ºå‡ºæ¥çš„å°±æ˜¯ä¸€ä¸ªåŸºäº<code>CharcterData_SO</code>çš„ScriptableObjectï¼Œæˆ‘ä»¬å°†å…¶å‘½åä¸º<code>Player Data</code></p><img src="https://p3-tt.byteimg.com/origin/pgc-image/5ff5985ea4a742efa56703027a071053.png" alt="4.png" style="zoom:80%;" /><img src="https://p26-tt.byteimg.com/origin/pgc-image/b6c7ca8158fb45f89fa331bffdba9eba.png" alt="5.png" style="zoom:80%;" /><p>è¿™ä¸ªæ—¶å€™è¿˜æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰çš„ï¼Œæˆ‘ä»¬é‡æ–°æ‰“å¼€<code>CharcterData_SO.cs</code>ç»§ç»­å¡«å†™ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//æ·»åŠ å³é”®èœå•</span><span class="token punctuation">[</span><span class="token function">CreateAssetMenu</span><span class="token punctuation">(</span>fileName <span class="token operator">=</span> <span class="token string">"New Data"</span><span class="token punctuation">,</span>menuName <span class="token operator">=</span> <span class="token string">"Charcter States/Data"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterData_SO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">ScriptableObject</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"States Infoï¼ˆå±æ€§ä¿¡æ¯ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> maxHealth<span class="token punctuation">;</span><span class="token comment">//æœ€å¤§ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentHealthl<span class="token punctuation">;</span><span class="token comment">//å½“å‰ç”Ÿå‘½å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> baseDefence<span class="token punctuation">;</span><span class="token comment">//åŸºç¡€é˜²å¾¡å€¼</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> currentDefence<span class="token punctuation">;</span><span class="token comment">//å½“å‰é˜²å¾¡å€¼</span>    <span class="token comment">//æ”»å‡»åŠ›æ¯”è¾ƒå¤æ‚ï¼Œæ‰“ç®—åˆ†å¼€å†™ï¼Œè¿™é‡Œæš‚æ—¶ä¸å†™ç€å…ˆ</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬èµ‹äºˆäº†4ä¸ªå±æ€§ï¼Œå½“Unityç¼–è¯‘ä¹‹ååœ¨æˆ‘ä»¬åˆšåˆšæ–°åˆ›å»ºçš„<code>Player Data</code>å°±æœ‰äº†æ”¹å˜ï¼Œå¤šäº†å‡ ä¸ªå±æ€§å€¼å‡ºæ¥</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/a9cdd098cf54461a8f0387b00d539f9b.png" alt="6.png" style="zoom:80%;" /><h2 id="æŒ‚è½½Scriptable-Object"><a href="#æŒ‚è½½Scriptable-Object" class="headerlink" title="æŒ‚è½½Scriptable Object"></a>æŒ‚è½½Scriptable Object</h2><p>é‚£ä¹ˆæœ‰äº†å­˜æ”¾çš„ScriptableObjectä¹‹åï¼Œæˆ‘ä»¬è¿˜è¦æƒ³åŠæ³•å°†å…¶è¿ç”¨ï¼ˆå³æŒ‚è½½ï¼‰åˆ°äººç‰©èº«ä¸Šï¼Œæ–¹ä¾¿æ•°æ®ä¹‹é—´çš„è¯»å–</p><p>æˆ‘ä»¬åœ¨<code>Charcter States/MonoBehavior</code>ä¸­æ–°å»ºä¸€ä¸ªä»£ç è„šæœ¬ï¼Œå‘½åä¸º<code>CharcterStates.cs</code></p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CharcterStates</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">CharcterData_SO</span> charcterData<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> MaxHealth<span class="token punctuation">&#123;</span>        <span class="token keyword">get</span><span class="token punctuation">&#123;</span><span class="token comment">//å–å€¼å±æ€§</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>charcterData <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> charcterData<span class="token punctuation">.</span>maxHealth<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">set</span><span class="token punctuation">&#123;</span><span class="token comment">//èµ‹å€¼å±æ€§</span>            charcterData<span class="token punctuation">.</span>maxHealth <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//TODO:ç…§ä¸Šé¢æ¨¡å¼å†™å‡ºå…¶å®ƒå‡ ä¸ªå±æ€§å€¼</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç ä¸­ç”¨åˆ°äº†C#çš„<strong>å±æ€§</strong>ï¼Œå³<code>get</code>å’Œ<code>set</code>æ¥è¯»å–æˆ–å†™å…¥äººç‰©çš„æœ€å¤§ç”Ÿå‘½å€¼ï¼Œå‰©ä¸‹çš„å‡ ä¸ªå±æ€§å€¼ä¹Ÿæ˜¯åŒæ ·æ–¹æ³•æ¥å†™</p><p>å†™å¥½ä¹‹åæˆ‘ä»¬ä¿å­˜ä¸€ä¸‹ä»£ç ï¼Œå°†ä»£ç æ–‡ä»¶å½“ä½œç»„ä»¶æ·»åŠ åˆ°äººç‰©ä¸Šé¢</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/4ccad37c1e6e4765a5459eef8bf7e044.png" alt="7.png" style="zoom:80%;" /><p>å¯ä»¥çœ‹åˆ°å®ƒéœ€è¦æ¥å—ä¸€ä¸ª<code>CharcterData_SO</code>ç±»å‹çš„</p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ğŸˆ&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šä»è¿™ä¸€ç« å¼€å§‹ï¼Œç¬”è®°å†…å®¹ä¼šåœ¨ä¸€äº›æ¯”è¾ƒç®€å•çš„åœ°æ–¹è¿›è¡Œç®€ç•¥&lt;/p&gt;
&lt;h1 id=&quot;è®¤è¯†Scriptable-Object&quot;&gt;&lt;a href=&quot;#è®¤è¯†Scriptable-Object&quot; class=&quot;headerlink&quot; title</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°9-æ•Œäººçš„éšæœºå·¡é€»</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B09-%E6%95%8C%E4%BA%BA%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%B7%A1%E9%80%BB/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B09-%E6%95%8C%E4%BA%BA%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%B7%A1%E9%80%BB/</id>
    <published>2021-07-15T01:15:42.000Z</published>
    <updated>2021-07-15T07:56:47.520Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    åœ¨ä¸Šä¸€ç« èŠ‚æˆ‘ä»¬å®ç°äº†æ•Œäººçš„è¿½å‡»æ•ˆæœï¼Œä¹Ÿå°±æ˜¯æ•Œäººçš„è¿½å‡»çŠ¶æ€ï¼Œè€Œè¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥å®ç°å®ƒçš„å·¡é€»çŠ¶æ€æ•ˆæœ</p><h1 id="å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´"><a href="#å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´" class="headerlink" title="å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´"></a>å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´</h1><p>â€‹    ç”±äºä¹‹åä¼šæœ‰ä¸€ä¸ªè®°å½•æ•Œäººå·¡é€»èŒƒå›´çš„å˜é‡ï¼Œå› æ­¤ä¸ºäº†æ–¹ä¾¿åˆ°æ—¶å€™çš„è®¾ç½®ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªå‡½æ•°å¯ä»¥å®æ—¶åœ¨<code>Scene</code>çª—å£ä¸Šæ˜¾ç¤ºè¿™ä¸ªèŒƒå›´å‡ºæ¥</p><p>â€‹    å› ä¸ºè¿™ä¸ªå˜é‡æ˜¯åœ¨<code>EnemyController.cs</code>ä»£ç æ–‡ä»¶é‡Œå£°æ˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç›´æ¥åœ¨æ­¤ä»£ç æ–‡ä»¶é‡Œç”¨è¿™ä¸ªå‡½æ•°</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Patrol Stateï¼ˆå·¡é€»çŠ¶æ€çš„è®¾ç½®é¡¹ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> potralRange<span class="token punctuation">;</span><span class="token comment">//å·¡é€»åœˆçš„åŠå¾„å¤§å°</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDrawGizmosSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        Gizmos<span class="token punctuation">.</span>color <span class="token operator">=</span> Color<span class="token punctuation">.</span>blue<span class="token punctuation">;</span>        Gizmos<span class="token punctuation">.</span><span class="token function">DrawWireSphere</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨æ•Œäººå½“å‰ä½ç½®ç”»ä¸€ä¸ªçƒå½¢èŒƒå›´çš„çº¿</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    <code>OnDrawGizmosSelected()</code>æ˜¯æ¥è‡ªäº<code>MonoBehaviour</code>ç±»çš„ä¸€ä¸ªå‡½æ•°ï¼Œè¿™é‡Œä»£ç æ„æ€æ˜¯åªè¦é€‰ä¸­äº†ä»£ç æ‰€åœ¨çš„å¯¹è±¡ä¸Šå°±ä¼šç»˜ç”»å‡ºä¸€ä¸ªçƒå½¢çš„çº¿ï¼Œè€Œè¿™ä¸ªçƒå½¢çš„åŠå¾„å°±æ˜¯<code>potralRange</code>ï¼Œä¾‹å¦‚å½“æ­¤å€¼è°ƒæˆä¸º2æ—¶ï¼Œçƒå½¢å¦‚ä¸‹å›¾æ‰€ç¤ºğŸ‘‡</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/8c138a5dc08f44ed92287bc624597238.png" alt="1.png" style="zoom:80%;" /><p>â€‹    å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ·»åŠ å…¶å®ƒå‚æ•°çš„å¯è§†åŒ–æ•ˆæœï¼Œå¯ä»¥è‡ªç”±å‘æŒ¥</p><h1 id="å®ç°æ•Œäººå·¡é€»"><a href="#å®ç°æ•Œäººå·¡é€»" class="headerlink" title="å®ç°æ•Œäººå·¡é€»"></a>å®ç°æ•Œäººå·¡é€»</h1><p>â€‹    æ¥ä¸‹æ¥å°±è¿›å…¥æ­£é¢˜ï¼Œå¦‚ä½•å®ç°æ•Œäººå·¡é€»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®ƒè®¾å®šçš„å·¡é€»èŒƒå›´å†…è·å¾—ä¸€ä¸ªç‚¹ï¼Œç„¶åå†è®©æ•Œäººèµ°è¿‡å»ï¼Œåå¤æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œï¼Œå°±å¯ä»¥è®©æ•Œäººå·¡é€»èµ·æ¥äº†</p><h2 id="éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹"><a href="#éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹" class="headerlink" title="éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹"></a>éšæœºè·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹</h2><p>â€‹    è¦è·å¾—å·¡é€»èŒƒå›´å†…çš„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬å°±è¦æœ‰ä¸€ä¸ªVector3å˜é‡æ¥è®°å½•è¿™ä¸ªç‚¹ï¼Œç„¶åæ¯æ¬¡ä½¿ç”¨éšæœºæ•°æ¥æ”¹å˜å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥ä¸“é—¨éšæœºè·å¾—è¿™ä¸ªç‚¹çš„å€¼</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token class-name">Vector3</span> wayPoint<span class="token punctuation">;</span><span class="token comment">//æ•Œäººå·¡é€»çš„ä¸‹ä¸€ä¸ªéšæœºç›®æ ‡ç‚¹</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»çš„éšæœºç›®æ ‡ç‚¹</span>    <span class="token comment">//Yè½´æ˜¯æ§åˆ¶é«˜åº¦çš„ï¼Œæ‰€ä»¥ä¸ç”¨è·å–ï¼Œä¿æŒåŸæ¥çš„å°±è¡Œ</span>    <span class="token comment">//è·å–çš„èŒƒå›´æ—¶[-potralRange,potralRange]</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomX <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomZ <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//åœ¨æ•Œäººè‡ªå·±æœ¬èº«çš„åæ ‡ç‚¹ä¸Šè¿›è¡Œå–éšæœºç‚¹</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//FIXME:æœ‰å¯èƒ½å‡ºç°é—®é¢˜</span>    wayPoint <span class="token operator">=</span> randomPoint<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ç”±äºYè½´æ˜¯è®°å½•æ•Œäººæ‰€åœ¨çš„é«˜åº¦çš„ï¼Œæ‰€ä»¥è¿™é‡Œæš‚æ—¶ä¸ç”¨è·å–éšæœºæ•°ï¼Œä¿æŒåŸæ¥æ•ˆæœ</p><p>â€‹    åŒæ—¶ä¸Šé¢ä»£ç ä¸­ç»™æ ‡è®°äº†ä¸€ä¸ªFIXMEï¼Œæœ‰å¯èƒ½å‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆæ”¾ä¸€è¾¹åˆ°æ—¶å€™å†æ¥å‘ç°ä¿®æ”¹</p><h2 id="ä¿®æ”¹çŠ¶æ€åˆ‡æ¢"><a href="#ä¿®æ”¹çŠ¶æ€åˆ‡æ¢" class="headerlink" title="ä¿®æ”¹çŠ¶æ€åˆ‡æ¢"></a>ä¿®æ”¹çŠ¶æ€åˆ‡æ¢</h2><p>â€‹    è·å–äº†éšæœºç‚¹åï¼Œæˆ‘ä»¬è¿˜è¦å›åˆ°<code>SwitchStates()</code>å‡½æ•°ä¸­ä¿®æ”¹ä¸€ä¸‹çŠ¶æ€çš„è¡”æ¥</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>å·¡é€»        isChase <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ä¸æ˜¯è¿½é€åŠ¨ç”»</span>        agent<span class="token punctuation">.</span>speed <span class="token operator">=</span> speed<span class="token operator">*</span><span class="token number">0.5f</span><span class="token punctuation">;</span><span class="token comment">//å·¡é€»é€Ÿåº¦æ˜¯è¿½é€é€Ÿåº¦çš„ä¸€åŠ</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>wayPoint<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> agent<span class="token punctuation">.</span>stoppingDistance<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¦‚æœä¸‹ä¸€ä¸ªå·¡é€»ç‚¹å’Œå½“å‰äººç‰©çš„åæ ‡ç‚¹å°äºç­‰äºå¯ç§»åŠ¨è·ç¦»åˆ™ä¸ç§»åŠ¨</span>            isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ä¸æ’­æ”¾èµ°è·¯çš„åŠ¨ç”»</span>            <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»ç‚¹éšæœºæ•°</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token comment">//æ»¡è¶³è¡Œèµ°æ¡ä»¶</span>            isWalk <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ•ŒäººåŠ¨ç”»æ”¹ä¸ºèµ°è·¯åŠ¨ç”»</span>            agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> wayPoint<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ä¸Šé¢å°±æ˜¯åˆ¤æ–­åˆ°æ•Œäººä¸ºå·¡é€»çŠ¶æ€æ—¶è¦åšçš„äº‹æƒ…ï¼Œé‡Œé¢è¿˜æœ‰ä¸€ä¸ªifè¯­å¥æ˜¯ç”¨äºåˆ¤æ–­å¦‚æœä¸‹ä¸€ä¸ªå·¡é€»çš„ç‚¹å°äºæˆ–ç­‰äºå¯¼èˆªç»„ä»¶å¯ä»¥ç§»åŠ¨çš„èŒƒå›´æ—¶å°±ä¸ç§»åŠ¨ï¼Œå†è·å¾—ä¸‹ä¸€ä¸ªå·¡é€»ç‚¹</p><p>ğŸ„è€Œ <a href="https://docs.unity.cn/cn/2020.3/ScriptReference/AI.NavMeshAgent-stoppingDistance.html">stoppingDistance</a> æ˜¯<code>Nav Mesh Agent</code>ç»„ä»¶é‡Œçš„ä¸€ä¸ªå±æ€§ï¼Œä»£è¡¨<code>åœæ­¢è·ç¦»</code>ï¼Œå³å¦‚æœç»™å®šçš„ç›®çš„ç‚¹ä¸å½“å‰ç‚¹çš„è·ç¦»å°äºè¿™ä¸ªå€¼çš„è¯ï¼Œæ•Œäººæ—¶ä¸ä¼šè¿›è¡Œç§»åŠ¨çš„ï¼Œè¿™ä¸ªå€¼æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å±æ€§é¢æ¿ä¸­è¿›è¡Œè°ƒæ•´</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/107272d76d03463c8012565f3e821a87.png" alt="2.png" style="zoom:80%;" /><p>â€‹    äº†è§£åˆ°è¿™äº›ä¹‹åæˆ‘ä»¬ç»§ç»­å›åˆ°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å†™äº†å·¡é€»çŠ¶æ€æ—¶è¦åšçš„äº‹æƒ…ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯¥æ€æ ·åˆ¤æ–­å¹¶è¿›å…¥å·¡é€»çŠ¶æ€å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å°±æ¥å†™ä¸€ä¸‹è¿™äº›ä»£ç </p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Basic Settings"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//...</span><span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">bool</span></span> isGuard<span class="token punctuation">;</span><span class="token comment">//å½“å‰æ•Œäººæ˜¯å¦ä¸ºè­¦å«ï¼ˆè­¦æˆ’çŠ¶æ€ï¼‰</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//å¼€å§‹æ¸¸æˆæ—¶å…ˆæ£€æµ‹æ˜¯å¦å‹¾é€‰äº†å®ˆå«çŠ¶æ€</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>isGuard<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">;</span>        <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é˜²æ­¢å¼€å§‹æ—¶å·¡é€»ç‚¹æ˜¯ç©ºçš„é»˜è®¤èµ°åˆ°åœ°å›¾(0,0,0)ä½ç½®</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™é‡Œæˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ªå…¬å¼€çš„å¸ƒå°”å€¼å˜é‡<code>isGuard</code>ï¼Œå¯ä»¥ç›´æ¥åœ¨å±æ€§é¢æ¿å‹¾é€‰ï¼Œç”¨æ¥åˆ¤æ–­å½“å‰æ•Œäººæ˜¯å¦ä¸ºä¸€ä¸ªå®ˆå«ï¼Œå¦‚æœä¸ºå®ˆå«å°±ä¸ä¼šè¿›è¡Œå·¡é€»äº†</p><p>â€‹    åœ¨å¼„å¥½è¿™äº›ä¹‹åï¼Œæ•Œäººå·¡é€»çš„åŸºæœ¬åŠŸèƒ½å°±å®ç°äº†ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å»è¯•ç©ä¸€ä¸‹äº†</p><h2 id="ä¿®å¤ä¸€äº›é—®é¢˜"><a href="#ä¿®å¤ä¸€äº›é—®é¢˜" class="headerlink" title="ä¿®å¤ä¸€äº›é—®é¢˜"></a>ä¿®å¤ä¸€äº›é—®é¢˜</h2><p>â€‹    åœ¨è¯•ç©çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹é¢å°±æ¥ä¿®å¤å®ƒä»¬</p><h3 id="æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ"><a href="#æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ" class="headerlink" title="æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ"></a>æ•Œäººå·¡é€»çš„èŒƒå›´è¶Šæ¥è¶Šè¿œ</h3><p>â€‹    é¦–å…ˆæ˜¯æ•Œäººå·¡é€»èŒƒå›´çš„é—®é¢˜ï¼Œå¦‚æœåªä¾ç…§ä¸Šé¢çš„ä»£ç æˆ‘ä»¬ä¼šå‘ç°æ•Œäººçš„å·¡é€»èŒƒå›´ä¼šè¶Šæ¥è¶Šè¿œï¼Œè¿™æ˜¯å› ä¸ºå–éšæœºåæ ‡ç‚¹çš„ä»£ç é€»è¾‘è€ƒè™‘ä¸å¯¹åŠ²</p><p>â€‹    æˆ‘ä»¬å›åˆ°ä¸Šé¢çš„æ ‡æœ‰FIXMEä»£ç å—ä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//åœ¨æ•Œäººè‡ªå·±æœ¬èº«çš„åæ ‡ç‚¹ä¸Šè¿›è¡Œå–éšæœºç‚¹</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>â€‹    å‡ºç°é—®é¢˜çš„å°±æ˜¯åœ¨ä¸Šé¢è¿™ä¸€å¥ä»£ç ï¼Œæˆ‘ä»¬å–åˆ°çš„ä¸‹ä¸€ä¸ªéšæœºç›®æ ‡ç‚¹æ˜¯åŸºäºæ•Œäººç°åœ¨çš„ä½ç½®åŸºç¡€ä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡å–åˆ°çš„éšæœºç‚¹éƒ½ä¸ç°åœ¨ä½ç½®ç›¸åŠ ï¼Œè¿™å°±ä¸å¯¹äº†ï¼Œå¦‚æœä¸€ç›´å¾€åŒä¸€ä¸ªæ–¹å‘ç›¸åŠ ï¼Œåªä¼šå¯¼è‡´æ•Œäººèµ°çš„è¶Šæ¥è¶Šè¿œ</p><p>â€‹    å› æ­¤è¿™é‡Œ<strong>ä¸åº”è¯¥</strong><code>transform.position+xxx</code></p><p>â€‹    </p><p>â€‹    é‚£ä¹ˆè§£å†³æ–¹æ¡ˆæ€ä¹ˆæ ·åšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨æ¸¸æˆå¼€å§‹åˆå§‹åŒ–æŠŠå½“å‰æ•Œäººæ‰€åœ¨çš„ä½ç½®è®°å½•ä¸‹æ¥ï¼Œç„¶åæ¯æ¬¡å–éšæœºç‚¹æ˜¯åŸºäºè¿™ä¸ªç‚¹æ¥è¿›è¡Œåæ ‡ç›¸åŠ çš„</p><p>â€‹    åŒæ—¶è¿™ä¸ªåæ ‡ç‚¹ä¹Ÿä¸æ­¢åœ¨å·¡é€»çŠ¶æ€è¿™é‡Œç”¨å¾—åˆ°ï¼Œæˆ‘ä»¬åœ¨å®ˆå«çŠ¶æ€ä¸‹ä¹Ÿéœ€è¦è¿™ä¸ªåˆå§‹åæ ‡ç‚¹ï¼Œå®ˆå«çŠ¶æ€ä¸‹å¦‚æœè¿½å‡»æ•Œäººè„±æˆ˜ä¹‹åï¼Œæˆ‘ä»¬å¿…é¡»è®©æ•Œäººå›åˆ°è¿™ä¸ªåˆå§‹åæ ‡ç‚¹ç»§ç»­å®ˆå«</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">private</span> <span class="token class-name">Vector3</span> puardPos<span class="token punctuation">;</span><span class="token comment">//å½“å‰æ•Œäººæ¸¸æˆå¼€å§‹æ—¶çš„åˆå§‹ä½ç½®</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span> guardPos <span class="token operator">=</span> guardPos <span class="token operator">=</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>guardPos<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>guardPos<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    æŒ‰ç…§ä¸Šé¢çš„ä»£ç ä¿®æ”¹ï¼Œæˆ‘ä»¬å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜</p><p>â€‹    ğŸˆ<strong>è¦æ³¨æ„</strong>ï¼šæ–°çš„åæ ‡ç‚¹çš„Yè½´è¿˜æ˜¯ä»¥æ•Œäººå½“å‰ä½ç½®ä¸ºåŸºç¡€çš„</p><h3 id="æ•Œäººç§»åŠ¨å¡ä½"><a href="#æ•Œäººç§»åŠ¨å¡ä½" class="headerlink" title="æ•Œäººç§»åŠ¨å¡ä½"></a>æ•Œäººç§»åŠ¨å¡ä½</h3><p>â€‹    ç¬¬äºŒä¸ªå¯èƒ½é‡åˆ°çš„é—®é¢˜å°±æ˜¯å¯èƒ½æ•Œäººèµ°ç€èµ°ç€ä¼šçªç„¶ç»™å¡ä½ï¼Œä½†å®ƒä»ç„¶å¤„äºç§»åŠ¨çŠ¶æ€ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºæ‰€è·å–çš„ç›®æ ‡ç‚¹ä¸º<strong>ä¸å¯ç§»åŠ¨åŒºåŸŸ</strong>é€ æˆçš„ï¼Œä¾‹å¦‚æ ‘æœ¨ã€çŸ³å¤´æ‰€åœ¨çš„ç‚¹</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/e5d07eb926e74385a3d3454bf171703c.png" alt="3.png" style="zoom:80%;" /><p>â€‹    å› æ­¤è§£å†³æ–¹æ³•å°±æ˜¯æˆ‘ä»¬åœ¨è·å–ç‚¹ä¹‹åè¦åˆ¤æ–­ä¸€ä¸‹æ‰€è·å¾—çš„ç‚¹æ˜¯å¦ä¸ºåˆ°è¾¾çš„ç‚¹ï¼Œå¦‚æœä¸æ˜¯å°±å†è·å–ä¸€é</p><p>â€‹    è¿™é‡Œå¯ä»¥ç”¨åˆ° <a href="https://docs.unity.cn/cn/2020.3/ScriptReference/AI.NavMeshAgent.html">NavMeshAgent</a> çš„ä¸€ä¸ªæ–¹æ³• <a href="https://docs.unity.cn/cn/2020.3/ScriptReference/AI.NavMeshAgent.SamplePathPosition.html">SamplePathPosition()</a> ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¥åˆ¤æ–­æ•Œäººåˆ°ç›®æ ‡ç‚¹æ˜¯å¦å¯ä»¥è¡Œèµ°ï¼Œæˆ‘ä»¬å›åˆ°<code>GetNewWayPoint()</code>å‡½æ•°ä¸­</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»çš„éšæœºç›®æ ‡ç‚¹</span>    <span class="token comment">//Yè½´æ˜¯æ§åˆ¶é«˜åº¦çš„ï¼Œæ‰€ä»¥ä¸ç”¨è·å–ï¼Œä¿æŒåŸæ¥çš„å°±è¡Œ</span>    <span class="token comment">//è·å–çš„èŒƒå›´æ—¶[-potralRange,potralRange]</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomX <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name"><span class="token keyword">float</span></span> randomZ <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token operator">-</span>potralRange<span class="token punctuation">,</span>potralRange<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Vector3</span> randomPoint <span class="token operator">=</span>        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Vector3</span><span class="token punctuation">(</span>guardPos<span class="token punctuation">.</span>x<span class="token operator">+</span>randomX<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>guardPos<span class="token punctuation">.</span>z<span class="token operator">+</span>randomZ<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//æ£€æµ‹ä¸‹ä¸ªç‚¹æ˜¯å¦å¯è¡Œ</span>    <span class="token class-name">NavMeshHit</span> hit<span class="token punctuation">;</span>    wayPoint <span class="token operator">=</span><span class="token comment">//å¦‚æœæ–°çš„ç›®æ ‡ç‚¹å¯ä»¥åˆ°è¾¾åˆ™èµ‹å€¼ï¼Œå¦åˆ™åˆ™æŠŠæ•Œäººå½“å‰æ‰€åœ¨ç‚¹èµ‹å€¼</span>        NavMesh<span class="token punctuation">.</span><span class="token function">SamplePosition</span><span class="token punctuation">(</span>randomPoint<span class="token punctuation">,</span><span class="token keyword">out</span> hit<span class="token punctuation">,</span>potralRange<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> hit<span class="token punctuation">.</span>position <span class="token punctuation">:</span> transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>    <span class="token comment">//æä¾›ä¸€ä¸ªå‚è€ƒç‚¹ï¼Œè¾“å‡ºå±æ€§çš„ç½‘æ ¼ä¿¡æ¯</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·æˆ‘ä»¬å°±è§£å†³äº†æ•Œäººä¼šå¡ä½çš„é—®é¢˜</p><h3 id="å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´"><a href="#å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´" class="headerlink" title="å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´"></a>å¢åŠ æ•Œäººç­‰å¾…æ—¶é—´</h3><p>â€‹    è¿˜æœ‰ä¸€ä¸ªå¯ä»¥å®Œå–„çš„åœ°æ–¹å°±æ˜¯æ•Œäººåœ¨ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„ç‚¹åï¼Œå®ƒä¼šç«‹å³åˆå‰å¾€ä¸‹ä¸€ä¸ªåœ°ç‚¹ï¼Œè¿™é‡Œå¯ä»¥ä¸ºå®ƒå¢åŠ ä¸€äº›ç­‰å¾…æ—¶é—´</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Header</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Patrol Stateï¼ˆå·¡é€»çŠ¶æ€çš„è®¾ç½®é¡¹ï¼‰"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span><span class="token comment">//...</span><span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">float</span></span> lookAtTime<span class="token punctuation">;</span><span class="token comment">//æ•Œäººåˆ°è¾¾ä¸€ä¸ªç‚¹åœç•™çš„æ—¶é—´</span><span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> remainLookAtTime<span class="token punctuation">;</span><span class="token comment">//è¿˜å‰©ä¸‹çš„åœç•™æ—¶é—´</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                enemyStates <span class="token operator">=</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//è„±ç¦»æˆ˜æ–—ååˆ¤æ–­å›åˆ°å®ˆå«çŠ¶æ€è¿˜æ˜¯å·¡é€»çŠ¶æ€</span>                enemyStates <span class="token operator">=</span> isGuard <span class="token punctuation">?</span> EnemyStates<span class="token punctuation">.</span>GUARD <span class="token punctuation">:</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">//åˆ¤æ–­æ˜¯å¦åˆ°äº†éšæœºå·¡é€»ç‚¹</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>Vector3<span class="token punctuation">.</span><span class="token function">Distance</span><span class="token punctuation">(</span>wayPoint<span class="token punctuation">,</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> agent<span class="token punctuation">.</span>stoppingDistance<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å¦‚æœä¸‹ä¸€ä¸ªå·¡é€»ç‚¹å’Œå½“å‰äººç‰©çš„åæ ‡ç‚¹å°äºç­‰äºå¯ç§»åŠ¨è·ç¦»åˆ™ä¸ç§»åŠ¨</span>                isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//ä¸æ’­æ”¾èµ°è·¯çš„åŠ¨ç”»</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>remainLookAtTime <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">//å¦‚æœå‰©ä½™ç­‰å¾…æ—¶é—´å¤§äº0åˆ™ç»§ç»­ç­‰å¾…</span>                    remainLookAtTime <span class="token operator">-=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>                <span class="token keyword">else</span>                    <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»ç‚¹éšæœºæ•°</span>            <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token comment">//æ»¡è¶³è¡Œèµ°æ¡ä»¶</span>                isWalk <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ•ŒäººåŠ¨ç”»æ”¹ä¸ºèµ°è·¯åŠ¨ç”»</span>                agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> wayPoint<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">//PATROL</span>    <span class="token punctuation">&#125;</span><span class="token comment">//...</span><span class="token punctuation">&#125;</span><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetNewWayPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//è·å–ä¸‹ä¸€ä¸ªå·¡é€»çš„éšæœºç›®æ ‡ç‚¹</span>    remainLookAtTime <span class="token operator">=</span> lookAtTime<span class="token punctuation">;</span><span class="token comment">//é‡ç½®å‰©ä½™ç­‰å¾…æ—¶é—´</span>    <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªå˜é‡ï¼Œ<code>lookAtTime</code>è¡¨ç¤ºéœ€è¦ç­‰å¾…æ—¶é—´çš„é•¿åº¦ï¼ˆå¯ä¾›å¤–ç•Œè¿›è¡Œè°ƒæ•´ï¼‰ï¼Œ<code>remainLookAtTime</code>è¡¨ç¤ºå½“å‰æ•Œäººè¿˜å‰©ä½™çš„ç­‰å¾…æ—¶é—´ï¼Œç„¶åæˆ‘ä»¬åœ¨<code>SwitchEnemyStates()</code>å‡½æ•°é‡Œçš„è¿½å‡»çŠ¶æ€ä¸­åˆ¤æ–­æ•Œäººåˆ°è¾¾äº†ç›®æ ‡ç‚¹å°±å¼€å§‹é€å¸§é€’å‡<code>remainLookAtTime</code>ï¼Œå½“å‡åˆ°å°äº0æ•Œäººæ‰ä¼šå¼€å§‹èµ°åŠ¨ï¼ŒåŒæ—¶å†ä¸€æ¬¡è°ƒç”¨<code>GetNewWayPoint()</code>æ—¶ä¼šé‡ç½®<code>remainLookAtTime</code></p><p>â€‹    ğŸˆæ³¨æ„ï¼š<code>lookAtTime</code>çš„å•ä½æ˜¯<strong>ç§’</strong></p><p>â€‹    åœ¨switchä»£ç å‰é¢è¿˜æ·»åŠ äº†ä¸€æ¡è¯­å¥ç”¨æ¥åˆ¤æ–­è„±ç¦»æˆ˜æ–—åæ•Œäººå›åˆ°å®ˆå«çŠ¶æ€è¿˜æ˜¯å·¡é€»çŠ¶æ€ï¼Œè¿™å¯ä»¥è®©æˆ‘ä»¬æ•Œäººæ›´åŠ å®Œå–„</p><p>â€‹    åˆ°è¿™é‡Œï¼Œæœ¬ç« çš„ç›®çš„å°±å®ç°äº†ï¼Œæˆ‘ä»¬è®©æ•Œäººéšæœºå·¡é€»äº†èµ·æ¥ï¼Œå¿«å»æ¸¸æˆä¸­è¯•è¯•å§ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    åœ¨ä¸Šä¸€ç« èŠ‚æˆ‘ä»¬å®ç°äº†æ•Œäººçš„è¿½å‡»æ•ˆæœï¼Œä¹Ÿå°±æ˜¯æ•Œäººçš„è¿½å‡»çŠ¶æ€ï¼Œè€Œè¿™ä¸€ç« èŠ‚æˆ‘ä»¬æ¥å®ç°å®ƒçš„å·¡é€»çŠ¶æ€æ•ˆæœ&lt;/p&gt;
&lt;h1 id=&quot;å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´&quot;&gt;&lt;a href=&quot;#å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´&quot; class=&quot;headerlink&quot; title=&quot;å®æ—¶æ˜¾ç¤ºå·¡é€»èŒƒå›´&quot;&gt;&lt;/a&gt;å®æ—¶</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
  <entry>
    <title>Unityç¬”è®°8--ä¸ºæ•Œäººæ·»åŠ è¿½å‡»æ•ˆæœä»¥åŠåŠ¨ç”»åˆ‡æ¢ç®¡ç†</title>
    <link href="http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B08-%E4%B8%BA%E6%95%8C%E4%BA%BA%E6%B7%BB%E5%8A%A0%E8%BF%BD%E5%87%BB%E6%95%88%E6%9E%9C%E4%BB%A5%E5%8F%8A%E5%8A%A8%E7%94%BB%E5%88%87%E6%8D%A2%E7%AE%A1%E7%90%86/"/>
    <id>http://sakura-pub.ltd/UnityNotes/Unity%E7%AC%94%E8%AE%B08-%E4%B8%BA%E6%95%8C%E4%BA%BA%E6%B7%BB%E5%8A%A0%E8%BF%BD%E5%87%BB%E6%95%88%E6%9E%9C%E4%BB%A5%E5%8F%8A%E5%8A%A8%E7%94%BB%E5%88%87%E6%8D%A2%E7%AE%A1%E7%90%86/</id>
    <published>2021-07-12T08:58:41.000Z</published>
    <updated>2021-07-14T03:45:14.534Z</updated>
    
    <content type="html"><![CDATA[<!--ç»ˆäºæœŸæœ«è€ƒå®Œè¯•äº†ï¼Œå¯ä»¥å›åˆ°Unityä¸Šæ¥äº†ğŸ˜ƒ--><p>â€‹    æˆ‘ä»¬æ¥ç»§ç»­å®Œå–„æ•Œäººï¼Œè¿˜è®°å¾—æˆ‘ä»¬æœ‰ä¸ªåŠ¨ç”»åˆ‡æ¢çš„æ¡†æ¶ä»£ç æ‘†åœ¨é‚£å—ï¼Ÿè¿™ä¸€æ¬¡æˆ‘ä»¬æ¥ä¸ºæ•Œäººæ·»åŠ è¿½å‡»æ•ˆæœå¹¶ä¸”å¯¹ä¸åŒçŠ¶æ€ä¸‹çš„åŠ¨ç”»åˆ‡æ¢è¿›è¡Œç®¡ç†</p><h1 id="ä¿å­˜ä¿®æ”¹åçš„ç´ æ"><a href="#ä¿å­˜ä¿®æ”¹åçš„ç´ æ" class="headerlink" title="ä¿å­˜ä¿®æ”¹åçš„ç´ æ"></a>ä¿å­˜ä¿®æ”¹åçš„ç´ æ</h1><p>â€‹    åœ¨è¿›è¡Œåˆ‡æ¢åŠ¨ç”»ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå°†ä¸Šä¸€æ¬¡ä¿®æ”¹åçš„ä¸»è§’å’Œå²è±å§†ä¿å­˜ä¸ºä¸€ä¸ªç´ æå¯¹è±¡ï¼Œè¿™æ–¹ä¾¿ä»¥åæˆ‘ä»¬çš„ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯å²è±å§†ï¼Œå°†å…¶ä¿å­˜ä¸ºç´ æå¯¹è±¡åå°±å¯ä»¥æ‰¹é‡åˆ›å»ºæ•Œäººäº†</p><h2 id="ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡"><a href="#ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡" class="headerlink" title="ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡"></a>ä¿å­˜ä¸»è§’ä¸ºç´ æå¯¹è±¡</h2><p>â€‹    ç”±äºæˆ‘ä»¬çš„ä¸»è§’å°ç‹—åœ¨ä¹‹å‰å°±ä¿å­˜ä¸ºç´ æäº†ï¼Œè€Œåœ¨ä¸Šä¸€ç« æˆ‘ä»¬ä¸ºå…¶æ·»åŠ äº†ä¸€ä¸ªèƒ¶å›Šç¢°æ’ä½“ï¼Œè¿™é‡Œæˆ‘ä»¬åªç”¨å°†èƒ¶å›Šç¢°æ’ä½“ä¿å­˜ä¸€ä¸‹å°±è¡Œäº†</p><p>â€‹    åœ¨<code>Hierarchy</code>è§†å›¾é€‰æ‹©æˆ‘ä»¬çš„å°äºº<code>Player</code>ï¼Œç„¶åæ‰¾åˆ°èƒ¶å›Šç¢°æ’ä½“ç»„ä»¶ï¼Œå³é”®å®ƒï¼ŒæŒ‰ä¸‹å›¾æ‰¾åˆ°<code>Added Component-&gt;Apply to Prefab &#39;Player&#39;</code>ï¼Œç‚¹å‡»å®ƒå°±å¯ä»¥å°†æ–°å¢åŠ çš„èƒ¶å›Šç¢°æ’ä½“åº”ç”¨åœ¨åŸæœ¬çš„ç´ æä¸Šäº†</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/f15d609363c14d13b3e1a79616db15e6.png" alt="1.png" style="zoom:80%;" /><h2 id="ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡"><a href="#ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡" class="headerlink" title="ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡"></a>ä¿å­˜å²è±å§†æ•Œäººä¸ºç´ æå¯¹è±¡</h2><p>â€‹    ä¿å­˜å²è±å§†ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„äº‹æƒ…ï¼Œåªç”¨åœ¨<code>Hierarchy</code>è§†å›¾ä¸‹å°†å²è±å§†æ‹–æ‹½åˆ°åˆ°<code>Prefab-&gt;Characters</code>æ–‡ä»¶å¤¹ä¸‹å°±è¡Œäº†ï¼Œæ³¨æ„åœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©<code>Original Prefab</code></p><img src="https://p3-tt.byteimg.com/origin/pgc-image/e4d3d1be8f5a4a63aae9fa7f85938fdb.png" alt="2.png" style="zoom:80%;" /><h1 id="æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ"><a href="#æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ" class="headerlink" title="æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ"></a>æ€è€ƒå¦‚ä½•æ•Œäººçš„è¿½å‡»æ•ˆæœ</h1><p>â€‹    å¯¹äºæ•Œäººè¿½å‡»æˆ‘ä»¬äººç‰©ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯æ•Œäººçš„ç§»åŠ¨ç›®æ ‡æ˜¯æˆ‘ä»¬çš„äººç‰©ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸæœ‰çš„ä»£ç åŸºç¡€ä¸Šæ¥å®ç°è¿½å‡»æ•ˆæœ</p><p>â€‹    æ‰“å¼€æˆ‘ä»¬çš„<code>EnemyController.cs</code>ä»£ç æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆåœ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ª<code>attackTarget</code>çš„å˜é‡ï¼Œè¿™ä¸ªä»£è¡¨ç€æˆ‘ä»¬æ•Œäººè¿½å‡»çš„ç›®æ ‡ï¼Œå¹¶åœ¨å…ˆå‰å†™çš„<code>FoundPlayer</code>å‡½æ•°é‡Œå¯¹å…¶èµ‹äºˆç›®æ ‡ï¼ˆå³å°†åœ¨æ•Œäººä¸€å®šèŒƒå›´æ‰¾åˆ°äººç‰©æ—¶ï¼Œè¿½å‡»ç›®æ ‡ä¸ºæ•Œäººï¼‰</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">GameObject</span> attackTarget<span class="token punctuation">;</span>        <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Collider<span class="token punctuation">[</span><span class="token punctuation">]</span></span> colliders <span class="token operator">=</span> Physics<span class="token punctuation">.</span><span class="token function">OverlapSphere</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">,</span>sightRadius<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//æ¥å—ä¸€ä¸ªåœ†ç‚¹ï¼Œä¸€ä¸ªåŠå¾„çš„å‚æ•°ï¼Œè¿”å›çš„æ˜¯ç¢°æ’ä½“æ•°ç»„</span>                <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token class-name">Collider</span> target <span class="token keyword">in</span> colliders<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å¾ªç¯ç¢°æ’ä½“æ•°ç»„ï¼Œé€ä¸ªæŸ¥æ‰¾</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">CompareTag</span><span class="token punctuation">(</span><span class="token string">"Player"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//å½“å‰å¾ªç¯åˆ°çš„ç¢°æ’ä½“çš„æ ‡ç­¾ä¸ºPlayerå°±ä»£è¡¨æ‰¾åˆ°äººç‰©äº†</span>                attackTarget<span class="token operator">=</span>target<span class="token punctuation">.</span>gameObject<span class="token punctuation">;</span>                                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    åšå¥½ä¸Šé¢è¿™äº›åï¼Œæˆ‘ä»¬è¦å›åˆ°<code>SwitchEnemyStates</code>å‡½æ•°é‡Œè¿›è¡Œå®Œå–„Switchæ¡†æ¶</p><p>â€‹    åœ¨è¿½å‡»ä¸­ï¼Œæˆ‘ä»¬è¦æ€è€ƒä¸€ä¸‹åœ¨è¿™è¿‡ç¨‹æœ‰å“ªäº›è¡Œä¸ºï¼Œé¦–å…ˆæ˜¯è¿½å‡»æ•Œäººï¼Œè¿½å‡»åˆ°äº†çš„è¯ä¼šè¿›è¡Œæ”»å‡»ï¼Œå¦‚æœç›®æ ‡è„±ç¦»äº†è¿½å‡»èŒƒå›´åˆ™åº”è¯¥å›åˆ°ä¸Šä¸€ä¸ªçŠ¶æ€ï¼ŒåŒæ—¶è¿™æ•´ä¸ªæµç¨‹éƒ½è¦æœ‰åŠ¨ç”»çš„åˆ‡æ¢ã€‚ä»¥ä¸‹ä»£ç ä¸­ä¾¿ç”¨äº†TODOæ¥æè¿°è¦åšçš„äº‹æƒ…</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchEnemyStates</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token comment">//...</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>GUARD<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>PATROL<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»                <span class="token comment">//TODO:è¿½å‡»Player</span>                <span class="token comment">//TODO:åœ¨æ”»å‡»èŒƒå›´æ”»å‡»</span>                <span class="token comment">//TODO:é…åˆåŠ¨ç”»</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//TODO:æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token comment">//äººç‰©è¿›åˆ°æ•Œäººçš„èŒƒå›´ä¼šç»™è¿½å‡»</span>                    agent<span class="token punctuation">.</span>destination<span class="token operator">=</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>DEAD<span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    å†™äº†ä»¥ä¸Šçš„ä»£ç åï¼Œå½“æˆ‘ä»¬çš„äººç‰©é è¿‘æ•Œäººæ—¶å°±è¢«è¿½å‡»äº†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»™ä¸åŒçš„çŠ¶æ€èµ‹äºˆä¸åŒçš„é€Ÿåº¦ï¼Œå¦‚å®ˆå«çŠ¶æ€ç§»åŠ¨é€Ÿåº¦æ…¢ä¸€ç‚¹ï¼Œè€Œè¿½å‡»é€Ÿåº¦å¿«ä¸€ç‚¹ç­‰ç­‰</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">float</span></span> speed<span class="token punctuation">;</span><span class="token comment">//æ•Œäººçš„é€Ÿåº¦</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        agent <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NavMeshAgent<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        speed<span class="token operator">=</span>agent<span class="token punctuation">.</span>speed<span class="token punctuation">;</span><span class="token comment">//åœ¨åˆå§‹åŒ–æ—¶é€Ÿåº¦åˆå§‹åŒ–ä¸ºåŸæ¥é»˜è®¤çš„é€Ÿåº¦</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨<code>Switch</code>ä¸­ä¸åŒçŠ¶æ€ä¸‹ç»™å®šä¸åŒçš„é€Ÿåº¦å€¼äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//ä¸¾ä¸ªæ —å­</span><span class="token comment">//case xxx:</span>speed <span class="token operator">=</span> <span class="token number">1.0f</span><span class="token punctuation">;</span>agent<span class="token punctuation">.</span>speed<span class="token operator">=</span>speed<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç»™æ•Œäººæ·»åŠ åŠ¨ç”»"><a href="#ç»™æ•Œäººæ·»åŠ åŠ¨ç”»" class="headerlink" title="ç»™æ•Œäººæ·»åŠ åŠ¨ç”»"></a>ç»™æ•Œäººæ·»åŠ åŠ¨ç”»</h1><h2 id="ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹"><a href="#ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹"></a>ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹</h2><p>â€‹    ä¸Šé¢çš„ä»£ç æˆ‘ä»¬æ‰“å¥½åå…ˆæ”¾åœ¨ä¸€è¾¹ï¼Œå…ˆæ¥çœ‹çœ‹å²è±å§†çš„åŠ¨ç”»å¦‚ä½•æ·»åŠ </p><p>â€‹    å’Œä¹‹å‰çš„å°ç‹—ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç´ æçš„æ–‡ä»¶å¤¹ä¸‹é¢„è§ˆåŠ¨ç”»çš„æ•ˆæœ</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/cbd42713bc444c18836fedb8b0b42622.png" alt="3.png" style="zoom:80%;" /><p>â€‹    ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ª<code>Idleï¼ˆé—²ç½®ï¼‰</code>çš„åŠ¨ç”»æ•ˆæœï¼Œå…¶ä¸­çš„<code>IdleBattle</code>æ˜¯åœ¨æ”»å‡»ç©å®¶ä¸­é—´CDæ—¶é—´æ—¶çš„é—²ç½®åŠ¨ä½œï¼Œè€Œ<code>IdleNormal</code>åˆ™æ˜¯åœ¨ä¸€èˆ¬é—²ç½®çŠ¶æ€ä¸‹çš„é—²ç½®æ•ˆæœï¼Œè¿™é‡Œè¦æ³¨æ„åŒºåˆ†</p><p>â€‹    çŸ¥é“è¿™äº›åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†æ¬¡ä½¿ç”¨åŠ¨ç”»æ§åˆ¶å™¨æ¥ç®¡ç†åŠ¨ç”»çš„åˆ‡æ¢äº†</p><h2 id="ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»"><a href="#ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»" class="headerlink" title="ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»"></a>ä½¿ç”¨åŠ¨ç”»ç®¡ç†å™¨æ¥ç®¡ç†åŠ¨ç”»</h2><p>â€‹    é¦–å…ˆåœ¨<code>Animations</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª<code>Animator Controller</code>ä¸“é—¨ç”¨æ¥ç®¡ç†å²è±å§†çš„åŠ¨ç”»ï¼Œè¿™é‡Œæˆ‘å°†å®ƒå‘½åä¸º<code>Enemy _Slime</code>ï¼ŒğŸˆè®°ä½åˆ›å»ºå¥½åè¦æ‹–æ‹½åˆ°å²è±å§†çš„å±æ€§é¢æ¿ä¸Šåº”ç”¨è¯¥Animator Controller</p><img src="https://p6-tt.byteimg.com/origin/pgc-image/7fbb2f64cba8440f93954e02b86e2f50.png" alt="4.png" style="zoom:80%;" /><p>â€‹    æ¥ç€åŒå‡»æ‰“å¼€ä»–è¿›å…¥åŠ¨ç”»ç®¡ç†å™¨</p><p>â€‹    å› ä¸ºæ•Œäººæœ‰å¤šç§çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è€ƒè™‘å¦‚ä½•æ¥è§„åˆ’è¿™äº›åŠ¨ç”»ã€‚è€Œè¿™é‡Œåˆ™å¯ä»¥ä½¿ç”¨ä¸åŒçš„<code>Layer</code>æ¥å®ç°ä¸åŒçš„çŠ¶æ€</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/d35a90c16257478d823a52b598c87578.png" alt="5.png" style="zoom:80%;" /><center>å¯ä»¥åœ¨ä¸åŒçš„Layerä¸­å®ç°ä¸åŒçŠ¶æ€çš„åŠ¨ç”»</center><h3 id="Base-Layer"><a href="#Base-Layer" class="headerlink" title="Base Layer"></a>Base Layer</h3><p>â€‹    åˆšå¼€å§‹æˆ‘ä»¬åªç”¨åˆ°<code>Base Layer</code>ï¼Œå…¶å®ƒçš„layeræˆ‘ä»¬ä¹‹åå†åˆ›å»ºã€‚è€Œåœ¨æœ€å¼€å§‹çš„<code>Base Layer</code>å½“ä¸­ï¼Œæˆ‘ä»¬å®Œæˆæœ€åŸºæœ¬çš„çŠ¶æ€ï¼šæ™®é€šé—²ç½®å’Œè¡Œèµ°ï¼ˆå·¡é€»çŠ¶æ€ï¼‰</p><p>â€‹    å¦‚ä¸‹å›¾æ‰¾åˆ°å¯¹åº”çš„åŠ¨ç”»å¹¶æ‹–æ‹½åˆ°åŠ¨ç”»æ§åˆ¶å™¨ä¸­ï¼Œå¹¶è¿›è¡ŒçŠ¶æ€è½¬ç§»çš„è®¾ç½®</p><img src="https://p9-tt.byteimg.com/origin/pgc-image/138c62781a3b47deb564aacdc3bd0e6f.png" alt="6.png" style="zoom:80%;" /><p>â€‹    é‚£ä¹ˆé—²ç½®çŠ¶æ€åˆ‡æ¢åˆ°è¡Œèµ°çŠ¶æ€çš„æ¡ä»¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåœ¨ä¹‹å‰æˆ‘ä»¬æ§åˆ¶å°äººè¡Œèµ°çš„åŠ¨ç”»åˆ‡æ¢æ˜¯é€šè¿‡é¼ æ ‡ç‚¹å‡»çš„æ–¹å¼æ¥åˆ¤æ–­ï¼Œè€Œè¿™é‡Œæ•Œäººçš„çŠ¶æ€åˆ‡æ¢å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªé€»è¾‘çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªå¸ƒå°”å˜é‡æ¥æ§åˆ¶å®ƒä»¬çš„åˆ‡æ¢ï¼Œè¿™é‡Œå‘½åä¸º<code>Walk</code></p><img src="https://p5-tt.byteimg.com/origin/pgc-image/fc09aba486814ef9942061481e2d610e.png" alt="7.png" style="zoom:80%;" /><p>â€‹    ç„¶åå¡«å†™åŠ¨ç”»ä¹‹é—´çš„åˆ‡æ¢æ¡ä»¶</p><img src="https://p26-tt.byteimg.com/origin/pgc-image/9bfd3f46132a4c938c0dddaf775ab53b.png" alt="8.png" style="zoom:80%;" /><center>ä¸¤ä¸ªåˆ‡æ¢éƒ½è¦ï¼ˆä¸€ä¸ªä¸ºtrueï¼Œä¸€ä¸ªä¸ºfalseï¼‰</center><p>â€‹    </p><h3 id="Attack-Layerï¼ˆå®ç°è¿½å‡»ï¼‰"><a href="#Attack-Layerï¼ˆå®ç°è¿½å‡»ï¼‰" class="headerlink" title="Attack Layerï¼ˆå®ç°è¿½å‡»ï¼‰"></a>Attack Layerï¼ˆå®ç°è¿½å‡»ï¼‰</h3><p>â€‹    æ¥ä¸‹æ¥æˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–°çš„Layerï¼Œå¹¶å°†å…¶å‘½åä¸º<code>Attack Layer</code>ï¼Œæˆ‘ä»¬çš„è¿½å‡»åŠ¨ç”»åˆ‡æ¢å°±åœ¨è¿™é‡Œé¢æ¥å®ç°</p><p>â€‹    æ–°å»ºå¥½åæˆ‘ä»¬è¦è®¾ç½®ä¸€ä¸‹è¿™ä¸ªLayerçš„æƒé‡å€¼ï¼Œè¿™é‡Œè¦è°ƒæ•´<code>Weight</code>å€¼ä¸ºæœ€å¤§<code>1</code>ï¼Œè¡¨ç¤ºåœ¨åŠ¨ç”»è§¦å‘çš„æ—¶å€™æ˜¯å®Œå…¨è¦†ç›–åŸæ¥çš„Base Layeré‡Œçš„åŠ¨ç”»ï¼Œå¦‚æœä¸æ˜¯1çš„è¯å°±ç›¸å½“äºæ˜¯å åŠ åŸæ¥çš„åŠ¨ç”»ï¼Œä¸¤è€…è¿›è¡Œæ··åˆ</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/f5282b22821c4d0b919674b2c68cca85.png" alt="9.png" style="zoom:80%;" /><p>â€‹    é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦‚ä½•çŸ¥é“ä¸Šä¸€ä¸ªçŠ¶æ€æ˜¯æ€ä¹ˆåˆ‡æ¢åˆ°å½“å‰çš„Layerå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨æ–°å»ºçš„Layerä¸­åˆ›å»ºä¸€ä¸ª<code>Empty State</code>å¹¶å°†å®ƒå‘½åä¸º<code>Base State</code>ï¼Œè¿™ä¸ªç©ºçš„Stateå¯ä»¥ä»£è¡¨æˆ‘ä»¬ä¹‹å‰ä»»æ„ä¸€ä¸ªLayerï¼Œå½“æ»¡è¶³æ¡ä»¶çš„æ—¶å€™å®ƒå°±ä¼šåˆ‡æ¢è¿‡æ¥å¹¶è¿›ä¸€æ­¥åˆ‡æ¢åŠ¨ç”»</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/ac40128c56244e46893c469a70178825.png" alt="10.png" style="zoom:80%;" /><p>â€‹    åˆ‡æ¢è¿‡æ¥<code>Attack Layer</code>çš„æ—¶å€™æˆ‘ä»¬æœ€å…ˆè¦è¿›å…¥çš„æ˜¯ä¸€ä¸ªé—²ç½®çŠ¶æ€ï¼Œå†åŠ ä¸Šè¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºè¿½å‡»çš„Layerï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Idle_Battle</code>è¿™ä¸ªåŠ¨ç”»</p><img src="https://p3-tt.byteimg.com/origin/pgc-image/38b8683f9e2644ab8d281f80bcdd34fd.png" alt="11.png" style="zoom:80%;" /><p>â€‹    åŒæ ·æˆ‘ä»¬åˆ‡æ¢æ¡ä»¶ä¹Ÿæ˜¯å¯ä»¥å»ºç«‹ä¸€ä¸ª<code>å¸ƒå°”å€¼</code>å˜é‡æ¥æ§åˆ¶ï¼Œè¿™é‡Œå–åä¸º<code>Chase</code></p><p>â€‹    ä¸Šé¢çš„æ˜¯ä¸€ä¸ªæ•Œäººæ”»å‡»ç©ºå½“æ—¶CDåŠ¨ç”»ï¼Œå½“ç„¶æˆ‘ä»¬è¿˜è¦æœ‰ä¸€ä¸ªè¿½çš„åŠ¨ç”»ï¼Œä¹Ÿæ˜¯è¦é ä¸€ä¸ª<code>å¸ƒå°”å€¼</code>å˜é‡æ¥æ§åˆ¶ï¼Œå¦‚ä¸‹å›¾</p><img src="https://p5-tt.byteimg.com/origin/pgc-image/43a30493ed3d4be0a6204f23af878588.png" alt="12.png" style="zoom:80%;" /><p>â€‹    è¿™é‡Œæˆ‘æŠŠè¿½å‡»çš„åŠ¨ç”»ï¼ˆ<code>RunFWD</code>ï¼‰åŠ äº†ä¸Šå»ï¼Œå¹¶ç”¨ä¸€ä¸ªæ–°çš„å¸ƒå°”å€¼<code>Follow</code>æ¥ä½œä¸ºå®ƒä¸<code>IdleBattle</code>ä¹‹é—´çš„åˆ‡æ¢åˆ¤æ–­æ¡ä»¶</p><p>â€‹    ğŸˆæ³¨æ„å°†ä¸‰ä¸ªå¸ƒå°”å€¼éƒ½åº”ç”¨åˆ°å¯¹åº”çš„åŠ¨ç”»åˆ‡æ¢åˆ¤æ–­ä¸Šå»å“¦ï¼</p><p>â€‹    è¿™æ ·ä¸€æ¥å°±æœ‰äº†ä¸€ä¸ªé€»è¾‘ï¼šå¦‚æœæ•Œäººå‘ç°äº†æˆ‘ä»¬çš„æ§åˆ¶çš„å°äººï¼Œå¹¶ä¸”ä¸¤è€…è·ç¦»å¤§äºæ•Œäººçš„æ”»å‡»è·ç¦»ï¼Œæ•Œäººåˆ™ä¼šè¿›è¡Œè¿½å‡»æˆ‘ä»¬çš„å°äººï¼Œå½“é è¿‘ååˆ™ä¼šè¿›è¡Œæ”»å‡»CDçŠ¶æ€ï¼Œç­‰åˆ°ä¸‹ä¸€ä¸ªæ”»å‡»åˆ°æ¥ï¼ˆæ”»å‡»åŠ¨ç”»æ•ˆæœè¿™é‡Œè¿˜æ²¡å®ç°ï¼‰</p><h2 id="ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢"><a href="#ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢" class="headerlink" title="ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢"></a>ä½¿ç”¨ä»£ç é…åˆåŠ¨ç”»åˆ‡æ¢</h2><p>â€‹    å®ŒæˆåŠ¨ç”»ç®¡ç†å™¨ä¸­çš„å‰ç½®å·¥ä½œåï¼Œæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹æ¥å†™ä»£ç ä»è€Œé…åˆæˆ‘ä»¬çš„åŠ¨ç”»åˆ‡æ¢äº†</p><p>â€‹    æ‰“å¼€<code>EnemyController.cs</code>ï¼Œé¦–å…ˆè¦è·å–<code>Animator</code>ç»„ä»¶çš„ä¿¡æ¯</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token class-name">Animator</span> anim<span class="token punctuation">;</span>        <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//...</span>        anim <span class="token operator">=</span> <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Animator<span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    ç„¶åè¦å£°æ˜ä¸‰ä¸ªå¸ƒå°”å˜é‡å¯¹ç…§ç€åŠ¨ç”»ç®¡ç†å™¨çš„é‚£ä¸‰ä¸ªå¸ƒå°”å˜é‡ï¼ˆWalkã€Chaseã€Followï¼‰</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EnemyController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span><span class="token punctuation">&#123;</span><span class="token comment">//åŠ¨ç”»æ§åˆ¶çš„ä¸‰ä¸ªå¸ƒå°”å€¼å˜é‡</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isWalk<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isChase<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name"><span class="token keyword">bool</span></span> isFollow<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™ä¸‰ä¸ªå˜é‡æ˜¯ç”¨æ¥å®æ—¶æ›´æ–°åŠ¨ç”»æ§åˆ¶å™¨é‡Œçš„å¸ƒå°”å˜é‡çš„ï¼Œå› æ­¤æˆ‘ä»¬è¦ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å°†å®ƒæ”¾åœ¨<code>Update()</code>é‡Œè¾¹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//...</span>        <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//å®æ—¶æ›´æ–°Animatoré‡Œé¢å²è±å§†çš„ä¸‰ä¸ªå¸ƒå°”å€¼</span>    <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">SwitchAnimation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Walk"</span><span class="token punctuation">,</span>isWalk<span class="token punctuation">)</span><span class="token punctuation">;</span>        anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Chase"</span><span class="token punctuation">,</span>isChase<span class="token punctuation">)</span><span class="token punctuation">;</span>        anim<span class="token punctuation">.</span><span class="token function">SetBool</span><span class="token punctuation">(</span><span class="token string">"Follow"</span><span class="token punctuation">,</span>isFollow<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬åœ¨å…¶å®ƒå‡½æ•°é‡Œæ›´æ”¹äº†è¿™ä¸‰ä¸ªiså¸ƒå°”å€¼çš„è¯ï¼Œä»–ä»¬å°±å¯ä»¥å®æ—¶åŒæ­¥åˆ°Animatoré‡Œé¢äº†</p><p>â€‹    ç´§æ¥ç€æˆ‘ä»¬å›åˆ°<code>SwitchEnemyStates()</code>å‡½æ•°é‡Œé¢ä¿®æ”¹ä¸€ä¸‹</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//...</span><span class="token keyword">switch</span><span class="token punctuation">(</span>enemyStates<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token comment">//...</span>        <span class="token keyword">case</span> EnemyStates<span class="token punctuation">.</span>CHASE<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>è¿½å‡»<span class="token comment">//TODO:è¿½å‡»Player</span>    <span class="token comment">//TODO:åœ¨æ”»å‡»èŒƒå›´æ”»å‡»</span>            <span class="token comment">//TODO:é…åˆåŠ¨ç”»</span>        isWalk <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">//è¿½å‡»æ—¶å°±ä¸æ˜¯èµ°è·¯äº†</span>        isChase <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//åˆ‡æ¢åˆ°è¿½å‡»çš„Layerå±‚åŠ¨ç”»</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">//TODO:æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>        isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        isFollow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment">//æ‰¾åˆ°äººç‰©å°±è·‘ç€è¿½</span>      agent<span class="token punctuation">.</span>speed<span class="token operator">=</span>speed<span class="token punctuation">;</span>        <span class="token comment">//äººç‰©è¿›åˆ°æ•Œäººçš„èŒƒå›´ä¼šç»™è¿½å‡»</span>        agent<span class="token punctuation">.</span>destination<span class="token operator">=</span>attackTarget<span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>   <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    åˆ°è¿™é‡Œæˆ‘ä»¬å°±å®ç°äº†æ•Œäººè¿½å‡»æˆ‘ä»¬çš„çŠ¶æ€å•¦ï¼Œå¿«å»æ¸¸æˆä¸­è¯•ä¸€ä¸‹å§</p><h1 id="è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜"><a href="#è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜" class="headerlink" title="è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜"></a>è§£å†³æ•Œäººåœä¸‹æ¥æœ‰å»¶è¿Ÿçš„é—®é¢˜</h1><p>â€‹    è¯•è¿‡æ¸¸æˆåæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“æˆ‘ä»¬äººç‰©è„±ç¦»æ•Œäººè¿½å‡»èŒƒå›´æ—¶æ•Œäººä¼šå†èµ°ä¸€å°æ®µè·¯æ‰ä¼šåœä¸‹æ¥ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰åŠæ—¶ä¿®æ”¹æ•Œäººç§»åŠ¨çš„ç›®çš„åœ°ï¼Œä¹Ÿå°±æ˜¯<code>agent.destination</code>ï¼Œå½“è„±ç¦»è¿½å‡»èŒƒå›´åï¼Œæ•Œäººçš„ç›®çš„åœ°è¿˜åœ¨åé¢ä¸€å°æ®µè·¯ï¼Œä»è€Œå¯¼è‡´äº†å»¶è¿Ÿçš„æ•ˆæœ</p><p>â€‹    è¿™é‡Œä¿®æ”¹å®ƒä¹Ÿå¾ˆç®€å•ï¼Œåœ¨ä¸Šé¢ä»£ç æ·»åŠ ä¸€æ¡è¯­å¥å°±å¯ä»¥äº†</p><pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token comment">//...</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">FoundPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">//æ‹‰è„±å›ä¸Šä¸€ä¸ªçŠ¶æ€</span>    agent<span class="token punctuation">.</span>destination <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>transform<span class="token punctuation">.</span>position<span class="token punctuation">;</span><span class="token comment">//äººç‰©è„±ç¦»è¿½å‡»èŒƒå›´åï¼Œæ•Œäººåœåœ¨å½“å‰ä½ç½®</span>    isFollow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token comment">//...</span><span class="token punctuation">&#125;</span><span class="token comment">//...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹    è¿™æ ·ï¼Œæ•Œäººåœ¨è„±ç¦»è¿½å‡»çŠ¶æ€æ—¶å°±ä¼šç«‹åˆ»åœåœ¨å½“å‰ä½ç½®äº†</p><p>â€‹    ğŸ‰åˆ°è¿™é‡Œï¼Œæœ¬ç« æˆ‘ä»¬å°±æˆåŠŸå®ç°äº†æ•Œäººçš„ä¸€ä¸ªç®€å•çš„è¿½å‡»çŠ¶æ€åŠåŠ¨ç”»åˆ‡æ¢ç®¡ç†ï¼Œä¸‹ä¸€ç« æˆ‘ä»¬å°†æ›´åŠ å®Œå–„æ•Œäººå…¶å®ƒä¸€äº›çŠ¶æ€ï¼Œä¾‹å¦‚å·¡é€»æ•ˆæœç­‰</p>]]></content>
    
    
      
      
    <summary type="html">&lt;!--ç»ˆäºæœŸæœ«è€ƒå®Œè¯•äº†ï¼Œå¯ä»¥å›åˆ°Unityä¸Šæ¥äº†ğŸ˜ƒ--&gt;

&lt;p&gt;â€‹    æˆ‘ä»¬æ¥ç»§ç»­å®Œå–„æ•Œäººï¼Œè¿˜è®°å¾—æˆ‘ä»¬æœ‰ä¸ªåŠ¨ç”»åˆ‡æ¢çš„æ¡†æ¶ä»£ç æ‘†åœ¨é‚£å—ï¼Ÿè¿™ä¸€æ¬¡æˆ‘ä»¬æ¥ä¸ºæ•Œäººæ·»åŠ è¿½å‡»æ•ˆæœå¹¶ä¸”å¯¹ä¸åŒçŠ¶æ€ä¸‹çš„åŠ¨ç”»åˆ‡æ¢è¿›è¡Œç®¡ç†&lt;/p&gt;
&lt;h1 id=&quot;ä¿å­˜ä¿®æ”¹åçš„ç´ æ&quot;&gt;&lt;a href=&quot;#ä¿å­˜ä¿®æ”¹</summary>
      
    
    
    
    <category term="Unityå­¦ä¹ ç¬”è®°" scheme="http://sakura-pub.ltd/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity" scheme="http://sakura-pub.ltd/tags/Unity/"/>
    
  </entry>
  
</feed>
